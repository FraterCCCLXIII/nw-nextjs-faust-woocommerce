This file is a merged representation of the entire codebase, combined into a single document by Repomix.
The content has been processed where empty lines have been removed.

# File Summary

## Purpose
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

## File Format
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  a. A header with the file path (## File: path/to/file)
  b. The full contents of the file in a code block

## Usage Guidelines
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

## Notes
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Empty lines have been removed from all files
- Files are sorted by Git change count (files with more changes are at the bottom)

# Directory Structure
```
.github/
  ISSUE_TEMPLATE/
    bug_report.md
  workflows/
    codeql.yml
    lighthouse.yml
    playwright.yml
    repomix.yml
DOCS/
  PROJECT_REVIEW.md
  SUGGESTIONS.md
public/
  images/
    hero.jpg
    pexels-anastasia-shuraeva-7663296.jpg
    pexels-artempodrez-5726794.jpg
    pexels-bamboo-ave-677926128-29205121.jpg
    pexels-chokniti-khongchum-1197604-2280547.jpg
    pexels-chokniti-khongchum-1197604-2280549.jpg
    pexels-edward-jenner-4033152.jpg
    pexels-fotios-photos-734973.jpg
    pexels-googledeepmind-25626518.jpg
    pexels-jonathanborba-3076509.jpg
    pexels-mediocrememories-954584.jpg
    pexels-mediocrememories-954585.jpg
    pexels-polina-tankilevitch-3735766.jpg
    pexels-polina-tankilevitch-3735769.jpg
    pexels-polina-tankilevitch-3735782.jpg
    pexels-ron-lach-10534008.jpg
    pexels-sohi-807598.jpg
    pexels-tara-winstead-7723355.jpg
    pexels-tara-winstead-7723393.jpg
    pexels-thirdman-8940517.jpg
    pexels-vlada-karpovich-4534657.jpg
    vial.png
  favicon-16x16.png
  favicon-32x32.png
  favicon.ico
  favicon.svg
  preview.png
screenshots/
  screenshot1.jpg
src/
  components/
    AlgoliaSearch/
      AlgoliaSearchBox.component.tsx
      MobileSearch.component.tsx
      SearchResults.component.tsx
    Animations/
      types/
        Animations.types.ts
      FadeLeftToRight.component.tsx
      FadeLeftToRightItem.component.tsx
      FadeUp.component.tsx
    Blocks/
      BlockRenderer.component.tsx
    Cart/
      CartContents.component.tsx
      CartInitializer.component.tsx
      CartStickyFooter.component.tsx
    Category/
      Categories.component.tsx
    Checkout/
      Billing.component.tsx
      BillingAddressCheckbox.component.tsx
      BillingAddressFields.component.tsx
      CheckoutConfirmation.component.tsx
      CheckoutForm.component.tsx
      CheckoutLogin.component.tsx
      CheckoutOrderSummary.component.tsx
      CreateAccountAfterCheckout.component.tsx
      CreateAccountCheckbox.component.tsx
      CreditCardFields.component.tsx
      PaymentMethod.component.tsx
      StateField.component.tsx
      StripeElement.component.tsx
    Footer/
      Footer.component.tsx
      FooterDisclaimer.component.tsx
      Hamburger.component.tsx
      Stickynav.component.tsx
    Header/
      Cart.component.tsx
      Header.component.tsx
      MobileMenu.component.tsx
      nav.module.css
      Navbar.component.tsx
      NavDropdown.component.tsx
      SearchModal.component.tsx
      SearchTrigger.component.tsx
    Index/
      FeaturesList.component.tsx
      Hero.component.tsx
      HomeFAQ.component.tsx
      ImageBanner.component.tsx
      ProductCarousel.component.tsx
      TextSection.component.tsx
    Input/
      InputField.component.tsx
    Layout/
      AgeVerificationModal.component.tsx
      CartLayout.component.tsx
      CheckoutLayout.component.tsx
      Layout.component.tsx
      PageTitle.component.tsx
      ShippingBanner.component.tsx
    LoadingSpinner/
      LoadingSpinner.component.tsx
    Product/
      AddToCart.component.tsx
      DisplayProducts.component.tsx
      ImageGallery.component.tsx
      OptionSelect.component.tsx
      ProductActions.component.tsx
      ProductCard.component.tsx
      ProductDetailTabs.component.tsx
      ProductDisclaimer.component.tsx
      ProductFilters.component.tsx
      ProductInfo.component.tsx
      ProductList.component.tsx
      ProductPrice.component.tsx
      ProductTabs.component.tsx
      SingleProduct.component.tsx
    Research/
      ResearchPostCard.component.tsx
    SVG/
      SVGMobileSearchIcon.component.tsx
    UI/
      icons/
        AccountIcon.component.tsx
        CartIcon.component.tsx
        PlusIcon.component.tsx
        SearchIcon.component.tsx
        StarIcon.component.tsx
      Button.component.tsx
      Checkbox.component.tsx
      ChevronDown.component.tsx
      FAQ.component.tsx
      Logo.component.tsx
      RangeSlider.component.tsx
    User/
      AccountAddresses.component.tsx
      AccountDashboard.component.tsx
      AccountDetails.component.tsx
      AccountDownloads.component.tsx
      AccountNavigation.component.tsx
      AccountOrders.component.tsx
      AccountPaymentMethods.component.tsx
      CustomerAccount.component.tsx
      UserLogin.component.tsx
      UserRegistration.component.tsx
      withAuth.component.tsx
  hooks/
    useProductFilters.ts
  images/
    hero.jpg
  lib/
    fonts.ts
  pages/
    account/
      account-details.tsx
      addresses.tsx
      downloads.tsx
      orders.tsx
      payment-methods.tsx
    api/
      faust/
        [[...route]].js
    articles/
      [slug].tsx
    category/
      [slug].tsx
    kategori/
      [slug].tsx
    pages/
      [slug].tsx
      about-us.tsx
      components.tsx
      contact.tsx
      privacy-policy.tsx
      returns-and-refunds.tsx
      terms-of-service.tsx
    product/
      [slug].tsx
    produkt/
      [slug].tsx
    _app.tsx
    _document.tsx
    [...slug].tsx
    account.tsx
    articles.tsx
    cart.tsx
    catalog.tsx
    categories.tsx
    checkout.tsx
    handlekurv.tsx
    index.tsx
    kasse.tsx
    kategorier.tsx
    logg-inn.tsx
    login-faust.tsx
    login.tsx
    min-konto.tsx
    produkter.tsx
    register.tsx
  stores/
    cartStore.ts
  styles/
    algolia.min.css
    animate.min.css
    globals.css
    wp-blocks.css
  tests/
    Categories/
      Categories.spec.ts
    Index/
      Index.spec.ts
  types/
    product.ts
  utils/
    apollo/
      ApolloClient.js
    constants/
      INPUT_FIELDS.ts
      LINKS.ts
    functions/
      functions.tsx
      productUtils.ts
    gql/
      GQL_MUTATIONS.ts
      GQL_QUERIES.ts
    auth.ts
  wp-blocks/
    CoreImage.js
    index.js
  faust.config.js
.codeclimate.yml
.dockerignore
.env.example
.eslintrc.json
.gitignore
.prettierrc
ACCOUNT_AND_PAYMENT_FIXES.md
BEST_PRACTICES_FROM_WOONUXT.md
CODE_OF_CONDUCT.md
CONTRIBUTING.md
COOLIFY.md
Dockerfile
IMPLEMENTATION_COMPLETE.md
IMPLEMENTATION_STATUS.md
LICENSE
lighthouserc.json
LOGOUT_FIX.md
next.config.js
package.json
playwright.config.ts
postcss.config.js
README copy.md
README.md
renovate.json
STRIPE_ENV_VARIABLES_EXPLAINED.md
tailwind.config.js
tsconfig.json
WORDPRESS_BLOCKS_SETUP.md
WORDPRESS_CUSTOM_FIELDS_SETUP.md
WPGraphQL_CONTENT_BLOCKS_INSTALL.md
```

# Files

## File: .github/ISSUE_TEMPLATE/bug_report.md
````markdown
* * *

name: Bug report
about: Create a report to help us improve
title: ''
labels: ''
assignees: ''

* * *

**Describe the bug**
A clear and concise description of what the bug is.

**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Desktop (please complete the following information):**

-   OS: [e.g. iOS]
-   Browser [e.g. chrome, safari]
-   Version [e.g. 22]

**Smartphone (please complete the following information):**

-   Device: [e.g. iPhone6]
-   OS: [e.g. iOS8.1]
-   Browser [e.g. stock browser, safari]
-   Version [e.g. 22]

**Additional context**
Add any other context about the problem here.
````

## File: .github/workflows/codeql.yml
````yaml
name: "CodeQL"
on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]
  schedule:
    - cron: "5 12 * * 2"
jobs:
  analyze:
    name: Analyze
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write
    strategy:
      fail-fast: false
      matrix:
        language: [ javascript ]
    steps:
      - name: Checkout
        uses: actions/checkout@v6
      - name: Initialize CodeQL
        uses: github/codeql-action/init@v4
        with:
          languages: ${{ matrix.language }}
          queries: +security-and-quality
      - name: Autobuild
        uses: github/codeql-action/autobuild@v4
      - name: Perform CodeQL Analysis
        uses: github/codeql-action/analyze@v4
        with:
          category: "/language:${{ matrix.language }}"
````

## File: .github/workflows/lighthouse.yml
````yaml
name: Lighthouse CI
on: [push, pull_request]
jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v6
      - name: Setup Node.js
        uses: actions/setup-node@v6
        with:
          node-version: '24'
      - name: Setup pnpm
        uses: pnpm/action-setup@41ff72655975bd51cab0327fa583b6e92b6d3061 # v4
        with:
          version: 10
          run_install: false
      - name: Get pnpm store directory
        shell: bash
        run: |
          echo "STORE_PATH=$(pnpm store path --silent)" >> $GITHUB_ENV
      - name: Setup pnpm cache
        uses: actions/cache@v4
        with:
          path: ${{ env.STORE_PATH }}
          key: ${{ runner.os }}-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}
          restore-keys: |
            ${{ runner.os }}-pnpm-store-
      - name: Install dependencies
        run: pnpm install
      - name: Build project
        env:
          NEXT_PUBLIC_GRAPHQL_URL: ${{ secrets.NEXT_PUBLIC_GRAPHQL_URL }}
          NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL: "https://via.placeholder.com/200"
          NEXT_PUBLIC_PLACEHOLDER_LARGE_IMAGE_URL: "https://via.placeholder.com/600"
        run: pnpm build
      - name: Start server
        env:
          NEXT_PUBLIC_GRAPHQL_URL: ${{ secrets.NEXT_PUBLIC_GRAPHQL_URL }}
          NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL: "https://via.placeholder.com/200"
          NEXT_PUBLIC_PLACEHOLDER_LARGE_IMAGE_URL: "https://via.placeholder.com/600"
        run: |
          pnpm start &
          echo "Waiting for server to be ready..."
          while ! nc -z localhost 3000; do
            sleep 5
          done
          # Additional wait to ensure full initialization
          sleep 20
      - name: Run Lighthouse CI
        run: |
          pnpm lhci:perf
          pnpm lhci:desktop
        env:
          LHCI_GITHUB_APP_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      - name: Stop server
        if: always()
        run: |
          pkill -f "next start" || true
````

## File: .github/workflows/playwright.yml
````yaml
name: Playwright Tests
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
jobs:
  test:
    timeout-minutes: 60
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v6
    - uses: actions/setup-node@v6
      with:
        node-version: 24
    - name: Install dependencies
      run: npm ci
    - name: Install Playwright Browsers
      run: npx playwright install --with-deps
    - name: Build the project
      run: npm run build
      env:
        NEXT_PUBLIC_GRAPHQL_URL: ${{ secrets.NEXT_PUBLIC_GRAPHQL_URL }}
    - name: Start the application
      run: npm run start &
      env:
        NEXT_PUBLIC_GRAPHQL_URL: ${{ secrets.NEXT_PUBLIC_GRAPHQL_URL }}
    - name: Wait for the application to be ready
      run: |
        echo "Waiting for the application to be ready..."
        timeout 300 bash -c 'while [[ "$(curl -s -o /dev/null -w ''%{http_code}'' localhost:3000)" != "200" ]]; do sleep 5; done' || false
        echo "Application is ready!"
    - name: Run Playwright tests
      run: npx playwright test
      env:
        CI: true
        NEXT_PUBLIC_GRAPHQL_URL: ${{ secrets.NEXT_PUBLIC_GRAPHQL_URL }}
        DEBUG: pw:api
    - name: Upload test results
      if: always()
      uses: actions/upload-artifact@v5
      with:
        name: playwright-report
        path: playwright-report/
        retention-days: 30
    - name: Upload test traces
      if: failure()
      uses: actions/upload-artifact@v5
      with:
        name: playwright-traces
        path: test-results/
        retention-days: 30
````

## File: .github/workflows/repomix.yml
````yaml
name: Repository Documentation
on:
  push:
    branches:
      - main
  workflow_dispatch: # allows manual triggering
permissions:
  contents: write
  pull-requests: write
jobs:
  analyze:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6
        with:
          fetch-depth: 0 # fetch all history for better context
      - name: Wait for other checks
        run: |
          echo "Waiting for 5 minutes to allow other checks to complete..."
          sleep 300
      - name: Setup Node.js
        uses: actions/setup-node@v6
        with:
          node-version: "24"
      - name: Install Repomix
        run: npm install -g repomix
      - name: Generate Repository Documentation
        run: |
          echo "Creating DOCS directory..."
          mkdir -p DOCS
          echo "Running Repomix..."
          if ! repomix --output DOCS/repository_context.txt --style markdown --remove-empty-lines --verbose; then
            echo "Error: Repomix command failed"
            # Print directory contents for debugging
            echo "DOCS directory contents:"
            ls -la DOCS/
            exit 1
          fi
          echo "Verifying output file..."
          if [ ! -f "DOCS/repository_context.txt" ]; then
            echo "Error: repository_context.txt was not created"
            # Print directory contents for debugging
            echo "DOCS directory contents:"
            ls -la DOCS/
            exit 1
          fi
          if [ ! -s "DOCS/repository_context.txt" ]; then
            echo "Error: repository_context.txt is empty"
            exit 1
          fi
          echo "Repository context file generated successfully"
          echo "File size: $(stat --format=%s "DOCS/repository_context.txt") bytes"
          echo "First few lines of the file:"
          head -n 5 "DOCS/repository_context.txt"
      # Update Documentation
      - name: Commit and Push Changes
        run: |
          echo "Configuring git..."
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          echo "Checking for changes..."
          if [[ -n "$(git status --porcelain)" ]]; then
            echo "Changes detected, committing..."
            # Stage only repository_context.txt to avoid unintended changes
            if ! git add DOCS/repository_context.txt; then
              echo "Error: Failed to stage repository_context.txt"
              exit 1
            fi
            if ! git commit -m "docs: update repository context via Repomix [skip ci]"; then
              echo "Error: Failed to create commit"
              exit 1
            fi
            echo "Pushing to main branch..."
            if ! git push; then
              echo "Error: Failed to push changes"
              exit 1
            fi
            echo "Successfully updated repository context"
          else
            echo "No changes detected in repository_context.txt"
          fi
````

## File: DOCS/PROJECT_REVIEW.md
````markdown
# Project Review & Recommendations

## Overall Assessment

The project demonstrates solid engineering practices with a well-structured codebase. The separation of concerns is clear, components are modular, and the state management approach is pragmatic.

## Key Strengths

1. **Cart Implementation**
   - Clean separation between UI and state management
   - Effective use of React Context for global state
   - Smart persistence strategy with localStorage

2. **Checkout Flow**
   - Well-orchestrated process with clear state handling
   - Good use of react-hook-form for form management
   - Clear loading/error/success states

## Recommended Improvements

### 1. State Management Refinements
- Currently exposes raw `setCart` function in CartProvider, which could lead to inconsistent state
- Recommendation: Replace with specific action functions:
  ```typescript
  {
    addToCart: (product: Product) => void;
    removeFromCart: (productId: string) => void;
    updateQuantity: (productId: string, quantity: number) => void;
    clearCart: () => void;
  }
  ```

### 2. Security Enhancements
- Session tokens stored in localStorage are vulnerable to XSS
- Consider implementing:
  - HttpOnly cookies for session management
  - CSRF protection for mutations
  - Rate limiting on checkout endpoints

### 3. Payment System Flexibility
- Currently hardcoded to Cash on Delivery
- Suggested improvements:
  - Abstract payment method selection
  - Implement payment gateway integration interface
  - Add support for multiple payment providers

### 4. Error Handling
- Add comprehensive error boundaries
- Implement retry logic for failed GraphQL operations
- Add detailed error logging and monitoring
- Consider implementing offline support/queue for cart operations

### 5. Performance Optimizations
- Implement cart item quantity debouncing
- Add product list virtualization for large catalogs
- Consider implementing optimistic UI updates
- Add prefetching for common user paths

### 6. Developer Experience
- Add more comprehensive TypeScript types
- Consider implementing Storybook for component development
- Add unit tests for critical business logic
- Implement automated accessibility testing

### 7. User Experience
- Add toast notifications for cart operations
- Implement better loading skeletons
- Add offline support indicators
- Improve form error messaging and validation feedback

## Priority Recommendations

1. **High Priority**
   - Secure session management (move from localStorage to HttpOnly cookies)
   - Implement specific cart action functions instead of exposing setCart
   - Add comprehensive error handling

2. **Medium Priority**
   - Flexible payment gateway integration
   - Performance optimizations
   - Enhanced error feedback

3. **Nice to Have**
   - Developer experience improvements
   - Additional UX enhancements
   - Automated testing expansion
````

## File: DOCS/SUGGESTIONS.md
````markdown
# Senior-Level Improvements

## 1. Architecture & State Management

### Global State Management
- **Replace Context API with Redux Toolkit or Zustand**
  - Gain: Better state management, dev tools, middleware support
  - Example: Move cart state to Redux with proper slices and actions

```typescript
// Example Redux slice for cart
const cartSlice = createSlice({
  name: 'cart',
  initialState,
  reducers: {
    addToCart: (state, action) => {
      // Immutable state updates with Redux Toolkit
    },
    removeFromCart: (state, action) => {
      // Automatic handling of immutability
    }
  }
});
```

### Service Layer
- **API Abstraction**
  - Gain: Better separation of concerns, easier testing and maintenance
  - Example: Create dedicated service classes for API operations

```typescript
class ProductService {
  private api: ApiClient;
  
  async getProducts(filters: ProductFilters): Promise<Product[]> {
    // Centralized error handling and response mapping
  }
}
```

## 2. Performance Optimizations

### Code Splitting
- **Dynamic Imports**
  - Gain: Smaller initial bundle size, faster page loads
  - Example: Lazy load product filters on mobile

```typescript
const ProductFilters = dynamic(() => import('./ProductFilters'), {
  loading: () => <FiltersSkeleton />,
  ssr: false
});
```

### Caching Strategy
- **Apollo Client Caching**
  - Gain: Faster data access, reduced server load
  - Example: Implement field-level caching policies

```typescript
const cache = new InMemoryCache({
  typePolicies: {
    Product: {
      fields: {
        price: {
          read(price) {
            // Custom cache reading logic
          }
        }
      }
    }
  }
});
```

## 3. Testing & Quality Assurance

### Unit Testing
- **Jest/React Testing Library**
  - Gain: Catch bugs early, ensure component behavior
  - Example: Test hooks like useProductFilters in isolation

```typescript
describe('useProductFilters', () => {
  it('should filter products by price range', () => {
    const { result } = renderHook(() => useProductFilters());
    act(() => {
      result.current.setPriceRange([10, 50]);
    });
    expect(result.current.filterProducts(mockProducts)).toEqual(
      expect.arrayContaining([
        expect.objectContaining({ price: expect.any(Number) })
      ])
    );
  });
});
```

### E2E Testing
- **Expand Playwright Tests**
  - Gain: Ensure critical user flows work end-to-end
  - Example: Add comprehensive checkout flow testing

```typescript
test('complete checkout process', async ({ page }) => {
  await page.goto('/');
  await page.click('[data-testid="product-card"]');
  await page.click('[data-testid="add-to-cart"]');
  // Test entire checkout flow
});
```

## 4. WooCommerce Integration Enhancements

### Session Management
- **Improve WooCommerce Session Handling**
  - Gain: Better cart persistence, reduced errors
  - Example: Enhanced session token management

```typescript
// Enhanced WooCommerce session middleware
const enhancedMiddleware = new ApolloLink((operation, forward) => {
  const session = getWooSession();
  if (session && !isExpired(session)) {
    operation.setContext({
      headers: {
        'woocommerce-session': `Session ${session.token}`
      }
    });
  }
  return forward(operation);
});
```

### Cart Improvements
- **Enhanced Cart Features**
  - Gain: Better user experience with cart functionality
  - Example: Add cart total, copy billing address to shipping

## 5. Developer Experience

### Documentation
- **Storybook Integration**
  - Gain: Better component documentation, easier UI development
  - Example: Document all variants of ProductCard

```typescript
// ProductCard.stories.tsx
export const WithDiscount = {
  args: {
    product: {
      name: 'Test Product',
      price: '100',
      salePrice: '80',
      onSale: true
    }
  }
};
```

### TypeScript Improvements
- **Stricter Configuration**
  - Gain: Catch more bugs at compile time
  - Example: Enable strict mode, add proper generics

```typescript
// tsconfig.json improvements
{
  "compilerOptions": {
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "exactOptionalPropertyTypes": true
  }
}
```

## 6. Monitoring & Analytics

### Error Tracking
- **Sentry Integration**
  - Gain: Better error tracking, faster bug fixing
  - Example: Add proper error boundaries with Sentry

```typescript
class ErrorBoundary extends React.Component {
  componentDidCatch(error, errorInfo) {
    Sentry.captureException(error, { extra: errorInfo });
  }
}
```

### Performance Monitoring
- **Core Web Vitals**
  - Gain: Track and improve user experience metrics
  - Example: Implement proper performance monitoring

## 7. Code Quality & Maintainability

### Design Patterns
- **Implement Factory Pattern**
  - Gain: Better code organization, easier maintenance
  - Example: Create product factory for different types

```typescript
class ProductFactory {
  createProduct(type: ProductType, data: ProductData): Product {
    switch (type) {
      case 'simple':
        return new SimpleProduct(data);
      case 'variable':
        return new VariableProduct(data);
      default:
        throw new Error(`Unknown product type: ${type}`);
    }
  }
}
```

### Code Organization
- **Feature-based Structure**
  - Gain: Better code organization, easier navigation
  - Example: Reorganize code by feature instead of type

```
src/
  features/
    products/
      components/
      hooks/
      services/
      types/
    cart/
      components/
      hooks/
      services/
      types/
```

## Implementation Priority Matrix

### High Impact, Low Effort (Do First)
1. **TypeScript Strict Mode**
   - Simply update tsconfig.json
   - Immediate impact on code quality
   - Catches type-related bugs early

2. **Lighthouse Score Improvements**
   - Already have CI integration
   - Focus on performance metrics
   - Quick accessibility wins

3. **Cart Total Implementation**
   - Listed in TODO
   - High user impact
   - Relatively simple change

### High Impact, High Effort (Plan Carefully)
1. **State Management Refactor**
   - Requires significant refactoring
   - Major architectural improvement
   - Plan and implement in phases

2. **Feature-based Code Reorganization**
   - Substantial restructuring needed
   - Improves long-term maintainability
   - Requires team coordination

### Low Impact, Low Effort (Quick Wins)
1. **Storybook Documentation**
   - Can be added gradually
   - Improves developer experience
   - Start with key components

2. **Performance Monitoring**
   - Easy integration with existing tools
   - Provides valuable insights
   - Quick setup process

### Low Impact, High Effort (Consider Later)
1. **Expand Test Coverage**
   - Build upon existing Playwright E2E tests
   - Already have basic homepage tests
   - Focus on:
     - WooCommerce integration tests
     - Cart/checkout flows
     - Variable product handling
     - Stock status updates

2. **User Registration & Dashboard**
   - Listed in TODO
   - Requires careful WooCommerce integration
   - Consider after core improvements

## Implementation Strategy

1. **Week 1-2: Quick Wins**
   - Enable TypeScript strict mode
   - Add error boundaries
   - Optimize Apollo cache
   - Estimated effort: 3-4 days
   - Immediate quality improvements

2. **Week 3-4: Foundation Building**
   - Begin Storybook documentation
   - Set up performance monitoring
   - Expand existing E2E tests with:
     - Cart manipulation scenarios
     - Checkout flow validation
     - Error state handling
   - Estimated effort: 5-7 days
   - Builds upon existing test infrastructure

3. **Month 2: Major Improvements**
   - Implement user registration flow
   - Add cart improvements from TODO list
   - Enhance WooCommerce session handling
   - Estimated effort: 3-4 weeks
   - Focus on core user experience

This prioritization ensures:
- Quick delivery of high-impact improvements
- Minimal disruption to ongoing development
- Measurable progress at each stage
- Efficient use of development resources
````

## File: public/favicon.svg
````
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" version="1.1" viewBox="0 0 160 145" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421"><path d="M11.142,45.302l45.301,-45.302c14.82,14.819 14.82,38.846 0,53.665l-45.301,45.303c-14.82,-14.82 -14.82,-38.847 0,-53.666l0,0Z" style="fill:#095684;fill-rule:nonzero"/><path d="M56.411,90.635l-14.562,-14.562l-30.74,-30.739c-10.09,10.091 -13.303,24.446 -9.654,37.261c1.712,6.006 4.923,11.676 9.654,16.405l45.302,45.301c14.819,-14.818 14.819,-38.846 0,-53.666l0,0Z" style="fill:#23b99a;fill-rule:nonzero"/><path d="M147.903,45.302l-45.301,-45.302c-14.819,14.819 -14.819,38.846 0,53.665l45.301,45.303c14.82,-14.82 14.82,-38.847 0,-53.666l0,0Z" style="fill:#23b99a;fill-rule:nonzero"/><path d="M102.635,90.635l14.562,-14.562l30.74,-30.739c10.089,10.091 13.302,24.446 9.653,37.261c-1.711,6.006 -4.924,11.676 -9.653,16.405l-45.302,45.301c-14.82,-14.818 -14.82,-38.846 0,-53.666l0,0Z" style="fill:#095684;fill-rule:nonzero"/><path d="M11.141,45.302l45.302,-45.302c14.82,14.819 14.82,38.846 0,53.665l-45.302,45.303c-14.819,-14.82 -14.819,-38.847 0,-53.666l0,0Z" style="fill:#095684;fill-rule:nonzero"/><path d="M56.411,90.635l-14.563,-14.562l-30.739,-30.739c-10.09,10.091 -13.303,24.446 -9.654,37.261c1.712,6.006 4.923,11.676 9.654,16.405l45.302,45.301c14.819,-14.818 14.819,-38.846 -0.001,-53.666l0,0Z" style="fill:#23b99a;fill-rule:nonzero"/><path d="M147.903,45.302l-45.301,-45.302c-14.82,14.819 -14.82,38.846 0,53.665l45.301,45.303c14.82,-14.82 14.82,-38.847 0,-53.666l0,0Z" style="fill:#23b99a;fill-rule:nonzero"/><path d="M102.635,90.635l14.561,-14.562l30.741,-30.739c10.089,10.091 13.302,24.446 9.652,37.261c-1.71,6.006 -4.923,11.676 -9.652,16.405l-45.303,45.301c-14.82,-14.818 -14.82,-38.846 0,-53.666l0,0Z" style="fill:#095684;fill-rule:nonzero"/></svg>
````

## File: src/components/AlgoliaSearch/AlgoliaSearchBox.component.tsx
````typescript
import algoliasearch from 'algoliasearch';
import { InstantSearch, SearchBox, Hits } from 'react-instantsearch-dom';
import { useState, useMemo } from 'react';
import SearchResults from './SearchResults.component';
// Check if Algolia credentials are configured
const isAlgoliaConfigured = () => {
  const appId = process.env.NEXT_PUBLIC_ALGOLIA_APP_ID;
  const apiKey = process.env.NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY;
  const indexName = process.env.NEXT_PUBLIC_ALGOLIA_INDEX_NAME;
  return !!(
    appId && 
    appId !== 'changeme' && 
    appId !== 'changethis' &&
    apiKey && 
    apiKey !== 'changeme' && 
    apiKey !== 'changethis' &&
    indexName && 
    indexName !== 'changeme'
  );
};
// Create a mock search client that returns empty results when Algolia is not configured
const createMockSearchClient = () => ({
  search: async () => ({
    results: [{
      hits: [],
      nbHits: 0,
      nbPages: 0,
      page: 0,
      hitsPerPage: 0,
      processingTimeMS: 0,
      query: '',
      params: '',
    }],
  }),
});
const searchClient = isAlgoliaConfigured()
  ? algoliasearch(
      process.env.NEXT_PUBLIC_ALGOLIA_APP_ID!,
      process.env.NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY!,
    )
  : createMockSearchClient();
// https://www.algolia.com/doc/api-reference/widgets/instantsearch/react/
/**
 * Displays Algolia search for larger resolutions that do not show the mobile menu
 */
const AlgoliaSearchBox = () => {
  const [search, setSearch] = useState<string | null>(null);
  const [hasFocus, sethasFocus] = useState<boolean>(false);
  const algoliaConfigured = useMemo(() => isAlgoliaConfigured(), []);
  // Don't render if Algolia is not configured
  if (!algoliaConfigured) {
    return null;
  }
  return (
    <div className="hidden mt-2 md:inline xl:inline">
      <div className="">
        <InstantSearch
          indexName={process.env.NEXT_PUBLIC_ALGOLIA_INDEX_NAME!}
          searchClient={searchClient}
        >
          {/*We need to conditionally add a border because the element has position:fixed*/}
          <SearchBox
            aria-label="Search here"
            translations={{
              submitTitle: 'Search',
              resetTitle: 'Clear search text',
              placeholder: 'Search for products',
            }}
            className={`px-4 py-2 text-base bg-white border outline-none rounded ${
              hasFocus ? 'border-black' : 'border-gray-400'
            }`}
            onChange={(event) => {
              const target = event.target as HTMLInputElement;
              sethasFocus(true);
              setSearch(target.value);
            }}
            onKeyDown={(event) => {
              const target = event.target as HTMLInputElement;
              sethasFocus(true);
              setSearch(target.value);
            }}
            onReset={() => {
              setSearch(null);
            }}
          />
          {search && (
            <div className="absolute z-50 bg-white shadow-lg rounded-md mt-1 md:w-[18rem]">
              <Hits hitComponent={SearchResults} />
            </div>
          )}
        </InstantSearch>
      </div>
    </div>
  );
};
export default AlgoliaSearchBox;
````

## File: src/components/AlgoliaSearch/MobileSearch.component.tsx
````typescript
import algoliasearch from 'algoliasearch';
import { InstantSearch, SearchBox, Hits } from 'react-instantsearch-dom';
import { useState, useMemo } from 'react';
import SearchResults from './SearchResults.component';
// Check if Algolia credentials are configured
const isAlgoliaConfigured = () => {
  const appId = process.env.NEXT_PUBLIC_ALGOLIA_APP_ID;
  const apiKey = process.env.NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY;
  const indexName = process.env.NEXT_PUBLIC_ALGOLIA_INDEX_NAME;
  return !!(
    appId && 
    appId !== 'changeme' && 
    appId !== 'changethis' &&
    apiKey && 
    apiKey !== 'changeme' && 
    apiKey !== 'changethis' &&
    indexName && 
    indexName !== 'changeme'
  );
};
// Create a mock search client that returns empty results when Algolia is not configured
const createMockSearchClient = () => ({
  search: async () => ({
    results: [{
      hits: [],
      nbHits: 0,
      nbPages: 0,
      page: 0,
      hitsPerPage: 0,
      processingTimeMS: 0,
      query: '',
      params: '',
    }],
  }),
});
const searchClient = isAlgoliaConfigured()
  ? algoliasearch(
      process.env.NEXT_PUBLIC_ALGOLIA_APP_ID!,
      process.env.NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY!,
    )
  : createMockSearchClient();
/**
 * Algolia search for mobile menu.
 */
const MobileSearch = () => {
  const [search, setSearch] = useState<string | null>(null);
  const [hasFocus, sethasFocus] = useState<boolean>(false);
  const algoliaConfigured = useMemo(() => isAlgoliaConfigured(), []);
  // Don't render if Algolia is not configured
  if (!algoliaConfigured) {
    return null;
  }
  return (
    <div className="inline mt-4 md:hidden">
      <InstantSearch
        indexName={process.env.NEXT_PUBLIC_ALGOLIA_INDEX_NAME!}
        searchClient={searchClient}
      >
        <SearchBox
          translations={{
            submitTitle: 'Search',
            resetTitle: 'Clear search text',
            placeholder: 'Search for products',
          }}
          className={`px-4 py-2 text-base bg-white border outline-none rounded ${
            hasFocus ? 'border-black' : 'border-gray-400'
          }`}
          onReset={() => {
            setSearch(null);
          }}
          onChange={(event) => {
            const target = event.target as HTMLInputElement;
            sethasFocus(true);
            setSearch(target.value);
          }}
          onKeyDown={(event) => {
            const target = event.target as HTMLInputElement;
            sethasFocus(true);
            setSearch(target.value);
          }}
        />
        {search && <Hits hitComponent={SearchResults} />}
      </InstantSearch>
    </div>
  );
};
export default MobileSearch;
````

## File: src/components/AlgoliaSearch/SearchResults.component.tsx
````typescript
import Link from 'next/link';
import { trimmedStringToLength } from '@/utils/functions/functions';
interface ISearchResultProps {
  hit: {
    product_image: string;
    product_name: string;
    regular_price: string;
    sale_price: string;
    on_sale: boolean;
    short_description: string;
    slug: string;
  };
}
/**
 * Displays search results from Algolia
 * @param {object} hit {
 * @param {string} product_image Product image from WooCommerce
 * @param {string} product_name Name of product
 * @param {string} regular_price Price without discount
 * @param {string} sale_price Price when on sale
 * @param {boolean} on_sale Is the product on sale? True or false
 * @param {string} short_description Short description of product
 }
 */
const SearchResults = ({
  hit: {
    product_image,
    product_name,
    regular_price,
    sale_price,
    on_sale,
    short_description,
  },
}: ISearchResultProps) => {
  return (
    <article className="cursor-pointer hit">
      <Link
        href={`/product/${product_name.replace(/ /g, '-')}`}
        passHref
      >
        <div className="flex p-6 bg-white">
          <header className="hit-image-container">
            <img
              src={product_image}
              alt={product_name}
              className="w-12 hit-image"
            />
          </header>
          <div className="pl-4 text-left">
            {product_name && (
              <span className="text-lg font-bold">{product_name}</span>
            )}
            <br />
            {on_sale && (
              <>
                <span className="text-base line-through">
                  {regular_price}
                </span>
                <span className="ml-2 text-base">{sale_price}</span>
              </>
            )}
            {!on_sale && <span className="text-base">{regular_price}</span>}
            <br />
            <span className="text-base">
              {trimmedStringToLength(short_description, 30)}
            </span>
          </div>
        </div>
      </Link>
    </article>
  );
};
export default SearchResults;
````

## File: src/components/Animations/types/Animations.types.ts
````typescript
import { ReactNode } from 'react';
export interface IAnimateProps {
  children: ReactNode;
  cssClass?: string;
}
export interface IAnimateBounceProps {
  children: ReactNode;
  cssClass?: string;
  viewAmount?: 'some' | 'all' | number;
}
export interface IAnimateWithDelayProps {
  children: ReactNode;
  cssClass?: string;
  delay: number;
}
export interface IAnimateStaggerWithDelayProps {
  children: ReactNode;
  cssClass?: string;
  delay: number;
  staggerDelay?: number;
  animateNotReverse: boolean;
}
````

## File: src/components/Animations/FadeLeftToRight.component.tsx
````typescript
import { motion, Transition } from 'motion/react';
import type { IAnimateStaggerWithDelayProps } from './types/Animations.types';
/**
 * Fade content left to right. Needs to be used with FadeLeftToRightItem
 * @function FadeLeftToRight
 * @param {ReactNode} children - Children content to render
 * @param {string} cssClass - CSS classes to apply to component
 * @param {number} delay - Time to wait before starting animation
 * @param {number} staggerDelay - Time to wait before starting animation for children items
 * @param {boolean} animateNotReverse - Start animation backwards
 * @returns {JSX.Element} - Rendered component
 */
const FadeLeftToRight = ({
  children,
  cssClass,
  delay,
  staggerDelay,
  animateNotReverse,
}: IAnimateStaggerWithDelayProps) => {
  const visibleTransition: Transition = {
    when: 'beforeChildren',
    staggerChildren: staggerDelay ? staggerDelay : 0.5,
    delay,
    ease: 'easeInOut',
    staggerDirection: 1,
  };
  const hiddenTransition: Transition = {
    when: 'afterChildren',
    staggerChildren: staggerDelay ? staggerDelay : 0.5,
    staggerDirection: -1,
  };
  const FadeLeftToRightVariants = {
    visible: {
      opacity: 1,
      transition: visibleTransition,
    },
    hidden: {
      opacity: 0,
      transition: hiddenTransition,
    },
  };
  return (
    <motion.div
      initial="hidden"
      animate={animateNotReverse ? 'visible' : 'hidden'}
      variants={FadeLeftToRightVariants}
      className={cssClass}
      data-testid="fadelefttoright"
    >
      {children}
    </motion.div>
  );
};
export default FadeLeftToRight;
````

## File: src/components/Animations/FadeLeftToRightItem.component.tsx
````typescript
import { motion, Transition } from 'motion/react';
import type { IAnimateProps } from './types/Animations.types';
/**
 * Fade content left to right. Needs to be used with FadeLeftToRight as parent container
 * @function FadeLeftToRightItem
 * @param {ReactNode} children - Children content to render
 * @param {string} cssClass - CSS classes to apply to component
 * @returns {JSX.Element} - Rendered component
 */
const FadeLeftToRightItem = ({ children, cssClass }: IAnimateProps) => {
  const transition: Transition = {
    type: 'spring',
    duration: 0.5,
    stiffness: 110,
  };
  const fadeLeftToRightItemVariants = {
    visible: {
      opacity: 1,
      x: 0,
      transition,
    },
    hidden: { opacity: 0, x: -20 },
  };
  return (
    <motion.span
      variants={fadeLeftToRightItemVariants}
      className={cssClass}
      data-testid="fadelefttorightitem"
    >
      {children}
    </motion.span>
  );
};
export default FadeLeftToRightItem;
````

## File: src/components/Animations/FadeUp.component.tsx
````typescript
import { motion, Transition } from 'motion/react';
import type { IAnimateWithDelayProps } from './types/Animations.types';
/**
 * Fade up content animation
 * @function FadeUp
 * @param {ReactNode} children - Children content to render
 * @param {string} cssClass - CSS classes to apply to component
 * @param {number} delay - Time to wait before starting animation
 * @returns {JSX.Element} - Rendered component
 */
const FadeUp = ({ children, cssClass, delay }: IAnimateWithDelayProps) => {
  const transition: Transition = {
    delay,
    type: 'spring',
    duration: 0.5,
    stiffness: 110,
  };
  const fadeUpVariants = {
    initial: { opacity: 0, y: 20 },
    animate: {
      y: 0,
      opacity: 1,
      transition,
    },
  };
  return (
    <motion.div
      className={cssClass}
      variants={fadeUpVariants}
      initial="initial"
      animate="animate"
      data-testid="fadeup"
    >
      {children}
    </motion.div>
  );
};
export default FadeUp;
````

## File: src/components/Blocks/BlockRenderer.component.tsx
````typescript
"use client";
import Image from 'next/image';
import { ReactNode } from 'react';
interface Block {
  blockName?: string | null;
  name?: string;
  __typename?: string;
  innerBlocks?: Block[];
  innerContent?: string[];
  attrs?: Record<string, any>;
  attributes?: Record<string, any>;
  innerHTML?: string;
  renderedHtml?: string;
  saveContent?: string;
  originalContent?: string;
  clientId?: string;
  parentClientId?: string | null;
}
interface BlockRendererProps {
  blocks?: Block[] | string | null | undefined;
  editorBlocks?: Block[] | null | undefined;
  fallbackContent?: string;
}
/**
 * Converts flat editorBlocks array to hierarchical structure
 * Based on clientId and parentClientId relationships
 * If blocks are already hierarchical (have innerBlocks), returns as-is
 */
const flatListToHierarchical = (blocks: Block[]): Block[] => {
  if (!Array.isArray(blocks) || blocks.length === 0) {
    return [];
  }
  // Check if blocks already have hierarchical structure (innerBlocks populated)
  const hasHierarchy = blocks.some(block => 
    block.innerBlocks && Array.isArray(block.innerBlocks) && block.innerBlocks.length > 0
  );
  if (hasHierarchy) {
    // Already hierarchical, return as-is
    return blocks;
  }
  // Check if we have clientId/parentClientId structure (flat list from WPGraphQL Content Blocks)
  const hasClientIds = blocks.some(block => block.clientId);
  if (!hasClientIds) {
    // No clientId structure, return as-is (might be from blocks/blocksJSON)
    return blocks;
  }
  // Create a map of blocks by clientId
  const blockMap = new Map<string, Block>();
  blocks.forEach(block => {
    if (block.clientId) {
      blockMap.set(block.clientId, { ...block, innerBlocks: [] });
    }
  });
  // Build hierarchical structure
  const rootBlocks: Block[] = [];
  blocks.forEach(block => {
    if (!block.clientId) {
      // Block without clientId goes to root
      rootBlocks.push(block);
      return;
    }
    const currentBlock = blockMap.get(block.clientId);
    if (!currentBlock) return;
    if (block.parentClientId) {
      const parent = blockMap.get(block.parentClientId);
      if (parent && parent.innerBlocks) {
        parent.innerBlocks.push(currentBlock);
      } else {
        // Parent not found, add to root
        rootBlocks.push(currentBlock);
      }
    } else {
      // No parent, add to root
      rootBlocks.push(currentBlock);
    }
  });
  return rootBlocks.length > 0 ? rootBlocks : blocks;
};
/**
 * Renders WordPress Gutenberg blocks
 * Supports both editorBlocks (WPGraphQL Content Blocks) and blocks/blocksJSON formats
 */
const BlockRenderer = ({ blocks, editorBlocks, fallbackContent }: BlockRendererProps) => {
  let parsedBlocks: Block[] = [];
  // Debug logging (remove in production)
  if (typeof window !== 'undefined') {
    console.log('[BlockRenderer] editorBlocks:', editorBlocks);
    console.log('[BlockRenderer] blocks:', blocks);
    console.log('[BlockRenderer] fallbackContent length:', fallbackContent?.length);
  }
  // Priority: editorBlocks > blocks > fallbackContent
  if (editorBlocks && Array.isArray(editorBlocks) && editorBlocks.length > 0) {
    // Use editorBlocks from WPGraphQL Content Blocks plugin
    // Convert flat structure to hierarchical if needed
    parsedBlocks = flatListToHierarchical(editorBlocks);
    if (typeof window !== 'undefined') {
      console.log('[BlockRenderer] Parsed blocks:', parsedBlocks);
    }
    // If parsing resulted in empty array, fall back to HTML
    if (parsedBlocks.length === 0 && fallbackContent) {
      if (typeof window !== 'undefined') {
        console.log('[BlockRenderer] Parsed blocks empty, falling back to HTML');
      }
      return (
        <div
          className="prose prose-lg max-w-none product-detail-content"
          dangerouslySetInnerHTML={{ __html: fallbackContent }}
        />
      );
    }
  } else if (blocks) {
    // Fallback to blocks/blocksJSON format
    if (typeof blocks === 'string') {
      try {
        parsedBlocks = JSON.parse(blocks);
      } catch (e) {
        // If parsing fails, treat as HTML content
        if (fallbackContent) {
          return (
            <div
              className="prose prose-lg max-w-none product-detail-content"
              dangerouslySetInnerHTML={{ __html: fallbackContent }}
            />
          );
        }
        return null;
      }
    } else if (Array.isArray(blocks)) {
      parsedBlocks = blocks;
    }
  }
  if (!Array.isArray(parsedBlocks) || parsedBlocks.length === 0) {
    // Fallback to HTML content
    if (fallbackContent) {
      if (typeof window !== 'undefined') {
        console.log('[BlockRenderer] No blocks found, using fallback HTML content');
      }
      return (
        <div
          className="prose prose-lg max-w-none product-detail-content"
          dangerouslySetInnerHTML={{ __html: fallbackContent }}
        />
      );
    }
    if (typeof window !== 'undefined') {
      console.warn('[BlockRenderer] No blocks and no fallback content available');
    }
    return null;
  }
  if (typeof window !== 'undefined') {
    console.log('[BlockRenderer] Rendering', parsedBlocks.length, 'blocks');
  }
  return (
    <div className="wp-blocks">
      {parsedBlocks.map((block, index) => {
        const key = block.clientId || block.name || index;
        return <BlockComponent key={key} block={block} />;
      })}
    </div>
  );
};
/**
 * Renders a single block
 */
const BlockComponent = ({ block }: { block: Block }) => {
  if (!block) {
    if (typeof window !== 'undefined') {
      console.warn('[BlockComponent] Block is null or undefined');
    }
    return null;
  }
  // Handle different block name formats
  // WPGraphQL Content Blocks uses 'name' field (e.g., "core/paragraph")
  // Other formats may use 'blockName'
  const blockName = block.name || block.blockName;
  if (!blockName) {
    // Handle classic editor content (no blockName)
    // WPGraphQL Content Blocks provides renderedHtml
    const htmlContent = block.renderedHtml || block.innerHTML || block.saveContent || block.originalContent;
    if (htmlContent) {
      if (typeof window !== 'undefined') {
        console.log('[BlockComponent] Rendering block without name using HTML content');
      }
      return (
        <div
          className="prose prose-lg max-w-none"
          dangerouslySetInnerHTML={{ __html: htmlContent }}
        />
      );
    }
    if (typeof window !== 'undefined') {
      console.warn('[BlockComponent] Block has no name and no HTML content:', block);
    }
    return null;
  }
  if (typeof window !== 'undefined') {
    console.log('[BlockComponent] Rendering block:', blockName, block);
  }
  // Merge attrs and attributes (different plugins use different field names)
  const attrs = { ...(block.attrs || {}), ...(block.attributes || {}) };
  const innerBlocks = block.innerBlocks || [];
  // WPGraphQL Content Blocks provides renderedHtml which is preferred
  // Fall back to other HTML sources if not available
  const innerHTML = block.renderedHtml || block.innerHTML || block.saveContent || block.originalContent || '';
  // Handle both 'core/paragraph' and 'paragraph' formats
  // Extract block type from name (e.g., "core/paragraph" -> "paragraph")
  const blockType = blockName.replace(/^(core\/|wp\/)/, '').toLowerCase();
  // If renderedHtml is available and contains full HTML, prefer using it directly for most blocks
  // This ensures server/client consistency
  const hasRenderedHtml = !!block.renderedHtml;
  // For most blocks, if renderedHtml exists, use it directly to avoid hydration issues
  // Only construct custom components for blocks that need special handling (like images, galleries)
  if (hasRenderedHtml && !['image', 'gallery', 'columns', 'column'].includes(blockType)) {
    return (
      <div
        className="my-4"
        dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
      />
    );
  }
  switch (blockType) {
    case 'paragraph':
      // If renderedHtml is available, use it directly (it's already a complete <p> tag)
      if (hasRenderedHtml && block.renderedHtml) {
        return (
          <div
            className="mb-4"
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      // Otherwise construct from attributes
      const paragraphContent = innerHTML || attrs.content || '';
      return (
        <p
          className="mb-4 text-gray-700 leading-relaxed"
          dangerouslySetInnerHTML={{ __html: paragraphContent }}
        />
      );
    case 'heading':
      // If renderedHtml is available, use it directly (it's already a complete heading tag)
      if (hasRenderedHtml && block.renderedHtml) {
        return (
          <div
            className="mb-4"
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      // Otherwise construct from attributes
      const level = attrs.level || 2;
      const HeadingTag = `h${level}` as keyof JSX.IntrinsicElements;
      const headingContent = innerHTML || attrs.content || '';
      return (
        <HeadingTag
          className={`mb-4 font-bold text-gray-900 ${
            level === 1 ? 'text-4xl' :
            level === 2 ? 'text-3xl' :
            level === 3 ? 'text-2xl' :
            level === 4 ? 'text-xl' :
            'text-lg'
          }`}
          dangerouslySetInnerHTML={{ __html: headingContent }}
        />
      );
    case 'image':
      const imageUrl = attrs.url || attrs.src;
      const imageAlt = attrs.alt || '';
      const imageWidth = attrs.width || 800;
      const imageHeight = attrs.height || 600;
      if (!imageUrl) return null;
      return (
        <figure className="my-8">
          <div className="relative w-full" style={{ aspectRatio: `${imageWidth}/${imageHeight}` }}>
            <Image
              src={imageUrl}
              alt={imageAlt}
              fill
              className="object-cover rounded-lg"
              sizes="(max-width: 768px) 100vw, (max-width: 1200px) 80vw, 800px"
              unoptimized={imageUrl.includes('localhost') || imageUrl.includes('127.0.0.1')}
            />
          </div>
          {attrs.caption && (
            <figcaption className="mt-2 text-sm text-gray-600 text-center">
              {attrs.caption}
            </figcaption>
          )}
        </figure>
      );
    case 'gallery':
      const galleryImages = attrs.images || [];
      return (
        <div className="my-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {galleryImages.map((img: any, idx: number) => (
            <div key={idx} className="relative aspect-square">
              <Image
                src={img.url || img.src}
                alt={img.alt || ''}
                fill
                className="object-cover rounded-lg"
                sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
                unoptimized={img.url?.includes('localhost') || img.url?.includes('127.0.0.1')}
              />
            </div>
          ))}
        </div>
      );
    case 'list':
      // If renderedHtml is available, use it directly
      if (hasRenderedHtml && block.renderedHtml) {
        return (
          <div
            className="my-4 prose prose-lg max-w-none"
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      return (
        <div
          className="my-4 prose prose-lg max-w-none"
          dangerouslySetInnerHTML={{ __html: innerHTML }}
        />
      );
    case 'quote':
      // If renderedHtml is available, use it directly (it's already a complete <blockquote> tag)
      if (hasRenderedHtml && block.renderedHtml) {
        return (
          <div
            className="my-8"
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      // Otherwise construct from attributes
      const quoteContent = innerHTML || attrs.value || '';
      return (
        <blockquote className="my-8 pl-6 border-l-4 border-gray-300 italic text-gray-700">
          <div dangerouslySetInnerHTML={{ __html: quoteContent }} />
          {attrs.citation && (
            <cite className="block mt-2 text-sm text-gray-600 not-italic">
               {attrs.citation}
            </cite>
          )}
        </blockquote>
      );
    case 'code':
      // If renderedHtml is available, use it directly (it's already a complete <pre><code> tag)
      if (hasRenderedHtml && block.renderedHtml) {
        return (
          <div
            className="my-8"
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      // Otherwise construct from attributes
      const codeContent = innerHTML || attrs.content || '';
      return (
        <pre className="my-8 p-4 bg-gray-100 rounded-lg overflow-x-auto">
          <code className="text-sm" dangerouslySetInnerHTML={{ __html: codeContent }} />
        </pre>
      );
    case 'separator':
      return <hr className="my-8 border-gray-300" />;
    case 'spacer':
      const height = attrs.height || 20;
      return <div style={{ height: `${height}px` }} />;
    case 'columns':
      // Number of columns is determined by the number of innerBlocks (CoreColumn blocks)
      const columnCount = innerBlocks.length || 2;
      const gridColsClass = 
        columnCount === 1 ? 'grid-cols-1' :
        columnCount === 2 ? 'grid-cols-1 md:grid-cols-2' :
        columnCount === 3 ? 'grid-cols-1 md:grid-cols-3' :
        columnCount === 4 ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-4' :
        'grid-cols-1 md:grid-cols-2';
      return (
        <div className={`my-8 grid gap-4 ${gridColsClass}`}>
          {innerBlocks.map((innerBlock, idx) => (
            <BlockComponent key={innerBlock.clientId || idx} block={innerBlock} />
          ))}
        </div>
      );
    case 'column':
      return (
        <div>
          {innerBlocks.map((innerBlock, idx) => (
            <BlockComponent key={idx} block={innerBlock} />
          ))}
        </div>
      );
    case 'group':
    case 'cover':
    case 'media-text':
      // If renderedHtml is available, use it directly (it contains the full HTML structure)
      if (hasRenderedHtml && block.renderedHtml) {
        return (
          <div
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      // Otherwise try to render innerBlocks
      if (innerBlocks && innerBlocks.length > 0) {
        return (
          <div className="my-8">
            {innerBlocks.map((innerBlock, idx) => (
              <BlockComponent key={innerBlock.clientId || idx} block={innerBlock} />
            ))}
          </div>
        );
      }
      // Fallback to renderedHtml if available
      if (block.renderedHtml) {
        return (
          <div
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      return null;
    case 'button':
      const buttonText = attrs.text || 'Click here';
      const buttonUrl = attrs.url || '#';
      return (
        <div className="my-6">
          <a
            href={buttonUrl}
            className="inline-block px-6 py-3 bg-black text-white rounded-full hover:bg-gray-800 transition-colors"
          >
            {buttonText}
          </a>
        </div>
      );
    case 'html':
      return (
        <div
          className="my-4"
          dangerouslySetInnerHTML={{ __html: innerHTML }}
        />
      );
    default:
      // For unknown blocks, prefer renderedHtml from WPGraphQL Content Blocks
      // This ensures server/client consistency
      if (hasRenderedHtml && block.renderedHtml) {
        return (
          <div
            className="my-4 prose prose-lg max-w-none"
            dangerouslySetInnerHTML={{ __html: block.renderedHtml }}
          />
        );
      }
      // Then try innerHTML
      if (innerHTML) {
        return (
          <div
            className="my-4 prose prose-lg max-w-none"
            dangerouslySetInnerHTML={{ __html: innerHTML }}
          />
        );
      }
      // Finally try innerBlocks
      if (innerBlocks && innerBlocks.length > 0) {
        return (
          <div className="my-4">
            {innerBlocks.map((innerBlock, idx) => (
              <BlockComponent key={innerBlock.clientId || idx} block={innerBlock} />
            ))}
          </div>
        );
      }
      return null;
  }
};
export default BlockRenderer;
````

## File: src/components/Cart/CartContents.component.tsx
````typescript
import { useEffect, useState } from 'react';
import { useMutation, useQuery } from '@apollo/client';
import Link from 'next/link';
import Image from 'next/image';
import { useRouter } from 'next/router';
import { v4 as uuidv4 } from 'uuid';
import { useCartStore } from '@/stores/cartStore';
import Button from '@/components/UI/Button.component';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
import CartStickyFooter from './CartStickyFooter.component';
import {
  getFormattedCart,
  getUpdatedItems,
  handleQuantityChange,
  IProductRootObject,
} from '@/utils/functions/functions';
import { GET_CART } from '@/utils/gql/GQL_QUERIES';
import { UPDATE_CART } from '@/utils/gql/GQL_MUTATIONS';
const CartContents = () => {
  const router = useRouter();
  const { clearWooCommerceSession, syncWithWooCommerce } = useCartStore();
  const isCheckoutPage = router.pathname === '/checkout';
  const { data, refetch, error: cartError } = useQuery(GET_CART, {
    notifyOnNetworkStatusChange: true,
    errorPolicy: 'all', // Return partial data even if there are errors
  });
  // Use useEffect instead of onCompleted (deprecated)
  useEffect(() => {
    if (data) {
      const updatedCart = getFormattedCart(data);
      if (!updatedCart && !data?.cart?.contents?.nodes?.length) {
        clearWooCommerceSession();
        return;
      }
      if (updatedCart) {
        syncWithWooCommerce(updatedCart);
      }
    }
  }, [data, clearWooCommerceSession, syncWithWooCommerce]);
  // Log errors for debugging
  useEffect(() => {
    if (cartError) {
      console.error('[CartContents] Error fetching cart:', cartError);
    }
  }, [cartError]);
  const [updateCart, { loading: updateCartProcessing }] = useMutation(
    UPDATE_CART,
    {
      onCompleted: () => {
        refetch();
        setTimeout(() => {
          refetch();
        }, 3000);
      },
    },
  );
  const handleRemoveProductClick = (
    cartKey: string,
    products: IProductRootObject[],
  ) => {
    if (products?.length) {
      const updatedItems = getUpdatedItems(products, 0, cartKey);
      updateCart({
        variables: {
          input: {
            clientMutationId: uuidv4(),
            items: updatedItems,
          },
        },
      });
    }
    refetch();
    setTimeout(() => {
      refetch();
    }, 3000);
  };
  useEffect(() => {
    refetch();
  }, [refetch]);
  const getUnitPrice = (subtotal: string, quantity: number) => {
    const numericSubtotal = parseFloat(subtotal.replace(/[^0-9.-]+/g, ''));
    return isNaN(numericSubtotal)
      ? 'N/A'
      : (numericSubtotal / quantity).toFixed(2);
  };
  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      {data?.cart?.contents?.nodes?.length ? (
        <>
          {/* Top Banner */}
          <div className="bg-white p-6 mb-8 text-center border-b border-gray-300">
            <h2 className="text-2xl md:text-3xl font-bold mb-2 text-gray-900">Your Shopping Cart</h2>
            <p className="text-gray-600 text-sm md:text-base">
              Review your items and proceed to checkout when ready
            </p>
          </div>
          <div className="bg-white rounded-lg p-6 mb-8 md:w-full">
            {data.cart.contents.nodes.map((item: IProductRootObject) => (
              <div
                key={item.key}
                className="flex items-center border-b border-gray-200 py-4"
              >
                <div className="flex-shrink-0 w-24 h-24 relative hidden md:block">
                  <Image
                    src={
                      item.product.node.image?.sourceUrl || '/placeholder.png'
                    }
                    alt={item.product.node.name}
                    fill
                    sizes="96px"
                    className="rounded object-cover"
                    unoptimized={
                      item.product.node.image?.sourceUrl?.includes('localhost') ||
                      item.product.node.image?.sourceUrl?.includes('127.0.0.1')
                    }
                  />
                </div>
                <div className="flex-grow ml-4">
                  <h2 className="text-lg font-semibold">
                    {item.product.node.name}
                  </h2>
                  <p className="text-gray-600">
                    ${getUnitPrice(item.subtotal, item.quantity)}
                  </p>
                </div>
                <div className="flex items-center">
                  <input
                    type="number"
                    min="1"
                    value={item.quantity}
                    onChange={(event) => {
                      handleQuantityChange(
                        event,
                        item.key,
                        data.cart.contents.nodes,
                        updateCart,
                        updateCartProcessing,
                      );
                    }}
                    className="w-16 px-2 py-1 text-center border border-gray-300 rounded mr-2"
                  />
                  <Button
                    handleButtonClick={() =>
                      handleRemoveProductClick(
                        item.key,
                        data.cart.contents.nodes,
                      )
                    }
                    variant="danger"
                    buttonDisabled={updateCartProcessing}
                  >
                    Remove
                  </Button>
                </div>
                <div className="ml-4">
                  <p className="text-lg font-semibold">{item.subtotal}</p>
                </div>
              </div>
            ))}
          </div>
          {/* Sticky Footer - Subtotal, Terms, and Checkout Button */}
          {!isCheckoutPage && <CartStickyFooter />}
        </>
      ) : (
        <div className="text-center">
          <h2 className="text-2xl font-bold mb-4">
            No products in cart
          </h2>
          <Link href="/catalog" passHref>
            <Button variant="primary">Continue Shopping</Button>
          </Link>
        </div>
      )}
      {updateCartProcessing && (
        <div className="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50">
          <div className="bg-white p-4 rounded-lg">
            <p className="text-lg mb-2">Updating cart...</p>
            <LoadingSpinner />
          </div>
        </div>
      )}
    </div>
  );
};
export default CartContents;
````

## File: src/components/Cart/CartInitializer.component.tsx
````typescript
import { useEffect } from 'react';
import { useQuery } from '@apollo/client';
// State
import { useCartStore } from '@/stores/cartStore';
// Utils
import { getFormattedCart } from '@/utils/functions/functions';
// GraphQL
import { GET_CART } from '@/utils/gql/GQL_QUERIES';
/**
 * Non-rendering component responsible for initializing the cart state
 * by fetching data from WooCommerce and syncing it with the Zustand store.
 * This should be rendered once at the application root (_app.tsx).
 * @function CartInitializer
 * @returns {null} - This component does not render any UI
 */
const CartInitializer = () => {
  const { syncWithWooCommerce } = useCartStore();
  const { data, refetch, error, loading } = useQuery(GET_CART, {
    notifyOnNetworkStatusChange: true,
    errorPolicy: 'all', // Return partial data even if there are errors
  });
  // Use useEffect instead of onCompleted (deprecated)
  useEffect(() => {
    if (data && !loading) {
      // On successful fetch, format the data and sync with the store
      const updatedCart = getFormattedCart(data);
      if (updatedCart) {
        syncWithWooCommerce(updatedCart);
      }
    }
  }, [data, loading, syncWithWooCommerce]);
  // Log errors for debugging
  useEffect(() => {
    if (error) {
      console.error('[CartInitializer] Error fetching cart:', error);
      if (error.networkError) {
        const networkError = error.networkError;
        const errorDetails: Record<string, unknown> = {
          message: networkError.message,
        };
        // Only include statusCode if it exists (ServerParseError or ServerError)
        if ('statusCode' in networkError) {
          errorDetails.statusCode = (networkError as { statusCode: number }).statusCode;
        }
        // Only include result if it exists
        if ('result' in networkError) {
          errorDetails.result = (networkError as { result: unknown }).result;
        }
        console.error('[CartInitializer] Network error details:', errorDetails);
      }
    }
  }, [error]);
  useEffect(() => {
    refetch();
  }, [refetch]);
  // This component does not render any UI
  return null;
};
export default CartInitializer;
````

## File: src/components/Cart/CartStickyFooter.component.tsx
````typescript
"use client";
import Link from 'next/link';
import { useQuery } from '@apollo/client';
import { GET_CART } from '@/utils/gql/GQL_QUERIES';
import Button from '@/components/UI/Button.component';
/**
 * Sticky footer component for cart page
 * Contains subtotal and checkout button
 */
const CartStickyFooter = () => {
  const { data } = useQuery(GET_CART, {
    notifyOnNetworkStatusChange: true,
    errorPolicy: 'all',
  });
  const cartTotal = data?.cart?.total || '$0.00';
  const hasItems = data?.cart?.contents?.nodes?.length > 0;
  if (!hasItems) {
    return null;
  }
  return (
    <div className="fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 shadow-lg">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div className="flex flex-col gap-4">
          {/* Subtotal and Checkout Button */}
          <div className="flex flex-col md:flex-row items-center justify-between gap-4">
            {/* Subtotal */}
            <div className="flex items-center gap-2">
              <span className="font-semibold text-gray-900">Subtotal:</span>
              <span className="text-lg font-bold text-gray-900">{cartTotal}</span>
            </div>
            {/* Checkout Button */}
            <div className="w-full md:w-auto min-w-[200px]">
              <Link href="/checkout" passHref>
                <Button variant="primary" fullWidth>
                  GO TO CHECKOUT
                </Button>
              </Link>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};
export default CartStickyFooter;
````

## File: src/components/Category/Categories.component.tsx
````typescript
import Link from 'next/link';
import { v4 as uuidv4 } from 'uuid';
interface ICategoriesProps {
  categories: { id: string; name: string; slug: string }[];
}
const Categories = ({ categories }: ICategoriesProps) => (
  <section className="container mx-auto bg-white">
    <div className="grid gap-2 px-2 pt-2 pb-2 lg:px-0 xl:px-0 md:px-0 lg:grid-cols-3 sm:grid-cols-1 md:grid-cols-3 xs:grid-cols-3">
      {categories.map(({ id, name, slug }) => (
        <Link
          key={uuidv4()}
          href={`/category/${encodeURIComponent(slug)}?id=${encodeURIComponent(id)}`}
        >
          <div className="p-6 cursor-pointer">
            <div className="flex items-center justify-center w-full h-16 text-center border border-gray-300 rounded-lg shadow hover:shadow-outline">
              <p className="text-lg">{name}</p>
            </div>
          </div>
        </Link>
      ))}
    </div>
  </section>
);
export default Categories;
````

## File: src/components/Checkout/BillingAddressCheckbox.component.tsx
````typescript
"use client";
import { useFormContext } from 'react-hook-form';
/**
 * Checkbox to indicate billing address is same as shipping
 */
const BillingAddressCheckbox = () => {
  const { register, watch, setValue } = useFormContext();
  const billingSameAsShipping = watch('billingSameAsShipping') ?? true;
  return (
    <div className="mb-6">
      <label className="flex items-center cursor-pointer">
        <input
          type="checkbox"
          {...register('billingSameAsShipping')}
          defaultChecked={true}
          className="h-4 w-4 cursor-pointer accent-black"
        />
        <span className="ml-2 text-sm text-gray-700">
          Billing address is same as shipping
        </span>
      </label>
    </div>
  );
};
export default BillingAddressCheckbox;
````

## File: src/components/Checkout/BillingAddressFields.component.tsx
````typescript
"use client";
import { useFormContext } from 'react-hook-form';
import { InputField } from '@/components/Input/InputField.component';
import { INPUT_FIELDS } from '@/utils/constants/INPUT_FIELDS';
const US_STATES = [
  { value: 'AL', label: 'Alabama' },
  { value: 'AK', label: 'Alaska' },
  { value: 'AZ', label: 'Arizona' },
  { value: 'AR', label: 'Arkansas' },
  { value: 'CA', label: 'California' },
  { value: 'CO', label: 'Colorado' },
  { value: 'CT', label: 'Connecticut' },
  { value: 'DE', label: 'Delaware' },
  { value: 'FL', label: 'Florida' },
  { value: 'GA', label: 'Georgia' },
  { value: 'HI', label: 'Hawaii' },
  { value: 'ID', label: 'Idaho' },
  { value: 'IL', label: 'Illinois' },
  { value: 'IN', label: 'Indiana' },
  { value: 'IA', label: 'Iowa' },
  { value: 'KS', label: 'Kansas' },
  { value: 'KY', label: 'Kentucky' },
  { value: 'LA', label: 'Louisiana' },
  { value: 'ME', label: 'Maine' },
  { value: 'MD', label: 'Maryland' },
  { value: 'MA', label: 'Massachusetts' },
  { value: 'MI', label: 'Michigan' },
  { value: 'MN', label: 'Minnesota' },
  { value: 'MS', label: 'Mississippi' },
  { value: 'MO', label: 'Missouri' },
  { value: 'MT', label: 'Montana' },
  { value: 'NE', label: 'Nebraska' },
  { value: 'NV', label: 'Nevada' },
  { value: 'NH', label: 'New Hampshire' },
  { value: 'NJ', label: 'New Jersey' },
  { value: 'NM', label: 'New Mexico' },
  { value: 'NY', label: 'New York' },
  { value: 'NC', label: 'North Carolina' },
  { value: 'ND', label: 'North Dakota' },
  { value: 'OH', label: 'Ohio' },
  { value: 'OK', label: 'Oklahoma' },
  { value: 'OR', label: 'Oregon' },
  { value: 'PA', label: 'Pennsylvania' },
  { value: 'RI', label: 'Rhode Island' },
  { value: 'SC', label: 'South Carolina' },
  { value: 'SD', label: 'South Dakota' },
  { value: 'TN', label: 'Tennessee' },
  { value: 'TX', label: 'Texas' },
  { value: 'UT', label: 'Utah' },
  { value: 'VT', label: 'Vermont' },
  { value: 'VA', label: 'Virginia' },
  { value: 'WA', label: 'Washington' },
  { value: 'WV', label: 'West Virginia' },
  { value: 'WI', label: 'Wisconsin' },
  { value: 'WY', label: 'Wyoming' },
];
/**
 * Billing address fields component
 * Shows when user unchecks "Billing address is same as shipping"
 */
const BillingAddressFields = () => {
  const { watch, register, formState: { errors } } = useFormContext();
  const billingSameAsShipping = watch('billingSameAsShipping') ?? true;
  if (billingSameAsShipping) {
    return null;
  }
  return (
    <div className="mb-6">
      <div className="text-sm text-gray-600 mb-3">Billing address</div>
      <div className="space-y-3">
        {/* Address - Full Width */}
        {INPUT_FIELDS.filter(field => field.name === 'address1').map(({ id, label, name, customValidation }) => (
          <InputField
            key={`billing-${id}`}
            inputLabel={label}
            inputName={`billing${name.charAt(0).toUpperCase() + name.slice(1)}`}
            customValidation={customValidation}
            className="w-full"
          />
        ))}
        {/* City, State, and Postal Code - Side by Side */}
        <div className="flex gap-3">
          {INPUT_FIELDS.filter(field => field.name === 'city').map(({ id, label, name, customValidation }) => (
            <InputField
              key={`billing-${id}`}
              inputLabel={label}
              inputName={`billing${name.charAt(0).toUpperCase() + name.slice(1)}`}
              customValidation={customValidation}
            />
          ))}
          <div className="flex-1 relative">
            <select
              className="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-2 focus:ring-black focus:border-black block w-full pl-3 pr-10 py-2 appearance-none cursor-pointer"
              {...register('billingState', {
                required: 'State is required'
              })}
            >
              <option value="">State</option>
              {US_STATES.map((state) => (
                <option key={state.value} value={state.value}>{state.value}</option>
              ))}
            </select>
            {/* Dropdown Arrow */}
            <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none">
              <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
              </svg>
            </div>
            {errors.billingState && (
              <p className="text-red-600 text-xs mt-1">{errors.billingState.message as string}</p>
            )}
          </div>
          {INPUT_FIELDS.filter(field => field.name === 'postcode').map(({ id, label, name, customValidation }) => (
            <InputField
              key={`billing-${id}`}
              inputLabel={label}
              inputName={`billing${name.charAt(0).toUpperCase() + name.slice(1)}`}
              customValidation={customValidation}
            />
          ))}
        </div>
      </div>
    </div>
  );
};
export default BillingAddressFields;
````

## File: src/components/Checkout/CheckoutConfirmation.component.tsx
````typescript
// Imports
import Image from 'next/image';
import Link from 'next/link';
import Button from '../UI/Button.component';
import CreateAccountAfterCheckout from './CreateAccountAfterCheckout.component';
interface OrderItem {
  id: string;
  productId: number | null;
  quantity: number;
  subtotal: string;
  total: string;
  product: {
    node: {
      id: string;
      name: string;
      image: {
        sourceUrl: string;
        altText: string;
      } | null;
    };
  } | null;
  variation: {
    node: {
      id: string;
      name: string;
      image: {
        sourceUrl: string;
        altText: string;
      } | null;
    };
  } | null;
}
interface BillingAddress {
  firstName: string;
  lastName: string;
  address1: string;
  address2?: string;
  city: string;
  state?: string;
  postcode: string;
  country: string;
  email: string;
  phone?: string;
  company?: string;
}
interface ShippingAddress {
  firstName: string;
  lastName: string;
  address1: string;
  address2?: string;
  city: string;
  state?: string;
  postcode: string;
  country: string;
}
interface OrderData {
  id: string;
  databaseId: number;
  orderNumber: string;
  orderKey: string;
  status: string;
  date: string;
  total: string;
  subtotal: string;
  totalTax: string;
  shippingTotal: string;
  paymentMethod: string;
  paymentMethodTitle: string;
  currency: string;
  billing: BillingAddress;
  shipping: ShippingAddress;
  lineItems: {
    nodes: OrderItem[];
  };
}
interface CheckoutConfirmationProps {
  order: OrderData;
}
const CheckoutConfirmation = ({ order }: CheckoutConfirmationProps) => {
  const formatAddress = (address: BillingAddress | ShippingAddress) => {
    const parts = [
      address.address1,
      address.address2,
      `${address.city}, ${address.state || ''} ${address.postcode}`.trim(),
      address.country,
    ].filter(Boolean);
    return parts.join(', ');
  };
  const getProductImage = (item: OrderItem) => {
    if (item.variation?.node?.image?.sourceUrl) {
      return item.variation.node.image.sourceUrl;
    }
    if (item.product?.node?.image?.sourceUrl) {
      return item.product.node.image.sourceUrl;
    }
    return '/placeholder.png';
  };
  const getProductName = (item: OrderItem) => {
    if (item.variation?.node?.name) {
      return item.variation.node.name;
    }
    if (item.product?.node?.name) {
      return item.product.node.name;
    }
    return 'Product';
  };
  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      {/* Success Banner */}
      <div className="bg-white border-b border-gray-300 p-6 mb-8 text-center">
        <h1 className="text-3xl md:text-4xl font-bold mb-2 text-gray-900">
          Thank you for your order!
        </h1>
        <p className="text-gray-600 text-base md:text-lg">
          Your order has been received and is being processed
        </p>
      </div>
      {/* Order Details Card */}
      <div className="bg-white rounded-lg shadow-md p-6 mb-8">
        <div className="border-b border-gray-200 pb-4 mb-6">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">Order Details</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
            <div>
              <span className="font-semibold text-gray-700">Order Number:</span>
              <span className="ml-2 text-gray-900">#{order.orderNumber}</span>
            </div>
            <div>
              <span className="font-semibold text-gray-700">Order Date:</span>
              <span className="ml-2 text-gray-900">
                {new Date(order.date).toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </span>
            </div>
            <div>
              <span className="font-semibold text-gray-700">Order Status:</span>
              <span className="ml-2 text-gray-900 capitalize">{order.status}</span>
            </div>
            <div>
              <span className="font-semibold text-gray-700">Payment Method:</span>
              <span className="ml-2 text-gray-900">
                {order.paymentMethodTitle || order.paymentMethod}
              </span>
            </div>
          </div>
        </div>
        {/* Order Items */}
        <div className="mb-6">
          <h3 className="text-xl font-semibold text-gray-900 mb-4">Order Items</h3>
          <div className="space-y-4">
            {order.lineItems.nodes.map((item) => (
              <div
                key={item.id}
                className="flex items-center border-b border-gray-200 pb-4 last:border-b-0"
              >
                <div className="flex-shrink-0 w-20 h-20 relative mr-4">
                  <Image
                    src={getProductImage(item)}
                    alt={getProductName(item)}
                    fill
                    sizes="80px"
                    className="rounded object-cover"
                    unoptimized={
                      getProductImage(item).includes('localhost') ||
                      getProductImage(item).includes('127.0.0.1')
                    }
                  />
                </div>
                <div className="flex-grow">
                  <h4 className="font-semibold text-gray-900">{getProductName(item)}</h4>
                  <p className="text-sm text-gray-600">Quantity: {item.quantity}</p>
                </div>
                <div className="text-right">
                  <p className="font-semibold text-gray-900">{item.total}</p>
                </div>
              </div>
            ))}
          </div>
        </div>
        {/* Order Totals */}
        <div className="border-t border-gray-200 pt-4">
          <div className="flex justify-between items-center mb-2">
            <span className="text-gray-700">Subtotal:</span>
            <span className="font-semibold text-gray-900">{order.subtotal}</span>
          </div>
          {parseFloat(order.shippingTotal) > 0 && (
            <div className="flex justify-between items-center mb-2">
              <span className="text-gray-700">Shipping:</span>
              <span className="font-semibold text-gray-900">{order.shippingTotal}</span>
            </div>
          )}
          {parseFloat(order.totalTax) > 0 && (
            <div className="flex justify-between items-center mb-2">
              <span className="text-gray-700">Tax:</span>
              <span className="font-semibold text-gray-900">{order.totalTax}</span>
            </div>
          )}
          <div className="flex justify-between items-center pt-4 border-t border-gray-200">
            <span className="text-xl font-bold text-gray-900">Total:</span>
            <span className="text-xl font-bold text-gray-900">{order.total}</span>
          </div>
        </div>
      </div>
      {/* Billing and Shipping Addresses */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        {/* Billing Address */}
        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-900 mb-4">Billing Address</h3>
          <div className="text-gray-700 space-y-1">
            <p className="font-semibold">
              {order.billing.firstName} {order.billing.lastName}
            </p>
            {order.billing.company && <p>{order.billing.company}</p>}
            <p>{formatAddress(order.billing)}</p>
            {order.billing.phone && <p>Phone: {order.billing.phone}</p>}
            <p>Email: {order.billing.email}</p>
          </div>
        </div>
        {/* Shipping Address */}
        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-900 mb-4">Shipping Address</h3>
          <div className="text-gray-700 space-y-1">
            <p className="font-semibold">
              {order.shipping.firstName} {order.shipping.lastName}
            </p>
            <p>{formatAddress(order.shipping)}</p>
          </div>
        </div>
      </div>
      {/* Create Account After Checkout (Recommended) */}
      <div className="mb-8">
        <CreateAccountAfterCheckout
          email={order.billing.email}
          firstName={order.billing.firstName}
          lastName={order.billing.lastName}
        />
      </div>
      {/* Action Buttons */}
      <div className="flex flex-col sm:flex-row gap-4 justify-center">
        <Link href="/catalog" passHref>
          <Button variant="secondary">Continue Shopping</Button>
        </Link>
        <Link href="/" passHref>
          <Button variant="primary">Return to Home</Button>
        </Link>
      </div>
    </div>
  );
};
export default CheckoutConfirmation;
````

## File: src/components/Checkout/CheckoutOrderSummary.component.tsx
````typescript
import { useQuery } from '@apollo/client';
import Image from 'next/image';
import Link from 'next/link';
import { GET_CART } from '@/utils/gql/GQL_QUERIES';
import { IProductRootObject } from '@/utils/functions/functions';
interface CheckoutOrderSummaryProps {
  className?: string;
}
const CheckoutOrderSummary = ({ className = '' }: CheckoutOrderSummaryProps) => {
  const { data, loading } = useQuery(GET_CART, {
    notifyOnNetworkStatusChange: true,
    errorPolicy: 'all',
  });
  if (loading) {
    return (
      <aside className={className}>
        <div className="bg-white rounded-lg p-6">
          <p className="text-gray-600">Loading order summary...</p>
        </div>
      </aside>
    );
  }
  const cartItems = data?.cart?.contents?.nodes || [];
  const cartTotal = data?.cart?.total || '$0.00';
  const subtotal = data?.cart?.subtotal || '$0.00';
  if (!cartItems.length) {
    return (
      <aside className={className}>
        <div className="bg-white rounded-lg p-6">
          <h2 className="text-xl font-semibold mb-4">Order summary</h2>
          <p className="text-gray-600">Your cart is empty.</p>
          <Link href="/catalog" className="text-blue-600 hover:underline mt-4 inline-block">
            Continue shopping
          </Link>
        </div>
      </aside>
    );
  }
  return (
    <aside className={className}>
      <div className="bg-white rounded-lg shadow-sm">
        {/* Header */}
        <div className="p-6 border-b border-gray-200">
          <h2 className="text-xl font-semibold text-gray-900">Order summary</h2>
        </div>
        {/* Cart Items */}
        <div className="p-6 border-b border-gray-200 max-h-[60vh] overflow-y-auto">
          <div className="space-y-4">
            {cartItems.map((item: IProductRootObject) => (
              <div key={item.key} className="flex gap-4">
                <div className="flex-shrink-0 w-16 h-16 relative">
                  <Image
                    src={item.product.node.image?.sourceUrl || '/placeholder.png'}
                    alt={item.product.node.name}
                    fill
                    sizes="64px"
                    className="rounded object-cover"
                    unoptimized={
                      item.product.node.image?.sourceUrl?.includes('localhost') ||
                      item.product.node.image?.sourceUrl?.includes('127.0.0.1')
                    }
                  />
                </div>
                <div className="flex-1 min-w-0">
                  <h3 className="text-sm font-medium text-gray-900 truncate">
                    {item.product.node.name}
                  </h3>
                  <p className="text-sm text-gray-500">Quantity: {item.quantity}</p>
                </div>
                <div className="flex-shrink-0">
                  <p className="text-sm font-medium text-gray-900">{item.subtotal}</p>
                </div>
              </div>
            ))}
          </div>
        </div>
        {/* Totals */}
        <div className="p-6 space-y-3">
          <div className="flex justify-between text-sm">
            <span className="text-gray-600">Subtotal</span>
            <span className="text-gray-900">{subtotal}</span>
          </div>
          <div className="flex justify-between text-sm">
            <span className="text-gray-600">Shipping</span>
            <span className="text-gray-900">Calculated at next step</span>
          </div>
          <div className="border-t border-gray-200 pt-3 mt-3">
            <div className="flex justify-between">
              <span className="text-base font-semibold text-gray-900">Total</span>
              <span className="text-base font-semibold text-gray-900">{cartTotal}</span>
            </div>
          </div>
        </div>
      </div>
    </aside>
  );
};
export default CheckoutOrderSummary;
````

## File: src/components/Checkout/CreateAccountAfterCheckout.component.tsx
````typescript
"use client";
import { useState } from 'react';
import { useMutation } from '@apollo/client';
import { CREATE_USER } from '@/utils/gql/GQL_MUTATIONS';
import Button from '@/components/UI/Button.component';
interface CreateAccountAfterCheckoutProps {
  email: string;
  firstName?: string;
  lastName?: string;
  onAccountCreated?: () => void;
}
/**
 * Component for creating account after checkout completion
 * Recommended option - allows customers to create account after order is placed
 */
const CreateAccountAfterCheckout = ({
  email,
  firstName,
  lastName,
  onAccountCreated,
}: CreateAccountAfterCheckoutProps) => {
  const [username, setUsername] = useState(email.split('@')[0] || '');
  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);
  const [showForm, setShowForm] = useState(false);
  const [createAccount] = useMutation(CREATE_USER);
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError(null);
    if (password !== confirmPassword) {
      setError('Passwords do not match');
      return;
    }
    if (password.length < 8) {
      setError('Password must be at least 8 characters');
      return;
    }
    setLoading(true);
    try {
      const result = await createAccount({
        variables: {
          username: username || email.split('@')[0],
          email,
          password,
          firstName: firstName || '',
          lastName: lastName || '',
        },
      });
      if (result.data?.registerCustomer?.customer) {
        setSuccess(true);
        if (onAccountCreated) {
          onAccountCreated();
        }
        // Optionally redirect to account page or refresh
        setTimeout(() => {
          window.location.href = '/account';
        }, 2000);
      } else {
        setError('Failed to create account. Please try again.');
      }
    } catch (err: any) {
      setError(err.message || 'Failed to create account. Please try again.');
    } finally {
      setLoading(false);
    }
  };
  if (success) {
    return (
      <div className="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
        <div className="flex items-center">
          <svg className="w-5 h-5 text-green-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
          </svg>
          <p className="text-sm text-green-800">
            Account created successfully! Redirecting to your account page...
          </p>
        </div>
      </div>
    );
  }
  if (!showForm) {
    return (
      <div className="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
        <div className="flex items-start justify-between">
          <div className="flex-1">
            <h4 className="text-sm font-semibold text-blue-900 mb-1">
              Create an account for faster checkout next time
            </h4>
            <p className="text-xs text-blue-700">
              Save your information and track your orders easily.
            </p>
          </div>
          <button
            type="button"
            onClick={() => setShowForm(true)}
            className="ml-4 px-4 py-2 text-sm font-medium text-blue-700 bg-blue-100 rounded-lg hover:bg-blue-200 transition-colors"
          >
            Create Account
          </button>
        </div>
      </div>
    );
  }
  return (
    <div className="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
      <div className="flex items-center justify-between mb-4">
        <h4 className="text-sm font-semibold text-gray-900">Create Your Account</h4>
        <button
          type="button"
          onClick={() => {
            setShowForm(false);
            setError(null);
            setPassword('');
            setConfirmPassword('');
          }}
          className="text-gray-500 hover:text-gray-700"
          aria-label="Close form"
        >
          <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd" />
          </svg>
        </button>
      </div>
      <form onSubmit={handleSubmit} className="space-y-4">
        {error && (
          <div className="p-3 bg-red-50 border border-red-200 rounded-lg">
            <p className="text-sm text-red-600">{error}</p>
          </div>
        )}
        <div>
          <label htmlFor="post-checkout-username" className="block text-sm font-medium text-gray-700 mb-1">
            Username
          </label>
          <input
            id="post-checkout-username"
            type="text"
            value={username}
            onChange={(e) => setUsername(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
            placeholder="Choose a username"
          />
        </div>
        <div>
          <label htmlFor="post-checkout-password" className="block text-sm font-medium text-gray-700 mb-1">
            Password <span className="text-red-500">*</span>
          </label>
          <input
            id="post-checkout-password"
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            required
            minLength={8}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
            placeholder="Enter a password (min. 8 characters)"
          />
        </div>
        <div>
          <label htmlFor="post-checkout-confirm-password" className="block text-sm font-medium text-gray-700 mb-1">
            Confirm Password <span className="text-red-500">*</span>
          </label>
          <input
            id="post-checkout-confirm-password"
            type="password"
            value={confirmPassword}
            onChange={(e) => setConfirmPassword(e.target.value)}
            required
            minLength={8}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
            placeholder="Confirm your password"
          />
        </div>
        <div className="flex items-center justify-between pt-2">
          <Button
            type="submit"
            variant="primary"
            buttonDisabled={loading}
          >
            {loading ? 'Creating Account...' : 'Create Account'}
          </Button>
          <button
            type="button"
            onClick={() => setShowForm(false)}
            className="text-sm text-gray-600 hover:text-gray-800"
          >
            Skip for now
          </button>
        </div>
      </form>
    </div>
  );
};
export default CreateAccountAfterCheckout;
````

## File: src/components/Checkout/CreditCardFields.component.tsx
````typescript
"use client";
import { useFormContext } from 'react-hook-form';
import StripeElement from './StripeElement.component';
import { useCartStore } from '@/stores/cartStore';
interface CreditCardFieldsProps {
  stripeClientSecret?: string;
  onStripeElementReady?: (elements: any) => void;
  onStripePaymentReady?: (ready: boolean) => void;
}
/**
 * Credit card fields component for checkout
 * Uses Stripe Elements for Stripe payments, manual fields for other gateways
 */
const CreditCardFields = ({ stripeClientSecret, onStripeElementReady, onStripePaymentReady }: CreditCardFieldsProps = {}) => {
  const { register, formState: { errors }, watch } = useFormContext();
  const { cart } = useCartStore();
  const paymentMethod = watch('paymentMethod');
  // Show credit card fields for Stripe or Ecrypt payment methods
  // Stripe can have different gateway IDs: 'stripe', 'woocommerce_gateway_stripe', 'stripe_cc', etc.
  // Default to 'stripe' based on webhook URL format (wc-api=wc_stripe)
  const stripeGatewayId = process.env.NEXT_PUBLIC_STRIPE_GATEWAY_ID || 'stripe';
  const isStripe = 
    paymentMethod === stripeGatewayId ||
    paymentMethod === 'stripe' || 
    paymentMethod === 'woocommerce_gateway_stripe' ||
    paymentMethod === 'stripe_cc' ||
    paymentMethod?.startsWith('stripe');
  const isEcrypt = paymentMethod === 'ecrypt_payment_gateway';
  const showCardFields = isStripe || isEcrypt;
  // Don't render if payment method doesn't require card fields
  if (!showCardFields) {
    return null;
  }
  // Use Stripe Elements for Stripe payments
  if (isStripe && stripeClientSecret && process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY) {
    const cartTotal = cart?.total ? parseFloat(cart.total.replace(/[^0-9.]/g, '')) * 100 : 0;
    const currency = 'usd'; // TODO: Get from cart or config
    return (
      <div className="mb-6">
        <div className="text-sm text-gray-600 mb-3">Card information</div>
        <StripeElement
          clientSecret={stripeClientSecret}
          amount={cartTotal}
          currency={currency}
          onElementReady={(elements) => {
            if (onStripeElementReady) onStripeElementReady(elements);
          }}
          onPaymentReady={(ready) => {
            if (onStripePaymentReady) onStripePaymentReady(ready);
          }}
        />
      </div>
    );
  }
  // Fallback to manual card fields for Ecrypt or if Stripe Elements not available
  return (
    <div className="mb-6">
      <div className="text-sm text-gray-600 mb-3">Card information</div>
      {/* Name on Card */}
      <div className="mb-3">
        <input
          type="text"
          placeholder="Name on card"
          className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
          {...register('cardName', {
            required: showCardFields ? 'Name on card is required' : false
          })}
        />
        {errors.cardName && (
          <p className="text-red-600 text-xs mt-1">{errors.cardName.message as string}</p>
        )}
      </div>
      {/* Card Number */}
      <div className="mb-3">
        <div className="relative">
          <input
            type="text"
            placeholder="1234 1234 1234 1234"
            maxLength={19}
            className="w-full px-3 py-2 pr-32 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
            {...register('cardNumber', {
              required: showCardFields ? 'Card number is required' : false,
              validate: (value) => {
                if (showCardFields && !value) {
                  return 'Card number is required';
                }
                if (showCardFields && value && !/^[\d\s]{13,19}$/.test(value)) {
                  return 'Please enter a valid card number';
                }
                return true;
              }
            })}
            onInput={(e) => {
              // Format card number with spaces
              let value = e.currentTarget.value.replace(/\s/g, '');
              if (value.length > 0) {
                value = value.match(/.{1,4}/g)?.join(' ') || value;
                e.currentTarget.value = value;
              }
            }}
          />
          {/* Payment Method Logos */}
          <div className="absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1.5 pointer-events-none">
            <div className="w-7 h-4 bg-blue-600 rounded flex items-center justify-center">
              <span className="text-white text-[10px] font-bold">VISA</span>
            </div>
            <div className="w-7 h-4 bg-gradient-to-r from-orange-500 to-red-500 rounded flex items-center justify-center">
              <span className="text-white text-[10px] font-bold">MC</span>
            </div>
            <div className="w-7 h-4 bg-blue-700 rounded flex items-center justify-center">
              <span className="text-white text-[10px] font-bold">AM</span>
            </div>
            <div className="w-7 h-4 bg-gradient-to-r from-blue-600 via-red-500 to-green-500 rounded flex items-center justify-center">
              <span className="text-white text-[10px] font-bold">JCB</span>
            </div>
          </div>
        </div>
        {errors.cardNumber && (
          <p className="text-red-600 text-xs mt-1">{errors.cardNumber.message as string}</p>
        )}
      </div>
      {/* Expiration and CVC - Side by Side */}
      <div className="flex gap-3">
        {/* Expiration Date */}
        <div className="flex-1">
          <input
            type="text"
            placeholder="MM / YY"
            maxLength={7}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
            {...register('cardExpiry', {
              required: showCardFields ? 'Expiration date is required' : false,
              validate: (value) => {
                if (showCardFields && !value) {
                  return 'Expiration date is required';
                }
                if (showCardFields && value && !/^(0[1-9]|1[0-2])\s?\/\s?([0-9]{2})$/.test(value)) {
                  return 'Please enter MM/YY format';
                }
                return true;
              }
            })}
            onKeyDown={(e) => {
              // Allow backspace, delete, tab, escape, enter
              if ([8, 9, 27, 13, 46].indexOf(e.keyCode) !== -1 ||
                  // Allow Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
                  (e.keyCode === 65 && e.ctrlKey === true) ||
                  (e.keyCode === 67 && e.ctrlKey === true) ||
                  (e.keyCode === 86 && e.ctrlKey === true) ||
                  (e.keyCode === 88 && e.ctrlKey === true) ||
                  // Allow home, end, left, right
                  (e.keyCode >= 35 && e.keyCode <= 39)) {
                return;
              }
              // Ensure that it is a number and stop the keypress
              if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
              }
            }}
            onInput={(e) => {
              // Format expiration date - allow easier typing
              let value = e.currentTarget.value.replace(/\D/g, '');
              if (value.length > 0) {
                if (value.length <= 2) {
                  e.currentTarget.value = value;
                } else {
                  // Add slash after month
                  e.currentTarget.value = value.substring(0, 2) + ' / ' + value.substring(2, 4);
                }
              } else {
                e.currentTarget.value = '';
              }
            }}
          />
          {errors.cardExpiry && (
            <p className="text-red-600 text-xs mt-1">{errors.cardExpiry.message as string}</p>
          )}
        </div>
        {/* CVC */}
        <div className="flex-1 relative">
          <input
            type="text"
            placeholder="CVC"
            maxLength={4}
            className="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
            {...register('cardCvc', {
              required: showCardFields ? 'CVC is required' : false,
              validate: (value) => {
                if (showCardFields && !value) {
                  return 'CVC is required';
                }
                if (showCardFields && value && !/^[0-9]{3,4}$/.test(value)) {
                  return 'Please enter a valid CVC';
                }
                return true;
              }
            })}
          />
          {/* CVC Hint Icon */}
          <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none">
            <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
            </svg>
          </div>
          {errors.cardCvc && (
            <p className="text-red-600 text-xs mt-1">{errors.cardCvc.message as string}</p>
          )}
        </div>
      </div>
    </div>
  );
};
export default CreditCardFields;
````

## File: src/components/Checkout/PaymentMethod.component.tsx
````typescript
"use client";
import { useFormContext } from 'react-hook-form';
import { useState, useEffect } from 'react';
import { useQuery } from '@apollo/client';
import { GET_AVAILABLE_PAYMENT_GATEWAYS, GET_STRIPE_PAYMENT_INTENT } from '@/utils/gql/GQL_QUERIES';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
import { useCartStore } from '@/stores/cartStore';
interface PaymentGateway {
  id: string;
  title: string;
  description: string;
}
/**
 * Payment method component for checkout
 * Only displays payment gateways that are enabled in WooCommerce
 * 
 * Stripe gateway ID can be configured via NEXT_PUBLIC_STRIPE_GATEWAY_ID environment variable
 * Common values: 'stripe' (most common, matches webhook URL wc-api=wc_stripe), 'stripe_cc', 'woocommerce_gateway_stripe'
 */
interface PaymentMethodProps {
  onStripeElementReady?: (ready: boolean) => void;
  onStripeClientSecret?: (secret: string) => void;
}
const PaymentMethod = ({ onStripeElementReady, onStripeClientSecret }: PaymentMethodProps = {}) => {
  const { register, watch, setValue } = useFormContext();
  const { cart } = useCartStore();
  // Get Stripe gateway ID from environment or use common defaults
  // Based on webhook URL format (wc-api=wc_stripe), the gateway ID is typically 'stripe'
  const stripeGatewayId = process.env.NEXT_PUBLIC_STRIPE_GATEWAY_ID || 'stripe';
  // Calculate cart total for Stripe payment intent
  const cartTotal = cart?.total ? parseFloat(cart.total.replace(/[^0-9.]/g, '')) * 100 : 0; // Convert to cents
  // Fetch available payment gateways from WooCommerce
  const { data, loading, error } = useQuery<{ paymentGateways: { nodes: PaymentGateway[] } }>(
    GET_AVAILABLE_PAYMENT_GATEWAYS,
    {
      errorPolicy: 'all', // Continue even if query fails
      fetchPolicy: 'network-only', // Always fetch from network
    }
  );
  // Debug logging
  useEffect(() => {
    if (data) {
      console.log('[PaymentMethod] Payment gateways data:', data);
      console.log('[PaymentMethod] All gateways:', data.paymentGateways?.nodes);
      console.log('[PaymentMethod] Enabled gateways:', data.paymentGateways?.nodes?.filter(g => g.enabled));
    }
    if (error) {
      console.error('[PaymentMethod] Error fetching payment gateways:', error);
    }
  }, [data, error]);
  // Get enabled payment gateways
  // Note: WooCommerce GraphQL returns only available (enabled) gateways by default
  const allGateways = data?.paymentGateways?.nodes || [];
  const enabledGateways = allGateways; // All returned gateways are already enabled
  // Create a map of gateway IDs for quick lookup
  const enabledGatewayIds = new Set(enabledGateways.map(gateway => gateway.id));
  // Check if specific gateways are enabled
  const isBacsEnabled = enabledGatewayIds.has('bacs') || enabledGatewayIds.has('cod');
  const isStripeEnabled = enabledGatewayIds.has(stripeGatewayId) || 
                          enabledGatewayIds.has('stripe') || 
                          enabledGatewayIds.has('stripe_cc') ||
                          enabledGatewayIds.has('woocommerce_gateway_stripe') ||
                          Array.from(enabledGatewayIds).some(id => id.startsWith('stripe'));
  const isEcryptEnabled = enabledGatewayIds.has('ecrypt_payment_gateway');
  // Determine default payment method (first enabled gateway, or bacs if available)
  const defaultMethod = isBacsEnabled ? 'bacs' : 
                        isStripeEnabled ? stripeGatewayId : 
                        enabledGateways[0]?.id || 'bacs';
  const [selectedMethod, setSelectedMethod] = useState<string>(defaultMethod);
  // Watch payment method to sync with form state
  const paymentMethod = watch('paymentMethod');
  // Fetch Stripe payment intent when Stripe is selected
  const isStripeSelected = selectedMethod === stripeGatewayId || 
                          selectedMethod === 'stripe' || 
                          selectedMethod === 'stripe_cc' ||
                          selectedMethod === 'woocommerce_gateway_stripe' ||
                          selectedMethod?.startsWith('stripe');
  const { data: stripeData, loading: stripeLoading } = useQuery(
    GET_STRIPE_PAYMENT_INTENT,
    {
      variables: {
        stripePaymentMethod: 'PAYMENT', // Use PAYMENT for modern Payment Element
      },
      skip: !isStripeSelected || cartTotal === 0, // Skip if Stripe not selected or cart is empty
      errorPolicy: 'all',
      fetchPolicy: 'network-only',
    }
  );
  // Pass Stripe client secret to parent when available
  useEffect(() => {
    if (stripeData?.stripePaymentIntent?.clientSecret && onStripeClientSecret) {
      onStripeClientSecret(stripeData.stripePaymentIntent.clientSecret);
    }
  }, [stripeData, onStripeClientSecret]);
  // Sync selectedMethod with form state on mount and when gateways load
  useEffect(() => {
    if (paymentMethod) {
      setSelectedMethod(paymentMethod);
    } else if (defaultMethod && !loading) {
      setSelectedMethod(defaultMethod);
      setValue('paymentMethod', defaultMethod, { shouldValidate: true });
    }
  }, [paymentMethod, defaultMethod, loading, setValue]);
  // Update form value when selection changes
  const handleMethodChange = (method: string) => {
    // Map 'stripe' to the actual Stripe gateway ID
    const actualMethod = method === 'stripe' ? stripeGatewayId : method;
    setSelectedMethod(actualMethod);
    setValue('paymentMethod', actualMethod, { shouldValidate: true });
  };
  // Register the payment method field
  register('paymentMethod', { required: 'Please select a payment method' });
  // Helper function to get display info for a gateway
  const getGatewayDisplayInfo = (gatewayId: string) => {
    const gateway = enabledGateways.find(g => g.id === gatewayId);
    if (gateway) {
      return {
        title: gateway.title,
        description: gateway.description || '',
      };
    }
    // Fallback display info for known gateways
    if (gatewayId === 'bacs' || gatewayId === 'cod') {
      return {
        title: 'Bank Transfer / Cash on Delivery',
        description: 'Pay with bank transfer or cash on delivery',
      };
    }
    if (gatewayId === stripeGatewayId || gatewayId === 'stripe' || gatewayId === 'stripe_cc' || gatewayId === 'woocommerce_gateway_stripe' || gatewayId?.startsWith('stripe')) {
      return {
        title: 'Credit / Debit Card',
        description: 'Pay securely with Stripe',
      };
    }
    if (gatewayId === 'ecrypt_payment_gateway') {
      return {
        title: 'Ecrypt Payment Gateway',
        description: 'Alternative payment method',
      };
    }
    return {
      title: gatewayId,
      description: '',
    };
  };
  // Show loading state
  if (loading) {
    return (
      <div className="mb-6">
        <div className="text-sm text-gray-600 mb-3">Payment method</div>
        <div className="flex items-center gap-2">
          <LoadingSpinner />
          <span className="text-sm text-gray-500">Loading payment methods...</span>
        </div>
      </div>
    );
  }
  // Show error state with helpful message
  if (error) {
    console.error('[PaymentMethod] GraphQL error:', error);
    return (
      <div className="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <div className="text-sm text-gray-600 mb-2 font-semibold">Payment method</div>
        <div className="text-sm text-yellow-700">
          Unable to load payment methods. Please check your WooCommerce payment gateway settings.
          {process.env.NODE_ENV === 'development' && (
            <div className="mt-2 text-xs text-yellow-600">
              Error: {error.message || 'Unknown error'}
            </div>
          )}
        </div>
      </div>
    );
  }
  // If no gateways are enabled, show a message
  if (enabledGateways.length === 0) {
    return (
      <div className="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <div className="text-sm text-gray-600 mb-2 font-semibold">Payment method</div>
        <div className="text-sm text-yellow-700">
          No payment methods available. Please enable at least one payment gateway in WooCommerce settings.
          {process.env.NODE_ENV === 'development' && (
            <div className="mt-2 text-xs text-yellow-600">
              Debug: Found {allGateways.length} total gateways, {enabledGateways.length} enabled.
              {allGateways.length > 0 && (
                <div>Gateway IDs: {allGateways.map(g => g.id).join(', ')}</div>
              )}
            </div>
          )}
        </div>
      </div>
    );
  }
  return (
    <div className="mb-6">
      <div className="text-sm text-gray-600 mb-3">Payment method</div>
      <div className="space-y-2">
        {/* Bank Transfer / Cash on Delivery - only show if enabled */}
        {isBacsEnabled && (
          <label className="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors">
            <input
              type="radio"
              value="bacs"
              checked={selectedMethod === 'bacs' || selectedMethod === 'cod'}
              onChange={() => handleMethodChange('bacs')}
              className="mr-3 h-4 w-4 cursor-pointer accent-black"
            />
            <div className="flex-1">
              <div className="font-medium text-gray-900">Bank Transfer / Cash on Delivery</div>
              <div className="text-xs text-gray-500">Pay with bank transfer or cash on delivery</div>
            </div>
          </label>
        )}
        {/* Stripe WooCommerce - only show if enabled */}
        {isStripeEnabled && (
          <label className="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors">
            <input
              type="radio"
              value="stripe"
              checked={
                selectedMethod === stripeGatewayId ||
                selectedMethod === 'stripe' ||
                selectedMethod === 'stripe_cc' ||
                selectedMethod === 'woocommerce_gateway_stripe' ||
                selectedMethod?.startsWith('stripe')
              }
              onChange={() => handleMethodChange('stripe')}
              className="mr-3 h-4 w-4 cursor-pointer accent-black"
            />
            <div className="flex-1">
              <div className="font-medium text-gray-900 flex items-center gap-2">
                Credit / Debit Card
                <div className="flex items-center gap-1">
                  <svg className="w-6 h-4" viewBox="0 0 24 16" fill="none">
                    <rect width="24" height="16" rx="2" fill="#635BFF"/>
                    <path d="M9.5 8L7 5.5L4.5 8L7 10.5L9.5 8Z" fill="white"/>
                    <path d="M14.5 8L17 5.5L19.5 8L17 10.5L14.5 8Z" fill="white"/>
                  </svg>
                  <span className="text-xs text-gray-400">Stripe</span>
                </div>
              </div>
              <div className="text-xs text-gray-500">Pay securely with Stripe</div>
            </div>
          </label>
        )}
        {/* Ecrypt Gateway - only show if enabled */}
        {isEcryptEnabled && (
          <label className="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors">
            <input
              type="radio"
              value="ecrypt_payment_gateway"
              checked={selectedMethod === 'ecrypt_payment_gateway'}
              onChange={() => handleMethodChange('ecrypt_payment_gateway')}
              className="mr-3 h-4 w-4 cursor-pointer accent-black"
            />
            <div className="flex-1">
              <div className="font-medium text-gray-900">Ecrypt Payment Gateway</div>
              <div className="text-xs text-gray-500">Alternative payment method</div>
            </div>
          </label>
        )}
        {/* Display any other enabled gateways that don't match our known patterns */}
        {enabledGateways
          .filter(gateway => {
            const id = gateway.id;
            return !isBacsEnabled && id !== 'bacs' && id !== 'cod' &&
                   !isStripeEnabled && id !== stripeGatewayId && id !== 'stripe' && id !== 'stripe_cc' && id !== 'woocommerce_gateway_stripe' && !id.startsWith('stripe') &&
                   !isEcryptEnabled && id !== 'ecrypt_payment_gateway';
          })
          .map(gateway => {
            const displayInfo = getGatewayDisplayInfo(gateway.id);
            return (
              <label key={gateway.id} className="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors">
                <input
                  type="radio"
                  value={gateway.id}
                  checked={selectedMethod === gateway.id}
                  onChange={() => handleMethodChange(gateway.id)}
                  className="mr-3 h-4 w-4 cursor-pointer accent-black"
                />
                <div className="flex-1">
                  <div className="font-medium text-gray-900">{displayInfo.title}</div>
                  {displayInfo.description && (
                    <div className="text-xs text-gray-500">{displayInfo.description}</div>
                  )}
                </div>
              </label>
            );
          })}
      </div>
      {/* Hidden input for form submission */}
      <input
        type="hidden"
        value={selectedMethod}
        {...register('paymentMethod')}
      />
    </div>
  );
};
export default PaymentMethod;
````

## File: src/components/Checkout/StateField.component.tsx
````typescript
"use client";
import { useFormContext } from 'react-hook-form';
const US_STATES = [
  { value: 'AL', label: 'Alabama' },
  { value: 'AK', label: 'Alaska' },
  { value: 'AZ', label: 'Arizona' },
  { value: 'AR', label: 'Arkansas' },
  { value: 'CA', label: 'California' },
  { value: 'CO', label: 'Colorado' },
  { value: 'CT', label: 'Connecticut' },
  { value: 'DE', label: 'Delaware' },
  { value: 'FL', label: 'Florida' },
  { value: 'GA', label: 'Georgia' },
  { value: 'HI', label: 'Hawaii' },
  { value: 'ID', label: 'Idaho' },
  { value: 'IL', label: 'Illinois' },
  { value: 'IN', label: 'Indiana' },
  { value: 'IA', label: 'Iowa' },
  { value: 'KS', label: 'Kansas' },
  { value: 'KY', label: 'Kentucky' },
  { value: 'LA', label: 'Louisiana' },
  { value: 'ME', label: 'Maine' },
  { value: 'MD', label: 'Maryland' },
  { value: 'MA', label: 'Massachusetts' },
  { value: 'MI', label: 'Michigan' },
  { value: 'MN', label: 'Minnesota' },
  { value: 'MS', label: 'Mississippi' },
  { value: 'MO', label: 'Missouri' },
  { value: 'MT', label: 'Montana' },
  { value: 'NE', label: 'Nebraska' },
  { value: 'NV', label: 'Nevada' },
  { value: 'NH', label: 'New Hampshire' },
  { value: 'NJ', label: 'New Jersey' },
  { value: 'NM', label: 'New Mexico' },
  { value: 'NY', label: 'New York' },
  { value: 'NC', label: 'North Carolina' },
  { value: 'ND', label: 'North Dakota' },
  { value: 'OH', label: 'Ohio' },
  { value: 'OK', label: 'Oklahoma' },
  { value: 'OR', label: 'Oregon' },
  { value: 'PA', label: 'Pennsylvania' },
  { value: 'RI', label: 'Rhode Island' },
  { value: 'SC', label: 'South Carolina' },
  { value: 'SD', label: 'South Dakota' },
  { value: 'TN', label: 'Tennessee' },
  { value: 'TX', label: 'Texas' },
  { value: 'UT', label: 'Utah' },
  { value: 'VT', label: 'Vermont' },
  { value: 'VA', label: 'Virginia' },
  { value: 'WA', label: 'Washington' },
  { value: 'WV', label: 'West Virginia' },
  { value: 'WI', label: 'Wisconsin' },
  { value: 'WY', label: 'Wyoming' },
];
/**
 * State dropdown field component
 */
const StateField = () => {
  const { register, formState: { errors } } = useFormContext();
  const fieldError = errors.state;
  return (
    <div className="flex-1 relative">
      <select
        className="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-2 focus:ring-black focus:border-black block w-full pl-3 pr-10 py-2 appearance-none cursor-pointer"
        {...register('state', {
          required: 'State is required'
        })}
      >
        <option value="">State</option>
        {US_STATES.map((state) => (
          <option key={state.value} value={state.value}>
            {state.value}
          </option>
        ))}
      </select>
      {/* Dropdown Arrow */}
      <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none">
        <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
        </svg>
      </div>
      {fieldError && (
        <p className="text-red-600 text-xs mt-1">{fieldError.message as string}</p>
      )}
    </div>
  );
};
export default StateField;
````

## File: src/components/Checkout/StripeElement.component.tsx
````typescript
"use client";
import { useEffect, useRef, useState } from 'react';
import { loadStripe, Stripe, StripeElements, StripeElementsOptions } from '@stripe/stripe-js';
import { Elements, PaymentElement, useStripe, useElements } from '@stripe/react-stripe-js';
interface StripeElementProps {
  clientSecret: string;
  amount: number;
  currency: string;
  onElementReady: (elements: StripeElements) => void;
  onPaymentReady: (ready: boolean) => void;
}
// Stripe publishable key from environment
const stripePromise = process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY
  ? loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY)
  : null;
/**
 * Inner component that uses Stripe hooks
 */
const StripePaymentForm = ({ onElementReady, onPaymentReady }: { onElementReady: (elements: StripeElements) => void; onPaymentReady: (ready: boolean) => void }) => {
  const stripe = useStripe();
  const elements = useElements();
  const [isReady, setIsReady] = useState(false);
  useEffect(() => {
    if (elements) {
      onElementReady(elements);
      // Listen for changes in the Payment Element
      const paymentElement = elements.getElement('payment');
      if (paymentElement) {
        const handleChange = (event: any) => {
          const ready = event.complete;
          setIsReady(ready);
          onPaymentReady(ready);
        };
        paymentElement.on('change', handleChange);
        return () => {
          paymentElement.off('change', handleChange);
        };
      }
    }
  }, [elements, onElementReady, onPaymentReady]);
  if (!stripe || !elements) {
    return (
      <div className="p-4 bg-gray-50 rounded-lg">
        <p className="text-sm text-gray-600">Loading payment form...</p>
      </div>
    );
  }
  return (
    <div className="stripe-payment-element">
      <PaymentElement
        options={{
          layout: 'tabs',
          paymentMethodOrder: ['card', 'apple_pay', 'google_pay'],
          fields: {
            billingDetails: {
              name: 'auto',
              email: 'auto',
              phone: 'never',
              address: 'never',
            },
          },
        }}
      />
    </div>
  );
};
/**
 * Stripe Element wrapper component
 * Handles Stripe Elements integration for payment processing
 */
const StripeElement = ({ clientSecret, amount, currency, onElementReady, onPaymentReady }: StripeElementProps) => {
  if (!stripePromise) {
    return (
      <div className="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <p className="text-sm text-yellow-700">
          Stripe is not configured. Please set NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY in your environment variables.
        </p>
      </div>
    );
  }
  if (!clientSecret) {
    return (
      <div className="p-4 bg-gray-50 rounded-lg">
        <p className="text-sm text-gray-600">Preparing payment form...</p>
      </div>
    );
  }
  const options: StripeElementsOptions = {
    clientSecret,
    appearance: {
      theme: 'stripe',
      variables: {
        colorPrimary: '#000000',
        colorBackground: '#ffffff',
        colorText: '#1a202c',
        colorDanger: '#ef4444',
        fontFamily: 'system-ui, sans-serif',
        spacingUnit: '4px',
        borderRadius: '8px',
        fontSizeBase: '16px', // Ensure readable font size
      },
      rules: {
        '.Input': {
          fontSize: '16px', // Prevent zoom on iOS
          padding: '12px',
        },
        '.Input--focus': {
          borderColor: '#000000',
        },
      },
    },
  };
  return (
    <Elements stripe={stripePromise} options={options}>
      <StripePaymentForm onElementReady={onElementReady} onPaymentReady={onPaymentReady} />
    </Elements>
  );
};
export default StripeElement;
````

## File: src/components/Footer/Footer.component.tsx
````typescript
import Link from 'next/link';
import { useQuery } from '@apollo/client';
import Logo from '@/components/UI/Logo.component';
import FooterDisclaimer from './FooterDisclaimer.component';
import { FETCH_ALL_CATEGORIES_QUERY } from '@/utils/gql/GQL_QUERIES';
/**
 * Renders Footer of the application matching Medusa design.
 * @function Footer
 * @returns {JSX.Element} - Rendered component
 */
const Footer = () => {
  // Fetch categories dynamically from WordPress/WooCommerce
  const { data, loading, error } = useQuery(FETCH_ALL_CATEGORIES_QUERY, {
    errorPolicy: 'all',
    fetchPolicy: 'cache-first',
  });
  const categories = data?.productCategories?.nodes || [];
  return (
    <footer className="border-t border-gray-200 w-full">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col w-full">
        <div className="flex flex-col gap-y-6 xsmall:flex-row items-start justify-between py-40">
          <div className="flex items-start">
            <Link
              href="/"
              className="flex items-center"
            >
              <Logo className="h-6 w-auto" />
            </Link>
          </div>
          <div className="text-small-regular gap-10 md:gap-x-16 grid grid-cols-2 ml-auto">
            {!loading && categories && categories.length > 0 && (
              <div className="flex flex-col gap-y-2">
                <span className="text-small-semi text-gray-900">
                  Collections
                </span>
                <ul
                  className="grid grid-cols-1 gap-2 text-gray-600 text-small-regular"
                  data-testid="footer-categories"
                >
                  {categories.slice(0, 6).map((category: { id: string; name: string; slug: string }) => (
                    <li key={category.id}>
                      <Link
                        className="hover:text-gray-900 transition-colors"
                        href={`/category/${category.slug}`}
                        data-testid="category-link"
                      >
                        {category.name}
                      </Link>
                    </li>
                  ))}
                </ul>
              </div>
            )}
            <div className="flex flex-col gap-y-2">
              <span className="text-small-semi text-gray-900">Company</span>
              <ul className="grid grid-cols-1 gap-y-2 text-gray-600 text-small-regular">
                <li>
                  <Link
                    href="/pages/about-us"
                    className="hover:text-gray-900 transition-colors"
                  >
                    About Us
                  </Link>
                </li>
                <li>
                  <Link
                    href="/pages/contact"
                    className="hover:text-gray-900 transition-colors"
                  >
                    Contact Us
                  </Link>
                </li>
                <li>
                  <Link
                    href="/pages/terms-of-service"
                    className="hover:text-gray-900 transition-colors"
                  >
                    Terms of Service
                  </Link>
                </li>
                <li>
                  <Link
                    href="/pages/privacy-policy"
                    className="hover:text-gray-900 transition-colors"
                  >
                    Privacy Policy
                  </Link>
                </li>
                <li>
                  <Link
                    href="/pages/returns-and-refunds"
                    className="hover:text-gray-900 transition-colors"
                  >
                    Returns & Refunds
                  </Link>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div className="flex flex-col gap-6 w-full mb-16">
          <div className="flex w-full justify-between items-start text-gray-600">
            <p className="text-small-regular">
               {new Date().getFullYear()} NW. All rights reserved.
            </p>
          </div>
          <div className="flex justify-start">
            <FooterDisclaimer />
          </div>
        </div>
      </div>
    </footer>
  );
};
export default Footer;
````

## File: src/components/Footer/FooterDisclaimer.component.tsx
````typescript
const FooterDisclaimer = () => {
  return null;
};
export default FooterDisclaimer;
````

## File: src/components/Footer/Hamburger.component.tsx
````typescript
import { useState, useEffect, useCallback, useRef } from 'react';
import Link from 'next/link';
import FadeLeftToRight from '@/components/Animations/FadeLeftToRight.component';
import FadeLeftToRightItem from '@/components/Animations/FadeLeftToRightItem.component';
import LINKS from '@/utils/constants/LINKS';
const hamburgerLine =
  'h-1 w-10 my-1 rounded-full bg-white transition ease transform duration-300 not-sr-only';
const opacityFull = 'opacity-100 group-hover:opacity-100';
/**
 * Hamburger component used in mobile menu. Animates to a X when clicked
 * @function Hamburger
 * @param {MouseEventHandler<HTMLButtonElement>} onClick - onClick handler to respond to clicks
 * @param {boolean} isExpanded - Should the hamburger animate to a X?
 * @returns {JSX.Element} - Rendered component
 */
const Hamburger = () => {
  const [isExpanded, setisExpanded] = useState(false);
  const [hidden, setHidden] = useState('invisible');
  const [isAnimating, setIsAnimating] = useState(false);
  const animationTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(
    null,
  );
  useEffect(() => {
    if (isExpanded) {
      setHidden('');
      setIsAnimating(true);
      // Clear any existing timeout
      if (animationTimeoutRef.current) {
        clearTimeout(animationTimeoutRef.current);
      }
      // Set a timeout for the animation duration
      animationTimeoutRef.current = setTimeout(() => {
        setIsAnimating(false);
      }, 1000); // Match this with the animation duration
    } else {
      setIsAnimating(true);
      // Clear any existing timeout
      if (animationTimeoutRef.current) {
        clearTimeout(animationTimeoutRef.current);
      }
      // Set a timeout for the animation duration and hiding
      animationTimeoutRef.current = setTimeout(() => {
        setHidden('invisible');
        setIsAnimating(false);
      }, 1000); // Match this with the animation duration
    }
    // Cleanup function to clear timeout when component unmounts
    return () => {
      if (animationTimeoutRef.current) {
        clearTimeout(animationTimeoutRef.current);
      }
    };
  }, [isExpanded]);
  const handleMobileMenuClick = useCallback(() => {
    // Prevent clicks during animation
    if (isAnimating) {
      return;
    }
    /**
     * Anti-pattern: setisExpanded(!isExpanded)
     * Even if your state updates are batched and multiple updates to the enabled/disabled state are made together
     * each update will rely on the correct previous state so that you always end up with the result you expect.
     */
    setisExpanded((prevExpanded) => !prevExpanded);
  }, [setisExpanded, isAnimating]);
  return (
    <div className="z-50 md:hidden lg:hidden xl:hidden bg-blue-800">
      <button
        className={`flex flex-col w-16 rounded justify-center items-center group ${isAnimating ? 'cursor-not-allowed' : 'cursor-pointer'}`}
        data-cy="hamburger"
        data-testid="hamburger"
        onClick={handleMobileMenuClick}
        aria-expanded={isExpanded}
        disabled={isAnimating}
        type="button"
      >
        <span className="sr-only text-white text-2xl">Hamburger</span>
        <span
          data-testid="hamburgerline"
          className={`${hamburgerLine} ${
            isExpanded
              ? 'rotate-45 translate-y-3 opacity-100 group-hover:opacity-100'
              : opacityFull
          }`}
        />
        <span
          className={`${hamburgerLine} ${
            isExpanded ? 'opacity-0' : opacityFull
          }`}
        />
        <span
          className={`${hamburgerLine} ${
            isExpanded
              ? '-rotate-45 -translate-y-3 opacity-100 group-hover:opacity-100'
              : opacityFull
          }`}
        />
      </button>
      <FadeLeftToRight
        delay={0.2}
        staggerDelay={0.2}
        animateNotReverse={isExpanded}
      >
        <div
          id="mobile-menu"
          aria-hidden={!isExpanded}
          className={`absolute left-0 bottom-24 z-10 w-full text-center text-black bg-white ${hidden}`}
        >
          <ul>
            {LINKS.map(({ id, title, href }) => (
              <FadeLeftToRightItem key={id} cssClass="block">
                <li
                  id="mobile-li"
                  className="w-full p-4 border-t border-gray-400 border-solid rounded"
                >
                  <Link href={href} passHref>
                    <span
                      className="text-xl inline-block px-4 py-2 no-underline hover:text-black hover:underline"
                      onClick={() => {
                        if (!isAnimating) {
                          setisExpanded((prevExpanded) => !prevExpanded);
                        }
                      }}
                      onKeyDown={(event) => {
                        // 'Enter' key or 'Space' key
                        if (
                          (event.key === 'Enter' || event.key === ' ') &&
                          !isAnimating
                        ) {
                          setisExpanded((prevExpanded) => !prevExpanded);
                        }
                      }}
                      tabIndex={0} // Make the span focusable
                      role="button" // Indicate the span acts as a button
                    >
                      {title}
                    </span>
                  </Link>
                </li>
              </FadeLeftToRightItem>
            ))}
          </ul>
        </div>
      </FadeLeftToRight>
    </div>
  );
};
export default Hamburger;
````

## File: src/components/Footer/Stickynav.component.tsx
````typescript
import Link from 'next/link';
import Cart from '@/components/Header/Cart.component';
import Search from '@/components/AlgoliaSearch/AlgoliaSearchBox.component';
import SVGMobileSearchIcon from '@/components/SVG/SVGMobileSearchIcon.component';
import Hamburger from './Hamburger.component';
/**
 * Navigation for the application.
 * Includes mobile menu.
 */
const Stickynav = () => (
  <nav id="footer" className="fixed bottom-0 z-50 w-full mt-[10rem] md:hidden">
    <div className="container flex flex-wrap items-center justify-between px-6 py-3 mx-auto mt-0 md:min-w-96 bg-blue-800">
      <Hamburger />
      <div
        className="order-3 hidden w-full md:flex md:items-center md:w-auto md:order-1"
        id="menu"
      >
        <ul className="items-center justify-between pt-4 text-base text-gray-700 md:flex md:pt-0">
          <li>
            <Link href="/catalog">
              <span className="inline-block py-2 pr-4 text-xl font-bold no-underline hover:underline">
                Products
              </span>
            </Link>
          </li>
          <li>
            <Link href="/categories">
              <span className="inline-block py-2 pr-4 text-xl font-bold no-underline hover:underline">
                Categories
              </span>
            </Link>
          </li>
        </ul>
      </div>
      <div className="flex items-center order-2 md:order-3" id="nav-content">
        <Search />
        <SVGMobileSearchIcon />
        <Cart stickyNav />
      </div>
    </div>
  </nav>
);
export default Stickynav;
````

## File: src/components/Header/Cart.component.tsx
````typescript
import { useState, useEffect } from 'react';
import Link from 'next/link';
import { useCartStore } from '@/stores/cartStore';
interface ICartProps {
  stickyNav?: boolean;
}
/**
 * Displays the shopping cart contents.
 * Displays amount of items in cart.
 */
const Cart = ({ stickyNav }: ICartProps) => {
  const cart = useCartStore((state) => state.cart);
  const [productCount, setProductCount] = useState<number | null | undefined>();
  useEffect(() => {
    if (cart) {
      setProductCount(cart.totalProductsCount);
    } else {
      setProductCount(null);
    }
  }, [cart]);
  return (
    <>
      <Link href="/cart">
        <span
          className="pl-4 mt-4 no-underline inline-block"
          aria-label="Cart"
        >
          <svg
            className={`${stickyNav ? 'fill-white' : 'fill-current'}`}
            xmlns="https://www.w3.org/2000/svg"
            width="55"
            height="55"
            viewBox="0 0 30 30"
            aria-label="Cart"
            role="img"
          >
            <path
              d="M21,7H7.462L5.91,3.586C5.748,3.229,5.392,3,5,3H2v2h2.356L9.09,15.414C9.252,15.771,9.608,16,10,16h8 c0.4,0,0.762-0.238,0.919-0.606l3-7c0.133-0.309,0.101-0.663-0.084-0.944C21.649,7.169,21.336,7,21,7z M17.341,14h-6.697L8.371,9 h11.112L17.341,14z"
            />
            <circle cx="10.5" cy="18.5" r="1.5" />
            <circle cx="17.5" cy="18.5" r="1.5" />
          </svg>
        </span>
      </Link>
      {productCount && (
        <span
          className={`w-6 h-6 pb-2 -mt-5 !-ml-2 text-center rounded-full
          ${stickyNav ? 'text-black bg-white' : 'text-white bg-black'}`}
        >
          {productCount}
        </span>
      )}
    </>
  );
};
export default Cart;
````

## File: src/components/Header/Header.component.tsx
````typescript
import Head from 'next/head';
import Navbar from './Navbar.component';
interface IHeaderProps {
  title: string;
}
/**
 * Renders header for each page.
 * @function Header
 * @param {string} title - Title for the page. Is set in <title>{title}</title>
 * @returns {JSX.Element} - Rendered component
 */
const Header = ({ title }: IHeaderProps) => (
  <>
    <Head>
      <title>{`Next.js webshop with WooCommerce ${title}`}</title>
      <meta name="description" content="WooCommerce webshop" />
      <meta name="keywords" content="Ecommerce, WooCommerce" />
      <meta
        property="og:title"
        content="Nextjs Ecommerce with Woocommerce"
        key="pagetitle"
      />
    </Head>
    <Navbar />
  </>
);
export default Header;
````

## File: src/components/Header/MobileMenu.component.tsx
````typescript
"use client";
import { useState } from "react";
import { createPortal } from "react-dom";
import Link from "next/link";
import { useQuery } from "@apollo/client";
import SearchIcon from "@/components/UI/icons/SearchIcon.component";
import AccountIcon from "@/components/UI/icons/AccountIcon.component";
import CartIcon from "@/components/UI/icons/CartIcon.component";
import { GET_CURRENT_USER, GET_PAGES } from "@/utils/gql/GQL_QUERIES";
// Simple close icon component
const CloseIcon = () => (
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    strokeWidth="2"
    strokeLinecap="round"
    strokeLinejoin="round"
  >
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>
);
const menuItems = [
  { name: "Home", href: "/" },
  { name: "Catalog", href: "/catalog" },
  { name: "Contact Us", href: "/pages/contact" },
];
const resourcesItems = [
  { name: "Components", href: "/pages/components" },
];
export default function MobileMenu() {
  const [isOpen, setIsOpen] = useState(false);
  // Check if user is authenticated
  // Use network-only to ensure we always check current authentication status
  // This prevents showing stale cached data after logout
  const { data, loading, error } = useQuery(GET_CURRENT_USER, {
    errorPolicy: 'all',
    fetchPolicy: 'network-only', // Always check server for current auth status
  });
  // Fetch pages from WordPress
  const { data: pagesData } = useQuery(GET_PAGES, {
    errorPolicy: 'all',
  });
  // Only consider logged in if we have customer data and no error
  // If loading or error, default to not logged in (show login link)
  const loggedIn = !loading && !error && !!data?.customer;
  // Build pages list
  const pages = pagesData?.pages?.nodes || [];
  const pageItems = pages
    .filter((page: { slug: string }) => 
      !['about-us', 'contact', 'components', 'terms-of-service', 'privacy-policy', 'returns-and-refunds'].includes(page.slug)
    )
    .map((page: { title: string; uri: string }) => ({
      name: page.title,
      href: page.uri || `/pages/${page.title.toLowerCase().replace(/\s+/g, '-')}`,
    }));
  const menuContent = isOpen ? (
    <>
      <div
        className="fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm lg:hidden"
        onClick={() => setIsOpen(false)}
      />
      <div
        id="header-sidebar-menu"
        className="fixed left-0 top-0 bottom-0 z-[61] w-80 max-w-[85vw] bg-white shadow-xl lg:hidden"
        role="dialog"
        aria-modal="true"
      >
        <div className="flex flex-col h-full">
          <div className="flex justify-end p-4">
            <button
              aria-label="Close"
              onClick={() => setIsOpen(false)}
              className="p-2 hover:bg-gray-100 rounded"
            >
              <CloseIcon />
            </button>
          </div>
          <div className="flex-1 overflow-y-auto px-6 py-8">
            <ul className="space-y-6">
              {menuItems.map((item) => (
                <li key={item.name} className="text-2xl">
                  <Link
                    href={item.href}
                    className="block w-full hover:text-gray-600 transition-colors font-space-mono"
                    style={{ fontFamily: "var(--font-space-mono), monospace" }}
                    onClick={() => setIsOpen(false)}
                  >
                    {item.name}
                  </Link>
                </li>
              ))}
              {pageItems.length > 0 && (
                <li className="text-2xl">
                  <div className="mb-2 font-space-mono" style={{ fontFamily: "var(--font-space-mono), monospace" }}>Pages</div>
                  <ul className="ml-4 space-y-4 text-xl">
                    {pageItems.map((item: { name: string; href: string }) => (
                      <li key={item.name}>
                        <Link
                          href={item.href}
                          className="block w-full hover:text-gray-600 transition-colors font-space-mono"
                          style={{ fontFamily: "var(--font-space-mono), monospace" }}
                          onClick={() => setIsOpen(false)}
                        >
                          {item.name}
                        </Link>
                      </li>
                    ))}
                  </ul>
                </li>
              )}
              <li className="text-2xl">
                <div className="mb-2 font-space-mono" style={{ fontFamily: "var(--font-space-mono), monospace" }}>Resources</div>
                <ul className="ml-4 space-y-4 text-xl">
                  {resourcesItems.map((item) => (
                    <li key={item.name}>
                      <Link
                        href={item.href}
                        className="block w-full hover:text-gray-600 transition-colors font-space-mono"
                        style={{ fontFamily: "var(--font-space-mono), monospace" }}
                        onClick={() => setIsOpen(false)}
                      >
                        {item.name}
                      </Link>
                    </li>
                  ))}
                </ul>
              </li>
            </ul>
          </div>
          <div className="border-t p-6 space-y-4">
            <Link
              href="/catalog"
              className="flex items-center gap-3 text-sm font-bold w-full hover:text-gray-600 transition-colors"
              onClick={() => setIsOpen(false)}
            >
              <SearchIcon className="w-5 h-5" />
              Search
            </Link>
            <Link
              href={loggedIn ? "/account" : "/login"}
              className="flex items-center gap-3 text-sm font-bold hover:text-gray-600 transition-colors"
              onClick={() => setIsOpen(false)}
            >
              <AccountIcon className="w-5 h-5" />
              {loggedIn ? "Account" : "Login"}
            </Link>
            <Link
              href="/cart"
              className="flex items-center gap-3 text-sm font-bold hover:text-gray-600 transition-colors"
              onClick={() => setIsOpen(false)}
            >
              <CartIcon className="w-5 h-5" />
              Cart
            </Link>
          </div>
        </div>
      </div>
    </>
  ) : null;
  return (
    <>
      <button
        type="button"
        className="tap-area lg:hidden"
        aria-controls="header-sidebar-menu"
        onClick={() => setIsOpen(true)}
      >
        <span className="sr-only">Menu</span>
        <svg
          role="presentation"
          strokeWidth="2"
          focusable="false"
          width="22"
          height="22"
          className="icon icon-hamburger"
          viewBox="0 0 22 22"
        >
          <path
            d="M1 5h20M1 11h20M1 17h20"
            stroke="currentColor"
            strokeLinecap="round"
          />
        </svg>
      </button>
      {/* Use portal to render menu at body level, escaping any parent constraints */}
      {typeof window !== "undefined" && menuContent && createPortal(menuContent, document.body)}
    </>
  );
}
````

## File: src/components/Header/nav.module.css
````css
.headerGrid {
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto minmax(0, 1fr);
  grid-template-areas: "main-nav logo secondary-nav";
  gap: 1rem;
  padding-block: 1.125rem;
  align-items: center;
}
@media (min-width: 700px) {
  .headerGrid {
    padding-block: 2.125rem;
  }
}
/* When menu text is visible (lg breakpoint ~1024px), move logo to left */
@media (min-width: 1024px) {
  .headerGrid {
    grid-template-columns: auto 1fr auto;
    grid-template-areas: "logo main-nav secondary-nav";
    gap: 2rem;
  }
}
.mainNav {
  grid-area: main-nav;
}
.logo {
  grid-area: logo;
}
.secondaryNav {
  grid-area: secondary-nav;
}
````

## File: src/components/Header/Navbar.component.tsx
````typescript
"use client";
import Link from 'next/link';
import { useQuery } from '@apollo/client';
import MobileMenu from './MobileMenu.component';
import NavDropdown from './NavDropdown.component';
import SearchTrigger from './SearchTrigger.component';
import Logo from '@/components/UI/Logo.component';
import AccountIcon from '@/components/UI/icons/AccountIcon.component';
import CartIcon from '@/components/UI/icons/CartIcon.component';
import { useCartStore } from '@/stores/cartStore';
import { GET_CURRENT_USER, GET_PAGES } from '@/utils/gql/GQL_QUERIES';
import styles from './nav.module.css';
type NavItemLink = {
  name: string;
  href: string;
  type?: never;
  items?: never;
};
type NavItemDropdown = {
  name: string;
  type: "dropdown";
  items: Array<{ name: string; href: string }>;
  href?: never;
};
type NavItem = NavItemLink | NavItemDropdown;
// Static nav items - Pages dropdown will be added dynamically
const staticNavItems: NavItem[] = [
  { name: "Home", href: "/" },
  { name: "Catalog", href: "/catalog" },
  { name: "Articles", href: "/articles" },
  {
    name: "Resources",
    type: "dropdown",
    items: [
      { name: "Components", href: "/pages/components" },
    ],
  },
  { name: "Contact Us", href: "/pages/contact" },
];
/**
 * Navigation for the application.
 * Includes mobile menu and desktop navigation matching Medusa theme.
 */
const Navbar = () => {
  const cart = useCartStore((state) => state.cart);
  const cartCount = cart?.totalProductsCount || 0;
  // Check if user is authenticated
  // Use network-only to ensure we always check current authentication status
  // This prevents showing stale cached data after logout
  const { data, loading, error } = useQuery(GET_CURRENT_USER, {
    errorPolicy: 'all',
    fetchPolicy: 'network-only', // Always check server for current auth status
  });
  // Fetch pages from WordPress
  const { data: pagesData } = useQuery(GET_PAGES, {
    errorPolicy: 'all',
  });
  // Only consider logged in if we have customer data and no error
  // If loading or error, default to not logged in (show login link)
  const loggedIn = !loading && !error && !!data?.customer;
  // Build navigation items with pages dropdown
  const pages = pagesData?.pages?.nodes || [];
  const pageItems = pages
    .filter((page: { slug: string }) => 
      !['about-us', 'contact', 'components', 'terms-of-service', 'privacy-policy', 'returns-and-refunds'].includes(page.slug)
    )
    .map((page: { title: string; uri: string }) => ({
      name: page.title,
      href: page.uri || `/pages/${page.title.toLowerCase().replace(/\s+/g, '-')}`,
    }));
  const mainNavItems: NavItem[] = [
    ...staticNavItems,
    ...(pageItems.length > 0 ? [{
      name: "Pages",
      type: "dropdown" as const,
      items: pageItems,
    }] : []),
  ];
  return (
    <header className="sticky top-0 z-50 bg-white/80 backdrop-blur-[20px] border-b border-gray-200">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        {/* Grid layout: main-nav | logo | secondary-nav on mobile/tablet, logo | main-nav | secondary-nav on desktop */}
        <div className={styles.headerGrid}>
          {/* Main Navigation */}
          <div className={`${styles.mainNav} flex items-center gap-4`}>
            {/* Mobile Menu Button */}
            <div className="lg:hidden">
              <MobileMenu />
            </div>
            {/* Desktop Navigation Links */}
            <nav className="hidden lg:flex items-center justify-center w-full" role="navigation">
              <ul className="flex items-center gap-6" role="list">
                {mainNavItems.map((item) => (
                  <li key={item.name}>
                    {item.type === "dropdown" ? (
                      <NavDropdown label={item.name} items={item.items} />
                    ) : (
                      <Link
                        href={item.href}
                        className="text-sm hover:text-gray-900 transition-colors font-space-mono"
                        style={{ fontFamily: "var(--font-space-mono), monospace" }}
                      >
                        {item.name}
                      </Link>
                    )}
                  </li>
                ))}
              </ul>
            </nav>
          </div>
          {/* Logo */}
          <div className={`${styles.logo} flex items-center justify-start`}>
            <Link href="/" className="flex items-center">
              <span className="sr-only">Molecule</span>
              <Logo className="h-6 w-auto" />
            </Link>
          </div>
          {/* Secondary Navigation */}
          <div className={`${styles.secondaryNav} flex items-center justify-end gap-4`}>
            {/* Search - Always visible */}
            <SearchTrigger />
            {/* Account - Always visible */}
            <Link
              href={loggedIn ? "/account" : "/login"}
              className="p-2 hover:text-gray-900 transition-colors"
              aria-label={loggedIn ? "Account" : "Login"}
            >
              <span className="sr-only">{loggedIn ? "Account" : "Login"}</span>
              <AccountIcon />
            </Link>
            {/* Cart - Always visible */}
            <Link
              href="/cart"
              className="relative p-2 hover:text-gray-900 transition-colors"
              aria-label="Cart"
            >
              <span className="sr-only">Cart</span>
              <CartIcon />
              {cartCount > 0 && (
                <div className="absolute -top-1 -right-1 bg-black text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                  {cartCount}
                </div>
              )}
            </Link>
          </div>
        </div>
      </div>
    </header>
  );
};
export default Navbar;
````

## File: src/components/Header/NavDropdown.component.tsx
````typescript
"use client";
import { useState, useRef, useEffect } from "react";
import Link from "next/link";
import ChevronDown from "@/components/UI/ChevronDown.component";
type NavDropdownItem = {
  name: string;
  href: string;
};
type NavDropdownProps = {
  label: string;
  items: NavDropdownItem[];
};
export default function NavDropdown({ label, items }: NavDropdownProps) {
  const [isOpen, setIsOpen] = useState(false);
  const dropdownRef = useRef<HTMLDivElement>(null);
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (
        dropdownRef.current &&
        !dropdownRef.current.contains(event.target as Node)
      ) {
        setIsOpen(false);
      }
    };
    if (isOpen) {
      document.addEventListener("mousedown", handleClickOutside);
    }
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, [isOpen]);
  return (
    <div className="relative" ref={dropdownRef}>
      <button
        type="button"
        className="text-sm hover:text-gray-900 transition-colors flex items-center gap-1 font-space-mono"
        style={{ fontFamily: "var(--font-space-mono), monospace" }}
        onClick={() => setIsOpen(!isOpen)}
        aria-expanded={isOpen}
        aria-haspopup="true"
      >
        {label}
        <ChevronDown
          size="16"
          className={`transition-transform ${
            isOpen ? "rotate-180" : ""
          }`}
        />
      </button>
      {isOpen && (
        <div className="absolute top-full left-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50">
          {items.map((item) => (
            <Link
              key={item.href}
              href={item.href}
              className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors font-space-mono"
              style={{ fontFamily: "var(--font-space-mono), monospace" }}
              onClick={() => setIsOpen(false)}
            >
              {item.name}
            </Link>
          ))}
        </div>
      )}
    </div>
  );
}
````

## File: src/components/Header/SearchModal.component.tsx
````typescript
"use client";
import { useState, useEffect, useRef } from "react";
import { createPortal } from "react-dom";
import Link from "next/link";
import Image from "next/image";
import { useQuery } from "@apollo/client";
import { gql } from "@apollo/client";
import client from "@/utils/apollo/ApolloClient";
// Simple X icon component
const X = ({ className }: { className?: string }) => (
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    stroke="currentColor"
    strokeWidth="2"
    strokeLinecap="round"
    strokeLinejoin="round"
    className={className}
  >
    <line x1="15" y1="5" x2="5" y2="15"></line>
    <line x1="5" y1="5" x2="15" y2="15"></line>
  </svg>
);
type SearchResult = {
  type: "product" | "page" | "article";
  id: string;
  title: string;
  description?: string;
  href: string;
  thumbnail?: string;
};
type SearchModalProps = {
  isOpen: boolean;
  onClose: () => void;
};
// GraphQL query to search products
const SEARCH_PRODUCTS = gql`
  query SearchProducts($search: String!) {
    products(first: 10, where: { search: $search }) {
      nodes {
        id
        databaseId
        name
        slug
        description
        image {
          sourceUrl
          altText
        }
      }
    }
  }
`;
// GraphQL query to search posts
const SEARCH_POSTS = gql`
  query SearchPosts($search: String!) {
    posts(first: 10, where: { search: $search, status: PUBLISH }) {
      nodes {
        id
        databaseId
        title
        slug
        excerpt
        featuredImage {
          node {
            sourceUrl
            altText
          }
        }
      }
    }
  }
`;
const SearchModal = ({ isOpen, onClose }: SearchModalProps) => {
  const [query, setQuery] = useState("");
  const [results, setResults] = useState<SearchResult[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [isAnimating, setIsAnimating] = useState(false);
  const inputRef = useRef<HTMLInputElement>(null);
  // Handle animation states
  useEffect(() => {
    if (isOpen) {
      setIsAnimating(true);
    } else {
      setIsAnimating(false);
      const timer = setTimeout(() => {
        setQuery("");
        setResults([]);
      }, 150);
      return () => clearTimeout(timer);
    }
  }, [isOpen]);
  // Focus input when modal opens
  useEffect(() => {
    if (isOpen && inputRef.current) {
      setTimeout(() => {
        inputRef.current?.focus();
      }, 50);
    }
  }, [isOpen]);
  // Close on Escape key and prevent body scroll
  useEffect(() => {
    if (isOpen) {
      document.body.style.overflow = "hidden";
    } else {
      document.body.style.overflow = "";
    }
    return () => {
      document.body.style.overflow = "";
    };
  }, [isOpen]);
  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === "Escape" && isOpen) {
        onClose();
      }
    };
    window.addEventListener("keydown", handleEscape);
    return () => window.removeEventListener("keydown", handleEscape);
  }, [isOpen, onClose]);
  // Search function
  const performSearch = async (searchQuery: string) => {
    if (!searchQuery.trim()) {
      setResults([]);
      return;
    }
    setIsLoading(true);
    const searchResults: SearchResult[] = [];
    try {
      // Search products via GraphQL
      try {
        const { data: productsData } = await client.query({
          query: SEARCH_PRODUCTS,
          variables: { search: searchQuery },
        });
        if (productsData?.products?.nodes) {
          productsData.products.nodes.forEach((product: any) => {
            searchResults.push({
              type: "product",
              id: product.id,
              title: product.name,
              description: product.description
                ? product.description.replace(/<[^>]*>/g, "").substring(0, 100)
                : undefined,
              href: `/product/${product.slug}`,
              thumbnail: product.image?.sourceUrl,
            });
          });
        }
      } catch (error) {
        console.error("Product search error:", error);
      }
      // Search pages (static pages)
      const pages = [
        { title: "About Us", href: "/pages/about-us" },
        { title: "Contact Us", href: "/pages/contact" },
        { title: "Components", href: "/pages/components" },
        { title: "Articles", href: "/articles" },
        { title: "Terms of Service", href: "/pages/terms-of-service" },
        { title: "Privacy Policy", href: "/pages/privacy-policy" },
        { title: "Returns & Refunds", href: "/pages/returns-and-refunds" },
      ];
      pages.forEach((page) => {
        if (page.title.toLowerCase().includes(searchQuery.toLowerCase())) {
          searchResults.push({
            type: "page",
            id: page.href,
            title: page.title,
            href: page.href,
          });
        }
      });
      // Search research articles (blog posts) via GraphQL
      try {
        const { data: postsData } = await client.query({
          query: SEARCH_POSTS,
          variables: { search: searchQuery },
        });
        if (postsData?.posts?.nodes) {
          postsData.posts.nodes.forEach((post: any) => {
            const cleanExcerpt = post.excerpt
              ? post.excerpt.replace(/<[^>]*>/g, "").trim().substring(0, 100)
              : undefined;
            searchResults.push({
              type: "article",
              id: post.id,
              title: post.title,
              description: cleanExcerpt,
              href: `/articles/${post.slug}`,
              thumbnail: post.featuredImage?.node?.sourceUrl,
            });
          });
        }
      } catch (error) {
        console.error("Post search error:", error);
      }
    } catch (error) {
      console.error("Search error:", error);
    }
    setResults(searchResults);
    setIsLoading(false);
  };
  // Debounced search
  useEffect(() => {
    if (!query.trim()) {
      setResults([]);
      setIsLoading(false);
      return;
    }
    const timer = setTimeout(() => {
      performSearch(query);
    }, 300);
    return () => clearTimeout(timer);
  }, [query]);
  if (!isOpen && !isAnimating) return null;
  const modalContent = (
    <div className="fixed inset-0 z-[100]">
      {/* Blurred background */}
      <div
        className={`fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-150 ease-out ${
          isAnimating ? "opacity-100" : "opacity-0"
        }`}
        onClick={onClose}
      />
      {/* Modal content */}
      <div
        className="absolute inset-0 flex items-start justify-center pt-20 px-4 pointer-events-none"
        onClick={(e) => {
          if (e.target === e.currentTarget) {
            onClose();
          }
        }}
      >
        <div
          className={`relative w-full max-w-2xl bg-white rounded-2xl shadow-2xl overflow-hidden pointer-events-auto transition-all duration-150 ease-out ${
            isAnimating
              ? "opacity-100 translate-y-0 scale-100"
              : "opacity-0 translate-y-2 scale-[0.98]"
          }`}
          onClick={(e) => e.stopPropagation()}
        >
          {/* Search input */}
          <div className="flex items-center gap-4 p-6 border-b border-gray-200">
            <input
              ref={inputRef}
              type="text"
              value={query}
              onChange={(e) => setQuery(e.target.value)}
              placeholder="Search products, pages, and articles..."
              className="flex-1 text-lg outline-none border-none bg-transparent"
            />
            <button
              onClick={onClose}
              className="p-2 hover:bg-gray-100 rounded-full transition-colors"
              aria-label="Close search"
            >
              <X className="w-5 h-5" />
            </button>
          </div>
          {/* Results */}
          <div className="max-h-[60vh] overflow-y-auto">
            {isLoading ? (
              <div className="p-8 text-center text-gray-500">Searching...</div>
            ) : query.trim() && results.length === 0 ? (
              <div className="p-8 text-center text-gray-500">
                No results found for &quot;{query}&quot;
              </div>
            ) : query.trim() && results.length > 0 ? (
              <div className="divide-y divide-gray-100">
                {results.map((result) => (
                  <Link
                    key={`${result.type}-${result.id}`}
                    href={result.href}
                    onClick={onClose}
                    className="block p-4 hover:bg-gray-50 transition-colors"
                  >
                    <div className="flex items-start gap-4">
                      {result.thumbnail && (
                        <div className="w-16 h-16 rounded-lg overflow-hidden flex-shrink-0 bg-gray-100 relative">
                          <Image
                            src={result.thumbnail}
                            alt={result.title}
                            fill
                            className="object-cover"
                            sizes="64px"
                            unoptimized={
                              result.thumbnail.includes("localhost") ||
                              result.thumbnail.includes("127.0.0.1")
                            }
                          />
                        </div>
                      )}
                      <div className="flex-1 min-w-0">
                        <div className="flex items-center gap-2 mb-1">
                          <span className="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded-full uppercase">
                            {result.type}
                          </span>
                          <h3 className="text-base font-semibold text-gray-900 truncate">
                            {result.title}
                          </h3>
                        </div>
                        {result.description && (
                          <p className="text-sm text-gray-600 line-clamp-2">
                            {result.description}
                          </p>
                        )}
                      </div>
                    </div>
                  </Link>
                ))}
              </div>
            ) : (
              <div className="p-8 text-center text-gray-500">
                Start typing to search...
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
  // Use portal to render at body level
  if (typeof window !== "undefined") {
    return createPortal(modalContent, document.body);
  }
  return null;
};
export default SearchModal;
````

## File: src/components/Header/SearchTrigger.component.tsx
````typescript
"use client";
import { useState } from "react";
import SearchIcon from "@/components/UI/icons/SearchIcon.component";
import SearchModal from "@/components/Header/SearchModal.component";
const SearchTrigger = () => {
  const [isOpen, setIsOpen] = useState(false);
  return (
    <>
      <button
        onClick={() => setIsOpen(true)}
        className="p-2 hover:text-gray-900 transition-colors"
        aria-label="Search"
      >
        <span className="sr-only">Search</span>
        <SearchIcon />
      </button>
      <SearchModal isOpen={isOpen} onClose={() => setIsOpen(false)} />
    </>
  );
};
export default SearchTrigger;
````

## File: src/components/Index/FeaturesList.component.tsx
````typescript
"use client";
import { useState } from "react";
import Image from "next/image";
import { Zap, Link2, ShoppingCart } from "lucide-react";
type Feature = {
  id: number;
  title: string;
  description: string;
  icon: React.ReactNode;
  image: string;
  imageAlt: string;
};
const getFeatures = (): Feature[] => [
  {
    id: 1,
    title: "Next.js Powered",
    description:
      "Built on Next.js 16 with React 19 for lightning-fast performance and SEO optimization. Server-side rendering ensures your store loads quickly and ranks well in search results.",
    icon: <Zap className="w-6 h-6" />,
    image: "/images/pexels-fotios-photos-734973.jpg",
    imageAlt: "Next.js Powered",
  },
  {
    id: 2,
    title: "WooCommerce Integration",
    description:
      "Seamlessly integrated with WordPress and WooCommerce. Manage your products, orders, and inventory from the familiar WordPress admin panel while delivering a modern frontend experience.",
    icon: <Link2 className="w-6 h-6" />,
    image: "/images/pexels-polina-tankilevitch-3735769.jpg",
    imageAlt: "WooCommerce Integration",
  },
  {
    id: 3,
    title: "Modern E-Commerce",
    description:
      "A fully-featured commerce solution with cart management, checkout, user accounts, and payment processing. Built with TypeScript for type safety and maintainability.",
    icon: <ShoppingCart className="w-6 h-6" />,
    image: "/images/pexels-thirdman-8940517.jpg",
    imageAlt: "Modern E-Commerce",
  },
];
export default function FeaturesList() {
  const [activeFeature, setActiveFeature] = useState(1); // Start with the first feature active
  const features = getFeatures();
  return (
    <section className="features-list relative bg-white/50 py-12 md:py-16 -mt-10 md:-mt-0">
      {/* Backdrop blur overlay */}
      <div className="absolute inset-0 backdrop-blur-[20px] -z-10" />
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="features-list__container">
          <div className="features-list__content-container grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 lg:gap-[50px] items-center">
            {/* Text Area - Buttons */}
            <div className="features-list__text-area flex flex-col gap-3 order-2 md:order-1">
              <h2 className="text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-4">
                Why Choose This Solution
              </h2>
              {features.map((feature) => (
                <button
                  key={feature.id}
                  onClick={() => setActiveFeature(feature.id)}
                  className={`features-list__button text-left bg-white/70 p-4 md:p-6 md:px-8 rounded-lg transition-all duration-200 w-full relative ${
                    activeFeature === feature.id
                      ? "opacity-100 border border-gray-900 bg-[#EAEAEA]"
                      : "opacity-50 border border-transparent"
                  } hover:transform hover:-translate-y-0.5 hover:border-gray-900 hover:bg-[#EAEAEA]`}
                  aria-pressed={activeFeature === feature.id}
                >
                  {/* Backdrop blur for button */}
                  <div className="absolute inset-0 backdrop-blur-[10px] rounded-lg bg-[#EAEAEA] -z-10" />
                  <div className={`features-list__button-content flex gap-2 md:gap-4 relative z-10 ${
                    activeFeature === feature.id ? "items-start" : "items-center"
                  }`}>
                    {/* Icon */}
                    <div className="features-list__icon flex-shrink-0 w-12 md:w-14 rounded-lg p-3 flex items-center justify-center">
                      <div className="text-gray-900">{feature.icon}</div>
                    </div>
                    {/* Text Content */}
                    <div className="features-list__text-content flex flex-col gap-2 flex-1">
                      <span className="features-list__button-title text-xl md:text-2xl font-medium tracking-tight">
                        {feature.title}
                      </span>
                      <div
                        className={`features-list__text text-base leading-relaxed transition-all duration-300 overflow-hidden ${
                          activeFeature === feature.id
                            ? "h-auto opacity-100 mt-2"
                            : "h-0 opacity-0 mt-0"
                        }`}
                      >
                        <p>{feature.description}</p>
                      </div>
                    </div>
                  </div>
                </button>
              ))}
            </div>
            {/* Image Area */}
            <div className="features-list__image-area relative aspect-[3/4] bg-white rounded-3xl overflow-hidden order-1 md:order-2 mb-2 md:mb-0 md:h-full flex items-center">
              {features.map((feature) => (
                <div
                  key={feature.id}
                  className={`features-list__image-wrapper absolute inset-0 transition-opacity duration-300 ${
                    activeFeature === feature.id
                      ? "opacity-100 visible z-10"
                      : "opacity-0 invisible z-0"
                  }`}
                >
                  <Image
                    src={feature.image}
                    alt={feature.imageAlt}
                    fill
                    className="features-list__main-image object-cover"
                    sizes="(max-width: 699px) 100vw, 479px"
                  />
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>
  );
}
````

## File: src/components/Index/Hero.component.tsx
````typescript
import Link from 'next/link';
import StarIcon from '../UI/icons/StarIcon.component';
/**
 * Renders Hero section for Index page matching Medusa design
 * @function Hero
 * @returns {JSX.Element} - Rendered component
 */
const Hero = () => (
  <section className="w-full relative bg-white py-16 md:py-24">
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div className="text-left">
        {/* Star Rating & Verified Text Pill */}
        <div className="inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-full mb-6">
          <div className="flex items-center gap-1">
            <StarIcon className="w-3 h-3" />
            <StarIcon className="w-3 h-3" />
            <StarIcon className="w-3 h-3" />
            <StarIcon className="w-3 h-3" />
            <StarIcon className="w-3 h-3" />
          </div>
          <span className="text-sm text-gray-600 font-space-mono" style={{ fontFamily: "var(--font-space-mono), monospace" }}>
            Quality Guaranteed & Fast Shipping
          </span>
        </div>
        {/* Main Heading */}
        <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-8 max-w-4xl leading-tight">
          Quality Products for Your Every Need
        </h1>
        {/* CTA Button */}
        <div className="mt-8">
          <Link
            href="/catalog"
            className="inline-block px-8 py-4 bg-black text-white text-lg font-semibold rounded-full hover:bg-gray-800 transition-colors"
          >
            Shop Now
          </Link>
        </div>
      </div>
    </div>
  </section>
);
export default Hero;
````

## File: src/components/Index/HomeFAQ.component.tsx
````typescript
"use client";
import { useState } from "react";
import { Plus } from "lucide-react";
import Link from "next/link";
type FAQItem = {
  question: string;
  answer: React.ReactNode;
};
const faqs: FAQItem[] = [
  {
    question: "Are your products quality tested?",
    answer: (
      <p>
        Absolutely. All our products undergo rigorous quality testing to ensure they meet our high standards. We work with trusted suppliers and conduct quality checks to verify product integrity and specifications.
      </p>
    ),
  },
  {
    question: "What are typical delivery times?",
    answer: (
      <p>
        Delivery for our standard shipping option typically takes 3-5 business days. We ship from our warehouse to addresses across the country. We also provide expedited shipping options for faster delivery. Please allow 24 hours for order processing. <br /><br />
        Every package comes with professional packaging, tracking updates via email, and secure delivery.
      </p>
    ),
  },
  {
    question: "How should products be stored?",
    answer: (
      <p>
        Storage instructions vary by product type. Please refer to the product description and packaging for specific storage requirements. Most products should be stored in a cool, dry place away from direct sunlight.
      </p>
    ),
  },
  {
    question: "Are products safe during shipping?",
    answer: (
      <p>
        Yes, we take great care in packaging all products to ensure they arrive in perfect condition. Our packaging is designed to protect items during transit and is resistant to normal shipping conditions. Each order is carefully packed and sealed to maintain product integrity.
      </p>
    ),
  },
  {
    question: "What are your bulk ordering options?",
    answer: (
      <p>
        For bulk inquiries and volume pricing, please <Link href="/pages/contact" title="Contact" className="underline hover:no-underline">contact us</Link>. We're happy to work with you on custom orders and special pricing for larger quantities.
      </p>
    ),
  },
  {
    question: "What is your return/refund policy?",
    answer: (
      <p>
        We want you to be completely satisfied with your purchase. If you're not happy with your order, please <Link href="/pages/contact" title="Contact" className="underline hover:no-underline">contact us</Link> within 30 days of receipt. We'll work with you to resolve any issues or process a return if eligible.<br /><br />
        Some items may be non-returnable due to their nature. Please check product descriptions for specific return policies.
      </p>
    ),
  },
  {
    question: "What payment methods do you accept?",
    answer: (
      <>
        <p>
          We accept all major credit and debit cards, as well as PayPal. All payments are processed securely through our encrypted payment gateway.
        </p>
        <p>
          If you experience any issues with payment, please contact our support team and we'll be happy to assist.
        </p>
      </>
    ),
  },
  {
    question: "Do you ship internationally?",
    answer: (
      <>
        <p>
          Currently, we primarily ship within the United States. For international shipping inquiries, please <Link href="/pages/contact" title="Contact" className="underline hover:no-underline">contact us</Link> and we'll see what options are available for your location.
        </p>
        <p>
          International orders may be subject to customs fees and import duties, which are the responsibility of the customer.
        </p>
      </>
    ),
  },
  {
    question: "Do I need an account to place an order?",
    answer: (
      <p>
        While you can browse our catalog without an account, you'll need to create an account to complete a purchase. Creating an account allows you to track orders, save your shipping information, and access order history. The checkout process is quick and secure.
      </p>
    ),
  },
  {
    question: "How can I track my order?",
    answer: (
      <p>
        Once your order ships, you'll receive a confirmation email with a tracking number. You can use this tracking number on the carrier's website to monitor your package's progress. You can also log into your account to view order status and tracking information.
      </p>
    ),
  },
];
export default function HomeFAQ() {
  const [openIndex, setOpenIndex] = useState<number | null>(null);
  const toggleItem = (index: number) => {
    setOpenIndex(openIndex === index ? null : index);
  };
  return (
    <section className="w-full py-16 md:py-24 text-gray-900">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16">
          {/* Intro Section */}
          <div className="section-stack__intro">
            <div className="flex flex-col gap-10">
              <div className="prose">
                <h3 className="text-4xl md:text-5xl lg:text-6xl font-bold leading-tight font-chakra-petch">
                  Got questions?<br />
                  We've got <span className="underline">answers.</span>
                </h3>
              </div>
            </div>
          </div>
          {/* Accordion Section */}
          <div className="section-stack__main">
            <div className="accordion-box rounded-lg p-6">
              {faqs.map((faq, index) => {
                const isOpen = openIndex === index;
                return (
                  <div
                    key={index}
                    className="accordion group border-b border-gray-200 last:border-b-0"
                  >
                    <button
                      onClick={() => toggleItem(index)}
                      className={`accordion__toggle w-full flex gap-4 py-6 font-semibold text-xl hover:text-gray-700 transition-colors text-left ${
                        isOpen ? "items-start" : "items-center"
                      }`}
                      aria-expanded={isOpen}
                    >
                      <span
                        className={`circle-plus flex-shrink-0 w-8 h-8 rounded-full border-2 border-gray-900 flex items-center justify-center transition-all duration-200 ${
                          isOpen ? "rotate-45 bg-gray-900 text-white" : "bg-transparent text-gray-900"
                        } hover:bg-gray-900 hover:text-white`}
                      >
                        <Plus className="w-3 h-3" />
                      </span>
                      <h4 className="flex-1">{faq.question}</h4>
                    </button>
                    <div
                      className={`accordion__content overflow-hidden transition-all duration-300 ease-in-out ${
                        isOpen ? "max-h-[1000px] opacity-100 pb-6" : "max-h-0 opacity-0 pb-0"
                      }`}
                    >
                      <div className="prose pl-12">
                        <div className="text-base leading-relaxed text-gray-700">
                          {faq.answer}
                        </div>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        </div>
      </div>
    </section>
  );
}
````

## File: src/components/Index/ImageBanner.component.tsx
````typescript
import Image from 'next/image';
/**
 * Renders Image Banner section for Index page
 * @function ImageBanner
 * @returns {JSX.Element} - Rendered component
 */
const ImageBanner = () => {
  return (
    <section className="w-full py-12 md:py-16">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="rounded-3xl overflow-hidden">
          <div className="relative w-full h-[400px] md:h-[500px] lg:h-[600px]">
            <Image
              src="/images/pexels-bamboo-ave-677926128-29205121.jpg"
              alt="Premium Products"
              fill
              className="object-cover object-center"
              priority
              sizes="(max-width: 768px) 100vw, (max-width: 1200px) 90vw, 1280px"
            />
          </div>
        </div>
      </div>
    </section>
  );
};
export default ImageBanner;
````

## File: src/components/Index/ProductCarousel.component.tsx
````typescript
"use client";
import { useRef } from "react";
import Link from "next/link";
import ProductCard from "@/components/Product/ProductCard.component";
interface Product {
  databaseId: number;
  name: string;
  price: string;
  regularPrice: string;
  salePrice?: string;
  onSale: boolean;
  slug: string;
  image?: {
    sourceUrl?: string;
  };
}
type ProductCarouselProps = {
  products: Product[];
};
export default function ProductCarousel({
  products,
}: ProductCarouselProps) {
  const scrollContainerRef = useRef<HTMLDivElement>(null);
  const scroll = (direction: "left" | "right") => {
    if (scrollContainerRef.current) {
      const scrollAmount = 400;
      scrollContainerRef.current.scrollBy({
        left: direction === "left" ? -scrollAmount : scrollAmount,
        behavior: "smooth",
      });
    }
  };
  if (!products || products.length === 0) {
    return null;
  }
  return (
    <div className="relative">
      {/* Scroll Buttons */}
      <button
        onClick={() => scroll("left")}
        className="absolute left-0 top-1/2 -translate-y-1/2 z-20 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors hidden md:block"
        aria-label="Scroll left"
      >
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
        >
          <path d="M15 18l-6-6 6-6" />
        </svg>
      </button>
      <button
        onClick={() => scroll("right")}
        className="absolute right-0 top-1/2 -translate-y-1/2 z-20 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors hidden md:block"
        aria-label="Scroll right"
      >
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
        >
          <path d="M9 18l6-6-6-6" />
        </svg>
      </button>
      {/* Scrollable Product List */}
      <div
        ref={scrollContainerRef}
        className="flex gap-6 overflow-x-auto pb-4 -mx-4 px-4 md:-mx-6 md:px-6 no-scrollbar"
      >
        {products.map((product) => (
          <div
            key={product.databaseId}
            className="flex-shrink-0 w-[280px] sm:w-[320px]"
          >
            <ProductCard
              databaseId={product.databaseId}
              name={product.name}
              price={product.price}
              regularPrice={product.regularPrice}
              salePrice={product.salePrice}
              onSale={product.onSale}
              slug={product.slug}
              image={product.image}
            />
          </div>
        ))}
      </div>
    </div>
  );
}
````

## File: src/components/Index/TextSection.component.tsx
````typescript
/**
 * Renders Text Section for Index page
 * @function TextSection
 * @returns {JSX.Element} - Rendered component
 */
const TextSection = () => (
  <section className="w-full py-16 md:py-24 bg-white">
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div className="text-center">
        <h2 className="text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 max-w-4xl mx-auto leading-tight">
          Built with modern technology. Your store starts with{" "}
          <span className="underline">ours.</span>
        </h2>
      </div>
    </div>
  </section>
);
export default TextSection;
````

## File: src/components/Input/InputField.component.tsx
````typescript
import { FieldValues, useFormContext, UseFormRegister } from 'react-hook-form';
interface ICustomValidation {
  required?: boolean;
  minlength?: number;
}
interface IErrors {}
export interface IInputRootObject {
  inputLabel: string;
  inputName: string;
  customValidation: ICustomValidation;
  errors?: IErrors;
  register?: UseFormRegister<FieldValues>;
  type?: string;
  className?: string;
  showLabel?: boolean;
}
/**
 * Input field component displays a text input in a form, with label.
 * The various properties of the input field can be determined with the props:
 * @param {ICustomValidation} [customValidation] - the validation rules to apply to the input field
 * @param {IErrors} errors - the form errors object provided by react-hook-form
 * @param {string} inputLabel - used for the display label
 * @param {string} inputName - the key of the value in the submitted data. Must be unique
 * @param {UseFormRegister<FieldValues>} register - register function from react-hook-form
 * @param {boolean} [required=true] - whether or not this field is required. default true
 * @param {string} [type='text'] - the input type. defaults to text
 */
export const InputField = ({
  customValidation,
  inputLabel,
  inputName,
  type,
  className = '',
  showLabel = false,
}: IInputRootObject) => {
  const { register, formState: { errors } } = useFormContext();
  // Convert HTML attributes to React props
  const reactProps: any = {};
  if (customValidation) {
    Object.keys(customValidation).forEach((key) => {
      // Convert minlength to minLength for React
      if (key === 'minlength') {
        reactProps.minLength = customValidation.minlength;
      } else {
        reactProps[key] = customValidation[key as keyof typeof customValidation];
      }
    });
  }
  const fieldError = errors[inputName];
  return (
    <div className={`${className || 'flex-1'}`}>
      {showLabel && (
        <label htmlFor={inputName} className="block text-sm text-gray-600 mb-1">
          {inputLabel}
        </label>
      )}
      <input
        className="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-2 focus:ring-black focus:border-black block w-full px-3 py-2 placeholder-gray-400"
        id={inputName}
        placeholder={inputLabel}
        type={type ?? 'text'}
        {...reactProps}
        {...register(inputName)}
      />
      {fieldError && (
        <p className="text-red-600 text-xs mt-1">{fieldError.message as string}</p>
      )}
    </div>
  );
};
````

## File: src/components/Layout/AgeVerificationModal.component.tsx
````typescript
"use client";
import { useEffect, useState } from "react";
import Logo from "@/components/UI/Logo.component";
const AGE_VERIFICATION_KEY = "age_verification_accepted";
const REMEMBER_ME_KEY = "age_verification_remember_me";
export default function AgeVerificationModal() {
  const [isOpen, setIsOpen] = useState(false);
  const [rememberMe, setRememberMe] = useState(false);
  const [showError, setShowError] = useState(false);
  useEffect(() => {
    // Check if user has already accepted and "Remember me" was checked
    const remembered = localStorage.getItem(REMEMBER_ME_KEY) === "true";
    const accepted = localStorage.getItem(AGE_VERIFICATION_KEY) === "true";
    if (!remembered && !accepted) {
      setIsOpen(true);
    }
  }, []);
  const handleAccept = () => {
    if (rememberMe) {
      localStorage.setItem(REMEMBER_ME_KEY, "true");
    }
    localStorage.setItem(AGE_VERIFICATION_KEY, "true");
    setIsOpen(false);
  };
  const handleDecline = () => {
    setShowError(true);
    // Optionally redirect away or show error message
  };
  if (!isOpen) return null;
  return (
    <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm">
      <div className="age-popup-content bg-white rounded-lg p-8 max-w-md w-full mx-4 shadow-2xl">
        <div className="flex justify-center mb-6">
          <Logo className="h-8 w-auto" />
        </div>
        <div className="text-center mb-6">
          <p className="mb-4 text-lg">
            <strong>You must be at least 21 to visit this site.</strong>
          </p>
          <p className="text-sm text-gray-600">
            By entering this site, you are accepting our Terms of Service
          </p>
        </div>
        <div className="age-popup-buttons flex gap-4 mb-4">
          <button
            className="age-popup-btn decline flex-1 px-6 py-3 bg-gray-200 text-gray-800 rounded-full hover:bg-gray-300 transition-colors"
            id="declineBtn"
            onClick={handleDecline}
          >
            Decline
          </button>
          <button
            className="age-popup-btn accept flex-1 px-6 py-3 bg-black text-white rounded-full hover:bg-gray-800 transition-colors"
            id="acceptBtn"
            onClick={handleAccept}
          >
            Accept
          </button>
        </div>
        <div className="age-popup-remember flex items-center gap-2 mb-4">
          <input
            type="checkbox"
            id="rememberMe"
            checked={rememberMe}
            onChange={(e) => setRememberMe(e.target.checked)}
            className="w-4 h-4 flex-shrink-0"
          />
          <label htmlFor="rememberMe" className="text-sm text-gray-700 cursor-pointer !transform-none">
            Remember me
          </label>
        </div>
        {showError && (
          <div className="age-popup-error bg-red-50 border border-red-200 text-red-700 p-3 rounded mb-4 text-sm">
            You are not old enough to view this content
          </div>
        )}
        <div className="age-popup-disclaimer text-xs text-gray-600 border-t pt-4 mt-4">
          <strong>DISCLAIMER:</strong> All products sold by Molecule are strictly
          intended for laboratory research use only. They are not approved for
          human or animal consumption, or for any form of therapeutic or
          diagnostic use.
          <br />
          <br />
          We do not provide usage instructions, dosing guidelines, or any
          advice regarding the application of our products.
          <br />
          <br />
          This is a research supply company only.
        </div>
      </div>
    </div>
  );
}
````

## File: src/components/Layout/CartLayout.component.tsx
````typescript
// Imports
import Head from 'next/head';
import Link from 'next/link';
import { ReactNode } from 'react';
import { useQuery } from '@apollo/client';
// Components
import Header from '@/components/Header/Header.component';
import ShippingBanner from './ShippingBanner.component';
import Logo from '@/components/UI/Logo.component';
import CartIcon from '@/components/UI/icons/CartIcon.component';
import { useCartStore } from '@/stores/cartStore';
import { GET_CURRENT_USER } from '@/utils/gql/GQL_QUERIES';
interface ICartLayoutProps {
  children?: ReactNode;
  title: string;
}
/**
 * Renders a layout specifically for cart page.
 * Features header but no footer - uses sticky footer for checkout actions instead.
 * @function CartLayout
 * @param {ReactNode} children - Children to be rendered by CartLayout component
 * @param {string} title - Title for the page. Is set in <title>{title}</title>
 * @returns {JSX.Element} - Rendered component
 */
const CartLayout = ({ children, title }: ICartLayoutProps) => {
  const cart = useCartStore((state) => state.cart);
  const cartCount = cart?.totalProductsCount || 0;
  // Check if user is authenticated
  const { data } = useQuery(GET_CURRENT_USER, {
    errorPolicy: 'all',
    fetchPolicy: 'cache-and-network',
  });
  const loggedIn = !!data?.customer;
  return (
    <>
      <Head>
        <title>{`${title} - Molecule`}</title>
        <meta name="description" content="Your shopping cart" />
      </Head>
      <div className="flex flex-col min-h-screen w-full mx-auto">
        <ShippingBanner />
        <Header title={title} />
        <main className="flex-1 pb-32">{children}</main>
        {/* No Footer or Stickynav - using sticky footer in CartContents instead */}
      </div>
    </>
  );
};
export default CartLayout;
````

## File: src/components/Layout/CheckoutLayout.component.tsx
````typescript
// Imports
import Head from 'next/head';
import Link from 'next/link';
import { ReactNode } from 'react';
// Components
import Logo from '@/components/UI/Logo.component';
interface ICheckoutLayoutProps {
  children?: ReactNode;
  title: string;
}
/**
 * Renders a minimal layout specifically for checkout pages.
 * Features a minimal header with logo and cart icon, and a two-column layout.
 * @function CheckoutLayout
 * @param {ReactNode} children - Children to be rendered by CheckoutLayout component
 * @param {string} title - Title for the page. Is set in <title>{title}</title>
 * @returns {JSX.Element} - Rendered component
 */
const CheckoutLayout = ({ children, title }: ICheckoutLayoutProps) => {
  return (
    <>
      <Head>
        <title>{`${title} - Molecule`}</title>
        <meta name="description" content="Complete your order" />
        <meta name="robots" content="noindex, nofollow" />
      </Head>
      <div className="flex flex-col min-h-screen w-full bg-gray-50">
        {/* Minimal Header */}
        <header className="sticky top-0 z-50 bg-white border-b border-gray-200">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="flex items-center justify-between h-16">
              {/* Logo */}
              <div className="flex items-center">
                <Link href="/" className="flex items-center">
                  <span className="sr-only">Molecule</span>
                  <Logo className="h-6 w-auto" />
                </Link>
              </div>
              {/* Back to Homepage Button */}
              <div className="flex items-center">
                <Link
                  href="/"
                  className="inline-flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-900 rounded-full transition-colors text-sm font-medium"
                  aria-label="Back to homepage"
                >
                  <svg
                    className="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M10 19l-7-7m0 0l7-7m-7 7h18"
                    />
                  </svg>
                  Back to homepage
                </Link>
              </div>
            </div>
          </div>
        </header>
        {/* Main Content - Two Column Layout */}
        <main className="flex-1">{children}</main>
      </div>
    </>
  );
};
export default CheckoutLayout;
````

## File: src/components/Layout/Layout.component.tsx
````typescript
// Imports
import { ReactNode } from 'react';
// Components
import Header from '@/components/Header/Header.component';
import Footer from '@/components/Footer/Footer.component';
import ShippingBanner from './ShippingBanner.component';
interface ILayoutProps {
  children?: ReactNode;
  title: string;
}
/**
 * Renders layout for each page. Also passes along the title to the Header component.
 * @function Layout
 * @param {ReactNode} children - Children to be rendered by Layout component
 * @param {TTitle} title - Title for the page. Is set in <title>{title}</title>
 * @returns {JSX.Element} - Rendered component
 */
const Layout = ({ children, title }: ILayoutProps) => {
  return (
    <div className="flex flex-col min-h-screen w-full mx-auto">
      <ShippingBanner />
      <Header title={title} />
      {title === 'Home' ? (
        <main className="flex-1 px-4 md:px-0">{children}</main>
      ) : (
        <main className="flex-1">{children}</main>
      )}
      <div className="mt-auto">
        <Footer />
      </div>
    </div>
  );
};
export default Layout;
````

## File: src/components/Layout/PageTitle.component.tsx
````typescript
interface IPageTitleProps {
  title: string;
}
/**
 * Renders page title for each page.
 * @function PageTitle
 * @param {string} title - Title for the page. Is set in <title>{title}</title>
 * @returns {JSX.Element} - Rendered component
 */
const PageTitle = ({ title }: IPageTitleProps) => (
  <section className="w-full bg-white border-b border-gray-200">
    <div className="container mx-auto py-12 px-6">
      <h1 className="text-2xl text-center tracking-wider text-gray-900 uppercase">
        {title}
      </h1>
    </div>
  </section>
);
export default PageTitle;
````

## File: src/components/Layout/ShippingBanner.component.tsx
````typescript
"use client";
import { useEffect, useState } from "react";
export default function ShippingBanner() {
  const [isVisible, setIsVisible] = useState(true);
  const [lastScrollY, setLastScrollY] = useState(0);
  useEffect(() => {
    const handleScroll = () => {
      const currentScrollY = window.scrollY;
      // Hide when scrolling down, show when scrolling up
      if (currentScrollY > lastScrollY && currentScrollY > 50) {
        setIsVisible(false);
      } else if (currentScrollY < lastScrollY) {
        setIsVisible(true);
      }
      setLastScrollY(currentScrollY);
    };
    window.addEventListener("scroll", handleScroll, { passive: true });
    return () => window.removeEventListener("scroll", handleScroll);
  }, [lastScrollY]);
  return (
    <div
      className={`w-full bg-black text-white py-3 px-4 text-center transition-transform duration-300 ease-in-out ${
        isVisible ? "translate-y-0" : "-translate-y-full"
      }`}
    >
      <p className="font-semibold text-base">
        Free US Domestic Shipping
      </p>
    </div>
  );
}
````

## File: src/components/LoadingSpinner/LoadingSpinner.component.tsx
````typescript
/**
 * Loading spinner, shows while loading products or categories.
 * Black circular spinner without grey track.
 */
const LoadingSpinner = () => (
  <div className="w-full h-full flex justify-center items-center p-4 mt-2">
    <div role="status" aria-label="Loading">
      <div className="animate-spin rounded-full w-12 h-12 border-4 border-transparent border-t-black border-r-black"></div>
      <span className="sr-only">Loading...</span>
    </div>
  </div>
);
export default LoadingSpinner;
````

## File: src/components/Product/AddToCart.component.tsx
````typescript
// Imports
import { useState, useEffect } from 'react';
import { useQuery, useMutation } from '@apollo/client';
import { v4 as uuidv4 } from 'uuid';
// Components
import Button from '@/components/UI/Button.component';
// State
import { useCartStore } from '@/stores/cartStore';
// Utils
import { getFormattedCart } from '@/utils/functions/functions';
// GraphQL
import { GET_CART } from '@/utils/gql/GQL_QUERIES';
import { ADD_TO_CART } from '@/utils/gql/GQL_MUTATIONS';
interface IImage {
  __typename: string;
  id: string;
  uri: string;
  title: string;
  srcSet: string;
  sourceUrl: string;
}
interface IVariationNode {
  __typename: string;
  name: string;
}
interface IAllPaColors {
  __typename: string;
  nodes: IVariationNode[];
}
interface IAllPaSizes {
  __typename: string;
  nodes: IVariationNode[];
}
export interface IVariationNodes {
  __typename?: string;
  id?: string;
  databaseId: number;
  name: string;
  price: string;
  stockStatus: string;
  stockQuantity: number;
  purchasable: boolean;
  onSale: boolean;
  salePrice?: string;
  regularPrice: string;
  attributes?: {
    nodes?: Array<{
      name: string;
      value: string;
    }>;
  };
}
interface IVariations {
  __typename?: string;
  nodes?: IVariationNodes[];
}
export interface IProduct {
  __typename?: string;
  id?: string;
  databaseId: number;
  averageRating?: number;
  slug?: string;
  description?: string;
  onSale: boolean;
  image?: IImage;
  name: string;
  salePrice?: string;
  regularPrice: string;
  price: string;
  stockQuantity?: number | null;
  stockStatus?: string;
  purchasable?: boolean;
  allPaColors?: IAllPaColors;
  allPaSizes?: IAllPaSizes;
  variations?: IVariations;
}
export interface IProductRootObject {
  product: IProduct;
  variationId?: number;
  fullWidth?: boolean;
  inStock?: boolean;
  hasVariations?: boolean;
  selectedVariation?: {
    databaseId: number;
    stockQuantity: number;
    purchasable: boolean;
  } | null;
}
/**
 * Handles the Add to cart functionality.
 * Uses GraphQL for product data
 * @param {IAddToCartProps} product // Product data
 * @param {number} variationId // Variation ID
 * @param {boolean} fullWidth // Whether the button should be full-width
 */
const AddToCart = ({
  product,
  variationId,
  fullWidth = false,
  inStock = true,
  hasVariations = false,
  selectedVariation = null,
}: IProductRootObject) => {
  const { syncWithWooCommerce, isLoading: isCartLoading } = useCartStore();
  const [requestError, setRequestError] = useState<boolean>(false);
  // For variable products, we need the parent product ID and the variation ID
  // For simple products, we only need the product ID
  const productId = product?.databaseId;
  const finalVariationId = hasVariations && selectedVariation ? (variationId || selectedVariation.databaseId) : undefined;
  // Determine button text based on state
  const getButtonText = () => {
    if (isCartLoading || addToCartLoading) {
      return 'Adding...';
    }
    if (hasVariations && !selectedVariation) {
      return 'Select variant';
    }
    if (!inStock) {
      return 'Out of stock';
    }
    return 'Add to cart';
  };
  // Get cart data query
  const { data, refetch, error: cartError } = useQuery(GET_CART, {
    notifyOnNetworkStatusChange: true,
    errorPolicy: 'all', // Return partial data even if there are errors
  });
  // Use useEffect instead of onCompleted (deprecated)
  useEffect(() => {
    if (data) {
      const updatedCart = getFormattedCart(data);
      if (updatedCart) {
        syncWithWooCommerce(updatedCart);
      }
    }
  }, [data, syncWithWooCommerce]);
  // Add to cart mutation
  const [addToCart, { loading: addToCartLoading }] = useMutation(ADD_TO_CART, {
    onCompleted: (mutationData) => {
      // Immediately refetch cart to get updated state
      refetch().then(() => {
        // Also update from the mutation response if available
        if (mutationData?.addToCart?.cartItem) {
          // Trigger a refetch to ensure we have the latest cart state
          setTimeout(() => {
            refetch();
          }, 500);
        }
      });
    },
    onError: (error) => {
      console.error('Add to cart error:', error);
      setRequestError(true);
      // Reset error after 3 seconds
      setTimeout(() => {
        setRequestError(false);
      }, 3000);
    },
  });
  const handleAddToCart = () => {
    if (!productId) {
      console.error('Product ID is missing');
      setRequestError(true);
      return;
    }
    // Check if GraphQL URL is configured
    if (!process.env.NEXT_PUBLIC_GRAPHQL_URL) {
      console.error('NEXT_PUBLIC_GRAPHQL_URL is not configured');
      alert('GraphQL endpoint is not configured. Please check your environment variables.');
      setRequestError(true);
      return;
    }
    // Build the mutation input - AddToCartInput does NOT include clientMutationId
    const input: {
      productId: number;
      variationId?: number;
      quantity?: number;
    } = {
      productId,
    };
    // Add variation ID if this is a variable product with a selected variation
    if (hasVariations && finalVariationId) {
      input.variationId = finalVariationId;
    }
    // Add quantity (default to 1)
    input.quantity = 1;
    // Log the input for debugging
    if (process.env.NODE_ENV === 'development') {
      console.log('[AddToCart] Starting mutation with:', {
        input,
        productId,
        variationId: finalVariationId,
        hasVariations,
        selectedVariation,
      });
      console.log('[AddToCart] GraphQL URL:', process.env.NEXT_PUBLIC_GRAPHQL_URL);
      console.log('[AddToCart] Mutation definition:', ADD_TO_CART);
    }
    // Call the mutation with the correct input
    addToCart({
      variables: {
        input,
      },
    }).catch((error) => {
      if (process.env.NODE_ENV === 'development') {
        console.error('[AddToCart] Mutation failed:', error);
      }
      // Additional error handling
      console.error('Add to cart mutation error:', error);
      if (error.networkError) {
        const networkError = error.networkError;
        const errorDetails: Record<string, unknown> = {
          message: networkError.message,
        };
        // Only include statusCode if it exists (ServerParseError or ServerError)
        if ('statusCode' in networkError) {
          errorDetails.statusCode = (networkError as { statusCode: number }).statusCode;
        }
        // Only include result if it exists
        if ('result' in networkError) {
          errorDetails.result = (networkError as { result: unknown }).result;
        }
        console.error('Network error details:', errorDetails);
        console.error('GraphQL URL:', process.env.NEXT_PUBLIC_GRAPHQL_URL);
        // Provide user-friendly error message
        if (networkError.message === 'Failed to fetch') {
          alert('Failed to connect to the server. Please check:\n1. WordPress is running\n2. GraphQL endpoint is accessible\n3. CORS is properly configured');
        }
      }
      if (error.graphQLErrors && error.graphQLErrors.length > 0) {
        console.error('GraphQL errors:', error.graphQLErrors);
        const errorMessages = error.graphQLErrors.map((e: any) => e.message).join('\n');
        alert(`GraphQL Error:\n${errorMessages}`);
      }
    });
  };
  const isDisabled = 
    addToCartLoading || 
    requestError || 
    isCartLoading || 
    !inStock || 
    (hasVariations && !selectedVariation);
  return (
    <>
      <Button
        handleButtonClick={() => handleAddToCart()}
        buttonDisabled={isDisabled}
        fullWidth={fullWidth}
      >
        {getButtonText()}
      </Button>
    </>
  );
};
export default AddToCart;
````

## File: src/components/Product/DisplayProducts.component.tsx
````typescript
/*eslint complexity: ["error", 20]*/
import Link from 'next/link';
import { v4 as uuidv4 } from 'uuid';
import { filteredVariantPrice, paddedPrice } from '@/utils/functions/functions';
interface Image {
  __typename: string;
  sourceUrl?: string;
}
interface Node {
  __typename: string;
  price: string;
  regularPrice: string;
  salePrice?: string;
}
interface Variations {
  __typename: string;
  nodes: Node[];
}
interface RootObject {
  __typename: string;
  name: string;
  onSale: boolean;
  slug: string;
  image: Image;
  price: string;
  regularPrice: string;
  salePrice?: string;
  variations: Variations;
}
interface IDisplayProductsProps {
  products: RootObject[];
}
/**
 * Displays all of the products as long as length is defined.
 * Does a map() over the props array and utilizes uuidv4 for unique key values.
 * @function DisplayProducts
 * @param {IDisplayProductsProps} products Products to render
 * @returns {JSX.Element} - Rendered component
 */
const DisplayProducts = ({ products }: IDisplayProductsProps) => (
  <section className="container mx-auto bg-white py-12">
    <div
      id="product-container"
      className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"
    >
      {products ? (
        products.map(
          ({
            name,
            price,
            regularPrice,
            salePrice,
            onSale,
            slug,
            image,
            variations,
          }) => {
            // Add padding/empty character after currency symbol here
            if (price) {
              price = paddedPrice(price, '$');
            }
            if (regularPrice) {
              regularPrice = paddedPrice(regularPrice, '$');
            }
            if (salePrice) {
              salePrice = paddedPrice(salePrice, '$');
            }
            return (
              <div key={uuidv4()} className="group">
                <Link href={`/product/${encodeURIComponent(slug)}`}>
                  <div className="aspect-[3/4] relative overflow-hidden bg-gray-100">
                    {image ? (
                      <img
                        id="product-image"
                        className="w-full h-full object-cover object-center transition duration-300 group-hover:scale-105"
                        alt={name}
                        src={image.sourceUrl}
                      />
                    ) : (
                      <img
                        id="product-image"
                        className="w-full h-full object-cover object-center transition duration-300 group-hover:scale-105"
                        alt={name}
                        src={
                          process.env.NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL
                        }
                      />
                    )}
                  </div>
                </Link>
                <Link href={`/product/${encodeURIComponent(slug)}`}>
                  <span>
                    <div className="mt-4">
                      <p className="text-xl font-bold text-center cursor-pointer hover:text-gray-600 transition-colors">
                        {name}
                      </p>
                    </div>
                  </span>
                </Link>
                <div className="mt-2 text-center">
                  {onSale ? (
                    <div className="flex justify-center items-center space-x-2">
                      <span className="text-xl font-bold text-red-600">
                        {variations && filteredVariantPrice(price, '')}
                        {!variations && salePrice}
                      </span>
                      <span className="text-lg text-gray-500 line-through">
                        {variations && filteredVariantPrice(price, 'right')}
                        {!variations && regularPrice}
                      </span>
                    </div>
                  ) : (
                    <span className="text-lg text-gray-900">{price}</span>
                  )}
                </div>
              </div>
            );
          },
        )
      ) : (
        <div className="mx-auto text-xl font-bold text-center text-gray-800 no-underline uppercase">
          No products found
        </div>
      )}
    </div>
  </section>
);
export default DisplayProducts;
````

## File: src/components/Product/ImageGallery.component.tsx
````typescript
import Image from 'next/image';
import { useState } from 'react';
interface ProductImage {
  id?: string;
  sourceUrl?: string;
  altText?: string;
}
interface ImageGalleryProps {
  images: ProductImage[];
}
const ImageGallery = ({ images }: ImageGalleryProps) => {
  const [imageErrors, setImageErrors] = useState<Set<number>>(new Set());
  if (!images || images.length === 0) {
    return (
      <div className="relative aspect-[29/34] w-full overflow-hidden bg-gray-100 rounded-lg">
        <div className="absolute inset-0 flex items-center justify-center">
          <span className="text-gray-400">No image</span>
        </div>
      </div>
    );
  }
  const handleImageError = (index: number) => {
    setImageErrors((prev) => new Set(prev).add(index));
  };
  return (
    <div className="flex items-start relative">
      <div className="flex flex-col flex-1 gap-y-4">
        {images.map((image, index) => {
          const hasError = imageErrors.has(index);
          const showFallback = hasError || !image.sourceUrl;
          return (
            <div
              key={image.id || index}
              className="relative aspect-[29/34] w-full overflow-hidden bg-gray-100 rounded-lg"
            >
              {showFallback ? (
                <div className="absolute inset-0 flex items-center justify-center">
                  <div className="text-center p-4">
                    <span className="text-gray-400 block mb-2">No image</span>
                    {process.env.NODE_ENV === 'development' && image.sourceUrl && (
                      <span className="text-xs text-gray-500 block break-all">
                        URL: {image.sourceUrl}
                      </span>
                    )}
                  </div>
                </div>
              ) : (
                <Image
                  src={image.sourceUrl!}
                  priority={index <= 2}
                  className="absolute inset-0 rounded-lg"
                  alt={image.altText || `Product image ${index + 1}`}
                  fill
                  sizes="(max-width: 576px) 280px, (max-width: 768px) 360px, (max-width: 992px) 480px, 800px"
                  style={{
                    objectFit: 'cover',
                  }}
                  onError={() => handleImageError(index)}
                  unoptimized={image.sourceUrl?.includes('localhost') || image.sourceUrl?.includes('127.0.0.1')}
                />
              )}
            </div>
          );
        })}
      </div>
    </div>
  );
};
export default ImageGallery;
````

## File: src/components/Product/OptionSelect.component.tsx
````typescript
"use client";
interface OptionSelectProps {
  title: string;
  options: string[];
  current?: string;
  updateOption: (value: string) => void;
  disabled?: boolean;
  "data-testid"?: string;
}
const OptionSelect: React.FC<OptionSelectProps> = ({
  title,
  options,
  current,
  updateOption,
  "data-testid": dataTestId,
  disabled,
}) => {
  return (
    <div className="flex flex-col gap-y-3">
      <span className="text-sm text-gray-700">Select {title}</span>
      <div
        className="flex flex-wrap justify-between gap-2"
        data-testid={dataTestId}
      >
        {options.map((value) => {
          const isSelected = value === current;
          return (
            <button
              onClick={() => updateOption(value)}
              key={value}
              className={`border text-sm h-10 rounded-full px-4 flex-1 transition-all ${
                isSelected
                  ? "border-gray-900 bg-gray-900 text-white"
                  : "border-gray-300 bg-gray-50 text-gray-900 hover:border-gray-900 hover:shadow-sm"
              }`}
              disabled={disabled}
              data-testid="option-button"
            >
              {value}
            </button>
          );
        })}
      </div>
    </div>
  );
};
export default OptionSelect;
````

## File: src/components/Product/ProductActions.component.tsx
````typescript
"use client";
import { useState, useMemo, useEffect } from "react";
import ProductPrice from "./ProductPrice.component";
import OptionSelect from "./OptionSelect.component";
import AddToCart from "./AddToCart.component";
import ProductTabs from "./ProductTabs.component";
interface ProductActionsProps {
  product: {
    databaseId: number;
    name: string;
    description?: string;
    price: string;
    regularPrice: string;
    salePrice?: string;
    onSale: boolean;
    stockQuantity?: number | null;
    stockStatus?: string;
    purchasable?: boolean;
    variations?: {
      nodes?: Array<{
        databaseId: number;
        name: string;
        price: string;
        regularPrice: string;
        salePrice?: string;
        onSale: boolean;
        stockQuantity: number;
        purchasable: boolean;
        stockStatus: string;
        attributes?: {
          nodes?: Array<{
            name: string;
            value: string;
          }>;
        };
      }>;
    };
  };
}
export default function ProductActions({ product }: ProductActionsProps) {
  const [selectedVariation, setSelectedVariation] = useState<number | undefined>();
  const [isAdding, setIsAdding] = useState(false);
  // Get unique attribute options from variations
  // WordPress variations use attributes differently - check if they exist
  const attributeOptions = useMemo(() => {
    if (!product.variations?.nodes) return {};
    const options: Record<string, string[]> = {};
    product.variations.nodes.forEach((variation) => {
      // WordPress variations might have attributes in different format
      // Try to extract from variation name or attributes
      if (variation.attributes?.nodes) {
        variation.attributes.nodes.forEach((attr) => {
          if (!options[attr.name]) {
            options[attr.name] = [];
          }
          if (!options[attr.name].includes(attr.value)) {
            options[attr.name].push(attr.value);
          }
        });
      } else if (variation.name) {
        // Fallback: try to parse variation name for attributes
        // This is a simple fallback - adjust based on your actual data structure
        const parts = variation.name.split(' - ');
        if (parts.length > 1) {
          const attrName = 'Variant';
          if (!options[attrName]) {
            options[attrName] = [];
          }
          if (!options[attrName].includes(parts[1] || parts[0])) {
            options[attrName].push(parts[1] || parts[0]);
          }
        }
      }
    });
    return options;
  }, [product.variations]);
  // Get selected attribute values
  const [selectedAttributes, setSelectedAttributes] = useState<Record<string, string>>({});
  // Auto-select first variation if only one exists
  useEffect(() => {
    if (product.variations?.nodes && product.variations.nodes.length === 1) {
      setSelectedVariation(product.variations.nodes[0].databaseId);
    }
  }, [product.variations]);
  // Find matching variation based on selected attributes
  useEffect(() => {
    if (!product.variations?.nodes || Object.keys(selectedAttributes).length === 0) {
      return;
    }
    const matchingVariation = product.variations.nodes.find((variation) => {
      const variationAttrs: Record<string, string> = {};
      variation.attributes?.nodes?.forEach((attr) => {
        variationAttrs[attr.name] = attr.value;
      });
      return Object.keys(selectedAttributes).every(
        (key) => variationAttrs[key] === selectedAttributes[key]
      );
    });
    if (matchingVariation) {
      setSelectedVariation(matchingVariation.databaseId);
    }
  }, [selectedAttributes, product.variations]);
  const updateAttribute = (attributeName: string, value: string) => {
    setSelectedAttributes((prev) => ({
      ...prev,
      [attributeName]: value,
    }));
  };
  const selectedVariationData = useMemo(() => {
    if (!selectedVariation || !product.variations?.nodes) return null;
    return product.variations.nodes.find((v) => v.databaseId === selectedVariation);
  }, [selectedVariation, product.variations]);
  const inStock = useMemo(() => {
    if (!product.variations) {
      // For simple products, check stockStatus first (most reliable)
      // GraphQL returns 'instock', 'outofstock', or 'onbackorder' (lowercase)
      // Also check purchasable flag if available
      if (product.stockStatus) {
        const isInStock = product.stockStatus === 'instock' || product.stockStatus === 'IN_STOCK';
        return isInStock && (product.purchasable !== false);
      }
      // Fallback to stockQuantity if stockStatus is not available
      // If stock management is disabled, stockQuantity may be null but product is still purchasable
      return (product.purchasable !== false) && 
             (product.stockQuantity === null || product.stockQuantity === undefined || product.stockQuantity > 0);
    }
    if (!selectedVariationData) return false;
    // For variations, check stockStatus and purchasable
    const isInStock = selectedVariationData.stockStatus === 'instock' || 
                      selectedVariationData.stockStatus === 'IN_STOCK';
    return isInStock && selectedVariationData.purchasable;
  }, [product, selectedVariationData]);
  const hasVariations = product.variations && product.variations.nodes && product.variations.nodes.length > 0;
  const variationsNodes = product.variations?.nodes;
  const hasMultipleVariations = hasVariations && variationsNodes && variationsNodes.length > 1;
  return (
    <div className="flex flex-col gap-y-6">
      {/* Variation Options */}
      {hasMultipleVariations && (
        <div className="flex flex-col gap-y-4">
          {Object.entries(attributeOptions).map(([attributeName, values]) => (
            <OptionSelect
              key={attributeName}
              title={attributeName}
              options={values}
              current={selectedAttributes[attributeName]}
              updateOption={(value) => updateAttribute(attributeName, value)}
              disabled={isAdding}
            />
          ))}
        </div>
      )}
      {/* Price */}
      <ProductPrice product={product} selectedVariation={selectedVariation} />
      {/* Add to Cart Button */}
      <AddToCart
        product={product}
        variationId={selectedVariation}
        fullWidth={true}
        inStock={inStock}
        hasVariations={hasVariations}
        selectedVariation={selectedVariationData}
      />
      {/* Product Tabs */}
      <ProductTabs product={product} />
    </div>
  );
}
````

## File: src/components/Product/ProductCard.component.tsx
````typescript
import Link from 'next/link';
import Image from 'next/image';
import { useState } from 'react';
import { paddedPrice } from '@/utils/functions/functions';
interface ProductCardProps {
  databaseId: number;
  name: string;
  price: string | null | undefined;
  regularPrice: string | null | undefined;
  salePrice?: string | null | undefined;
  onSale: boolean;
  slug: string;
  image?: {
    sourceUrl?: string;
  };
}
const ProductCard = ({
  databaseId,
  name,
  price,
  regularPrice,
  salePrice,
  onSale,
  slug,
  image,
}: ProductCardProps) => {
  const [imageError, setImageError] = useState(false);
  // Add padding/empty character after currency symbol
  // Handle null/undefined prices gracefully
  const formattedPrice = price ? paddedPrice(price, 'kr') : 'Price unavailable';
  const formattedRegularPrice = regularPrice ? paddedPrice(regularPrice, 'kr') : 'Price unavailable';
  const formattedSalePrice = salePrice ? paddedPrice(salePrice, 'kr') : undefined;
  const hasImage = image?.sourceUrl && !imageError;
  const isLocalhost = image?.sourceUrl?.includes('localhost') || image?.sourceUrl?.includes('127.0.0.1');
  return (
    <div className="group">
      <div className="aspect-[3/4] overflow-hidden bg-gray-100 relative rounded-lg">
        <Link href={`/product/${slug}`}>
          {hasImage ? (
            <Image
              src={image.sourceUrl!}
              alt={name}
              fill
              className="w-full h-full object-cover object-center transition duration-300 group-hover:scale-105 rounded-lg"
              priority={databaseId === 1}
              sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 25vw"
              onError={() => setImageError(true)}
              unoptimized={isLocalhost}
            />
          ) : (
            <div className="h-full w-full bg-gray-100 flex items-center justify-center rounded-lg">
              <span className="text-gray-400">No image</span>
            </div>
          )}
        </Link>
      </div>
      <Link href={`/product/${slug}`}>
        <div className="mt-4">
          <p className="text-xl font-bold text-center cursor-pointer hover:text-gray-600 transition-colors">
            {name}
          </p>
        </div>
      </Link>
      <div className="mt-2 text-center">
        {onSale ? (
          <div className="flex items-center justify-center gap-2">
            <span className="text-xl font-bold text-red-600">{formattedSalePrice}</span>
            <span className="text-lg text-gray-500 line-through">{formattedRegularPrice}</span>
          </div>
        ) : (
          <span className="text-lg text-gray-900">{formattedPrice}</span>
        )}
      </div>
    </div>
  );
};
export default ProductCard;
````

## File: src/components/Product/ProductDetailTabs.component.tsx
````typescript
"use client";
import { useState } from 'react';
import { cleanHtmlFromText } from '@/utils/functions/productUtils';
interface ProductDetailTabsProps {
  product: {
    description?: string;
    metaData?: Array<{
      key: string;
      value: string;
    }>;
    metadata?: {
      description?: string;
      reviews?: string;
    } | string;
  };
}
const ProductDetailTabs = ({ product }: ProductDetailTabsProps) => {
  const [activeTab, setActiveTab] = useState<'description' | 'reviews'>(
    'description'
  );
  // Transform metaData array from GraphQL to object format
  // GraphQL returns: [{ key: "description", value: "..." }, { key: "coa", value: "..." }]
  // Component expects: { description: "...", coa: "..." }
  let metadata: Record<string, any> = {};
  try {
    // First, try to get from metaData array (GraphQL format)
    if (product?.metaData && Array.isArray(product.metaData)) {
      product.metaData.forEach((item) => {
        if (item.key && item.value) {
          metadata[item.key] = item.value;
        }
      });
    }
    // Fallback to metadata object/string (legacy format)
    else if (product?.metadata) {
      if (typeof product.metadata === 'string') {
        try {
          metadata = JSON.parse(product.metadata);
        } catch {
          metadata = {};
        }
      } else if (
        typeof product.metadata === 'object' &&
        product.metadata !== null
      ) {
        metadata = product.metadata as Record<string, any>;
      }
    }
  } catch (error) {
    console.error('Error parsing product metadata:', error);
    metadata = {};
  }
  const description = cleanHtmlFromText(metadata?.description || product.description || '');
  const reviews = cleanHtmlFromText(metadata?.reviews || '');
  const tabs = [
    { id: 'description' as const, label: 'Description' },
    { id: 'reviews' as const, label: 'Reviews' },
  ];
  const getActiveContent = () => {
    switch (activeTab) {
      case 'description':
        return description;
      case 'reviews':
        return reviews || 'No reviews yet. Be the first to review this product!';
      default:
        return '';
    }
  };
  const activeContent = getActiveContent();
  return (
    <div className="w-full mt-8">
      {/* Tab Navigation */}
      <div className="border-b border-gray-200 mb-6">
        <nav className="flex space-x-8" aria-label="Product detail tabs">
          {tabs.map((tab) => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`
                py-4 px-1 border-b-2 font-medium text-sm transition-colors rounded-none
                ${
                  activeTab === tab.id
                    ? 'border-gray-900 text-gray-900'
                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                }
              `}
            >
              {tab.label}
            </button>
          ))}
        </nav>
      </div>
      {/* Tab Content */}
      <div className="prose prose-sm max-w-none">
        {activeContent ? (
          <div className="product-detail-content whitespace-pre-line">
            {activeContent}
          </div>
        ) : (
          <p className="text-gray-500">No content available.</p>
        )}
      </div>
    </div>
  );
};
export default ProductDetailTabs;
````

## File: src/components/Product/ProductDisclaimer.component.tsx
````typescript
const ProductDisclaimer = () => {
  return (
    <div className="w-full mt-12 pt-8 border-t border-gray-200">
      <div className="bg-gray-50 rounded-lg p-6 md:p-8">
        <h3 className="text-lg font-semibold text-gray-900 mb-4">
          Product Information Disclaimer
        </h3>
        <div className="text-sm text-gray-700 leading-relaxed space-y-4">
          <p>
            Product information, descriptions, and specifications are provided for informational
            purposes only. While we strive to ensure accuracy, we cannot guarantee that all
            information is complete, current, or error-free. Product images are for illustrative
            purposes and may not reflect the exact appearance of the product.
          </p>
          <p>
            Please refer to the actual product packaging and documentation for the most current
            information, usage instructions, and safety guidelines. We recommend consulting product
            documentation or contacting our support team if you have specific questions about
            product compatibility, usage, or safety.
          </p>
          <p>
            We reserve the right to correct any errors, inaccuracies, or omissions and to change
            or update information at any time without prior notice. This disclaimer applies to all product
            information provided on our website.
          </p>
        </div>
      </div>
    </div>
  );
};
export default ProductDisclaimer;
````

## File: src/components/Product/ProductFilters.component.tsx
````typescript
import { Dispatch, SetStateAction } from 'react';
import { Product, ProductType } from '@/types/product';
import Button from '@/components/UI/Button.component';
import Checkbox from '@/components/UI/Checkbox.component';
import RangeSlider from '@/components/UI/RangeSlider.component';
interface ProductFiltersProps {
  selectedSizes: string[];
  setSelectedSizes: Dispatch<SetStateAction<string[]>>;
  selectedColors: string[];
  setSelectedColors: Dispatch<SetStateAction<string[]>>;
  priceRange: [number, number];
  setPriceRange: Dispatch<SetStateAction<[number, number]>>;
  productTypes: ProductType[];
  toggleProductType: (id: string) => void;
  products: Product[];
  resetFilters: () => void;
}
const ProductFilters = ({
  selectedSizes,
  setSelectedSizes,
  selectedColors,
  setSelectedColors,
  priceRange,
  setPriceRange,
  productTypes,
  toggleProductType,
  products,
  resetFilters,
}: ProductFiltersProps) => {
  // Get unique sizes from all products
  const sizes = Array.from(
    new Set(
      products.flatMap(
        (product: Product) =>
          product.allPaSizes?.nodes.map(
            (node: { name: string }) => node.name,
          ) || [],
      ),
    ),
  ).sort((a, b) => a.localeCompare(b));
  // Get unique colors from all products
  const availableColors = products
    .flatMap((product: Product) => product.allPaColors?.nodes || [])
    .filter((color, index, self) => 
      index === self.findIndex((c) => c.slug === color.slug)
    )
    .sort((a, b) => a.name.localeCompare(b.name));
  const colors = availableColors.map((color) => ({
    name: color.name,
    class: `bg-${color.slug}-500`
  }));
  const toggleSize = (size: string) => {
    setSelectedSizes((prev) =>
      prev.includes(size) ? prev.filter((s) => s !== size) : [...prev, size],
    );
  };
  const toggleColor = (color: string) => {
    setSelectedColors((prev) =>
      prev.includes(color) ? prev.filter((c) => c !== color) : [...prev, color],
    );
  };
  return (
    <div className="w-full md:w-64 flex-shrink-0">
      <div className="bg-white px-8 pb-8 sm:px-6 sm:pb-6 rounded-lg shadow-sm">
        <div className="mb-8">
          <h3 className="font-semibold mb-4">PRODUCT TYPE</h3>
          <div className="space-y-2">
            {productTypes.map((type) => (
              <Checkbox
                key={type.id}
                id={type.id}
                label={type.name}
                checked={type.checked}
                onChange={() => toggleProductType(type.id)}
              />
            ))}
          </div>
        </div>
        <div className="mb-8">
          <h3 className="font-semibold mb-4">PRICE</h3>
          <RangeSlider
            id="price-range"
            label="Price"
            min={0}
            max={1000}
            value={priceRange[1]}
            startValue={priceRange[0]}
            onChange={(value) => setPriceRange([priceRange[0], value])}
            formatValue={(value) => `$${value}`}
          />
        </div>
        <div className="mb-8">
          <h3 className="font-semibold mb-4">SIZE</h3>
          <div className="grid grid-cols-3 gap-2">
            {sizes.map((size) => (
              <Button
                key={size}
                handleButtonClick={() => toggleSize(size)}
                variant="filter"
                selected={selectedSizes.includes(size)}
              >
                {size}
              </Button>
            ))}
          </div>
        </div>
        <div className="mb-8">
          <h3 className="font-semibold mb-4">COLOR</h3>
          <div className="grid grid-cols-3 gap-2">
            {colors.map((color) => (
              <button
                key={color.name}
                onClick={() => toggleColor(color.name)}
                className={`w-8 h-8 rounded-full flex items-center justify-center text-xs ${
                  color.class
                } ${
                  selectedColors.includes(color.name)
                    ? 'ring-2 ring-offset-2 ring-gray-900'
                    : ''
                }`}
                title={color.name}
              />
            ))}
          </div>
        </div>
        <Button
          handleButtonClick={resetFilters}
          variant="reset"
        >
          Reset Filters
        </Button>
      </div>
    </div>
  );
};
export default ProductFilters;
````

## File: src/components/Product/ProductInfo.component.tsx
````typescript
import Link from 'next/link';
import { cleanHtmlFromText } from '@/utils/functions/productUtils';
interface ProductInfoProps {
  product: {
    name: string;
    description?: string;
    productCategories?: {
      nodes?: Array<{
        name: string;
        slug: string;
      }>;
    };
  };
}
const ProductInfo = ({ product }: ProductInfoProps) => {
  const collection = product.productCategories?.nodes?.[0];
  const cleanDescription = cleanHtmlFromText(product.description);
  return (
    <div id="product-info">
      <div className="flex flex-col gap-y-4">
        {collection && (
          <Link
            href={`/category/${collection.slug}`}
            className="text-base text-gray-600 hover:text-gray-900 transition-colors"
          >
            {collection.name}
          </Link>
        )}
        <h2
          className="text-3xl leading-10 text-gray-900 font-chakra-petch"
          data-testid="product-title"
        >
          {product.name}
        </h2>
        {cleanDescription && (
          <p
            className="text-base text-gray-600 whitespace-pre-line"
            data-testid="product-description"
          >
            {cleanDescription}
          </p>
        )}
      </div>
    </div>
  );
};
export default ProductInfo;
````

## File: src/components/Product/ProductList.component.tsx
````typescript
import { Product } from '@/types/product';
import { useProductFilters } from '@/hooks/useProductFilters';
import ProductCard from './ProductCard.component';
import ProductFilters from './ProductFilters.component';
interface ProductListProps {
  products: Product[];
  title: string;
}
const ProductList = ({ products, title }: ProductListProps) => {
  const {
    sortBy,
    setSortBy,
    selectedSizes,
    setSelectedSizes,
    selectedColors,
    setSelectedColors,
    priceRange,
    setPriceRange,
    productTypes,
    toggleProductType,
    resetFilters,
    filterProducts
  } = useProductFilters(products);
  const filteredProducts = filterProducts(products);
  return (
    <div className="flex flex-col md:flex-row gap-8">
      <ProductFilters
        selectedSizes={selectedSizes}
        setSelectedSizes={setSelectedSizes}
        selectedColors={selectedColors}
        setSelectedColors={setSelectedColors}
        priceRange={priceRange}
        setPriceRange={setPriceRange}
        productTypes={productTypes}
        toggleProductType={toggleProductType}
        products={products}
        resetFilters={resetFilters}
      />
      {/* Main Content */}
      <div className="flex-1">
        <div className="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-8">
          <h1 className="text-xl sm:text-2xl font-medium text-center sm:text-left">
            {title} <span className="text-gray-500">({filteredProducts.length})</span>
          </h1>
          <div className="flex flex-wrap items-center justify-center sm:justify-end gap-2 sm:gap-4">
            <label htmlFor="sort-select" className="text-sm font-medium">Sort:</label>
            <select
              id="sort-select"
              value={sortBy}
              onChange={(e) => setSortBy(e.target.value)}
              className="min-w-[140px] border rounded-md px-3 py-1.5 text-sm"
            >
              <option value="popular">Popular</option>
              <option value="price-low">Price: Low to High</option>
              <option value="price-high">Price: High to Low</option>
              <option value="newest">Newest</option>
            </select>
          </div>
        </div>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {filteredProducts.map((product: Product) => (
            <ProductCard
              key={product.databaseId}
              databaseId={product.databaseId}
              name={product.name}
              price={product.price}
              regularPrice={product.regularPrice}
              salePrice={product.salePrice}
              onSale={product.onSale}
              slug={product.slug}
              image={product.image}
            />
          ))}
        </div>
      </div>
    </div>
  );
};
export default ProductList;
````

## File: src/components/Product/ProductPrice.component.tsx
````typescript
import { filteredVariantPrice, paddedPrice } from '@/utils/functions/functions';
interface ProductPriceProps {
  product: {
    price: string;
    regularPrice: string;
    salePrice?: string;
    onSale: boolean;
    variations?: {
      nodes?: Array<{
        databaseId: number;
        price: string;
        regularPrice: string;
        salePrice?: string;
        onSale: boolean;
      }>;
    };
  };
  selectedVariation?: number;
}
const ProductPrice = ({ product, selectedVariation }: ProductPriceProps) => {
  // Get the price based on whether we have a selected variation
  let displayPrice = product.price;
  let displayRegularPrice = product.regularPrice;
  let displaySalePrice = product.salePrice;
  let isOnSale = product.onSale;
  // If we have a selected variation, use its price
  if (selectedVariation && product.variations?.nodes) {
    const variation = product.variations.nodes.find(
      (v) => v.databaseId === selectedVariation
    );
    if (variation) {
      // Use salePrice if on sale, otherwise use price, fallback to regularPrice
      displayPrice = variation.onSale && variation.salePrice
        ? variation.salePrice
        : (variation.price || variation.regularPrice);
      displayRegularPrice = variation.regularPrice;
      displaySalePrice = variation.salePrice;
      isOnSale = variation.onSale;
    }
  } else {
    // For products without selected variation, determine display price
    // If on sale and salePrice exists, use salePrice, otherwise use price or regularPrice
    if (isOnSale && displaySalePrice) {
      displayPrice = displaySalePrice;
    } else {
      displayPrice = displayPrice || displayRegularPrice;
    }
  }
  // Format prices - ensure we have valid price strings
  const formattedPrice = displayPrice ? paddedPrice(displayPrice, 'kr') : '';
  const formattedRegularPrice = displayRegularPrice
    ? paddedPrice(displayRegularPrice, 'kr')
    : '';
  const formattedSalePrice = displaySalePrice
    ? paddedPrice(displaySalePrice, 'kr')
    : '';
  // Calculate percentage discount if on sale
  const percentageDiff =
    isOnSale && displayRegularPrice && displaySalePrice
      ? Math.round(
          ((parseFloat(displayRegularPrice) - parseFloat(displaySalePrice)) /
            parseFloat(displayRegularPrice)) *
            100
        )
      : null;
  // Determine what price to display - displayPrice is already set correctly above
  // Use formattedPrice (which is based on displayPrice) or fallback to regularPrice
  const priceToDisplay = formattedPrice || formattedRegularPrice;
  // Don't render if no price is available
  if (!priceToDisplay) {
    return null;
  }
  return (
    <div className="flex flex-col text-gray-900">
      <span
        className={`text-2xl font-semibold ${
          isOnSale ? 'text-red-600' : 'text-gray-900'
        }`}
        data-testid="product-price"
      >
        {product.variations && !selectedVariation && 'From '}
        {product.variations && selectedVariation
          ? filteredVariantPrice(priceToDisplay, '')
          : priceToDisplay}
      </span>
      {isOnSale && formattedRegularPrice && (
        <>
          <p className="mt-1">
            <span className="text-gray-600 text-base">Original: </span>
            <span
              className="line-through text-gray-500"
              data-testid="original-product-price"
            >
              {product.variations && selectedVariation
                ? filteredVariantPrice(formattedRegularPrice, 'right')
                : formattedRegularPrice}
            </span>
          </p>
          {percentageDiff && (
            <span className="text-red-600 text-sm mt-1">
              -{percentageDiff}%
            </span>
          )}
        </>
      )}
    </div>
  );
};
export default ProductPrice;
````

## File: src/components/Product/ProductTabs.component.tsx
````typescript
"use client";
import { useState } from 'react';
import { Plus } from 'lucide-react';
interface ProductTabsProps {
  product: {
    material?: string;
    origin_country?: string;
    type?: string;
    weight?: string;
    length?: string;
    width?: string;
    height?: string;
    [key: string]: unknown; // Allow additional properties
  };
}
const ProductTabs = ({ product }: ProductTabsProps) => {
  const [openTabs, setOpenTabs] = useState<string[]>(['Product Information']);
  const toggleTab = (tabLabel: string) => {
    setOpenTabs((prev) =>
      prev.includes(tabLabel)
        ? prev.filter((t) => t !== tabLabel)
        : [...prev, tabLabel]
    );
  };
  return (
    <div className="w-full">
      <div className="border-t border-gray-200">
        {/* Product Information Tab */}
        <div className="border-b border-gray-200">
          <button
            onClick={() => toggleTab('Product Information')}
            className={`w-full flex justify-between py-4 text-left ${
              openTabs.includes('Product Information') ? 'items-start' : 'items-center'
            }`}
            aria-expanded={openTabs.includes('Product Information')}
          >
            <span className="text-base font-medium text-gray-900">
              Product Information
            </span>
            <span
              className={`flex-shrink-0 w-6 h-6 rounded-full border-2 border-gray-900 flex items-center justify-center transition-all duration-200 ${
                openTabs.includes('Product Information')
                  ? 'rotate-45 bg-gray-900 text-white'
                  : 'bg-transparent text-gray-900'
              } hover:bg-gray-900 hover:text-white`}
            >
              <Plus className="w-3 h-3" />
            </span>
          </button>
          <div
            className={`overflow-hidden transition-all duration-300 ease-in-out ${
              openTabs.includes('Product Information')
                ? 'max-h-[1000px] opacity-100 pb-6'
                : 'max-h-0 opacity-0 pb-0'
            }`}
          >
            <div className="text-sm text-gray-700 py-4">
              <div className="grid grid-cols-2 gap-x-8 gap-y-4">
                <div className="flex flex-col gap-y-4">
                  <div>
                    <span className="font-semibold">Material</span>
                    <p className="mt-1">{product.material || '-'}</p>
                  </div>
                  <div>
                    <span className="font-semibold">Country of origin</span>
                    <p className="mt-1">{product.origin_country || '-'}</p>
                  </div>
                  <div>
                    <span className="font-semibold">Type</span>
                    <p className="mt-1">{product.type || '-'}</p>
                  </div>
                </div>
                <div className="flex flex-col gap-y-4">
                  <div>
                    <span className="font-semibold">Weight</span>
                    <p className="mt-1">{product.weight ? `${product.weight} g` : '-'}</p>
                  </div>
                  <div>
                    <span className="font-semibold">Dimensions</span>
                    <p className="mt-1">
                      {product.length && product.width && product.height
                        ? `${product.length}L x ${product.width}W x ${product.height}H`
                        : '-'}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        {/* Shipping & Returns Tab */}
        <div>
          <button
            onClick={() => toggleTab('Shipping & Returns')}
            className={`w-full flex justify-between py-4 text-left ${
              openTabs.includes('Shipping & Returns') ? 'items-start' : 'items-center'
            }`}
            aria-expanded={openTabs.includes('Shipping & Returns')}
          >
            <span className="text-base font-medium text-gray-900">
              Shipping & Returns
            </span>
            <span
              className={`flex-shrink-0 w-6 h-6 rounded-full border-2 border-gray-900 flex items-center justify-center transition-all duration-200 ${
                openTabs.includes('Shipping & Returns')
                  ? 'rotate-45 bg-gray-900 text-white'
                  : 'bg-transparent text-gray-900'
              } hover:bg-gray-900 hover:text-white`}
            >
              <Plus className="w-3 h-3" />
            </span>
          </button>
          <div
            className={`overflow-hidden transition-all duration-300 ease-in-out ${
              openTabs.includes('Shipping & Returns')
                ? 'max-h-[1000px] opacity-100 pb-6'
                : 'max-h-0 opacity-0 pb-0'
            }`}
          >
            <div className="text-sm text-gray-700 py-4">
              <div className="grid grid-cols-1 gap-y-8">
                <div className="flex items-start gap-x-2">
                  <svg
                    className="w-5 h-5 text-gray-900 mt-0.5 flex-shrink-0"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M13 10V3L4 14h7v7l9-11h-7z"
                    />
                  </svg>
                  <div>
                    <span className="font-semibold block mb-1">Fast delivery</span>
                    <p className="max-w-sm text-gray-600">
                      Your package will arrive in 3-5 business days at your pick up
                      location or in the comfort of your home.
                    </p>
                  </div>
                </div>
                <div className="flex items-start gap-x-2">
                  <svg
                    className="w-5 h-5 text-gray-900 mt-0.5 flex-shrink-0"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                    />
                  </svg>
                  <div>
                    <span className="font-semibold block mb-1">Simple exchanges</span>
                    <p className="max-w-sm text-gray-600">
                      Is the fit not quite right? No worries - we&apos;ll exchange your
                      product for a new one.
                    </p>
                  </div>
                </div>
                <div className="flex items-start gap-x-2">
                  <svg
                    className="w-5 h-5 text-gray-900 mt-0.5 flex-shrink-0"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M10 19l-7-7m0 0l7-7m-7 7h18"
                    />
                  </svg>
                  <div>
                    <span className="font-semibold block mb-1">Easy returns</span>
                    <p className="max-w-sm text-gray-600">
                      Just return your product and we&apos;ll refund your money. No
                      questions asked  we&apos;ll do our best to make sure your return
                      is hassle-free.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};
export default ProductTabs;
````

## File: src/components/Product/SingleProduct.component.tsx
````typescript
"use client";
import { useState, useEffect } from 'react';
import Image from 'next/image';
import ImageGallery from './ImageGallery.component';
import ProductInfo from './ProductInfo.component';
import ProductActions from './ProductActions.component';
import ProductDetailTabs from './ProductDetailTabs.component';
import ProductDisclaimer from './ProductDisclaimer.component';
import LoadingSpinner from '@/components/LoadingSpinner/LoadingSpinner.component';
import { IProductRootObject } from './AddToCart.component';
const SingleProduct = ({ product }: IProductRootObject) => {
  const [isLoading, setIsLoading] = useState<boolean>(true);
  useEffect(() => {
    setIsLoading(false);
  }, [product]);
  // Prepare images array for ImageGallery
  // Handle both null image and missing sourceUrl
  const images = (() => {
    // Check if image exists and has sourceUrl
    if (product.image?.sourceUrl) {
      return [
        {
          id: product.image.id || product.databaseId?.toString() || '1',
          sourceUrl: product.image.sourceUrl,
          altText: product.image.title || product.name || 'Product image',
        },
      ];
    }
    // Log in development only
    if (process.env.NODE_ENV === 'development') {
      console.warn('Product image missing for product:', {
        name: product.name,
        databaseId: product.databaseId,
        image: product.image,
      });
    }
    return [];
  })();
  if (isLoading) {
    return (
      <div className="h-56 mt-20">
        <p className="text-xl font-bold text-center">Loading product...</p>
        <br />
        <LoadingSpinner />
      </div>
    );
  }
  return (
    <>
      <div
        className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row md:items-start py-6 relative gap-6 md:gap-8"
        data-testid="product-container"
      >
        {/* Image Gallery */}
        <div className="block w-full md:flex-1 relative">
          <ImageGallery images={images} />
        </div>
        {/* Product Info and Actions */}
        <div className="flex flex-col md:sticky md:top-48 md:py-0 max-w-[600px] w-full py-8 gap-y-6">
          {/* Product Info (Title & Description) - Above Price */}
          <ProductInfo product={product} />
          {/* Product Actions (Price, Options, Add to Cart, Tabs) */}
          <ProductActions product={product} />
        </div>
      </div>
      {/* Product Detail Tabs */}
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 my-16">
        <ProductDetailTabs product={product} />
      </div>
    </>
  );
};
export default SingleProduct;
````

## File: src/components/Research/ResearchPostCard.component.tsx
````typescript
'use client';
import { useState } from 'react';
import Image from 'next/image';
import Link from 'next/link';
interface ResearchPostCardProps {
  post: {
    id: string;
    slug: string;
    title: string;
    excerpt: string;
    author?: {
      node: {
        name: string;
      };
    };
    featuredImage?: {
      node: {
        sourceUrl: string;
        altText: string;
      } | null;
    } | null;
  };
}
const ResearchPostCard = ({ post }: ResearchPostCardProps) => {
  const [imageError, setImageError] = useState(false);
  // Strip HTML from excerpt
  const cleanExcerpt = post.excerpt
    ? post.excerpt.replace(/<[^>]*>/g, '').trim()
    : '';
  const imageUrl = post.featuredImage?.node?.sourceUrl;
  const hasImage = imageUrl && !imageError;
  const isLocalhost =
    imageUrl?.includes('localhost') || imageUrl?.includes('127.0.0.1');
  return (
    <Link href={`/articles/${post.slug}`}>
      <article className="bg-white rounded-2xl overflow-hidden border border-gray-200 hover:border-gray-900 transition-colors cursor-pointer h-full flex flex-col">
        <div className="aspect-square overflow-hidden relative bg-gray-200">
          {hasImage ? (
            <Image
              src={imageUrl}
              alt={post.featuredImage?.node?.altText || post.title}
              fill
              className="object-cover"
              sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
              onError={() => setImageError(true)}
              unoptimized={isLocalhost}
            />
          ) : (
            <div className="absolute inset-0 flex items-center justify-center">
              <svg
                id="Isolation_Mode"
                data-name="Isolation Mode"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 42.05 48.55"
                className="w-16 h-16"
              >
                <defs>
                  <style>
                    {`.cls-1 { fill: #d1d5db; } .cls-2 { fill: #e5e7eb; }`}
                  </style>
                </defs>
                <polygon
                  className="cls-1"
                  points="42.05 36.41 42.05 12.14 21.02 0 0 12.14 0 36.41 21.02 48.55 42.05 36.41"
                />
                <polygon
                  className="cls-2"
                  points="21.41 43.23 20.63 41.89 36.47 32.75 37.25 34.09 21.41 43.23"
                />
                <rect
                  className="cls-2"
                  x="4.41"
                  y="15.13"
                  width="1.55"
                  height="18.29"
                />
                <polygon
                  className="cls-2"
                  points="36.47 15.8 20.63 6.66 21.41 5.32 37.25 14.46 36.47 15.8"
                />
              </svg>
            </div>
          )}
        </div>
        <div className="p-6 flex-1 flex flex-col">
          <h3 className="text-lg font-semibold text-gray-900 mb-3 leading-tight">
            {post.title}
          </h3>
          {cleanExcerpt && (
            <p className="text-sm text-gray-600 leading-relaxed flex-1">
              {cleanExcerpt}
            </p>
          )}
        </div>
      </article>
    </Link>
  );
};
export default ResearchPostCard;
````

## File: src/components/SVG/SVGMobileSearchIcon.component.tsx
````typescript
/**
 * The SVG that we use for search in the navbar for mobile.
 * Also includes logic for closing and opening the search form.
 */
const SVGMobileSearchIcon = () => {
  const scrollToTop = () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth',
    });
  };
  return (
    <div className="inline mb-0.5 mr-2 md:hidden xl:hidden">
      <svg
        className="cursor-pointer"
        onClick={scrollToTop}
        fill="#fff"
        xmlns="https://www.w3.org/2000/svg"
        viewBox="0 0 50 50"
        width="35px"
        height="35px"
      >
        <path d="M 21 3 C 11.601563 3 4 10.601563 4 20 C 4 29.398438 11.601563 37 21 37 C 24.355469 37 27.460938 36.015625 30.09375 34.34375 L 42.375 46.625 L 46.625 42.375 L 34.5 30.28125 C 36.679688 27.421875 38 23.878906 38 20 C 38 10.601563 30.398438 3 21 3 Z M 21 7 C 28.199219 7 34 12.800781 34 20 C 34 27.199219 28.199219 33 21 33 C 13.800781 33 8 27.199219 8 20 C 8 12.800781 13.800781 7 21 7 Z" />
      </svg>
    </div>
  );
};
export default SVGMobileSearchIcon;
````

## File: src/components/UI/icons/AccountIcon.component.tsx
````typescript
import React from "react";
const AccountIcon: React.FC<React.SVGProps<SVGSVGElement>> = (props) => {
  return (
    <svg
      role="presentation"
      strokeWidth="2"
      focusable="false"
      width="22"
      height="22"
      className="icon icon-account"
      viewBox="0 0 22 22"
      {...props}
    >
      <circle cx="11" cy="7" r="4" fill="none" stroke="currentColor" />
      <path
        d="M3.5 19c1.421-2.974 4.247-5 7.5-5s6.079 2.026 7.5 5"
        fill="none"
        stroke="currentColor"
        strokeLinecap="round"
      />
    </svg>
  );
};
export default AccountIcon;
````

## File: src/components/UI/icons/CartIcon.component.tsx
````typescript
import React from "react";
const CartIcon: React.FC<React.SVGProps<SVGSVGElement>> = (props) => {
  return (
    <svg
      role="presentation"
      strokeWidth="2"
      focusable="false"
      width="22"
      height="22"
      className="icon icon-cart"
      viewBox="0 0 22 22"
      {...props}
    >
      <path
        d="M11 7H3.577A2 2 0 0 0 1.64 9.497l2.051 8A2 2 0 0 0 5.63 19H16.37a2 2 0 0 0 1.937-1.503l2.052-8A2 2 0 0 0 18.422 7H11Zm0 0V1"
        fill="none"
        stroke="currentColor"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
    </svg>
  );
};
export default CartIcon;
````

## File: src/components/UI/icons/PlusIcon.component.tsx
````typescript
import React from "react";
const PlusIcon: React.FC<React.SVGProps<SVGSVGElement>> = (props) => {
  return (
    <svg
      role="presentation"
      focusable="false"
      strokeWidth="2"
      width="12"
      height="12"
      className="icon icon-plus"
      viewBox="0 0 12 12"
      {...props}
    >
      <path
        d="M6 0V12"
        fill="none"
        stroke="currentColor"
      />
      <path
        d="M0 6L12 6"
        fill="none"
        stroke="currentColor"
      />
    </svg>
  );
};
export default PlusIcon;
````

## File: src/components/UI/icons/SearchIcon.component.tsx
````typescript
import React from "react";
const SearchIcon: React.FC<React.SVGProps<SVGSVGElement>> = (props) => {
  return (
    <svg
      role="presentation"
      strokeWidth="2"
      focusable="false"
      width="22"
      height="22"
      className="icon icon-search"
      viewBox="0 0 22 22"
      {...props}
    >
      <circle cx="11" cy="10" r="7" fill="none" stroke="currentColor" />
      <path
        d="m16 15 3 3"
        stroke="currentColor"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
    </svg>
  );
};
export default SearchIcon;
````

## File: src/components/UI/icons/StarIcon.component.tsx
````typescript
import React from "react";
const StarIcon: React.FC<React.SVGProps<SVGSVGElement>> = (props) => {
  return (
    <svg
      viewBox="0 0 24 24"
      fill="currentColor"
      className="w-5 h-5 text-black"
      {...props}
    >
      <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
    </svg>
  );
};
export default StarIcon;
````

## File: src/components/UI/Button.component.tsx
````typescript
import { ReactNode } from 'react';
import Link from 'next/link';
type TButtonVariant = 'primary' | 'secondary' | 'hero' | 'filter' | 'reset' | 'danger';
interface IButtonProps {
  handleButtonClick?: () => void;
  buttonDisabled?: boolean;
  variant?: TButtonVariant;
  children?: ReactNode;
  fullWidth?: boolean;
  href?: string;
  title?: string;
  selected?: boolean;
  type?: 'button' | 'submit' | 'reset';
}
/**
 * Renders a clickable button
 * @function Button
 * @param {void} handleButtonClick - Handle button click
 * @param {boolean?} buttonDisabled - Is button disabled?
 * @param {TButtonVariant?} variant - Button variant
 * @param {ReactNode} children - Children for button
 * @param {boolean?} fullWidth - Whether the button should be full-width on mobile
 * @param {boolean?} selected - Whether the button is in a selected state
 * @returns {JSX.Element} - Rendered component
 */
const Button = ({
  handleButtonClick,
  buttonDisabled,
  variant = 'primary',
  children,
  fullWidth = false,
  href,
  title,
  selected = false,
  type = 'button',
}: IButtonProps) => {
  const getVariantClasses = (variant: TButtonVariant = 'primary') => {
    switch (variant) {
      case 'hero':
        return 'inline-block px-8 py-4 text-lg font-semibold bg-black text-white rounded-full hover:bg-gray-800 transition-colors';
      case 'filter':
        return selected 
          ? 'px-3 py-1 border rounded-full bg-gray-900 text-white'
          : 'px-3 py-1 border rounded-full hover:bg-gray-100 bg-white text-gray-900';
      case 'reset':
        return 'w-full mt-8 py-2 px-4 bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200 transition-colors';
      case 'secondary':
        return 'px-2 lg:px-4 py-2 font-semibold border-2 border-gray-900 rounded-full bg-white text-gray-900 hover:bg-gray-50 transition-colors';
      case 'danger':
        return 'px-2 lg:px-4 py-2 font-semibold border border-red-500 border-solid rounded-full text-white bg-red-500 hover:bg-red-600 transition-colors';
      default: // primary - matches Medusa product page button style
        return 'w-full h-10 px-4 py-2 font-semibold rounded-full bg-black text-white hover:bg-gray-800 transition-colors';
    }
  };
  const classes = `${getVariantClasses(variant)} ease-in-out transition-all duration-300 disabled:opacity-50 ${
    fullWidth ? 'w-full md:w-auto' : ''
  }`;
  if (href) {
    return (
      <Link href={href} className={classes}>
        {children}
      </Link>
    );
  }
  return (
    <button
      type={type}
      onClick={handleButtonClick}
      disabled={buttonDisabled}
      className={classes}
      title={title}
    >
      {children}
    </button>
  );
};
export default Button;
````

## File: src/components/UI/Checkbox.component.tsx
````typescript
import { ChangeEvent } from 'react';
interface ICheckboxProps {
  id: string;
  label: string;
  checked: boolean;
  onChange: (e: ChangeEvent<HTMLInputElement>) => void;
}
/**
 * A reusable checkbox component with a label
 * @function Checkbox
 * @param {string} id - Unique identifier for the checkbox
 * @param {string} label - Label text to display next to the checkbox
 * @param {boolean} checked - Whether the checkbox is checked
 * @param {function} onChange - Handler for when the checkbox state changes
 * @returns {JSX.Element} - Rendered component
 */
const Checkbox = ({ id, label, checked, onChange }: ICheckboxProps) => {
  return (
    <label htmlFor={id} className="flex items-center py-2 cursor-pointer">
      <input
        id={id}
        type="checkbox"
        className="form-checkbox h-5 w-5 cursor-pointer"
        checked={checked}
        onChange={onChange}
      />
      <span className="ml-3 text-base">{label}</span>
    </label>
  );
};
export default Checkbox;
````

## File: src/components/UI/ChevronDown.component.tsx
````typescript
import React from 'react';
interface ChevronDownProps {
  size?: string;
  color?: string;
  className?: string;
}
const ChevronDown: React.FC<ChevronDownProps> = ({
  size = "16",
  color = "currentColor",
  className = "",
  ...attributes
}) => {
  return (
    <svg
      width={size}
      height={size}
      viewBox="0 0 16 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={className}
      {...attributes}
    >
      <path
        d="M4 6L8 10L12 6"
        stroke={color}
        strokeWidth="1.5"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
    </svg>
  );
};
export default ChevronDown;
````

## File: src/components/UI/FAQ.component.tsx
````typescript
"use client";
import { useState } from "react";
import { Plus } from "lucide-react";
type FAQItem = {
  question: string;
  answer: React.ReactNode;
};
type FAQProps = {
  faqs: FAQItem[];
  title?: string;
  className?: string;
};
export default function FAQ({ faqs, title, className = "" }: FAQProps) {
  const [openIndex, setOpenIndex] = useState<number | null>(null);
  const toggleItem = (index: number) => {
    setOpenIndex(openIndex === index ? null : index);
  };
  return (
    <section className={`w-full ${className}`}>
      {title && (
        <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mb-6">
          {title}
        </h2>
      )}
      <div className="accordion-box rounded-lg bg-white p-6 border border-gray-200">
        {faqs.map((faq, index) => {
          const isOpen = openIndex === index;
          return (
            <div
              key={index}
              className="accordion group border-b border-gray-200 last:border-b-0"
            >
              <button
                onClick={() => toggleItem(index)}
                className={`accordion__toggle w-full flex gap-4 py-6 font-semibold text-xl hover:text-gray-700 transition-colors text-left ${
                  isOpen ? "items-start" : "items-center"
                }`}
                aria-expanded={isOpen}
              >
                <span
                  className={`circle-plus flex-shrink-0 w-8 h-8 rounded-full border-2 border-gray-900 flex items-center justify-center transition-all duration-200 ${
                    isOpen ? "rotate-45 bg-gray-900 text-white" : "bg-transparent text-gray-900"
                  } hover:bg-gray-900 hover:text-white`}
                >
                  <Plus className="w-3 h-3" />
                </span>
                <h4 className="flex-1">{faq.question}</h4>
              </button>
              <div
                className={`accordion__content overflow-hidden transition-all duration-300 ease-in-out ${
                  isOpen ? "max-h-[1000px] opacity-100 pb-6" : "max-h-0 opacity-0 pb-0"
                }`}
              >
                <div className="prose pl-12">
                  <div className="text-base leading-relaxed text-gray-700">
                    {faq.answer}
                  </div>
                </div>
              </div>
            </div>
          );
        })}
      </div>
    </section>
  );
}
````

## File: src/components/UI/Logo.component.tsx
````typescript
import React from "react";
type LogoProps = {
  className?: string;
};
const Logo: React.FC<LogoProps> = ({ className = "" }) => {
  return (
    <svg
      id="Layer_2"
      data-name="Layer 2"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 99.11 26.45"
      className={className}
      aria-label="Store"
    >
      <defs>
        <style>{`.cls-1 { fill: #231f20; }`}</style>
      </defs>
      <path
        className="cls-1"
        d="M27.6,26.38c-1.81,0-3.58-.71-4.91-2.04l-14.55-14.55c-.05-.05-.14-.01-.14.06v16.3s-.04.08-.08.08H.08S0,26.2,0,26.16V7.48C0,4.82,1.34,2.24,3.69,1,6.43-.45,9.72.07,11.88,2.22l14.55,14.55c.05.05.14.01.14-.06V.08s.04-.08.08-.08h7.84s.08.04.08.08v19.07c0,2.62-1.32,5.14-3.63,6.38-1.06.57-2.21.85-3.34.85Z"
      />
      <path
        className="cls-1"
        d="M87.89.09l-16.42,16.42c-.05.05-.14.01-.14-.06V7.54c0-2.66-1.34-5.24-3.7-6.48-2.74-1.45-6.03-.92-8.18,1.23l-14.55,14.55c-.05.05-.14.01-.14-.06V.15s-.04-.08-.08-.08h-7.84s-.08.04-.08.08v19.07c0,2.62,1.32,5.14,3.63,6.38,1.06.57,2.21.85,3.34.85,1.81,0,3.58-.71,4.91-2.04l14.55-14.55c.05-.05.14-.01.14.06v8.91c0,2.66,1.35,5.24,3.71,6.48,2.74,1.44,6.03.92,8.17-1.23L99.09.21c.05-.05.01-.14-.06-.14h-11.08s-.04,0-.06.02Z"
      />
    </svg>
  );
};
export default Logo;
````

## File: src/components/UI/RangeSlider.component.tsx
````typescript
import { ChangeEvent } from 'react';
interface IRangeSliderProps {
  id: string;
  label: string;
  min: number;
  max: number;
  value: number;
  onChange: (value: number) => void;
  startValue?: number;
  formatValue?: (value: number) => string;
}
/**
 * A reusable range slider component with labels
 * @function RangeSlider
 * @param {string} id - Unique identifier for the slider
 * @param {string} label - Accessible label for the slider
 * @param {number} min - Minimum value of the range
 * @param {number} max - Maximum value of the range
 * @param {number} value - Current value of the slider
 * @param {function} onChange - Handler for when the slider value changes
 * @param {number} startValue - Optional starting value to display (defaults to min)
 * @param {function} formatValue - Optional function to format the displayed values
 * @returns {JSX.Element} - Rendered component
 */
const RangeSlider = ({
  id,
  label,
  min,
  max,
  value,
  onChange,
  startValue = min,
  formatValue = (val: number) => val.toString(),
}: IRangeSliderProps) => {
  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {
    onChange(parseInt(e.target.value));
  };
  return (
    <div>
      <label htmlFor={id} className="sr-only">
        {label}
      </label>
      <input
        id={id}
        type="range"
        min={min}
        max={max}
        value={value}
        onChange={handleChange}
        className="w-full cursor-pointer"
      />
      <div className="flex justify-between mt-2">
        <span>{formatValue(startValue)}</span>
        <span>{formatValue(value)}</span>
      </div>
    </div>
  );
};
export default RangeSlider;
````

## File: src/components/User/AccountAddresses.component.tsx
````typescript
import { useQuery, useMutation } from '@apollo/client';
import { useState, useEffect } from 'react';
import { getApolloAuthClient } from '@faustwp/core';
import { GET_CURRENT_USER } from '@/utils/gql/GQL_QUERIES';
import { UPDATE_CUSTOMER } from '@/utils/gql/GQL_MUTATIONS';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
interface AddressFormData {
  firstName: string;
  lastName: string;
  address1: string;
  address2: string;
  city: string;
  postcode: string;
  country: string;
  state: string;
  email?: string;
  phone?: string;
}
const AccountAddresses = () => {
  const authClient = getApolloAuthClient(); // Get authenticated client
  const { data, loading, error, refetch } = useQuery(GET_CURRENT_USER, {
    client: authClient, // Use authenticated client
    fetchPolicy: 'network-only',
    errorPolicy: 'all',
  });
  const [updateCustomer, { loading: updating }] = useMutation(UPDATE_CUSTOMER, {
    client: authClient, // Use authenticated client
  });
  const [editingAddress, setEditingAddress] = useState<'billing' | 'shipping' | null>(null);
  const [billingForm, setBillingForm] = useState<AddressFormData>({
    firstName: '',
    lastName: '',
    address1: '',
    address2: '',
    city: '',
    postcode: '',
    country: '',
    state: '',
    email: '',
    phone: '',
  });
  const [shippingForm, setShippingForm] = useState<AddressFormData>({
    firstName: '',
    lastName: '',
    address1: '',
    address2: '',
    city: '',
    postcode: '',
    country: '',
    state: '',
  });
  const [updateMessage, setUpdateMessage] = useState<string | null>(null);
  const [updateError, setUpdateError] = useState<string | null>(null);
  const customer = data?.customer;
  // Initialize forms when customer data loads (using useEffect to avoid render issues)
  useEffect(() => {
    if (customer && billingForm.firstName === '' && customer.billing) {
      setBillingForm({
        firstName: customer.billing.firstName || customer.firstName || '',
        lastName: customer.billing.lastName || customer.lastName || '',
        address1: customer.billing.address1 || '',
        address2: customer.billing.address2 || '',
        city: customer.billing.city || '',
        postcode: customer.billing.postcode || '',
        country: customer.billing.country || '',
        state: customer.billing.state || '',
        email: customer.billing.email || customer.email || '',
        phone: customer.billing.phone || '',
      });
    }
  }, [customer]);
  useEffect(() => {
    if (customer && shippingForm.firstName === '' && customer.shipping) {
      setShippingForm({
        firstName: customer.shipping.firstName || customer.firstName || '',
        lastName: customer.shipping.lastName || customer.lastName || '',
        address1: customer.shipping.address1 || '',
        address2: customer.shipping.address2 || '',
        city: customer.shipping.city || '',
        postcode: customer.shipping.postcode || '',
        country: customer.shipping.country || '',
        state: customer.shipping.state || '',
      });
    }
  }, [customer]);
  if (loading) {
    return <LoadingSpinner />;
  }
  if (error || !customer) {
    return (
      <div className="woocommerce-MyAccount-content">
        <p className="text-red-600">Error loading addresses. Please try again later.</p>
      </div>
    );
  }
  const handleAddressSubmit = async (type: 'billing' | 'shipping') => {
    setUpdateMessage(null);
    setUpdateError(null);
    try {
      const input: any = {};
      if (type === 'billing') {
        input.billing = billingForm;
      } else {
        input.shipping = shippingForm;
      }
      const { data: updateData } = await updateCustomer({
        variables: { input },
      });
      if (updateData?.updateCustomer?.customer) {
        setUpdateMessage(`${type === 'billing' ? 'Billing' : 'Shipping'} address updated successfully!`);
        setEditingAddress(null);
        await refetch();
      } else {
        setUpdateError(`Failed to update ${type} address. Please try again.`);
      }
    } catch (err: any) {
      console.error(`Error updating ${type} address:`, err);
      setUpdateError(err.message || `Failed to update ${type} address. Please try again.`);
    }
  };
  const hasBillingAddress = customer.billing?.address1;
  const hasShippingAddress = customer.shipping?.address1;
  return (
    <div className="woocommerce-MyAccount-content">
      <h2 className="text-2xl font-bold mb-6">Addresses</h2>
      <p className="text-sm text-gray-600 mb-6">
        The following addresses will be used on the checkout page by default.
      </p>
      {updateMessage && (
        <div className="mb-4 p-3 bg-green-100 text-green-800 rounded-lg">{updateMessage}</div>
      )}
      {updateError && (
        <div className="mb-4 p-3 bg-red-100 text-red-800 rounded-lg">{updateError}</div>
      )}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        {/* Billing Address */}
        <div className="border border-gray-200 rounded-lg p-6">
          <div className="flex justify-between items-center mb-4">
            <h3 className="text-lg font-semibold">Billing address</h3>
            {editingAddress !== 'billing' && (
              <button
                onClick={() => setEditingAddress('billing')}
                className="text-sm text-gray-600 hover:text-gray-900 underline"
              >
                {hasBillingAddress ? 'Edit' : 'Add'}
              </button>
            )}
          </div>
          {editingAddress === 'billing' ? (
            <form
              onSubmit={(e) => {
                e.preventDefault();
                handleAddressSubmit('billing');
              }}
              className="space-y-4"
            >
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">First name</label>
                  <input
                    type="text"
                    value={billingForm.firstName}
                    onChange={(e) => setBillingForm({ ...billingForm, firstName: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Last name</label>
                  <input
                    type="text"
                    value={billingForm.lastName}
                    onChange={(e) => setBillingForm({ ...billingForm, lastName: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Address line 1</label>
                <input
                  type="text"
                  value={billingForm.address1}
                  onChange={(e) => setBillingForm({ ...billingForm, address1: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                  required
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Address line 2</label>
                <input
                  type="text"
                  value={billingForm.address2}
                  onChange={(e) => setBillingForm({ ...billingForm, address2: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                />
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">City</label>
                  <input
                    type="text"
                    value={billingForm.city}
                    onChange={(e) => setBillingForm({ ...billingForm, city: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Postcode</label>
                  <input
                    type="text"
                    value={billingForm.postcode}
                    onChange={(e) => setBillingForm({ ...billingForm, postcode: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Country</label>
                  <input
                    type="text"
                    value={billingForm.country}
                    onChange={(e) => setBillingForm({ ...billingForm, country: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">State</label>
                  <input
                    type="text"
                    value={billingForm.state}
                    onChange={(e) => setBillingForm({ ...billingForm, state: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                  />
                </div>
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                  <input
                    type="email"
                    value={billingForm.email}
                    onChange={(e) => setBillingForm({ ...billingForm, email: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                  <input
                    type="tel"
                    value={billingForm.phone}
                    onChange={(e) => setBillingForm({ ...billingForm, phone: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                  />
                </div>
              </div>
              <div className="flex gap-2">
                <button
                  type="submit"
                  disabled={updating}
                  className="px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 text-sm disabled:opacity-50"
                >
                  {updating ? 'Saving...' : 'Save address'}
                </button>
                <button
                  type="button"
                  onClick={() => {
                    setEditingAddress(null);
                    setUpdateMessage(null);
                    setUpdateError(null);
                  }}
                  disabled={updating}
                  className="px-4 py-2 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 text-sm disabled:opacity-50"
                >
                  Cancel
                </button>
              </div>
            </form>
          ) : (
            <div className="text-sm text-gray-600">
              {hasBillingAddress ? (
                <address className="not-italic">
                  {customer.billing.firstName} {customer.billing.lastName}
                  <br />
                  {customer.billing.address1}
                  {customer.billing.address2 && (
                    <>
                      <br />
                      {customer.billing.address2}
                    </>
                  )}
                  <br />
                  {customer.billing.city}, {customer.billing.postcode}
                  {customer.billing.state && (
                    <>
                      <br />
                      {customer.billing.state}
                    </>
                  )}
                  <br />
                  {customer.billing.country}
                  {customer.billing.email && (
                    <>
                      <br />
                      <br />
                      Email: {customer.billing.email}
                    </>
                  )}
                  {customer.billing.phone && (
                    <>
                      <br />
                      Phone: {customer.billing.phone}
                    </>
                  )}
                </address>
              ) : (
                <p>You have not set up this type of address yet.</p>
              )}
            </div>
          )}
        </div>
        {/* Shipping Address */}
        <div className="border border-gray-200 rounded-lg p-6">
          <div className="flex justify-between items-center mb-4">
            <h3 className="text-lg font-semibold">Shipping address</h3>
            {editingAddress !== 'shipping' && (
              <button
                onClick={() => setEditingAddress('shipping')}
                className="text-sm text-gray-600 hover:text-gray-900 underline"
              >
                {hasShippingAddress ? 'Edit' : 'Add'}
              </button>
            )}
          </div>
          {editingAddress === 'shipping' ? (
            <form
              onSubmit={(e) => {
                e.preventDefault();
                handleAddressSubmit('shipping');
              }}
              className="space-y-4"
            >
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">First name</label>
                  <input
                    type="text"
                    value={shippingForm.firstName}
                    onChange={(e) => setShippingForm({ ...shippingForm, firstName: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Last name</label>
                  <input
                    type="text"
                    value={shippingForm.lastName}
                    onChange={(e) => setShippingForm({ ...shippingForm, lastName: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Address line 1</label>
                <input
                  type="text"
                  value={shippingForm.address1}
                  onChange={(e) => setShippingForm({ ...shippingForm, address1: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                  required
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Address line 2</label>
                <input
                  type="text"
                  value={shippingForm.address2}
                  onChange={(e) => setShippingForm({ ...shippingForm, address2: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                />
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">City</label>
                  <input
                    type="text"
                    value={shippingForm.city}
                    onChange={(e) => setShippingForm({ ...shippingForm, city: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Postcode</label>
                  <input
                    type="text"
                    value={shippingForm.postcode}
                    onChange={(e) => setShippingForm({ ...shippingForm, postcode: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Country</label>
                  <input
                    type="text"
                    value={shippingForm.country}
                    onChange={(e) => setShippingForm({ ...shippingForm, country: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    required
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">State</label>
                  <input
                    type="text"
                    value={shippingForm.state}
                    onChange={(e) => setShippingForm({ ...shippingForm, state: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                  />
                </div>
              </div>
              <div className="flex gap-2">
                <button
                  type="submit"
                  disabled={updating}
                  className="px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 text-sm disabled:opacity-50"
                >
                  {updating ? 'Saving...' : 'Save address'}
                </button>
                <button
                  type="button"
                  onClick={() => {
                    setEditingAddress(null);
                    setUpdateMessage(null);
                    setUpdateError(null);
                  }}
                  disabled={updating}
                  className="px-4 py-2 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 text-sm disabled:opacity-50"
                >
                  Cancel
                </button>
              </div>
            </form>
          ) : (
            <div className="text-sm text-gray-600">
              {hasShippingAddress ? (
                <address className="not-italic">
                  {customer.shipping.firstName} {customer.shipping.lastName}
                  <br />
                  {customer.shipping.address1}
                  {customer.shipping.address2 && (
                    <>
                      <br />
                      {customer.shipping.address2}
                    </>
                  )}
                  <br />
                  {customer.shipping.city}, {customer.shipping.postcode}
                  {customer.shipping.state && (
                    <>
                      <br />
                      {customer.shipping.state}
                    </>
                  )}
                  <br />
                  {customer.shipping.country}
                </address>
              ) : (
                <p>You have not set up this type of address yet.</p>
              )}
            </div>
          )}
        </div>
      </div>
    </div>
  );
};
export default AccountAddresses;
````

## File: src/components/User/AccountDashboard.component.tsx
````typescript
import { useQuery } from '@apollo/client';
import Link from 'next/link';
import { getApolloAuthClient } from '@faustwp/core';
import { GET_CURRENT_USER, GET_CUSTOMER_ORDERS } from '@/utils/gql/GQL_QUERIES';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
const AccountDashboard = () => {
  const authClient = getApolloAuthClient(); // Get authenticated client
  const { data: customerData, loading: customerLoading } = useQuery(GET_CURRENT_USER, {
    client: authClient, // Use authenticated client
    fetchPolicy: 'network-only',
    errorPolicy: 'all',
  });
  const { data: ordersData, loading: ordersLoading } = useQuery(GET_CUSTOMER_ORDERS, {
    client: authClient, // Use authenticated client
    fetchPolicy: 'network-only',
    errorPolicy: 'all',
  });
  if (customerLoading || ordersLoading) {
    return <LoadingSpinner />;
  }
  const customer = customerData?.customer;
  const orders = ordersData?.customer?.orders?.nodes || [];
  const recentOrders = orders.slice(0, 5);
  return (
    <div className="woocommerce-MyAccount-content">
      <div className="woocommerce-notices-wrapper"></div>
      <p className="mb-4">
        Hello <strong>{customer?.firstName || customer?.email || 'there'}</strong>
        {customer?.firstName && customer?.lastName && (
          <> ({customer.firstName} {customer.lastName})</>
        )}
      </p>
      <p className="mb-6 text-gray-600">
        From your account dashboard you can view your{' '}
        <Link href="/account/orders" className="text-gray-900 underline hover:text-gray-700">
          recent orders
        </Link>
        , manage your{' '}
        <Link href="/account/addresses" className="text-gray-900 underline hover:text-gray-700">
          shipping and billing addresses
        </Link>
        , and{' '}
        <Link href="/account/account-details" className="text-gray-900 underline hover:text-gray-700">
          edit your password and account details
        </Link>
        .
      </p>
      {recentOrders.length > 0 && (
        <div className="mt-8">
          <h2 className="text-xl font-semibold mb-4">Recent Orders</h2>
          <div className="overflow-x-auto">
            <table className="min-w-full bg-white border border-gray-200 rounded-lg">
              <thead className="bg-gray-50">
                <tr>
                  <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Order</th>
                  <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Date</th>
                  <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Status</th>
                  <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Total</th>
                  <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Actions</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-200">
                {recentOrders.map((order: any) => (
                  <tr key={order.id} className="hover:bg-gray-50">
                    <td className="py-3 px-4 text-sm text-gray-900">#{order.orderNumber}</td>
                    <td className="py-3 px-4 text-sm text-gray-600">
                      {new Date(order.date).toLocaleDateString()}
                    </td>
                    <td className="py-3 px-4 text-sm">
                      <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                        {order.status.replace(/_/g, ' ')}
                      </span>
                    </td>
                    <td className="py-3 px-4 text-sm text-gray-900">{order.total}</td>
                    <td className="py-3 px-4 text-sm">
                      <Link
                        href={`/account/orders/${order.orderNumber}`}
                        className="text-gray-900 underline hover:text-gray-700"
                      >
                        View
                      </Link>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
          {orders.length > 5 && (
            <div className="mt-4">
              <Link
                href="/account/orders"
                className="text-gray-900 underline hover:text-gray-700 text-sm"
              >
                View all orders 
              </Link>
            </div>
          )}
        </div>
      )}
    </div>
  );
};
export default AccountDashboard;
````

## File: src/components/User/AccountDetails.component.tsx
````typescript
import { useQuery, useMutation } from '@apollo/client';
import { useState, useEffect } from 'react';
import { getApolloAuthClient } from '@faustwp/core';
import { GET_CURRENT_USER } from '@/utils/gql/GQL_QUERIES';
import { UPDATE_CUSTOMER } from '@/utils/gql/GQL_MUTATIONS';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
const AccountDetails = () => {
  console.log('[AccountDetails] Component rendering...');
  const authClient = getApolloAuthClient(); // Get authenticated client
  const { data, loading, error, refetch } = useQuery(GET_CURRENT_USER, {
    client: authClient, // Use authenticated client
    fetchPolicy: 'network-only',
    errorPolicy: 'all',
  });
  // Log query results
  useEffect(() => {
    if (data) {
      console.log('[AccountDetails] GET_CURRENT_USER query data received:', {
        hasCustomer: !!data?.customer,
        customerId: data?.customer?.id,
        customerEmail: data?.customer?.email,
        customerFirstName: data?.customer?.firstName,
        customerLastName: data?.customer?.lastName,
      });
    }
    if (error) {
      console.error('[AccountDetails] GET_CURRENT_USER query error:', error);
    }
  }, [data, error]);
  const [updateCustomer, { loading: updating }] = useMutation(UPDATE_CUSTOMER, {
    client: authClient, // Use authenticated client
  });
  const [isEditing, setIsEditing] = useState(false);
  const [formData, setFormData] = useState({
    firstName: '',
    lastName: '',
    email: '',
    currentPassword: '',
    newPassword: '',
    confirmPassword: '',
  });
  const [updateMessage, setUpdateMessage] = useState<string | null>(null);
  const [updateError, setUpdateError] = useState<string | null>(null);
  const customer = data?.customer;
  // Initialize form data when customer data loads (using useEffect to avoid render issues)
  useEffect(() => {
    console.log('[AccountDetails] useEffect triggered:', {
      hasCustomer: !!customer,
      isEditing,
      formDataFirstName: formData.firstName,
      customerFirstName: customer?.firstName,
      customerEmail: customer?.email,
    });
    if (customer && !isEditing && formData.firstName === '') {
      console.log('[AccountDetails] Initializing form data from customer:', {
        firstName: customer.firstName,
        lastName: customer.lastName,
        email: customer.email,
      });
      setFormData({
        firstName: customer.firstName || '',
        lastName: customer.lastName || '',
        email: customer.email || '',
        currentPassword: '',
        newPassword: '',
        confirmPassword: '',
      });
      console.log('[AccountDetails] Form data initialized');
    }
  }, [customer, isEditing]);
  if (loading) {
    return <LoadingSpinner />;
  }
  if (error || !customer) {
    return (
      <div className="woocommerce-MyAccount-content">
        <p className="text-red-600">Error loading account details. Please try again later.</p>
      </div>
    );
  }
  const handleSubmit = async (e: React.FormEvent) => {
    console.log('[AccountDetails] ========== FORM SUBMISSION STARTED ==========');
    e.preventDefault();
    e.stopPropagation();
    // Prevent submission if not in editing mode
    if (!isEditing) {
      console.log('[AccountDetails] Form submission prevented - not in editing mode');
      return;
    }
    console.log('[AccountDetails] Form is in editing mode, proceeding...');
    console.log('[AccountDetails] Current form data:', {
      firstName: formData.firstName,
      lastName: formData.lastName,
      email: formData.email,
      hasNewPassword: !!formData.newPassword,
      hasConfirmPassword: !!formData.confirmPassword,
    });
    setUpdateMessage(null);
    setUpdateError(null);
    // Validate passwords if changing
    if (formData.newPassword && formData.newPassword !== formData.confirmPassword) {
      console.log('[AccountDetails] Password validation failed: passwords do not match');
      setUpdateError('New passwords do not match.');
      return;
    }
    if (formData.newPassword && formData.newPassword.length < 8) {
      console.log('[AccountDetails] Password validation failed: password too short');
      setUpdateError('New password must be at least 8 characters long.');
      return;
    }
    console.log('[AccountDetails] Validation passed, preparing update input...');
    try {
      const updateInput: any = {
        firstName: formData.firstName,
        lastName: formData.lastName,
        email: formData.email,
      };
      // Only include password if provided
      if (formData.newPassword) {
        updateInput.password = formData.newPassword;
        console.log('[AccountDetails] Password change included in update');
      } else {
        console.log('[AccountDetails] No password change');
      }
      console.log('[AccountDetails] Update input prepared:', {
        firstName: updateInput.firstName,
        lastName: updateInput.lastName,
        email: updateInput.email,
        hasPassword: !!updateInput.password,
      });
      console.log('[AccountDetails] Calling updateCustomer mutation...');
      const { data: updateData, errors } = await updateCustomer({
        variables: {
          input: updateInput,
        },
      });
      console.log('[AccountDetails] Mutation response:', {
        hasData: !!updateData,
        hasErrors: !!errors,
        errors: errors?.map(e => e.message),
        customer: updateData?.updateCustomer?.customer,
      });
      if (updateData?.updateCustomer?.customer) {
        console.log('[AccountDetails] Update successful! Customer data:', {
          id: updateData.updateCustomer.customer.id,
          firstName: updateData.updateCustomer.customer.firstName,
          lastName: updateData.updateCustomer.customer.lastName,
          email: updateData.updateCustomer.customer.email,
        });
        setUpdateMessage('Account details updated successfully!');
        setIsEditing(false);
        // Reset password fields
        setFormData({
          ...formData,
          currentPassword: '',
          newPassword: '',
          confirmPassword: '',
        });
        console.log('[AccountDetails] Refetching customer data...');
        // Refetch customer data to get latest
        const refetchResult = await refetch();
        console.log('[AccountDetails] Refetch result:', {
          hasData: !!refetchResult.data,
          customer: refetchResult.data?.customer,
        });
        console.log('[AccountDetails] ========== FORM SUBMISSION SUCCESSFUL ==========');
      } else {
        console.error('[AccountDetails] Update failed: No customer data in response');
        console.error('[AccountDetails] Response data:', updateData);
        setUpdateError('Failed to update account details. Please try again.');
      }
    } catch (err: any) {
      console.error('[AccountDetails] ========== FORM SUBMISSION ERROR ==========');
      console.error('[AccountDetails] Error updating customer:', err);
      console.error('[AccountDetails] Error details:', {
        message: err.message,
        graphQLErrors: err.graphQLErrors,
        networkError: err.networkError,
      });
      setUpdateError(err.message || 'Failed to update account details. Please try again.');
    }
  };
  return (
    <div className="woocommerce-MyAccount-content">
      <h2 className="text-2xl font-bold mb-6">Account details</h2>
      {updateMessage && (
        <div className="mb-4 p-3 bg-green-100 text-green-800 rounded-lg">{updateMessage}</div>
      )}
      {updateError && (
        <div className="mb-4 p-3 bg-red-100 text-red-800 rounded-lg">{updateError}</div>
      )}
      <form onSubmit={handleSubmit} className="space-y-6">
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label htmlFor="first-name" className="block text-sm font-medium text-gray-700 mb-2">
              First name
            </label>
            <input
              id="first-name"
              type="text"
              value={formData.firstName}
              onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}
              disabled={!isEditing}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black disabled:bg-gray-100 disabled:cursor-not-allowed"
            />
          </div>
          <div>
            <label htmlFor="last-name" className="block text-sm font-medium text-gray-700 mb-2">
              Last name
            </label>
            <input
              id="last-name"
              type="text"
              value={formData.lastName}
              onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}
              disabled={!isEditing}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black disabled:bg-gray-100 disabled:cursor-not-allowed"
            />
          </div>
        </div>
        <div>
          <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-2">
            Email address
          </label>
          <input
            id="email"
            type="email"
            value={formData.email}
            onChange={(e) => setFormData({ ...formData, email: e.target.value })}
            disabled={!isEditing}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black disabled:bg-gray-100 disabled:cursor-not-allowed"
          />
        </div>
        {isEditing && (
          <>
            <div className="border-t border-gray-200 pt-6">
              <h3 className="text-lg font-semibold mb-4">Password change</h3>
              <div className="space-y-4">
                <div>
                  <label htmlFor="current-password" className="block text-sm font-medium text-gray-700 mb-2">
                    Current password (leave blank to leave unchanged)
                  </label>
                  <input
                    id="current-password"
                    type="password"
                    value={formData.currentPassword}
                    onChange={(e) => setFormData({ ...formData, currentPassword: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black"
                  />
                </div>
                <div>
                  <label htmlFor="new-password" className="block text-sm font-medium text-gray-700 mb-2">
                    New password (leave blank to leave unchanged)
                  </label>
                  <input
                    id="new-password"
                    type="password"
                    value={formData.newPassword}
                    onChange={(e) => setFormData({ ...formData, newPassword: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black"
                  />
                </div>
                <div>
                  <label htmlFor="confirm-password" className="block text-sm font-medium text-gray-700 mb-2">
                    Confirm new password
                  </label>
                  <input
                    id="confirm-password"
                    type="password"
                    value={formData.confirmPassword}
                    onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black"
                  />
                </div>
              </div>
            </div>
          </>
        )}
        <div className="flex gap-4">
          {isEditing ? (
            <>
              <button
                type="submit"
                disabled={updating}
                className="px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
              >
                {updating ? 'Saving...' : 'Save changes'}
              </button>
              <button
                type="button"
                onClick={() => {
                  setIsEditing(false);
                  setUpdateMessage(null);
                  setUpdateError(null);
                  // Reset form to original values
                  setFormData({
                    firstName: customer.firstName || '',
                    lastName: customer.lastName || '',
                    email: customer.email || '',
                    currentPassword: '',
                    newPassword: '',
                    confirmPassword: '',
                  });
                }}
                disabled={updating}
                className="px-6 py-3 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50"
              >
                Cancel
              </button>
            </>
          ) : (
            <button
              type="button"
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                setIsEditing(true);
              }}
              className="px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors"
            >
              Edit account details
            </button>
          )}
        </div>
      </form>
    </div>
  );
};
export default AccountDetails;
````

## File: src/components/User/AccountDownloads.component.tsx
````typescript
const AccountDownloads = () => {
  // Downloads functionality would require additional GraphQL queries
  // For now, showing a placeholder that matches WooCommerce structure
  return (
    <div className="woocommerce-MyAccount-content">
      <h2 className="text-2xl font-bold mb-6">Downloads</h2>
      <div className="text-center py-12">
        <p className="text-gray-600 mb-4">No downloads available yet.</p>
        <p className="text-sm text-gray-500">
          Downloads will appear here when you purchase digital products.
        </p>
      </div>
    </div>
  );
};
export default AccountDownloads;
````

## File: src/components/User/AccountNavigation.component.tsx
````typescript
import Link from 'next/link';
import { useRouter } from 'next/router';
import { useLogout } from '@faustwp/core';
import { useState, useEffect } from 'react';
interface AccountNavItem {
  id: string;
  label: string;
  href: string;
  endpoint: string;
  icon?: string;
}
const accountNavItems: AccountNavItem[] = [
  { id: 'my-details', label: 'My Details', href: '/account#my-details', endpoint: 'my-details', icon: 'information-circle' },
  { id: 'orders', label: 'Orders', href: '/account#orders', endpoint: 'orders', icon: 'bag-check' },
  { id: 'downloads', label: 'Downloads', href: '/account#downloads', endpoint: 'downloads', icon: 'cloud-download' },
  { id: 'addresses', label: 'Addresses', href: '/account#addresses', endpoint: 'addresses', icon: 'location' },
  { id: 'payment-methods', label: 'Payment methods', href: '/account#payment-methods', endpoint: 'payment-methods', icon: 'card' },
  { id: 'account-details', label: 'Account details', href: '/account#account-details', endpoint: 'account-details', icon: 'settings' },
];
interface AccountNavigationProps {
  activeEndpoint?: string;
}
const AccountNavigation = ({ activeEndpoint = 'dashboard' }: AccountNavigationProps) => {
  const router = useRouter();
  const currentPath = router.pathname;
  const [isLoggingOut, setIsLoggingOut] = useState(false);
  const { logout, loading: logoutLoading } = useLogout(); // Use Faust.js useLogout
  // Determine active item based on hash or fallback
  const getActiveItem = () => {
    if (typeof window !== 'undefined') {
      const hash = window.location.hash.slice(1);
      if (hash) {
        return hash;
      }
    }
    // Fallback to query parameter for backward compatibility
    const tab = router.query.tab as string;
    if (tab) {
      return tab;
    }
    // Fallback to path-based detection for backward compatibility
    if (currentPath === '/account') return 'my-details';
    if (currentPath.startsWith('/account/orders')) return 'orders';
    if (currentPath.startsWith('/account/downloads')) return 'downloads';
    if (currentPath.startsWith('/account/addresses')) return 'addresses';
    if (currentPath.startsWith('/account/payment-methods')) return 'payment-methods';
    if (currentPath.startsWith('/account/account-details')) return 'account-details';
    return activeEndpoint || 'my-details';
  };
  const [activeId, setActiveId] = useState(getActiveItem());
  // Update active tab when hash changes or when activeEndpoint prop changes
  useEffect(() => {
    const handleHashChange = () => {
      const hash = window.location.hash.slice(1);
      console.log('[AccountNav] Hash change detected:', hash);
      if (hash) {
        setActiveId(hash);
        console.log('[AccountNav] Active ID set to:', hash);
      } else {
        setActiveId('my-details');
        console.log('[AccountNav] Active ID set to default: my-details');
      }
    };
    window.addEventListener('hashchange', handleHashChange);
    // Also check on mount
    handleHashChange();
    return () => window.removeEventListener('hashchange', handleHashChange);
  }, []);
  // Separate effect to sync with activeEndpoint prop (from parent account page)
  useEffect(() => {
    if (activeEndpoint && activeEndpoint !== activeId) {
      console.log('[AccountNav] Syncing with activeEndpoint prop:', activeEndpoint);
      setActiveId(activeEndpoint);
    }
  }, [activeEndpoint]);
  const handleLogout = async () => {
    console.log('[AccountNav] Logout button clicked');
    setIsLoggingOut(true);
    try {
      console.log('[AccountNav] Calling Faust.js logout function...');
      await logout('/'); // Redirect to homepage after logout
      console.log('[AccountNav] Faust.js logout function completed');
    } catch (error) {
      console.error('[AccountNav] Logout error:', error);
      setIsLoggingOut(false);
    }
  };
  return (
    <nav className="woocommerce-MyAccount-navigation" aria-label="Account pages">
      <ul className="space-y-1 lg:block flex flex-wrap gap-2">
        {accountNavItems.map((item) => {
          const isActive = item.id === activeId;
            return (
              <li
                key={item.id}
                className={`woocommerce-MyAccount-navigation-link woocommerce-MyAccount-navigation-link--${item.endpoint} ${
                  isActive ? 'is-active' : ''
                }`}
              >
                <Link
                  href={item.href}
                  className={`flex items-center gap-4 px-4 py-3 text-sm font-medium rounded-lg transition-colors ${
                    isActive
                      ? 'bg-gray-900 text-white'
                      : 'text-gray-700 hover:bg-gray-100 hover:text-gray-900'
                  }`}
                  aria-current={isActive ? 'page' : undefined}
                  onClick={(e) => {
                    // For hash links, manually update the hash to trigger hashchange event
                    if (item.href.includes('#')) {
                      e.preventDefault();
                      const hash = item.href.split('#')[1];
                      console.log('[AccountNav] Clicked tab:', item.id, 'hash:', hash);
                      window.location.hash = hash;
                      // Manually trigger hashchange for immediate update
                      window.dispatchEvent(new HashChangeEvent('hashchange'));
                      // Also update local state immediately
                      setActiveId(hash);
                    }
                  }}
                >
                  {item.icon && (
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      {item.icon === 'information-circle' && (
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                      )}
                      {item.icon === 'bag-check' && (
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                      )}
                      {item.icon === 'cloud-download' && (
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
                      )}
                      {item.icon === 'location' && (
                        <>
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </>
                      )}
                      {item.icon === 'card' && (
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                      )}
                      {item.icon === 'settings' && (
                        <>
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </>
                      )}
                    </svg>
                  )}
                  {item.label}
                </Link>
              </li>
            );
        })}
        {/* Logout Link */}
        <li className="woocommerce-MyAccount-navigation-link woocommerce-MyAccount-navigation-link--customer-logout">
          <button
            onClick={handleLogout}
            disabled={isLoggingOut || logoutLoading} // Use Faust.js loading state
            className={`w-full text-left px-4 py-3 text-sm font-medium rounded-lg transition-colors ${
              isLoggingOut || logoutLoading
                ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                : 'text-gray-700 hover:bg-gray-100 hover:text-gray-900'
            }`}
          >
            {isLoggingOut || logoutLoading ? 'Logging out...' : 'Log out'}
          </button>
        </li>
      </ul>
    </nav>
  );
};
export default AccountNavigation;
````

## File: src/components/User/AccountOrders.component.tsx
````typescript
import { useQuery } from '@apollo/client';
import Link from 'next/link';
import { getApolloAuthClient } from '@faustwp/core';
import { GET_CUSTOMER_ORDERS } from '@/utils/gql/GQL_QUERIES';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
const AccountOrders = () => {
  const authClient = getApolloAuthClient(); // Get authenticated client
  const { data, loading, error } = useQuery(GET_CUSTOMER_ORDERS, {
    client: authClient, // Use authenticated client
    fetchPolicy: 'network-only',
    errorPolicy: 'all',
  });
  if (loading) {
    return <LoadingSpinner />;
  }
  if (error || !data?.customer) {
    return (
      <div className="woocommerce-MyAccount-content">
        <p className="text-red-600">Error loading orders. Please try again later.</p>
      </div>
    );
  }
  const orders = data.customer.orders?.nodes || [];
  return (
    <div className="woocommerce-MyAccount-content">
      <h2 className="text-2xl font-bold mb-6">Orders</h2>
      {orders.length > 0 ? (
        <div className="overflow-x-auto">
          <table className="min-w-full bg-white border border-gray-200 rounded-lg">
            <thead className="bg-gray-50">
              <tr>
                <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Order</th>
                <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Date</th>
                <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Status</th>
                <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Total</th>
                <th className="py-3 px-4 text-left text-sm font-medium text-gray-700">Actions</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-200">
              {orders.map((order: any) => (
                <tr key={order.id} className="hover:bg-gray-50">
                  <td className="py-3 px-4 text-sm text-gray-900 font-medium">#{order.orderNumber}</td>
                  <td className="py-3 px-4 text-sm text-gray-600">
                    {new Date(order.date).toLocaleDateString()}
                  </td>
                  <td className="py-3 px-4 text-sm">
                    <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                      {order.status.replace(/_/g, ' ')}
                    </span>
                  </td>
                  <td className="py-3 px-4 text-sm text-gray-900 font-medium">{order.total}</td>
                  <td className="py-3 px-4 text-sm">
                    <Link
                      href={`/account/orders/${order.orderNumber}`}
                      className="text-gray-900 underline hover:text-gray-700"
                    >
                      View
                    </Link>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      ) : (
        <div className="text-center py-12">
          <p className="text-gray-600 mb-4">You have no orders yet.</p>
          <Link
            href="/catalog"
            className="inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors"
          >
            Start Shopping
          </Link>
        </div>
      )}
    </div>
  );
};
export default AccountOrders;
````

## File: src/components/User/AccountPaymentMethods.component.tsx
````typescript
const AccountPaymentMethods = () => {
  // Payment methods functionality would require additional GraphQL queries
  // For now, showing a placeholder that matches WooCommerce structure
  return (
    <div className="woocommerce-MyAccount-content">
      <h2 className="text-2xl font-bold mb-6">Payment methods</h2>
      <div className="text-center py-12">
        <p className="text-gray-600 mb-4">No payment methods saved yet.</p>
        <p className="text-sm text-gray-500">
          Payment methods will appear here when you save them during checkout.
        </p>
      </div>
    </div>
  );
};
export default AccountPaymentMethods;
````

## File: src/components/User/CustomerAccount.component.tsx
````typescript
import { useQuery } from '@apollo/client';
import { useState } from 'react';
import { GET_CUSTOMER_ORDERS } from '../../utils/gql/GQL_QUERIES';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
import { logout } from '../../utils/auth';
interface Order {
  id: string;
  orderNumber: number;
  status: string;
  total: string;
  date: string;
}
/**
 * Formats order status by replacing underscores with spaces
 * @param {string} status - Order status (e.g., "ON_HOLD")
 * @returns {string} - Formatted status (e.g., "ON HOLD")
 */
const formatStatus = (status: string): string => {
  return status.replace(/_/g, ' ');
};
/**
 * Customer account component that displays user's orders
 * @function CustomerAccount
 * @returns {JSX.Element} - Rendered component with order history
 */
const CustomerAccount = () => {
  // Use network-only to prevent showing cached data after logout
  const { loading, error, data } = useQuery(GET_CUSTOMER_ORDERS, {
    fetchPolicy: 'network-only', // Always fetch from network, never use cache
    errorPolicy: 'all',
  });
  const [isLoggingOut, setIsLoggingOut] = useState(false);
  const handleLogout = async () => {
    setIsLoggingOut(true);
    try {
      // Logout will handle redirect, so we don't need to reset state
      await logout();
      // Note: logout() performs a full page redirect, so code after this won't execute
    } catch (error) {
      console.error('Logout error:', error);
      // Even on error, logout should redirect, but reset state just in case
      setIsLoggingOut(false);
    }
  };
  if (loading) return <LoadingSpinner />;
  // If there's an error or no customer data, don't show content
  // The withAuth HOC should handle redirect, but this is a safety check
  if (error || !data?.customer) {
    return null;
  }
  const orders = data?.customer?.orders?.nodes;
  return (
    <div>
      <h1 className="text-2xl font-bold mb-4">My Orders</h1>
      {orders && orders.length > 0 ? (
        <div className="overflow-x-auto">
          <table className="min-w-full bg-white">
            <thead>
              <tr>
                <th className="py-2 px-4 border-b text-left">Order Number</th>
                <th className="py-2 px-4 border-b text-left">Date</th>
                <th className="py-2 px-4 border-b text-left">Status</th>
                <th className="py-2 px-4 border-b text-left">Total</th>
              </tr>
            </thead>
            <tbody>
              {orders.map((order: Order) => (
                <tr key={order.id}>
                  <td className="py-2 px-4 border-b">{order.orderNumber}</td>
                  <td className="py-2 px-4 border-b">
                    {new Date(order.date).toLocaleDateString()}
                  </td>
                  <td className="py-2 px-4 border-b">
                    <span className="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                      {formatStatus(order.status)}
                    </span>
                  </td>
                  <td className="py-2 px-4 border-b">{order.total}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      ) : (
        <p>You have no orders.</p>
      )}
      <div className="mt-8 pt-6 border-t border-gray-200">
        <button
          onClick={handleLogout}
          disabled={isLoggingOut}
          className="px-6 py-2 bg-gray-900 text-white rounded-full hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
        >
          {isLoggingOut ? 'Logging out...' : 'Log Out'}
        </button>
      </div>
    </div>
  );
};
export default CustomerAccount;
````

## File: src/components/User/UserLogin.component.tsx
````typescript
import { useState } from 'react';
import { useForm, FormProvider } from 'react-hook-form';
import { useQuery } from '@apollo/client';
import { login } from '../../utils/auth';
import { InputField } from '../Input/InputField.component';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
import Button from '../UI/Button.component';
import { useRouter } from 'next/router';
import Link from 'next/link';
import { GET_CURRENT_USER } from '@/utils/gql/GQL_QUERIES';
interface ILoginData {
  username: string;
  password: string;
}
/**
 * User login component that handles user authentication
 * @function UserLogin
 * @returns {JSX.Element} - Rendered component with login form
 */
const UserLogin = () => {
  const methods = useForm<ILoginData>();
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const router = useRouter();
  // Refetch query to verify login
  const { refetch: refetchUser } = useQuery(GET_CURRENT_USER, {
    skip: true, // Don't run automatically
    fetchPolicy: 'network-only',
    errorPolicy: 'all',
  });
  const onSubmit = async (data: ILoginData) => {
    console.log('[UserLogin] Form submitted, starting login...');
    setLoading(true);
    setError(null);
    try {
      console.log('[UserLogin] Calling login function...');
      const result = await login(data.username, data.password);
      console.log('[UserLogin] Login result:', result);
      if (result.success && result.status === 'SUCCESS') {
        console.log('[UserLogin] Login successful, waiting for cookies...');
        // Wait a moment for cookies to be set and cache to clear
        await new Promise(resolve => setTimeout(resolve, 300));
        console.log('[UserLogin] Wait complete, refetching user data...');
        // Refetch user data to verify login worked
        try {
          const { data: userData, error: refetchError } = await refetchUser();
          console.log('[UserLogin] Refetch result:', { 
            hasCustomer: !!userData?.customer,
            customerId: userData?.customer?.id,
            customerEmail: userData?.customer?.email,
            customerFirstName: userData?.customer?.firstName,
            customerUsername: userData?.customer?.username,
            fullCustomerData: userData?.customer,
            error: refetchError 
          });
          // Check if customer is actually authenticated (not guest)
          if (userData?.customer?.id === 'guest' || userData?.customer?.id === 'cGd1ZXN0') {
            console.warn('[UserLogin] WARNING: Customer ID is "guest" - user may not be fully authenticated');
            console.warn('[UserLogin] This could indicate cookies are not being set properly');
          }
          if (!userData?.customer) {
            console.warn('[UserLogin] User data not available after login, but continuing...');
          } else {
            console.log('[UserLogin] User data confirmed, proceeding with redirect');
          }
        } catch (refetchError) {
          console.warn('[UserLogin] Error refetching user:', refetchError);
          // Continue anyway - cookies might be set even if query fails
        }
        // Check for return URL
        const returnUrl = typeof window !== 'undefined' ? sessionStorage.getItem('loginReturnUrl') : null;
        console.log('[UserLogin] Return URL:', returnUrl);
        // TEMPORARILY DISABLED: Prevent redirect to capture logs
        console.log('[UserLogin] REDIRECT DISABLED FOR DEBUGGING - Login successful!');
        console.log('[UserLogin] Would redirect to:', returnUrl && returnUrl !== '/login' && returnUrl !== '/account' ? `${returnUrl}?login=success` : '/account?login=success');
        // if (returnUrl && returnUrl !== '/login' && returnUrl !== '/account') {
        //   // Clear return URL and redirect
        //   if (typeof window !== 'undefined') {
        //     sessionStorage.removeItem('loginReturnUrl');
        //   }
        //   console.log('[UserLogin] Redirecting to return URL:', returnUrl);
        //   // Use replace with a query param to signal successful login
        //   router.replace(`${returnUrl}?login=success`);
        // } else {
        //   console.log('[UserLogin] Redirecting to /account');
        //   // Use replace with query param to signal successful login
        //   router.replace('/account?login=success');
        // }
      } else {
        console.error('[UserLogin] Login result indicates failure:', result);
        throw new Error('Failed to login');
      }
    } catch (error: unknown) {
      console.error('[UserLogin] Login error caught:', error);
      if (error instanceof Error) {
        setError(error.message);
      } else {
        setError('An unknown error occurred.');
      }
      console.error('Login error:', error);
    } finally {
      setLoading(false);
      console.log('[UserLogin] Login process complete');
    }
  };
  return (
    <section className="text-gray-700 container p-4 py-2 mx-auto mb-[8rem] md:mb-0">
      <div className="mx-auto lg:w-1/2">
        <h1 className="text-3xl font-bold text-gray-900 mb-8 text-center">
          Log In
        </h1>
        <FormProvider {...methods}>
          <form onSubmit={methods.handleSubmit(onSubmit)}>
            <div className="flex flex-col gap-4">
              <div className="w-full">
                <label htmlFor="username" className="block pb-2 text-sm font-medium text-gray-700">
                  Username or email
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="username"
                  placeholder="Username or email"
                  type="text"
                  {...methods.register('username', { required: true })}
                />
              </div>
              <div className="w-full">
                <label htmlFor="password" className="block pb-2 text-sm font-medium text-gray-700">
                  Password
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="password"
                  placeholder="Password"
                  type="password"
                  {...methods.register('password', { required: true })}
                />
              </div>
              {error && (
                <div className="w-full text-red-600 text-sm text-center">
                  {error}
                </div>
              )}
              <div className="w-full mt-4">
                <Button variant="primary" buttonDisabled={loading} type="submit">
                  {loading ? <LoadingSpinner /> : 'Log In'}
                </Button>
              </div>
              <div className="w-full mt-4 text-center">
                <p className="text-sm text-gray-600">
                  Don't have an account?{' '}
                  <Link href="/register" className="text-black font-semibold hover:underline">
                    Create Account
                  </Link>
                </p>
              </div>
            </div>
          </form>
        </FormProvider>
      </div>
    </section>
  );
};
export default UserLogin;
````

## File: src/components/User/UserRegistration.component.tsx
````typescript
import { useState } from 'react';
import { useMutation } from '@apollo/client';
import { useForm, FormProvider } from 'react-hook-form';
import { CREATE_USER } from '../../utils/gql/GQL_MUTATIONS';
import { InputField } from '../Input/InputField.component';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
import Button from '../UI/Button.component';
import Link from 'next/link';
interface IRegistrationData {
  username: string;
  email: string;
  password: string;
  firstName: string;
  lastName: string;
}
/**
 * User registration component that handles WooCommerce customer creation
 * @function UserRegistration
 * @returns {JSX.Element} - Rendered component with registration form
 */
const UserRegistration = () => {
  const methods = useForm<IRegistrationData>();
  const [registerUser, { loading }] = useMutation(CREATE_USER);
  const [registrationCompleted, setRegistrationCompleted] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const onSubmit = async (data: IRegistrationData) => {
    setError(null);
    console.log('[UserRegistration] Submitting registration with data:', {
      username: data.username,
      email: data.email,
      hasPassword: !!data.password,
      firstName: data.firstName,
      lastName: data.lastName,
    });
    try {
      const response = await registerUser({
        variables: data,
      });
      console.log('[UserRegistration] Registration response:', response);
      // Check for GraphQL errors in the response first
      if (response.errors && response.errors.length > 0) {
        const errorMessage = response.errors[0].message || 'Registration failed. Please check your information and try again.';
        setError(errorMessage);
        return;
      }
      const customer = response.data?.registerCustomer?.customer;
      if (customer) {
        setRegistrationCompleted(true);
      } else {
        setError('Failed to register customer. Please try again.');
      }
    } catch (error: unknown) {
      console.error('Registration error:', error);
      // Handle Apollo/GraphQL errors
      if (error && typeof error === 'object') {
        const apolloError = error as any;
        // Check for GraphQL errors
        if (apolloError.graphQLErrors && apolloError.graphQLErrors.length > 0) {
          const graphQLError = apolloError.graphQLErrors[0];
          setError(graphQLError.message || 'Registration failed. Please check your information and try again.');
          return;
        }
        // Check for network errors
        if (apolloError.networkError) {
          const networkError = apolloError.networkError;
          if (networkError.message === 'Failed to fetch') {
            setError('Unable to connect to the server. Please check your connection and try again.');
          } else {
            setError(networkError.message || 'Network error occurred. Please try again.');
          }
          return;
        }
      }
      // Handle standard Error objects
      if (error instanceof Error) {
        setError(error.message || 'Registration failed. Please try again.');
      } else {
        setError('An unexpected error occurred. Please try again.');
      }
    }
  };
  if (registrationCompleted) {
    return (
      <div className="text-center my-8">
        <h2 className="text-2xl font-bold text-green-600 mb-4">
          Registration successful!
        </h2>
        <p>You can now log in with your account.</p>
      </div>
    );
  }
  return (
    <section className="text-gray-700 container p-4 py-2 mx-auto mb-[8rem] md:mb-0">
      <div className="mx-auto lg:w-1/2">
        <h1 className="text-3xl font-bold text-gray-900 mb-8 text-center">
          Create Account
        </h1>
        <FormProvider {...methods}>
          <form onSubmit={methods.handleSubmit(onSubmit)}>
            <div className="flex flex-col gap-4">
              <div className="w-full">
                <label htmlFor="username" className="block pb-2 text-sm font-medium text-gray-700">
                  Username
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="username"
                  placeholder="Username"
                  type="text"
                  {...methods.register('username', { required: true })}
                />
              </div>
              <div className="w-full">
                <label htmlFor="email" className="block pb-2 text-sm font-medium text-gray-700">
                  Email
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="email"
                  placeholder="Email"
                  type="email"
                  {...methods.register('email', { required: true })}
                />
              </div>
              <div className="w-full">
                <label htmlFor="password" className="block pb-2 text-sm font-medium text-gray-700">
                  Password
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="password"
                  placeholder="Password"
                  type="password"
                  {...methods.register('password', { required: true })}
                />
              </div>
              <div className="w-full">
                <label htmlFor="firstName" className="block pb-2 text-sm font-medium text-gray-700">
                  First Name
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="firstName"
                  placeholder="First Name"
                  type="text"
                  {...methods.register('firstName', { required: true })}
                />
              </div>
              <div className="w-full">
                <label htmlFor="lastName" className="block pb-2 text-sm font-medium text-gray-700">
                  Last Name
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="lastName"
                  placeholder="Last Name"
                  type="text"
                  {...methods.register('lastName', { required: true })}
                />
              </div>
              {error && (
                <div className="w-full text-red-600 text-sm text-center">
                  {error}
                </div>
              )}
              <div className="w-full mt-4">
                <Button variant="primary" buttonDisabled={loading} type="submit">
                  {loading ? <LoadingSpinner /> : 'Register'}
                </Button>
              </div>
              <div className="w-full mt-4 text-center">
                <p className="text-sm text-gray-600">
                  Already have an account?{' '}
                  <Link href="/login" className="text-black font-semibold hover:underline">
                    Log In
                  </Link>
                </p>
              </div>
            </div>
          </form>
        </FormProvider>
      </div>
    </section>
  );
};
export default UserRegistration;
````

## File: src/components/User/withAuth.component.tsx
````typescript
import { useRouter } from 'next/router';
import { useEffect, ComponentType, useState } from 'react';
import { useQuery } from '@apollo/client';
import { GET_CURRENT_USER } from '../../utils/gql/GQL_QUERIES';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
// eslint-disable-next-line @typescript-eslint/no-explicit-any
function withAuth<P = any>(WrappedComponent: ComponentType<P>) {
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  const Wrapper = (props: any) => {
    const router = useRouter();
    const [hasRedirected, setHasRedirected] = useState(false);
    const [isMounted, setIsMounted] = useState(false);
    // Ensure we're mounted on the client side
    useEffect(() => {
      setIsMounted(true);
    }, []);
    // Use network-only to always check server-side authentication
    // This prevents showing stale cached data after logout
    // Only run query on client side after mounting
    const isClient = typeof window !== 'undefined';
    const { data, loading, error, refetch } = useQuery(GET_CURRENT_USER, {
      errorPolicy: 'all',
      fetchPolicy: 'network-only', // Always fetch from network, never use cache
      notifyOnNetworkStatusChange: false, // Don't trigger loading state on network updates
      skip: !isClient || !isMounted, // Skip query during SSR and until mounted
      // Removed onCompleted and onError - using useEffect instead for logging
    });
    // Debug logging
    useEffect(() => {
      if (isMounted) {
        console.log('[withAuth] State:', {
          isMounted,
          loading,
          hasData: !!data,
          hasCustomer: !!data?.customer,
          customerId: data?.customer?.id,
          customerEmail: data?.customer?.email,
          hasError: !!error,
          errorMessage: error?.message,
          hasRedirected,
          currentPath: typeof window !== 'undefined' ? window.location.pathname : 'N/A',
          query: typeof window !== 'undefined' ? window.location.search : 'N/A',
        });
        if (error) {
          console.error('[withAuth] Query error details:', {
            message: error.message,
            graphQLErrors: error.graphQLErrors,
            networkError: error.networkError,
          });
        }
      }
    }, [isMounted, loading, data, error, hasRedirected]);
    useEffect(() => {
      // Only check once we're mounted on the client and have a definitive answer
      // Add a small delay to allow cookies to propagate after login
      if (isMounted && !loading && !hasRedirected) {
        console.log('[withAuth] Checking authentication status...');
        // If there's an error or no customer data, user is not authenticated
        // But wait a bit longer if we just came from login (check URL params)
        const isFromLogin = typeof window !== 'undefined' && 
          (window.location.search.includes('login=success') || 
           document.referrer.includes('/login'));
        console.log('[withAuth] Auth check:', {
          hasError: !!error,
          hasCustomer: !!data?.customer,
          isFromLogin,
          referrer: typeof window !== 'undefined' ? document.referrer : 'N/A',
          search: typeof window !== 'undefined' ? window.location.search : 'N/A',
        });
        if (error || !data?.customer) {
          console.log('[withAuth] User not authenticated');
          // If we just came from login, give it a moment for cookies to set
          if (isFromLogin && !hasRedirected) {
            console.log('[withAuth] Coming from login, waiting 500ms before retry...');
            const timeoutId = setTimeout(() => {
              console.log('[withAuth] Retrying user query...');
              // Retry the query once more
              refetch().then(({ data: retryData, error: retryError }) => {
                console.log('[withAuth] Retry result:', {
                  hasCustomer: !!retryData?.customer,
                  customerId: retryData?.customer?.id,
                  error: retryError,
                });
                if (!retryData?.customer && !hasRedirected) {
                  console.log('[withAuth] Still no customer after retry, redirecting to login');
                  setHasRedirected(true);
                  router.replace('/login');
                } else if (retryData?.customer) {
                  console.log('[withAuth] Customer found after retry, authentication successful');
                }
              }).catch((retryErr) => {
                console.error('[withAuth] Retry error:', retryErr);
                if (!hasRedirected) {
                  setHasRedirected(true);
                  router.replace('/login');
                }
              });
            }, 500);
            return () => clearTimeout(timeoutId);
          } else if (!isFromLogin) {
            console.log('[withAuth] Not from login, redirecting to login page');
            setHasRedirected(true);
            router.replace('/login');
          }
          return;
        } else {
          console.log('[withAuth] User authenticated, allowing access');
        }
      }
    }, [data, loading, error, router, hasRedirected, isMounted, refetch]);
    // Show loading during SSR or initial load
    if (!isMounted || loading) {
      return (
        <div className="flex justify-center items-center min-h-screen">
          <LoadingSpinner />
        </div>
      );
    }
    // If we've redirected or no customer data, don't render (show nothing)
    // Also check for error to prevent showing content when not authenticated
    if (hasRedirected || !data?.customer || error) {
      return null;
    }
    return <WrappedComponent {...props} />;
  };
  return Wrapper;
}
export default withAuth;
````

## File: src/hooks/useProductFilters.ts
````typescript
import { useState } from 'react';
import { Product, ProductType } from '@/types/product';
import { getUniqueProductTypes } from '@/utils/functions/productUtils';
export const useProductFilters = (products: Product[]) => {
  // Calculate dynamic price range from actual products
  const calculatePriceRange = (products: Product[]): [number, number] => {
    if (!products || products.length === 0) return [0, 1000];
    const prices = products
      .map((product) => {
        if (!product.price) return null;
        const price = parseFloat(product.price.replace(/[^0-9.]/g, ''));
        return isNaN(price) ? null : price;
      })
      .filter((price): price is number => price !== null);
    if (prices.length === 0) return [0, 1000];
    const minPrice = Math.floor(Math.min(...prices));
    const maxPrice = Math.ceil(Math.max(...prices));
    // Add 10% padding to the max price for better UX
    return [0, Math.max(1000, maxPrice * 1.1)];
  };
  const [sortBy, setSortBy] = useState('popular');
  const [selectedSizes, setSelectedSizes] = useState<string[]>([]);
  const [selectedColors, setSelectedColors] = useState<string[]>([]);
  const [priceRange, setPriceRange] = useState<[number, number]>(() =>
    calculatePriceRange(products)
  );
  const [productTypes, setProductTypes] = useState<ProductType[]>(() =>
    products ? getUniqueProductTypes(products) : [],
  );
  const toggleProductType = (id: string) => {
    setProductTypes((prev) =>
      prev.map((type) =>
        type.id === id ? { ...type, checked: !type.checked } : type,
      ),
    );
  };
  const resetFilters = () => {
    setSelectedSizes([]);
    setSelectedColors([]);
    setPriceRange(calculatePriceRange(products));
    setProductTypes((prev) =>
      prev.map((type) => ({ ...type, checked: false })),
    );
  };
  const filterProducts = (products: Product[]) => {
    const filtered = products?.filter((product: Product) => {
      // Filter by price - skip products with null/undefined prices
      if (!product.price) return false;
      const productPrice = parseFloat(product.price.replace(/[^0-9.]/g, ''));
      if (isNaN(productPrice)) return false;
      const withinPriceRange =
        productPrice >= priceRange[0] && productPrice <= priceRange[1];
      if (!withinPriceRange) return false;
      // Filter by product type
      const selectedTypes = productTypes
        .filter((t) => t.checked)
        .map((t) => t.name.toLowerCase());
      if (selectedTypes.length > 0) {
        const productCategories =
          product.productCategories?.nodes.map((cat) =>
            cat.name.toLowerCase(),
          ) || [];
        if (!selectedTypes.some((type) => productCategories.includes(type)))
          return false;
      }
      // Filter by size
      if (selectedSizes.length > 0) {
        const productSizes =
          product.allPaSizes?.nodes.map((node) => node.name) || [];
        if (!selectedSizes.some((size) => productSizes.includes(size)))
          return false;
      }
      // Filter by color
      if (selectedColors.length > 0) {
        const productColors =
          product.allPaColors?.nodes.map((node) => node.name) || [];
        if (!selectedColors.some((color) => productColors.includes(color)))
          return false;
      }
      return true;
    });
    // Sort products
    return [...(filtered || [])].sort((a, b) => {
      // Handle null/undefined prices
      const priceAStr = a.price || '0';
      const priceBStr = b.price || '0';
      const priceA = parseFloat(priceAStr.replace(/[^0-9.]/g, '')) || 0;
      const priceB = parseFloat(priceBStr.replace(/[^0-9.]/g, '')) || 0;
      switch (sortBy) {
        case 'price-low':
          return priceA - priceB;
        case 'price-high':
          return priceB - priceA;
        case 'newest':
          return b.databaseId - a.databaseId;
        default: // 'popular'
          return 0;
      }
    });
  };
  return {
    sortBy,
    setSortBy,
    selectedSizes,
    setSelectedSizes,
    selectedColors,
    setSelectedColors,
    priceRange,
    setPriceRange,
    productTypes,
    toggleProductType,
    resetFilters,
    filterProducts,
  };
};
````

## File: src/lib/fonts.ts
````typescript
import { Chakra_Petch, Gilda_Display, Space_Mono } from "next/font/google"
export const chakraPetch = Chakra_Petch({
  subsets: ["latin"],
  weight: ["300", "400", "500", "600", "700"],
  variable: "--font-chakra-petch",
})
export const gildaDisplay = Gilda_Display({
  subsets: ["latin"],
  weight: ["400"],
  variable: "--font-gilda-display",
})
export const spaceMono = Space_Mono({
  subsets: ["latin"],
  weight: ["400", "700"],
  variable: "--font-space-mono",
})
````

## File: src/pages/account/account-details.tsx
````typescript
import dynamic from 'next/dynamic';
import Layout from '@/components/Layout/Layout.component';
import AccountNavigation from '@/components/User/AccountNavigation.component';
import AccountDetails from '@/components/User/AccountDetails.component';
import withAuth from '@/components/User/withAuth.component';
import type { NextPage } from 'next';
const AccountDetailsPage: NextPage = () => {
  return (
    <Layout title="Account details">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <h1 className="text-3xl font-bold mb-8">My account</h1>
        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
          {/* Left Navigation */}
          <div className="lg:col-span-1">
            <AccountNavigation activeEndpoint="edit-account" />
          </div>
          {/* Main Content */}
          <div className="lg:col-span-3">
            <AccountDetails />
          </div>
        </div>
      </div>
    </Layout>
  );
};
// Disable SSR to prevent issues with authentication hooks
const AuthenticatedPage = dynamic(
  () => Promise.resolve(withAuth(AccountDetailsPage)),
  {
    ssr: false,
    loading: () => (
      <div className="flex justify-center items-center min-h-screen">
        <div>Loading...</div>
      </div>
    ),
  }
);
export default AuthenticatedPage;
````

## File: src/pages/account/addresses.tsx
````typescript
import dynamic from 'next/dynamic';
import Layout from '@/components/Layout/Layout.component';
import AccountNavigation from '@/components/User/AccountNavigation.component';
import AccountAddresses from '@/components/User/AccountAddresses.component';
import withAuth from '@/components/User/withAuth.component';
import type { NextPage } from 'next';
const AccountAddressesPage: NextPage = () => {
  return (
    <Layout title="Addresses">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <h1 className="text-3xl font-bold mb-8">My account</h1>
        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
          {/* Left Navigation */}
          <div className="lg:col-span-1">
            <AccountNavigation activeEndpoint="edit-address" />
          </div>
          {/* Main Content */}
          <div className="lg:col-span-3">
            <AccountAddresses />
          </div>
        </div>
      </div>
    </Layout>
  );
};
// Disable SSR to prevent issues with authentication hooks
const AuthenticatedPage = dynamic(
  () => Promise.resolve(withAuth(AccountAddressesPage)),
  {
    ssr: false,
    loading: () => (
      <div className="flex justify-center items-center min-h-screen">
        <div>Loading...</div>
      </div>
    ),
  }
);
export default AuthenticatedPage;
````

## File: src/pages/account/downloads.tsx
````typescript
import dynamic from 'next/dynamic';
import Layout from '@/components/Layout/Layout.component';
import AccountNavigation from '@/components/User/AccountNavigation.component';
import AccountDownloads from '@/components/User/AccountDownloads.component';
import withAuth from '@/components/User/withAuth.component';
import type { NextPage } from 'next';
const AccountDownloadsPage: NextPage = () => {
  return (
    <Layout title="Downloads">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <h1 className="text-3xl font-bold mb-8">My account</h1>
        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
          {/* Left Navigation */}
          <div className="lg:col-span-1">
            <AccountNavigation activeEndpoint="downloads" />
          </div>
          {/* Main Content */}
          <div className="lg:col-span-3">
            <AccountDownloads />
          </div>
        </div>
      </div>
    </Layout>
  );
};
// Disable SSR to prevent issues with authentication hooks
const AuthenticatedPage = dynamic(
  () => Promise.resolve(withAuth(AccountDownloadsPage)),
  {
    ssr: false,
    loading: () => (
      <div className="flex justify-center items-center min-h-screen">
        <div>Loading...</div>
      </div>
    ),
  }
);
export default AuthenticatedPage;
````

## File: src/pages/account/orders.tsx
````typescript
import dynamic from 'next/dynamic';
import Layout from '@/components/Layout/Layout.component';
import AccountNavigation from '@/components/User/AccountNavigation.component';
import AccountOrders from '@/components/User/AccountOrders.component';
import withAuth from '@/components/User/withAuth.component';
import type { NextPage } from 'next';
const AccountOrdersPage: NextPage = () => {
  return (
    <Layout title="Orders">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <h1 className="text-3xl font-bold mb-8">My account</h1>
        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
          {/* Left Navigation */}
          <div className="lg:col-span-1">
            <AccountNavigation activeEndpoint="orders" />
          </div>
          {/* Main Content */}
          <div className="lg:col-span-3">
            <AccountOrders />
          </div>
        </div>
      </div>
    </Layout>
  );
};
// Disable SSR to prevent issues with authentication hooks
const AuthenticatedPage = dynamic(
  () => Promise.resolve(withAuth(AccountOrdersPage)),
  {
    ssr: false,
    loading: () => (
      <div className="flex justify-center items-center min-h-screen">
        <div>Loading...</div>
      </div>
    ),
  }
);
export default AuthenticatedPage;
````

## File: src/pages/account/payment-methods.tsx
````typescript
import dynamic from 'next/dynamic';
import Layout from '@/components/Layout/Layout.component';
import AccountNavigation from '@/components/User/AccountNavigation.component';
import AccountPaymentMethods from '@/components/User/AccountPaymentMethods.component';
import withAuth from '@/components/User/withAuth.component';
import type { NextPage } from 'next';
const AccountPaymentMethodsPage: NextPage = () => {
  return (
    <Layout title="Payment methods">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <h1 className="text-3xl font-bold mb-8">My account</h1>
        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
          {/* Left Navigation */}
          <div className="lg:col-span-1">
            <AccountNavigation activeEndpoint="payment-methods" />
          </div>
          {/* Main Content */}
          <div className="lg:col-span-3">
            <AccountPaymentMethods />
          </div>
        </div>
      </div>
    </Layout>
  );
};
// Disable SSR to prevent issues with authentication hooks
const AuthenticatedPage = dynamic(
  () => Promise.resolve(withAuth(AccountPaymentMethodsPage)),
  {
    ssr: false,
    loading: () => (
      <div className="flex justify-center items-center min-h-screen">
        <div>Loading...</div>
      </div>
    ),
  }
);
export default AuthenticatedPage;
````

## File: src/pages/api/faust/[[...route]].js
````javascript
import '../../../faust.config.js';
import { apiRouter } from '@faustwp/core';
export default apiRouter;
````

## File: src/pages/articles/[slug].tsx
````typescript
import type {
  NextPage,
  GetStaticProps,
  GetStaticPaths,
  InferGetStaticPropsType,
} from 'next';
import Head from 'next/head';
import Image from 'next/image';
import Link from 'next/link';
import { useState } from 'react';
import Layout from '@/components/Layout/Layout.component';
import BlockRenderer from '@/components/Blocks/BlockRenderer.component';
import client from '@/utils/apollo/ApolloClient';
import {
  GET_POST_BY_SLUG,
  GET_ALL_POST_SLUGS,
} from '@/utils/gql/GQL_QUERIES';
interface Post {
  id: string;
  databaseId: number;
  title: string;
  slug: string;
  content: string;
  excerpt: string;
  date: string;
  editorBlocks?: any[];
  author: {
    node: {
      name: string;
    };
  };
  featuredImage: {
    node: {
      sourceUrl: string;
      altText: string;
      mediaDetails: {
        width: number;
        height: number;
      };
    } | null;
  } | null;
  categories: {
    nodes: Array<{
      name: string;
      slug: string;
    }>;
  };
  tags: {
    nodes: Array<{
      name: string;
      slug: string;
    }>;
  };
}
interface PostPageProps {
  post: Post | null;
  error?: string;
}
const ArticlePost: NextPage<PostPageProps> = ({
  post,
  error,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  const [imageError, setImageError] = useState(false);
  if (error || !post) {
    return (
      <Layout title="Post Not Found">
        <div className="min-h-screen bg-white">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
            <div className="text-center">
              <h1 className="text-4xl font-bold text-gray-900 mb-4">
                Post Not Found
              </h1>
              <p className="text-gray-600 mb-8">{error || 'The post you are looking for does not exist.'}</p>
              <Link
                href="/articles"
                className="inline-block px-6 py-3 bg-black text-white rounded-full hover:bg-gray-800 transition-colors"
              >
                 Back to Articles
              </Link>
            </div>
          </div>
        </div>
      </Layout>
    );
  }
  // Strip HTML from excerpt for subtitle
  const cleanExcerpt = post.excerpt
    ? post.excerpt.replace(/<[^>]*>/g, '').trim()
    : '';
  return (
    <Layout title={post.title}>
      <Head>
        <title>{post.title} | Articles | Molecule</title>
        <meta
          name="description"
          content={cleanExcerpt || 'Article from Molecule'}
        />
      </Head>
      <div className="min-h-screen bg-white">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
          <Link
            href="/articles"
            className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-8 transition-colors"
          >
            <svg
              className="w-5 h-5 mr-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2}
                d="M15 19l-7-7 7-7"
              />
            </svg>
            Back to Articles
          </Link>
          <article>
            {/* Tags */}
            {post.tags?.nodes && post.tags.nodes.length > 0 && (
              <div className="flex flex-wrap gap-2 mb-4">
                {post.tags.nodes.map((tag) => (
                  <span
                    key={tag.slug}
                    className="text-xs px-3 py-1 bg-gray-100 text-gray-700 rounded-full"
                  >
                    {tag.name}
                  </span>
                ))}
              </div>
            )}
            {/* Title */}
            <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
              {post.title}
            </h1>
            {/* Byline */}
            <div className="flex items-center gap-4 text-sm text-gray-600 mb-6">
              {post.author?.node?.name && (
                <span className="font-medium text-gray-900">
                  By {post.author.node.name}
                </span>
              )}
              {post.date && (
                <span className="text-gray-500">
                  {new Date(post.date).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                  })}
                </span>
              )}
            </div>
            {/* Subtitle/Excerpt */}
            {cleanExcerpt && (
              <p className="text-xl text-gray-600 mb-8">{cleanExcerpt}</p>
            )}
            {/* Featured Image */}
            {post.featuredImage?.node?.sourceUrl && !imageError && (
              <div className="relative w-full h-64 md:h-96 mb-8 rounded-2xl overflow-hidden bg-gray-100">
                <Image
                  src={post.featuredImage.node.sourceUrl}
                  alt={post.featuredImage.node.altText || post.title}
                  fill
                  className="object-cover rounded-2xl"
                  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 800px"
                  style={{
                    objectFit: 'cover',
                  }}
                  onError={() => setImageError(true)}
                  unoptimized={
                    post.featuredImage.node.sourceUrl.includes('localhost') ||
                    post.featuredImage.node.sourceUrl.includes('127.0.0.1')
                  }
                />
              </div>
            )}
            {/* Content */}
            <BlockRenderer 
              editorBlocks={post.editorBlocks}
              fallbackContent={post.content}
            />
          </article>
        </div>
      </div>
    </Layout>
  );
};
export const getStaticPaths: GetStaticPaths = async () => {
  try {
    const { data } = await client.query({
      query: GET_ALL_POST_SLUGS,
    });
    const paths =
      data.posts?.nodes?.map((post: { slug: string }) => ({
        params: { slug: post.slug },
      })) || [];
    return {
      paths,
      fallback: 'blocking', // Generate pages on-demand if not found
    };
  } catch (error) {
    console.error('Error fetching post slugs:', error);
    return {
      paths: [],
      fallback: 'blocking',
    };
  }
};
export const getStaticProps: GetStaticProps = async ({ params }) => {
  try {
    const slug = params?.slug as string;
    if (!slug) {
      return {
        props: {
          post: null,
          error: 'Post slug is required',
        },
      };
    }
    const { data } = await client.query({
      query: GET_POST_BY_SLUG,
      variables: { slug },
    });
    if (!data.post) {
      return {
        props: {
          post: null,
          error: 'Post not found',
        },
        notFound: true,
      };
    }
    return {
      props: {
        post: data.post,
        error: null,
      },
      revalidate: 60, // Revalidate every 60 seconds
    };
  } catch (error: any) {
    console.error('Error fetching post:', error);
    return {
      props: {
        post: null,
        error: error.message || 'Failed to fetch post',
      },
    };
  }
};
export default ArticlePost;
````

## File: src/pages/category/[slug].tsx
````typescript
import { withRouter } from 'next/router';
// Components
import Layout from '@/components/Layout/Layout.component';
import DisplayProducts from '@/components/Product/DisplayProducts.component';
import client from '@/utils/apollo/ApolloClient';
import { GET_PRODUCTS_FROM_CATEGORY } from '@/utils/gql/GQL_QUERIES';
import { GetServerSideProps, InferGetServerSidePropsType } from 'next';
/**
 * Display products from a category with dynamic pretty urls
 */
const CategoryPage = ({
  categoryName,
  products,
}: InferGetServerSidePropsType<typeof getServerSideProps>) => {
  return (
    <Layout title={`${categoryName ? categoryName : ''}`}>
      {products ? (
        <DisplayProducts products={products} />
      ) : (
        <div className="mt-8 text-2xl text-center">Loading products...</div>
      )}
    </Layout>
  );
};
export default withRouter(CategoryPage);
export const getServerSideProps: GetServerSideProps = async ({
  query: { id },
}) => {
  const res = await client.query({
    query: GET_PRODUCTS_FROM_CATEGORY,
    variables: { id },
  });
  return {
    props: {
      categoryName: res.data.productCategory.name,
      products: res.data.productCategory.products.nodes,
    },
  };
};
````

## File: src/pages/kategori/[slug].tsx
````typescript
import { GetServerSideProps } from 'next';
/**
 * Redirect from Norwegian slug /kategori/[slug] to English /category/[slug]
 * Maintains backward compatibility for old links
 */
export const getServerSideProps: GetServerSideProps = async ({
  params,
  query,
  res,
}) => {
  const slug = params?.slug;
  const id = query.id;
  if (slug) {
    // If there's an ID query param, include it in the redirect
    const redirectUrl = id ? `/category/${slug}?id=${id}` : `/category/${slug}`;
    res.setHeader('Location', redirectUrl);
    res.statusCode = 301;
    res.end();
  }
  return { props: {} };
};
// This component will never render due to the redirect
export default function KategoriRedirect() {
  return null;
}
````

## File: src/pages/pages/[slug].tsx
````typescript
import type {
  NextPage,
  GetStaticProps,
  GetStaticPaths,
  InferGetStaticPropsType,
} from 'next';
import Head from 'next/head';
import Image from 'next/image';
import { useState } from 'react';
import Layout from '@/components/Layout/Layout.component';
import BlockRenderer from '@/components/Blocks/BlockRenderer.component';
import client from '@/utils/apollo/ApolloClient';
import {
  GET_PAGE_BY_SLUG,
  GET_ALL_PAGE_SLUGS,
} from '@/utils/gql/GQL_QUERIES';
interface Page {
  id: string;
  databaseId: number;
  title: string;
  slug: string;
  content: string;
  date: string;
  editorBlocks?: any[];
  featuredImage: {
    node: {
      sourceUrl: string;
      altText: string;
      mediaDetails: {
        width: number;
        height: number;
      };
    } | null;
  } | null;
}
interface PageProps {
  page: Page | null;
  error?: string;
}
const DynamicPage: NextPage<PageProps> = ({
  page,
  error,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  const [imageError, setImageError] = useState(false);
  if (error || !page) {
    return (
      <Layout title="Page Not Found">
        <div className="min-h-screen bg-white">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
            <div className="text-center">
              <h1 className="text-4xl font-bold text-gray-900 mb-4">
                Page Not Found
              </h1>
              <p className="text-gray-600 mb-8">{error || 'The page you are looking for does not exist.'}</p>
            </div>
          </div>
        </div>
      </Layout>
    );
  }
  return (
    <Layout title={page.title}>
      <Head>
        <title>{page.title} | NW</title>
        <meta
          name="description"
          content={`${page.title} page`}
        />
      </Head>
      <div className="min-h-screen bg-white">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
          <article>
            {/* Title */}
            <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-8">
              {page.title}
            </h1>
            {/* Featured Image */}
            {page.featuredImage?.node?.sourceUrl && !imageError && (
              <div className="relative w-full h-64 md:h-96 mb-8 rounded-2xl overflow-hidden bg-gray-100">
                <Image
                  src={page.featuredImage.node.sourceUrl}
                  alt={page.featuredImage.node.altText || page.title}
                  fill
                  className="object-cover rounded-2xl"
                  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 800px"
                  style={{
                    objectFit: 'cover',
                  }}
                  onError={() => setImageError(true)}
                  unoptimized={
                    page.featuredImage.node.sourceUrl.includes('localhost') ||
                    page.featuredImage.node.sourceUrl.includes('127.0.0.1')
                  }
                />
              </div>
            )}
            {/* Content */}
            <BlockRenderer 
              editorBlocks={page.editorBlocks}
              fallbackContent={page.content}
            />
          </article>
        </div>
      </div>
    </Layout>
  );
};
export const getStaticPaths: GetStaticPaths = async () => {
  try {
    const { data } = await client.query({
      query: GET_ALL_PAGE_SLUGS,
    });
    const paths =
      data.pages?.nodes?.map((page: { slug: string }) => ({
        params: { slug: page.slug },
      })) || [];
    return {
      paths,
      fallback: 'blocking', // Generate pages on-demand if not found
    };
  } catch (error) {
    console.error('Error fetching page slugs:', error);
    return {
      paths: [],
      fallback: 'blocking',
    };
  }
};
export const getStaticProps: GetStaticProps = async ({ params }) => {
  try {
    const slug = params?.slug as string;
    if (!slug) {
      return {
        props: {
          page: null,
          error: 'Page slug is required',
        },
      };
    }
    // WordPress pages use URI format, typically just the slug for root-level pages
    const uri = `/${slug}/`;
    const { data } = await client.query({
      query: GET_PAGE_BY_SLUG,
      variables: { uri },
    });
    if (!data.pageBy) {
      return {
        props: {
          page: null,
          error: 'Page not found',
        },
        notFound: true,
      };
    }
    return {
      props: {
        page: data.pageBy,
        error: null,
      },
      revalidate: 60, // Revalidate every 60 seconds
    };
  } catch (error: any) {
    console.error('Error fetching page:', error);
    return {
      props: {
        page: null,
        error: error.message || 'Failed to fetch page',
      },
    };
  }
};
export default DynamicPage;
````

## File: src/pages/pages/about-us.tsx
````typescript
import type { NextPage } from 'next';
import Head from 'next/head';
import Layout from '@/components/Layout/Layout.component';
const AboutUs: NextPage = () => {
  return (
    <>
      <Head>
        <title>About Us | Molecule</title>
        <meta
          name="description"
          content="Learn about Molecule - your trusted source for quality products and exceptional service."
        />
      </Head>
      <Layout title="About Us">
        <div className="min-h-screen bg-white">
          <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
            <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-8">
              About Us
            </h1>
            <div className="prose prose-lg max-w-none">
              <p className="text-lg text-gray-700 leading-relaxed mb-6">
                Molecule is a trusted online retailer committed to providing quality products and exceptional 
                customer service. We carefully curate our selection to offer products that meet high standards 
                of quality, reliability, and value.
              </p>
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                Our Mission
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-6">
                Our mission is to provide customers with access to quality products at competitive prices, 
                backed by outstanding customer service. We understand the importance of reliability and 
                customer satisfaction, and we are dedicated to ensuring that every purchase meets your 
                expectations.
              </p>
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                Quality Assurance
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-6">
                We work with trusted suppliers and manufacturers to ensure all products meet our quality 
                standards. Our team carefully reviews products before adding them to our catalog, and we 
                stand behind everything we sell.
              </p>
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                Customer Focus
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-6">
                Your satisfaction is our priority. We're committed to providing a seamless shopping 
                experience, from browsing our catalog to receiving your order. Our customer support team 
                is here to help with any questions or concerns you may have.
              </p>
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                Fast Shipping
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-6">
                We ship from our warehouse facilities, ensuring fast delivery times and secure packaging. 
                Our professional packaging and tracking updates ensure your orders arrive safely and on time.
              </p>
            </div>
          </div>
        </div>
      </Layout>
    </>
  );
};
export default AboutUs;
````

## File: src/pages/pages/components.tsx
````typescript
import type { NextPage } from 'next';
import Head from 'next/head';
import { useState } from 'react';
import Layout from '@/components/Layout/Layout.component';
import Button from '@/components/UI/Button.component';
import Checkbox from '@/components/UI/Checkbox.component';
import Logo from '@/components/UI/Logo.component';
import Hero from '@/components/Index/Hero.component';
import HomeFAQ from '@/components/Index/HomeFAQ.component';
import ImageBanner from '@/components/Index/ImageBanner.component';
import TextSection from '@/components/Index/TextSection.component';
import FeaturesList from '@/components/Index/FeaturesList.component';
import ProductCarousel from '@/components/Index/ProductCarousel.component';
import LoadingSpinner from '@/components/LoadingSpinner/LoadingSpinner.component';
const Components: NextPage = () => {
  const [checkboxState, setCheckboxState] = useState({
    option1: false,
    option2: true,
    option3: false,
  });
  const handleCheckboxChange = (id: string) => (e: React.ChangeEvent<HTMLInputElement>) => {
    setCheckboxState((prev) => ({ ...prev, [id]: e.target.checked }));
  };
  return (
    <>
      <Head>
        <title>Components | Molecule</title>
        <meta
          name="description"
          content="Browse our component library and design system showcase."
        />
      </Head>
      <Layout title="Components">
        <div className="min-h-screen bg-white">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
            {/* Header */}
            <div className="mb-16">
              <h1 className="text-5xl md:text-6xl font-bold text-gray-900 mb-6">
                Component Library
              </h1>
              <p className="text-xl text-gray-600 max-w-3xl">
                Explore our design system components, UI elements, and page sections. 
                All components are built with accessibility, responsiveness, and reusability in mind.
              </p>
            </div>
            {/* Logo */}
            <section className="mb-16 pb-16 border-b border-gray-200">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Logo</h2>
              <div className="bg-gray-50 p-8 rounded-2xl">
                <Logo className="h-12 w-auto" />
              </div>
            </section>
            {/* Buttons */}
            <section className="mb-16 pb-16 border-b border-gray-200">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Buttons</h2>
              <div className="space-y-6">
                <div>
                  <h3 className="text-lg font-semibold text-gray-700 mb-4">Primary</h3>
                  <div className="flex flex-wrap gap-4">
                    <Button variant="primary">Primary Button</Button>
                    <Button variant="primary" buttonDisabled>Disabled</Button>
                  </div>
                </div>
                <div>
                  <h3 className="text-lg font-semibold text-gray-700 mb-4">Secondary</h3>
                  <div className="flex flex-wrap gap-4">
                    <Button variant="secondary">Secondary Button</Button>
                  </div>
                </div>
                <div>
                  <h3 className="text-lg font-semibold text-gray-700 mb-4">Hero</h3>
                  <div className="flex flex-wrap gap-4">
                    <Button variant="hero">Hero Button</Button>
                  </div>
                </div>
                <div>
                  <h3 className="text-lg font-semibold text-gray-700 mb-4">Filter</h3>
                  <div className="flex flex-wrap gap-4">
                    <Button variant="filter">Filter Button</Button>
                    <Button variant="filter" selected>Selected Filter</Button>
                  </div>
                </div>
                <div>
                  <h3 className="text-lg font-semibold text-gray-700 mb-4">Danger</h3>
                  <div className="flex flex-wrap gap-4">
                    <Button variant="danger">Danger Button</Button>
                  </div>
                </div>
              </div>
            </section>
            {/* Form Elements */}
            <section className="mb-16 pb-16 border-b border-gray-200">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Form Elements</h2>
              <div className="space-y-6">
                <div>
                  <h3 className="text-lg font-semibold text-gray-700 mb-4">Input Fields</h3>
                  <div className="max-w-md space-y-4">
                    <div>
                      <label htmlFor="email-demo" className="block text-sm text-gray-600 mb-1">
                        Email Address
                      </label>
                      <input
                        id="email-demo"
                        type="email"
                        placeholder="Enter your email"
                        className="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-2 focus:ring-black focus:border-black block w-full px-3 py-2 placeholder-gray-400"
                      />
                    </div>
                    <div>
                      <label htmlFor="password-demo" className="block text-sm text-gray-600 mb-1">
                        Password
                      </label>
                      <input
                        id="password-demo"
                        type="password"
                        placeholder="Enter your password"
                        className="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-2 focus:ring-black focus:border-black block w-full px-3 py-2 placeholder-gray-400"
                      />
                    </div>
                  </div>
                </div>
                <div>
                  <h3 className="text-lg font-semibold text-gray-700 mb-4">Checkboxes</h3>
                  <div className="space-y-2">
                    <Checkbox
                      id="option1"
                      label="Option 1"
                      checked={checkboxState.option1}
                      onChange={handleCheckboxChange('option1')}
                    />
                    <Checkbox
                      id="option2"
                      label="Option 2 (Checked)"
                      checked={checkboxState.option2}
                      onChange={handleCheckboxChange('option2')}
                    />
                    <Checkbox
                      id="option3"
                      label="Option 3"
                      checked={checkboxState.option3}
                      onChange={handleCheckboxChange('option3')}
                    />
                  </div>
                </div>
              </div>
            </section>
            {/* Loading States */}
            <section className="mb-16 pb-16 border-b border-gray-200">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Loading States</h2>
              <div className="bg-gray-50 p-8 rounded-2xl">
                <LoadingSpinner />
              </div>
            </section>
            {/* Typography */}
            <section className="mb-16 pb-16 border-b border-gray-200">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Typography</h2>
              <div className="space-y-6">
                <div>
                  <h1 className="text-5xl font-bold text-gray-900 mb-2">Heading 1</h1>
                  <p className="text-sm text-gray-500">text-5xl font-bold</p>
                </div>
                <div>
                  <h2 className="text-4xl font-bold text-gray-900 mb-2">Heading 2</h2>
                  <p className="text-sm text-gray-500">text-4xl font-bold</p>
                </div>
                <div>
                  <h3 className="text-3xl font-bold text-gray-900 mb-2">Heading 3</h3>
                  <p className="text-sm text-gray-500">text-3xl font-bold</p>
                </div>
                <div>
                  <h4 className="text-2xl font-semibold text-gray-900 mb-2">Heading 4</h4>
                  <p className="text-sm text-gray-500">text-2xl font-semibold</p>
                </div>
                <div>
                  <p className="text-lg text-gray-700 mb-2">
                    Body Large - Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                  </p>
                  <p className="text-sm text-gray-500">text-lg text-gray-700</p>
                </div>
                <div>
                  <p className="text-base text-gray-700 mb-2">
                    Body - Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                  </p>
                  <p className="text-sm text-gray-500">text-base text-gray-700</p>
                </div>
                <div>
                  <p className="text-sm text-gray-600 mb-2">
                    Small - Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                  </p>
                  <p className="text-sm text-gray-500">text-sm text-gray-600</p>
                </div>
              </div>
            </section>
            {/* Colors */}
            <section className="mb-16 pb-16 border-b border-gray-200">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Color Palette</h2>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div>
                  <div className="h-24 bg-black rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">Black</p>
                  <p className="text-xs text-gray-500">bg-black</p>
                </div>
                <div>
                  <div className="h-24 bg-gray-900 rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">Gray 900</p>
                  <p className="text-xs text-gray-500">bg-gray-900</p>
                </div>
                <div>
                  <div className="h-24 bg-gray-700 rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">Gray 700</p>
                  <p className="text-xs text-gray-500">bg-gray-700</p>
                </div>
                <div>
                  <div className="h-24 bg-gray-600 rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">Gray 600</p>
                  <p className="text-xs text-gray-500">bg-gray-600</p>
                </div>
                <div>
                  <div className="h-24 bg-gray-200 rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">Gray 200</p>
                  <p className="text-xs text-gray-500">bg-gray-200</p>
                </div>
                <div>
                  <div className="h-24 bg-gray-100 rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">Gray 100</p>
                  <p className="text-xs text-gray-500">bg-gray-100</p>
                </div>
                <div>
                  <div className="h-24 bg-gray-50 rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">Gray 50</p>
                  <p className="text-xs text-gray-500">bg-gray-50</p>
                </div>
                <div>
                  <div className="h-24 bg-white border-2 border-gray-200 rounded-lg mb-2"></div>
                  <p className="text-sm font-semibold">White</p>
                  <p className="text-xs text-gray-500">bg-white</p>
                </div>
              </div>
            </section>
            {/* Page Sections */}
            <section className="mb-16 pb-16 border-b border-gray-200">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Page Sections</h2>
              <div className="space-y-12">
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 mb-4">Hero Section</h3>
                  <div className="border border-gray-200 rounded-2xl overflow-hidden">
                    <Hero />
                  </div>
                </div>
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 mb-4">Image Banner</h3>
                  <div className="border border-gray-200 rounded-2xl overflow-hidden">
                    <ImageBanner />
                  </div>
                </div>
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 mb-4">Text Section</h3>
                  <div className="border border-gray-200 rounded-2xl overflow-hidden">
                    <TextSection />
                  </div>
                </div>
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 mb-4">Features List</h3>
                  <div className="border border-gray-200 rounded-2xl overflow-hidden">
                    <FeaturesList />
                  </div>
                </div>
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 mb-4">FAQ Section</h3>
                  <div className="border border-gray-200 rounded-2xl overflow-hidden">
                    <HomeFAQ />
                  </div>
                </div>
              </div>
            </section>
            {/* Spacing */}
            <section className="mb-16">
              <h2 className="text-3xl font-bold text-gray-900 mb-8">Spacing Scale</h2>
              <div className="space-y-4">
                {[1, 2, 3, 4, 6, 8, 12, 16, 24].map((size) => (
                  <div key={size} className="flex items-center gap-4">
                    <div className="w-24 text-sm text-gray-600">p-{size}</div>
                    <div className={`bg-gray-200 h-8`} style={{ width: `${size * 0.25}rem` }}></div>
                    <div className="text-xs text-gray-500">{size * 0.25}rem / {size * 4}px</div>
                  </div>
                ))}
              </div>
            </section>
          </div>
        </div>
      </Layout>
    </>
  );
};
export default Components;
````

## File: src/pages/pages/contact.tsx
````typescript
import type { NextPage } from 'next';
import Head from 'next/head';
import Layout from '@/components/Layout/Layout.component';
const Contact: NextPage = () => {
  return (
    <>
      <Head>
        <title>Contact Us | Molecule</title>
        <meta
          name="description"
          content="Get in touch with Molecule for questions about our products, bulk orders, or customer support."
        />
      </Head>
      <Layout title="Contact Us">
        <div className="min-h-screen bg-white">
          <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
            <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-8">
              Contact Us
            </h1>
            <div className="prose prose-lg max-w-none">
              <p className="text-lg text-gray-700 leading-relaxed mb-8">
                Have questions about our products, need assistance with an order, or interested in bulk pricing? 
                We're here to help. Reach out to us through any of the following methods:
              </p>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-8 mt-12">
                <div className="p-6 bg-gray-50 rounded-lg">
                  <h2 className="text-xl font-semibold text-gray-900 mb-4">
                    General Inquiries
                  </h2>
                  <p className="text-gray-700 mb-2">
                    For general questions about our products or services:
                  </p>
                  <a
                    href="mailto:hello@example.com"
                    className="text-gray-900 font-medium hover:text-gray-700 underline"
                  >
                    hello@example.com
                  </a>
                </div>
                <div className="p-6 bg-gray-50 rounded-lg">
                  <h2 className="text-xl font-semibold text-gray-900 mb-4">
                    Bulk Orders
                  </h2>
                  <p className="text-gray-700 mb-2">
                    For bulk inquiries and volume pricing:
                  </p>
                  <a
                    href="mailto:sales@example.com"
                    className="text-gray-900 font-medium hover:text-gray-700 underline"
                  >
                    sales@example.com
                  </a>
                </div>
                <div className="p-6 bg-gray-50 rounded-lg">
                  <h2 className="text-xl font-semibold text-gray-900 mb-4">
                    Customer Support
                  </h2>
                  <p className="text-gray-700 mb-2">
                    For order questions or support:
                  </p>
                  <a
                    href="mailto:support@example.com"
                    className="text-gray-900 font-medium hover:text-gray-700 underline"
                  >
                    support@example.com
                  </a>
                </div>
                <div className="p-6 bg-gray-50 rounded-lg">
                  <h2 className="text-xl font-semibold text-gray-900 mb-4">
                    Business Hours
                  </h2>
                  <p className="text-gray-700">
                    Monday - Friday: 9:00 AM - 5:00 PM EST
                    <br />
                    Saturday - Sunday: Closed
                  </p>
                </div>
              </div>
              <div className="mt-12 p-6 bg-gray-50 rounded-lg">
                <h2 className="text-xl font-semibold text-gray-900 mb-4">
                  Response Time
                </h2>
                <p className="text-gray-700">
                  We typically respond to all inquiries within 24-48 hours during business days. 
                  For urgent matters, please indicate "URGENT" in your subject line.
                </p>
              </div>
            </div>
          </div>
        </div>
      </Layout>
    </>
  );
};
export default Contact;
````

## File: src/pages/pages/privacy-policy.tsx
````typescript
import type { NextPage } from 'next';
import Head from 'next/head';
import Layout from '@/components/Layout/Layout.component';
const PrivacyPolicy: NextPage = () => {
  return (
    <Layout title="Privacy Policy">
      <Head>
        <title>Privacy Policy | Molecule</title>
        <meta
          name="description"
          content="Read the Privacy Policy for Molecule - how we collect, use, and protect your personal information."
        />
      </Head>
      <div className="min-h-screen bg-white">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
          <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-8">
            Privacy Policy
          </h1>
          <div className="prose prose-lg max-w-none">
            <p className="text-sm text-gray-600 mb-8">
              Last updated:{' '}
              {new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
              })}
            </p>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                1. Information We Collect
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We collect information that you provide directly to us,
                including:
              </p>
              <ul className="list-disc pl-6 text-lg text-gray-700 leading-relaxed space-y-2">
                <li>Name, email address, and contact information</li>
                <li>Shipping and billing addresses</li>
                <li>
                  Payment information (processed securely through our payment
                  processor)
                </li>
                <li>Order history and preferences</li>
                <li>Communications with our customer support team</li>
              </ul>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                2. How We Use Your Information
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We use the information we collect to:
              </p>
              <ul className="list-disc pl-6 text-lg text-gray-700 leading-relaxed space-y-2">
                <li>Process and fulfill your orders</li>
                <li>Send you order confirmations and shipping updates</li>
                <li>Respond to your inquiries and provide customer support</li>
                <li>Improve our website and services</li>
                <li>Comply with legal obligations</li>
                <li>
                  Send you marketing communications (only with your consent)
                </li>
              </ul>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                3. Information Sharing
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We do not sell, trade, or rent your personal information to
                third parties. We may share your information only in the
                following circumstances:
              </p>
              <ul className="list-disc pl-6 text-lg text-gray-700 leading-relaxed space-y-2">
                <li>
                  With service providers who assist us in operating our website
                  and conducting our business
                </li>
                <li>With shipping carriers to deliver your orders</li>
                <li>With payment processors to process your transactions</li>
                <li>When required by law or to protect our rights</li>
              </ul>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                4. Data Security
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We implement appropriate security measures to protect your
                personal information against unauthorized access, alteration,
                disclosure, or destruction. However, no method of transmission
                over the Internet or electronic storage is 100% secure, and we
                cannot guarantee absolute security.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                5. Cookies and Tracking
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We use cookies and similar tracking technologies to enhance your
                browsing experience, analyze site traffic, and understand where
                our visitors are coming from. You can control cookie preferences
                through your browser settings.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                6. Your Rights
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                You have the right to:
              </p>
              <ul className="list-disc pl-6 text-lg text-gray-700 leading-relaxed space-y-2">
                <li>Access the personal information we hold about you</li>
                <li>Request correction of inaccurate information</li>
                <li>Request deletion of your personal information</li>
                <li>Opt-out of marketing communications</li>
                <li>Request a copy of your data</li>
              </ul>
              <p className="text-lg text-gray-700 leading-relaxed mt-4">
                To exercise these rights, please contact us at{' '}
                <a
                  href="mailto:privacy@molecule.com"
                  className="text-gray-900 font-medium hover:text-gray-700 underline"
                >
                  privacy@molecule.com
                </a>
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                7. Children's Privacy
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                Our services are not intended for individuals under the age of
                21. We do not knowingly collect personal information from
                children. If you believe we have collected information from a
                child, please contact us immediately.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                8. Changes to This Policy
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We may update this Privacy Policy from time to time. We will
                notify you of any changes by posting the new Privacy Policy on
                this page and updating the "Last updated" date.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                9. Contact Us
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                If you have any questions about this Privacy Policy, please
                contact us at{' '}
                <a
                  href="mailto:privacy@molecule.com"
                  className="text-gray-900 font-medium hover:text-gray-700 underline"
                >
                  privacy@molecule.com
                </a>
              </p>
            </section>
          </div>
        </div>
      </div>
    </Layout>
  );
};
export default PrivacyPolicy;
````

## File: src/pages/pages/returns-and-refunds.tsx
````typescript
import type { NextPage } from 'next';
import Head from 'next/head';
import Layout from '@/components/Layout/Layout.component';
const ReturnsAndRefunds: NextPage = () => {
  return (
    <Layout title="Returns & Refunds">
      <Head>
        <title>Returns & Refunds | Molecule</title>
        <meta
          name="description"
          content="Learn about Molecule's returns and refunds policy."
        />
      </Head>
      <div className="min-h-screen bg-white">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
          <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-8">
            Returns & Refunds
          </h1>
          <div className="prose prose-lg max-w-none">
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                Returns Policy
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We want you to be completely satisfied with your purchase. If you're
                not happy with your order, please contact us within 30 days of receipt.
                Some items may be non-returnable due to their nature (e.g., personalized
                items, perishables, or items that cannot be resold). If your order arrives
                with missing, incorrect, or damaged items, we are here to help. Please
                email{' '}
                <a
                  href="mailto:support@molecule.com"
                  className="text-gray-900 font-medium hover:text-gray-700 underline"
                >
                  support@molecule.com
                </a>{' '}
                for assistance.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                Cancellations
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                Cancellations must be requested by email before the order has
                shipped. Once the order has shipped, cancellations are no longer
                possible. If you need to cancel your order, please contact us at{' '}
                <a
                  href="mailto:support@molecule.com"
                  className="text-gray-900 font-medium hover:text-gray-700 underline"
                >
                  support@molecule.com
                </a>{' '}
                as soon as possible.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                Customer Support
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                Our customer support team is dedicated to ensuring your
                satisfaction with our product quality, delivery, and service.
                If you have any questions or concerns about your order, please
                don't hesitate to reach out to us at{' '}
                <a
                  href="mailto:support@molecule.com"
                  className="text-gray-900 font-medium hover:text-gray-700 underline"
                >
                  support@molecule.com
                </a>
                .
              </p>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We will do our best to assist you quickly and satisfactorily.
                Thank you for choosing Molecule.
              </p>
            </section>
          </div>
        </div>
      </div>
    </Layout>
  );
};
export default ReturnsAndRefunds;
````

## File: src/pages/pages/terms-of-service.tsx
````typescript
import type { NextPage } from 'next';
import Head from 'next/head';
import Layout from '@/components/Layout/Layout.component';
const TermsOfService: NextPage = () => {
  return (
    <Layout title="Terms of Service">
      <Head>
        <title>Terms of Service | Molecule</title>
        <meta
          name="description"
          content="Read the Terms of Service for Molecule - your trusted online retailer."
        />
      </Head>
      <div className="min-h-screen bg-white">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
          <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-8">
            Terms of Service
          </h1>
          <div className="prose prose-lg max-w-none">
            <p className="text-sm text-gray-600 mb-8">
              Last updated:{' '}
              {new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
              })}
            </p>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                1. Acceptance of Terms
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                By accessing and using the Molecule website and purchasing
                products, you accept and agree to be bound by the terms and
                provision of this agreement. If you do not agree to abide by the
                above, please do not use this service.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                2. Product Usage
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                All products are sold for their intended use as described in product
                listings. Please refer to product documentation for specific usage
                instructions, safety information, and recommended applications. By
                purchasing our products, you acknowledge and agree that:
              </p>
              <ul className="list-disc pl-6 text-lg text-gray-700 leading-relaxed space-y-2">
                <li>
                  You will use products according to their intended purpose and
                  manufacturer guidelines
                </li>
                <li>
                  You will follow all safety instructions and warnings provided
                  with products
                </li>
                <li>
                  You understand that product descriptions and images are for
                  informational purposes
                </li>
                <li>
                  You will comply with all applicable federal, state, and local
                  regulations regarding product use
                </li>
              </ul>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                3. Product Information
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                We strive to provide accurate product information, but we cannot
                guarantee that all information is complete, current, or error-free.
                Product images are for illustrative purposes and may not reflect the
                exact appearance of the product. The buyer assumes responsibility
                for reviewing product specifications before purchase.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                4. Order Acceptance and Payment
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                All orders are subject to acceptance by Molecule. We reserve the
                right to refuse or cancel any order for any reason, including
                but not limited to product availability, errors in pricing, or
                suspected fraudulent activity. Payment must be completed within
                48 hours of order placement. Unpaid orders will be automatically
                canceled.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                5. Return and Refund Policy
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                Please refer to our Returns & Refunds policy for detailed information
                about returns, exchanges, and refunds. Some products may be
                non-returnable due to their nature. If you have questions about your
                order, please contact our customer support team.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                6. Limitation of Liability
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                Molecule shall not be liable for any indirect, incidental,
                special, consequential, or punitive damages resulting from the
                use or inability to use our products. Our liability is limited to
                the purchase price of the product.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                7. Compliance with Laws
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                The buyer is responsible for knowing and complying with all
                applicable federal, state, and local laws and regulations
                regarding the purchase, possession, and use of products. Some
                products may be restricted in certain jurisdictions.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                8. Changes to Terms
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                Molecule reserves the right to modify these terms at any time.
                Your continued use of the website and services after any changes
                constitutes acceptance of the new terms.
              </p>
            </section>
            <section className="mb-12">
              <h2 className="text-2xl md:text-3xl font-bold text-gray-900 mt-12 mb-6">
                9. Contact Information
              </h2>
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                If you have any questions about these Terms of Service, please
                contact us at{' '}
                <a
                  href="mailto:hello@molecule.com"
                  className="text-gray-900 font-medium hover:text-gray-700 underline"
                >
                  hello@molecule.com
                </a>
              </p>
            </section>
          </div>
        </div>
      </div>
    </Layout>
  );
};
export default TermsOfService;
````

## File: src/pages/product/[slug].tsx
````typescript
// Imports
import { withRouter } from 'next/router';
// Components
import SingleProduct from '@/components/Product/SingleProduct.component';
import Layout from '@/components/Layout/Layout.component';
// Utilities
import client from '@/utils/apollo/ApolloClient';
// Types
import type {
  NextPage,
  GetServerSideProps,
  InferGetServerSidePropsType,
} from 'next';
// GraphQL
import { GET_SINGLE_PRODUCT } from '@/utils/gql/GQL_QUERIES';
/**
 * Display a single product with dynamic pretty urls
 * @function Product
 * @param {InferGetServerSidePropsType<typeof getServerSideProps>} product
 * @returns {JSX.Element} - Rendered component
 */
const Product: NextPage = ({
  product,
  networkStatus,
}: InferGetServerSidePropsType<typeof getServerSideProps>) => {
  const hasError = networkStatus === '8';
  return (
    <Layout title={`${product.name ? product.name : ''}`}>
      {product ? (
        <SingleProduct product={product} />
      ) : (
        <div className="mt-8 text-2xl text-center">Loading product...</div>
      )}
      {hasError && (
        <div className="mt-8 text-2xl text-center">
          Error loading product...
        </div>
      )}
    </Layout>
  );
};
export default withRouter(Product);
export const getServerSideProps: GetServerSideProps = async ({
  params,
  query,
  res,
}) => {
  // Handle legacy URLs with ID parameter by removing it
  if (query.id) {
    res.setHeader('Location', `/product/${params?.slug}`);
    res.statusCode = 301;
    res.end();
    return { props: {} };
  }
  const { data, loading, networkStatus } = await client.query({
    query: GET_SINGLE_PRODUCT,
    variables: { slug: params?.slug },
  });
  return {
    props: { product: data.product, loading, networkStatus },
  };
};
````

## File: src/pages/produkt/[slug].tsx
````typescript
import { GetServerSideProps } from 'next';
/**
 * Redirect from Norwegian slug /produkt/[slug] to English /product/[slug]
 * Maintains backward compatibility for old links
 */
export const getServerSideProps: GetServerSideProps = async ({
  params,
  res,
}) => {
  const slug = params?.slug;
  if (slug) {
    res.setHeader('Location', `/product/${slug}`);
    res.statusCode = 301;
    res.end();
  }
  return { props: {} };
};
// This component will never render due to the redirect
export default function ProduktRedirect() {
  return null;
}
````

## File: src/pages/_app.tsx
````typescript
// Imports
import Router from 'next/router';
import NProgress from 'nprogress';
import { ApolloProvider } from '@apollo/client';
import { useRouter } from 'next/router';
import { FaustProvider } from '@faustwp/core';
import { WordPressBlocksProvider } from '@faustwp/blocks';
import client from '@/utils/apollo/ApolloClient';
import CartInitializer from '@/components/Cart/CartInitializer.component';
import AgeVerificationModal from '@/components/Layout/AgeVerificationModal.component';
import '../faust.config.js';
import blocks from '../wp-blocks';
// Types
import type { AppProps } from 'next/app';
// Styles
import '@/styles/globals.css';
import '@/styles/wp-blocks.css';
import 'nprogress/nprogress.css';
// NProgress
Router.events.on('routeChangeStart', () => NProgress.start());
Router.events.on('routeChangeComplete', () => NProgress.done());
Router.events.on('routeChangeError', () => NProgress.done());
function MyApp({ Component, pageProps }: AppProps) {
  const router = useRouter();
  return (
    <FaustProvider pageProps={pageProps}>
      <WordPressBlocksProvider
        config={{
          blocks,
        }}
      >
        <ApolloProvider client={client}>
          <CartInitializer />
          <Component {...pageProps} key={router.asPath} />
          <AgeVerificationModal />
        </ApolloProvider>
      </WordPressBlocksProvider>
    </FaustProvider>
  );
}
export default MyApp;
````

## File: src/pages/_document.tsx
````typescript
import { Html, Head, Main, NextScript } from 'next/document';
import { chakraPetch, gildaDisplay, spaceMono } from '@/lib/fonts';
export default function Document() {
  return (
    <Html lang="en" className={`${chakraPetch.variable} ${gildaDisplay.variable} ${spaceMono.variable}`}>
      <Head>
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <body>
        <Main />
        <NextScript />
      </body>
    </Html>
  );
}
````

## File: src/pages/[...slug].tsx
````typescript
import type {
  NextPage,
  GetStaticProps,
  GetStaticPaths,
  InferGetStaticPropsType,
} from 'next';
import Head from 'next/head';
import Image from 'next/image';
import { useState } from 'react';
import { useRouter } from 'next/router';
import { flatListToHierarchical } from '@faustwp/core';
import { WordPressBlocksViewer } from '@faustwp/blocks';
import Layout from '@/components/Layout/Layout.component';
import client from '@/utils/apollo/ApolloClient';
import {
  GET_PAGE_BY_SLUG,
  GET_ALL_PAGE_SLUGS,
} from '@/utils/gql/GQL_QUERIES';
interface Page {
  id: string;
  databaseId: number;
  title: string;
  slug: string;
  content: string;
  date: string;
  editorBlocks?: any[];
  featuredImage: {
    node: {
      sourceUrl: string;
      altText: string;
      mediaDetails: {
        width: number;
        height: number;
      };
    } | null;
  } | null;
}
interface PageProps {
  page: Page | null;
  error?: string;
}
const DynamicPage: NextPage<PageProps> = ({
  page,
  error,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  const router = useRouter();
  const [imageError, setImageError] = useState(false);
  // If this is a known route, let Next.js handle it
  const slug = router.query.slug as string[];
  const path = slug ? `/${slug.join('/')}` : '';
  // Known routes that should not be handled here
  const knownRoutes = [
    '/catalog',
    '/cart',
    '/checkout',
    '/account',
    '/login',
    '/articles',
    '/categories',
    '/category',
    '/product',
  ];
  if (knownRoutes.some(route => path.startsWith(route))) {
    return null;
  }
  if (error || !page) {
    return (
      <Layout title="Page Not Found">
        <div className="min-h-screen bg-white">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
            <div className="text-center">
              <h1 className="text-4xl font-bold text-gray-900 mb-4">
                Page Not Found
              </h1>
              <p className="text-gray-600 mb-8">{error || 'The page you are looking for does not exist.'}</p>
            </div>
          </div>
        </div>
      </Layout>
    );
  }
  return (
    <Layout title={page.title}>
      <Head>
        <title>{page.title} | NW</title>
        <meta
          name="description"
          content={`${page.title} page`}
        />
      </Head>
      <div className="min-h-screen bg-white">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
          <article>
            {/* Title */}
            <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-8">
              {page.title}
            </h1>
            {/* Featured Image */}
            {page.featuredImage?.node?.sourceUrl && !imageError && (
              <div className="relative w-full h-64 md:h-96 mb-8 rounded-2xl overflow-hidden bg-gray-100">
                <Image
                  src={page.featuredImage.node.sourceUrl}
                  alt={page.featuredImage.node.altText || page.title}
                  fill
                  className="object-cover rounded-2xl"
                  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 800px"
                  style={{
                    objectFit: 'cover',
                  }}
                  onError={() => setImageError(true)}
                  unoptimized={
                    page.featuredImage.node.sourceUrl.includes('localhost') ||
                    page.featuredImage.node.sourceUrl.includes('127.0.0.1')
                  }
                />
              </div>
            )}
            {/* Content */}
            {page.editorBlocks && page.editorBlocks.length > 0 ? (
              <WordPressBlocksViewer 
                blocks={flatListToHierarchical(page.editorBlocks, {
                  childrenKey: 'innerBlocks',
                })} 
              />
            ) : (
              <div
                className="prose prose-lg max-w-none product-detail-content"
                dangerouslySetInnerHTML={{ __html: page.content }}
              />
            )}
          </article>
        </div>
      </div>
    </Layout>
  );
};
export const getStaticPaths: GetStaticPaths = async () => {
  try {
    const { data } = await client.query({
      query: GET_ALL_PAGE_SLUGS,
    });
    const paths =
      data.pages?.nodes?.map((page: { slug: string }) => ({
        params: { slug: [page.slug] },
      })) || [];
    return {
      paths,
      fallback: 'blocking', // Generate pages on-demand if not found
    };
  } catch (error) {
    console.error('Error fetching page slugs:', error);
    return {
      paths: [],
      fallback: 'blocking',
    };
  }
};
export const getStaticProps: GetStaticProps = async ({ params }) => {
  try {
    const slugArray = params?.slug as string[];
    const slug = slugArray ? slugArray.join('/') : '';
    if (!slug) {
      return {
        props: {
          page: null,
          error: 'Page slug is required',
        },
      };
    }
    // WordPress pages use URI format
    const uri = `/${slug}/`;
    const { data } = await client.query({
      query: GET_PAGE_BY_SLUG,
      variables: { uri },
    });
    if (!data.pageBy) {
      return {
        props: {
          page: null,
          error: 'Page not found',
        },
        notFound: true,
      };
    }
    // Fix image URLs in editorBlocks
    const wordpressUrl = process.env.NEXT_PUBLIC_WORDPRESS_URL || 'http://localhost:8080';
    const fixedPage = {
      ...data.pageBy,
      editorBlocks: data.pageBy.editorBlocks?.map((block: any) => {
        // Fix renderedHtml URLs
        if (block.renderedHtml) {
          let fixedHtml = block.renderedHtml;
          // Fix malformed URLs like http://localhost:3000:8080
          fixedHtml = fixedHtml.replace(/http:\/\/localhost:3000:8080/g, wordpressUrl);
          // Fix relative URLs in src attributes
          fixedHtml = fixedHtml.replace(/src="\/([^"]+)"/g, `src="${wordpressUrl}/$1"`);
          // Fix URLs that incorrectly use localhost:3000
          fixedHtml = fixedHtml.replace(/src="http:\/\/localhost:3000\/([^"]+)"/g, `src="${wordpressUrl}/$1"`);
          return { ...block, renderedHtml: fixedHtml };
        }
        // Fix attributes URLs
        if (block.attributes) {
          const fixedAttrs = { ...block.attributes };
          if (fixedAttrs.src) {
            if (fixedAttrs.src.includes(':3000:8080')) {
              fixedAttrs.src = fixedAttrs.src.replace(':3000:8080', ':8080');
            } else if (fixedAttrs.src.startsWith('/') && !fixedAttrs.src.startsWith('//')) {
              fixedAttrs.src = `${wordpressUrl}${fixedAttrs.src}`;
            } else if (fixedAttrs.src.startsWith('http://localhost:3000')) {
              fixedAttrs.src = fixedAttrs.src.replace('http://localhost:3000', wordpressUrl);
            }
          }
          if (fixedAttrs.url) {
            if (fixedAttrs.url.includes(':3000:8080')) {
              fixedAttrs.url = fixedAttrs.url.replace(':3000:8080', ':8080');
            } else if (fixedAttrs.url.startsWith('/') && !fixedAttrs.url.startsWith('//')) {
              fixedAttrs.url = `${wordpressUrl}${fixedAttrs.url}`;
            } else if (fixedAttrs.url.startsWith('http://localhost:3000')) {
              fixedAttrs.url = fixedAttrs.url.replace('http://localhost:3000', wordpressUrl);
            }
          }
          return { ...block, attributes: fixedAttrs };
        }
        return block;
      }),
    };
    return {
      props: {
        page: fixedPage,
        error: null,
      },
      revalidate: 60, // Revalidate every 60 seconds
    };
  } catch (error: any) {
    console.error('Error fetching page:', error);
    return {
      props: {
        page: null,
        error: error.message || 'Failed to fetch page',
      },
    };
  }
};
export default DynamicPage;
````

## File: src/pages/account.tsx
````typescript
import dynamic from 'next/dynamic';
import { useRouter } from 'next/router';
import { useState, useEffect } from 'react';
import { useAuth, getApolloAuthClient } from '@faustwp/core';
import Layout from '@/components/Layout/Layout.component';
import AccountNavigation from '@/components/User/AccountNavigation.component';
import AccountDashboard from '@/components/User/AccountDashboard.component';
import AccountOrders from '@/components/User/AccountOrders.component';
import AccountDownloads from '@/components/User/AccountDownloads.component';
import AccountAddresses from '@/components/User/AccountAddresses.component';
import AccountPaymentMethods from '@/components/User/AccountPaymentMethods.component';
import AccountDetails from '@/components/User/AccountDetails.component';
import { useQuery } from '@apollo/client';
import { GET_CURRENT_USER } from '@/utils/gql/GQL_QUERIES';
import type { NextPage } from 'next';
const CustomerAccountPage: NextPage = () => {
  const router = useRouter();
  const [activeTab, setActiveTab] = useState<string>('my-details');
  // Faust.js authentication hooks
  const { isAuthenticated, isReady, loginUrl } = useAuth({
    strategy: 'local',
    loginPageUrl: '/login-faust',
    shouldRedirect: true,
  });
  // Redirect to login if not authenticated (after auth check is ready)
  useEffect(() => {
    if (isReady && !isAuthenticated && loginUrl) {
      // Store current URL for redirect after login
      if (typeof window !== 'undefined') {
        sessionStorage.setItem('loginReturnUrl', router.asPath);
      }
      router.push(loginUrl);
    }
  }, [isReady, isAuthenticated, loginUrl, router]);
  // Handle hash-based navigation
  useEffect(() => {
    // Set default hash if none exists
    if (typeof window !== 'undefined') {
      const currentHash = window.location.hash.slice(1);
      console.log('[Account] Initial hash:', currentHash);
      if (!currentHash) {
        window.history.replaceState(null, '', '/account#my-details');
        setActiveTab('my-details');
        console.log('[Account] Set default hash to my-details');
      } else {
        setActiveTab(currentHash);
        console.log('[Account] Set active tab from hash:', currentHash);
      }
    }
    // Listen for hash changes
    const handleHashChange = () => {
      const newHash = window.location.hash.slice(1);
      console.log('[Account] Hash changed to:', newHash);
      if (newHash) {
        setActiveTab(newHash);
        console.log('[Account] Active tab updated to:', newHash);
      } else {
        setActiveTab('my-details');
        console.log('[Account] Active tab reset to my-details');
      }
    };
    window.addEventListener('hashchange', handleHashChange);
    // Also listen for popstate (back/forward button)
    window.addEventListener('popstate', handleHashChange);
    return () => {
      window.removeEventListener('hashchange', handleHashChange);
      window.removeEventListener('popstate', handleHashChange);
    };
  }, []);
  // Debug: Log activeTab changes
  useEffect(() => {
    console.log('[Account] Active tab state changed to:', activeTab);
  }, [activeTab]);
  // Get user data for avatar
  const authClient = getApolloAuthClient(); // Get authenticated client
  const { data: userData } = useQuery(GET_CURRENT_USER, {
    client: authClient, // Use authenticated client
    errorPolicy: 'all',
    fetchPolicy: 'cache-and-network',
  });
  const customer = userData?.customer;
  const avatar = null; // Avatar field removed from GraphQL query
  const firstName = customer?.firstName || customer?.email || 'User';
  const renderTabContent = () => {
    switch (activeTab) {
      case 'my-details':
      case 'dashboard':
        return <AccountDashboard />;
      case 'orders':
        return <AccountOrders />;
      case 'downloads':
        return <AccountDownloads />;
      case 'addresses':
        return <AccountAddresses />;
      case 'payment-methods':
        return <AccountPaymentMethods />;
      case 'account-details':
        return <AccountDetails />;
      default:
        return <AccountDashboard />;
    }
  };
  return (
    <Layout title="My account">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <div className="flex flex-col lg:flex-row items-start justify-between w-full lg:gap-12 mb-24">
          {/* Left Sidebar */}
          <div className="mt-2 lg:sticky top-16 w-full lg:max-w-[260px]">
            {/* User Info with Avatar */}
            <section className="my-8 flex gap-4 items-start justify-center w-full">
              {avatar ? (
                <img 
                  src={avatar} 
                  className="rounded-full aspect-square border border-gray-300" 
                  alt="user-avatar" 
                  width="48" 
                  height="48" 
                />
              ) : (
                <div className="w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center">
                  <span className="text-gray-600 font-semibold text-lg">
                    {firstName.charAt(0).toUpperCase()}
                  </span>
                </div>
              )}
              <div className="flex-1 text-balance leading-tight w-full text-ellipsis overflow-hidden">
                <div className="text-lg font-semibold">Welcome, {firstName}</div>
                {customer?.email && (
                  <span className="text-gray-400 font-light text-sm" title={customer.email}>
                    {customer.email}
                  </span>
                )}
              </div>
            </section>
            <hr className="my-8" />
            {/* Navigation */}
            <AccountNavigation activeEndpoint={activeTab} />
          </div>
          {/* Main Content */}
          <main className="flex-1 w-full lg:my-8 rounded-lg max-w-screen-lg lg:sticky top-24">
            {renderTabContent()}
          </main>
        </div>
      </div>
    </Layout>
  );
};
export default CustomerAccountPage;
````

## File: src/pages/articles.tsx
````typescript
import type { NextPage, GetStaticProps, InferGetStaticPropsType } from 'next';
import Head from 'next/head';
import Layout from '@/components/Layout/Layout.component';
import client from '@/utils/apollo/ApolloClient';
import { GET_ALL_POSTS } from '@/utils/gql/GQL_QUERIES';
import ResearchPostCard from '@/components/Research/ResearchPostCard.component';
interface Post {
  id: string;
  databaseId: number;
  title: string;
  slug: string;
  excerpt: string;
  date: string;
  author: {
    node: {
      name: string;
    };
  };
  featuredImage: {
    node: {
      sourceUrl: string;
      altText: string;
      mediaDetails: {
        width: number;
        height: number;
      };
    } | null;
  } | null;
  categories: {
    nodes: Array<{
      name: string;
      slug: string;
    }>;
  };
}
interface ArticlesPageProps {
  posts: Post[];
  error?: string;
}
const Articles: NextPage<ArticlesPageProps> = ({
  posts,
  error,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  return (
    <Layout title="Articles">
      <Head>
        <title>Articles | Molecule</title>
        <meta
          name="description"
          content="Read our latest articles and product guides."
        />
      </Head>
      <div className="min-h-screen bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
          <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-12">
            Articles
          </h1>
          {error && (
            <div className="mb-8 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
              <div className="flex">
                <div className="ml-3">
                  <p className="text-sm text-yellow-700">
                    <strong>Error:</strong> {error}
                  </p>
                </div>
              </div>
            </div>
          )}
          {posts && posts.length > 0 ? (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              {posts.map((post: Post) => (
                <ResearchPostCard key={post.id} post={post} />
              ))}
            </div>
          ) : (
            <div className="text-center py-16">
              <p className="text-gray-600 text-lg">
                No articles available yet. Check back soon!
              </p>
            </div>
          )}
        </div>
      </div>
    </Layout>
  );
};
export const getStaticProps: GetStaticProps = async () => {
  try {
    const { data } = await client.query({
      query: GET_ALL_POSTS,
    });
    return {
      props: {
        posts: data.posts?.nodes || [],
        error: null,
      },
      revalidate: 60, // Revalidate every 60 seconds
    };
  } catch (error: any) {
    console.error('Error fetching posts:', error);
    return {
      props: {
        posts: [],
        error: error.message || 'Failed to fetch blog posts',
      },
      revalidate: 60,
    };
  }
};
export default Articles;
````

## File: src/pages/cart.tsx
````typescript
// Components
import CartLayout from '@/components/Layout/CartLayout.component';
import CartContents from '@/components/Cart/CartContents.component';
// Types
import type { NextPage } from 'next';
const Cart: NextPage = () => (
  <CartLayout title="Cart">
    <CartContents />
  </CartLayout>
);
export default Cart;
````

## File: src/pages/catalog.tsx
````typescript
import Head from 'next/head';
import Layout from '@/components/Layout/Layout.component';
import ProductList from '@/components/Product/ProductList.component';
import LoadingSpinner from '@/components/LoadingSpinner/LoadingSpinner.component';
import client from '@/utils/apollo/ApolloClient';
import { FETCH_ALL_PRODUCTS_QUERY } from '@/utils/gql/GQL_QUERIES';
import type { NextPage, GetStaticProps, InferGetStaticPropsType } from 'next';
const Catalog: NextPage = ({
  products,
  loading,
  error,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  // Transform WordPress products to ensure consistent format and handle null prices
  // This matches the transformation done in index.tsx for the carousel
  const transformedProducts = products?.map((product: any) => ({
    ...product,
    databaseId: product.databaseId,
    name: product.name,
    price: product.price || product.regularPrice || '',
    regularPrice: product.regularPrice || product.price || '',
    salePrice: product.salePrice,
    onSale: product.onSale || false,
    slug: product.slug,
    image: product.image,
    // Preserve other fields that ProductList might need
    productCategories: product.productCategories,
    allPaColors: product.allPaColors,
    allPaSizes: product.allPaSizes,
    variations: product.variations,
  })) || [];
  // Filter out products without prices (they can't be displayed properly)
  const productsWithPrices = transformedProducts.filter(
    (product: any) => product.price && product.price !== ''
  );
  // Debug logging in development
  if (process.env.NODE_ENV === 'development') {
    console.log('[Catalog Component] Props:', {
      originalCount: products?.length || 0,
      transformedCount: transformedProducts.length,
      productsWithPricesCount: productsWithPrices.length,
      loading,
      error,
      sampleProduct: productsWithPrices?.[0],
    });
  }
  if (loading)
    return (
      <Layout title="Products">
        <div className="flex justify-center items-center min-h-screen">
          <LoadingSpinner />
        </div>
      </Layout>
    );
  if (error) {
    return (
      <Layout title="Products">
        <div className="flex flex-col justify-center items-center min-h-screen gap-4">
          <p className="text-red-500 text-lg font-semibold">Error loading products</p>
          <p className="text-gray-600">{error}</p>
          <p className="text-sm text-gray-500">Check the console for more details</p>
        </div>
      </Layout>
    );
  }
  if (!productsWithPrices || productsWithPrices.length === 0) {
    return (
      <Layout title="Products">
        <div className="flex flex-col justify-center items-center min-h-screen gap-4">
          <p className="text-red-500 text-lg font-semibold">No products found</p>
          <p className="text-gray-600">
            {products && products.length > 0
              ? 'No products with valid prices found. Please set prices for your products in WooCommerce.'
              : 'No products are available in the catalog.'}
          </p>
          <p className="text-sm text-gray-500">
            Check: 1) Products exist in WooCommerce 2) Products are published 3) Products have prices set 4) GraphQL endpoint is accessible
          </p>
        </div>
      </Layout>
    );
  }
  return (
    <Layout title="Products">
      <Head>
        <title>Catalog | WooCommerce Next.js</title>
      </Head>
      <div className="container mx-auto px-4 py-8">
        <ProductList products={productsWithPrices} title="Products" />
      </div>
    </Layout>
  );
};
export default Catalog;
export const getStaticProps: GetStaticProps = async () => {
  try {
    console.log('[Catalog] Fetching products...');
    console.log('[Catalog] GraphQL URL:', process.env.NEXT_PUBLIC_GRAPHQL_URL);
    const { data, loading, networkStatus, error } = await client.query({
      query: FETCH_ALL_PRODUCTS_QUERY,
      errorPolicy: 'all', // Return partial data even if there are errors
    });
    console.log('[Catalog] Query response:', {
      hasData: !!data,
      productsCount: data?.products?.nodes?.length || 0,
      loading,
      networkStatus,
      error: error ? error.message : null,
    });
    if (data?.products?.nodes) {
      console.log('[Catalog] Sample product:', data.products.nodes[0]);
    }
    const products = data?.products?.nodes || [];
    if (products.length === 0) {
      console.warn('[Catalog] No products returned from GraphQL query');
      console.warn('[Catalog] Full response:', JSON.stringify(data, null, 2));
    }
    return {
      props: {
        products,
        loading,
        networkStatus,
        error: error ? error.message : null,
      },
      revalidate: 60,
    };
  } catch (error: any) {
    // Handle GraphQL errors gracefully
    console.error('[Catalog] GraphQL Error:', error);
    console.error('[Catalog] Error details:', {
      message: error?.message,
      graphQLErrors: error?.graphQLErrors,
      networkError: error?.networkError,
    });
    return {
      props: {
        products: [],
        loading: false,
        networkStatus: 8, // Error status
        error: error?.message || 'Failed to fetch products',
      },
      revalidate: 60,
    };
  }
};
````

## File: src/pages/categories.tsx
````typescript
import { NextPage, InferGetStaticPropsType, GetStaticProps } from 'next';
import Categories from '@/components/Category/Categories.component';
import Layout from '@/components/Layout/Layout.component';
import client from '@/utils/apollo/ApolloClient';
import { FETCH_ALL_CATEGORIES_QUERY } from '@/utils/gql/GQL_QUERIES';
/**
 * Category page displays all of the categories
 */
const CategoriesPage: NextPage = ({
  categories,
}: InferGetStaticPropsType<typeof getStaticProps>) => (
  <Layout title="Categories">
    {categories && <Categories categories={categories} />}
  </Layout>
);
export default CategoriesPage;
export const getStaticProps: GetStaticProps = async () => {
  try {
    const result = await client.query({
      query: FETCH_ALL_CATEGORIES_QUERY,
    });
    return {
      props: {
        categories: result.data?.productCategories?.nodes || [],
      },
      revalidate: 10,
    };
  } catch (error) {
    // Handle GraphQL errors gracefully
    console.error('GraphQL Error:', error);
    return {
      props: {
        categories: [],
      },
      revalidate: 10,
    };
  }
};
````

## File: src/pages/checkout.tsx
````typescript
// Components
import CheckoutLayout from '@/components/Layout/CheckoutLayout.component';
import CheckoutForm from '@/components/Checkout/CheckoutForm.component';
// Types
import type { NextPage } from 'next';
const Checkout: NextPage = () => (
  <CheckoutLayout title="Checkout">
    <CheckoutForm />
  </CheckoutLayout>
);
export default Checkout;
````

## File: src/pages/handlekurv.tsx
````typescript
import { useEffect } from 'react';
import { useRouter } from 'next/router';
import type { NextPage } from 'next';
/**
 * Redirect from Norwegian slug /handlekurv to English /cart
 * Maintains backward compatibility for old links
 */
const Handlekurv: NextPage = () => {
  const router = useRouter();
  useEffect(() => {
    router.replace('/cart');
  }, [router]);
  return null;
};
export default Handlekurv;
````

## File: src/pages/index.tsx
````typescript
// Components
import Hero from '@/components/Index/Hero.component';
import ImageBanner from '@/components/Index/ImageBanner.component';
import TextSection from '@/components/Index/TextSection.component';
import ProductCarousel from '@/components/Index/ProductCarousel.component';
import FeaturesList from '@/components/Index/FeaturesList.component';
import HomeFAQ from '@/components/Index/HomeFAQ.component';
import Layout from '@/components/Layout/Layout.component';
import Link from 'next/link';
// Utilities
import client from '@/utils/apollo/ApolloClient';
// Types
import type { NextPage, GetStaticProps, InferGetStaticPropsType } from 'next';
// GraphQL
import { FETCH_ALL_PRODUCTS_QUERY } from '@/utils/gql/GQL_QUERIES';
/**
 * Main index page matching Medusa design
 * @function Index
 * @param {InferGetStaticPropsType<typeof getStaticProps>} products
 * @returns {JSX.Element} - Rendered component
 */
const Index: NextPage = ({
  products,
  error,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  // Transform WordPress products to match ProductCarousel format
  const carouselProducts = products?.map((product: any) => ({
    databaseId: product.databaseId,
    name: product.name,
    price: product.price || product.regularPrice || '',
    regularPrice: product.regularPrice || product.price || '',
    salePrice: product.salePrice,
    onSale: product.onSale || false,
    slug: product.slug,
    image: product.image,
  })) || [];
  return (
    <Layout title="Home">
      <div className="min-h-screen">
        {/* Hero Section with Star Rating and CTA */}
        <Hero />
        {/* Image Banner Section */}
        <ImageBanner />
        {/* Text Section */}
        <TextSection />
        {/* Featured Products Carousel Section */}
        {carouselProducts && carouselProducts.length > 0 && (
          <section className="w-full py-12 md:py-16 bg-white">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div className="flex items-center justify-between mb-8">
                <h2 className="text-3xl md:text-4xl font-bold text-gray-900">
                  Featured Products
                </h2>
                <Link
                  href="/catalog"
                  className="text-gray-900 font-semibold hover:text-gray-700 flex items-center gap-2 transition-colors"
                >
                  <span>Shop All</span>
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 22 22"
                    fill="currentColor"
                    className="w-5 h-5"
                  >
                    <path
                      d="M5 12L18 12"
                      stroke="currentColor"
                      strokeWidth="2"
                      strokeLinecap="square"
                      strokeLinejoin="round"
                    />
                    <path
                      d="M13 6L19 12"
                      stroke="currentColor"
                      strokeWidth="2"
                      strokeLinecap="square"
                      strokeLinejoin="round"
                    />
                    <path
                      d="M13 18L19 12"
                      stroke="currentColor"
                      strokeWidth="2"
                      strokeLinecap="square"
                      strokeLinejoin="round"
                    />
                  </svg>
                </Link>
              </div>
              <ProductCarousel products={carouselProducts} />
            </div>
          </section>
        )}
        {error && (
          <div className="container mx-auto px-4 py-8">
            <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
              <div className="flex">
                <div className="ml-3">
                  <p className="text-sm text-yellow-700">
                    <strong>Backend Connection Error:</strong> {error}
                  </p>
                  <p className="text-sm text-yellow-600 mt-2">
                    To fix this, update your <code className="bg-yellow-100 px-1 rounded">.env.local</code> file with a valid WordPress GraphQL URL.
                  </p>
                </div>
              </div>
            </div>
          </div>
        )}
        {/* Features List Section */}
        <FeaturesList />
        {/* FAQ Section */}
        <HomeFAQ />
      </div>
    </Layout>
  );
};
export default Index;
export const getStaticProps: GetStaticProps = async () => {
  try {
    const { data, loading, networkStatus } = await client.query({
      query: FETCH_ALL_PRODUCTS_QUERY,
    });
    return {
      props: {
        products: data?.products?.nodes || [],
        loading,
        networkStatus,
      },
      revalidate: 60,
    };
  } catch (error: any) {
    // Handle GraphQL errors gracefully - return empty products array
    // This allows the app to render even without a backend connection
    console.error('GraphQL Error:', error);
    const errorMessage = error?.message || 'Unable to connect to WordPress backend. Please configure NEXT_PUBLIC_GRAPHQL_URL in your .env.local file.';
    return {
      props: {
        products: [],
        loading: false,
        networkStatus: 8, // Error status
        error: errorMessage,
      },
      revalidate: 60,
    };
  }
};
````

## File: src/pages/kasse.tsx
````typescript
import { useEffect } from 'react';
import { useRouter } from 'next/router';
import type { NextPage } from 'next';
/**
 * Redirect from Norwegian slug /kasse to English /checkout
 * Maintains backward compatibility for old links
 */
const Kasse: NextPage = () => {
  const router = useRouter();
  useEffect(() => {
    router.replace('/checkout');
  }, [router]);
  return null;
};
export default Kasse;
````

## File: src/pages/kategorier.tsx
````typescript
import { useEffect } from 'react';
import { useRouter } from 'next/router';
import type { NextPage } from 'next';
/**
 * Redirect from Norwegian slug /kategorier to English /categories
 * Maintains backward compatibility for old links
 */
const Kategorier: NextPage = () => {
  const router = useRouter();
  useEffect(() => {
    router.replace('/categories');
  }, [router]);
  return null;
};
export default Kategorier;
````

## File: src/pages/logg-inn.tsx
````typescript
import { useEffect } from 'react';
import { useRouter } from 'next/router';
import type { NextPage } from 'next';
/**
 * Redirect from Norwegian slug /logg-inn to English /login
 * Maintains backward compatibility for old links
 */
const LoggInn: NextPage = () => {
  const router = useRouter();
  useEffect(() => {
    router.replace('/login');
  }, [router]);
  return null;
};
export default LoggInn;
````

## File: src/pages/login-faust.tsx
````typescript
import { useState, useEffect } from 'react';
import { useRouter } from 'next/router';
import { useLogin } from '@faustwp/core';
import Layout from '@/components/Layout/Layout.component';
import Button from '@/components/UI/Button.component';
import LoadingSpinner from '@/components/LoadingSpinner/LoadingSpinner.component';
import Link from 'next/link';
import type { NextPage } from 'next';
/**
 * Login page using Faust.js authentication
 */
const LoginFaustPage: NextPage = () => {
  const router = useRouter();
  const { login, loading, data, error } = useLogin();
  const [usernameEmail, setUsernameEmail] = useState('');
  const [password, setPassword] = useState('');
  const [errorMessage, setErrorMessage] = useState<string | null>(null);
  // Handle login response
  useEffect(() => {
    if (data?.generateAuthorizationCode) {
      if (data.generateAuthorizationCode.error) {
        setErrorMessage(data.generateAuthorizationCode.error);
      } else if (data.generateAuthorizationCode.code) {
        // Login successful - redirect will be handled by useLogin hook
        const returnUrl = typeof window !== 'undefined' 
          ? sessionStorage.getItem('loginReturnUrl') 
          : null;
        if (returnUrl && returnUrl !== '/login-faust' && returnUrl !== '/account') {
          if (typeof window !== 'undefined') {
            sessionStorage.removeItem('loginReturnUrl');
          }
          login(usernameEmail, password, `${returnUrl}?login=success`);
        } else {
          login(usernameEmail, password, '/account?login=success');
        }
      }
    }
  }, [data, usernameEmail, password, login]);
  // Handle Apollo errors
  useEffect(() => {
    if (error) {
      setErrorMessage(error.message || 'An error occurred during login');
    }
  }, [error]);
  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    setErrorMessage(null);
    if (!usernameEmail || !password) {
      setErrorMessage('Please enter both username/email and password');
      return;
    }
    // Get return URL from query or session storage
    const returnUrl = router.query.redirect_uri as string || 
      (typeof window !== 'undefined' ? sessionStorage.getItem('loginReturnUrl') : null) ||
      '/account';
    login(usernameEmail, password, returnUrl);
  };
  return (
    <Layout title="Log In">
      <section className="text-gray-700 container p-4 py-2 mx-auto mb-[8rem] md:mb-0">
        <div className="mx-auto lg:w-1/2">
          <h1 className="text-3xl font-bold text-gray-900 mb-8 text-center">
            Log In
          </h1>
          <form onSubmit={handleSubmit}>
            <div className="flex flex-col gap-4">
              <div className="w-full">
                <label htmlFor="usernameEmail" className="block pb-2 text-sm font-medium text-gray-700">
                  Username or email
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="usernameEmail"
                  placeholder="Username or email"
                  type="text"
                  value={usernameEmail}
                  onChange={(e) => setUsernameEmail(e.target.value)}
                  required
                  disabled={loading}
                />
              </div>
              <div className="w-full">
                <label htmlFor="password" className="block pb-2 text-sm font-medium text-gray-700">
                  Password
                </label>
                <input
                  className="bg-white border border-gray-300 text-gray-900 text-sm rounded-md focus:ring-2 focus:ring-black focus:border-black block w-full p-2.5 placeholder-gray-400"
                  id="password"
                  placeholder="Password"
                  type="password"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  required
                  disabled={loading}
                />
              </div>
              {errorMessage && (
                <div className="w-full text-red-600 text-sm text-center">
                  {errorMessage}
                </div>
              )}
              <div className="w-full mt-4">
                <Button variant="primary" buttonDisabled={loading} type="submit">
                  {loading ? <LoadingSpinner /> : 'Log In'}
                </Button>
              </div>
              <div className="w-full mt-4 text-center">
                <p className="text-sm text-gray-600">
                  Don't have an account?{' '}
                  <Link href="/register" className="text-black font-semibold hover:underline">
                    Create Account
                  </Link>
                </p>
              </div>
            </div>
          </form>
        </div>
      </section>
    </Layout>
  );
};
export default LoginFaustPage;
````

## File: src/pages/login.tsx
````typescript
import Layout from '@/components/Layout/Layout.component';
import UserLogin from '@/components/User/UserLogin.component';
import type { NextPage } from 'next';
const LoginPage: NextPage = () => {
  return (
    <Layout title="Log In">
      <div className="container mx-auto px-4 py-8">
        <UserLogin />
      </div>
    </Layout>
  );
};
export default LoginPage;
````

## File: src/pages/min-konto.tsx
````typescript
import { useEffect } from 'react';
import { useRouter } from 'next/router';
import type { NextPage } from 'next';
/**
 * Redirect from Norwegian slug /min-konto to English /account
 * Maintains backward compatibility for old links
 */
const MinKonto: NextPage = () => {
  const router = useRouter();
  useEffect(() => {
    router.replace('/account');
  }, [router]);
  return null;
};
export default MinKonto;
````

## File: src/pages/produkter.tsx
````typescript
import { useEffect } from 'react';
import { useRouter } from 'next/router';
import type { NextPage } from 'next';
/**
 * Redirect from Norwegian slug /produkter to English /catalog
 * Maintains backward compatibility for old links
 */
const Produkter: NextPage = () => {
  const router = useRouter();
  useEffect(() => {
    router.replace('/catalog');
  }, [router]);
  return null;
};
export default Produkter;
````

## File: src/pages/register.tsx
````typescript
import Layout from '@/components/Layout/Layout.component';
import UserRegistration from '@/components/User/UserRegistration.component';
import type { NextPage } from 'next';
const RegisterPage: NextPage = () => {
  return (
    <Layout title="Create Account">
      <div className="container mx-auto px-4 py-8">
        <UserRegistration />
      </div>
    </Layout>
  );
};
export default RegisterPage;
````

## File: src/stores/cartStore.ts
````typescript
import { create } from 'zustand';
import { persist } from 'zustand/middleware';
interface Image {
  sourceUrl?: string;
  srcSet?: string;
  title: string;
}
export interface Product {
  cartKey: string;
  name: string;
  qty: number;
  price: number;
  totalPrice: string;
  image: Image;
  productId: number;
}
interface CartState {
  cart: {
    products: Product[];
    totalProductsCount: number;
    totalProductsPrice: number;
  } | null;
  isLoading: boolean;
  setCart: (cart: CartState['cart']) => void;
  updateCart: (newCart: NonNullable<CartState['cart']>) => void;
  syncWithWooCommerce: (cart: NonNullable<CartState['cart']>) => void;
  clearWooCommerceSession: () => void;
}
export const useCartStore = create<CartState>()(
  persist(
    (set) => ({
      cart: null,
      isLoading: false,
      setCart: (cart) => set({ cart }),
      updateCart: (newCart) => {
        set({ cart: newCart });
        // Sync with WooCommerce
        localStorage.setItem('woocommerce-cart', JSON.stringify(newCart));
      },
      syncWithWooCommerce: (cart) => {
        set({ cart });
        localStorage.setItem('woocommerce-cart', JSON.stringify(cart));
      },
      clearWooCommerceSession: () => {
        set({ cart: null });
        localStorage.removeItem('woo-session');
        localStorage.removeItem('woocommerce-cart');
      },
    }),
    {
      name: 'cart-store',
      partialize: (state) => ({ cart: state.cart }),
    },
  ),
);
````

## File: src/styles/algolia.min.css
````css
.ais-Breadcrumb-list,.ais-CurrentRefinements-list,.ais-HierarchicalMenu-list,.ais-Hits-list,.ais-InfiniteHits-list,.ais-InfiniteResults-list,.ais-Menu-list,.ais-NumericMenu-list,.ais-Pagination-list,.ais-RatingMenu-list,.ais-RefinementList-list,.ais-Results-list,.ais-ToggleRefinement-list{margin:0;padding:0;list-style:none}.ais-ClearRefinements-button,.ais-CurrentRefinements-delete,.ais-CurrentRefinements-reset,.ais-GeoSearch-redo,.ais-GeoSearch-reset,.ais-HierarchicalMenu-showMore,.ais-InfiniteHits-loadMore,.ais-InfiniteHits-loadPrevious,.ais-InfiniteResults-loadMore,.ais-Menu-showMore,.ais-RangeInput-submit,.ais-RefinementList-showMore,.ais-SearchBox-reset,.ais-SearchBox-submit,.ais-VoiceSearch-button{padding:0;overflow:visible;font:inherit;line-height:normal;color:inherit;background:none;border:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ais-ClearRefinements-button::-moz-focus-inner,.ais-CurrentRefinements-delete::-moz-focus-inner,.ais-CurrentRefinements-reset::-moz-focus-inner,.ais-GeoSearch-redo::-moz-focus-inner,.ais-GeoSearch-reset::-moz-focus-inner,.ais-HierarchicalMenu-showMore::-moz-focus-inner,.ais-InfiniteHits-loadMore::-moz-focus-inner,.ais-InfiniteHits-loadPrevious::-moz-focus-inner,.ais-InfiniteResults-loadMore::-moz-focus-inner,.ais-Menu-showMore::-moz-focus-inner,.ais-RangeInput-submit::-moz-focus-inner,.ais-RefinementList-showMore::-moz-focus-inner,.ais-SearchBox-reset::-moz-focus-inner,.ais-SearchBox-submit::-moz-focus-inner,.ais-VoiceSearch-button::-moz-focus-inner{padding:0;border:0}.ais-ClearRefinements-button[disabled],.ais-CurrentRefinements-delete[disabled],.ais-CurrentRefinements-reset[disabled],.ais-GeoSearch-redo[disabled],.ais-GeoSearch-reset[disabled],.ais-HierarchicalMenu-showMore[disabled],.ais-InfiniteHits-loadMore[disabled],.ais-InfiniteHits-loadPrevious[disabled],.ais-InfiniteResults-loadMore[disabled],.ais-Menu-showMore[disabled],.ais-RangeInput-submit[disabled],.ais-RefinementList-showMore[disabled],.ais-SearchBox-reset[disabled],.ais-SearchBox-submit[disabled],.ais-VoiceSearch-button[disabled]{cursor:default}.ais-Breadcrumb-item,.ais-Breadcrumb-list,.ais-Pagination-list,.ais-PoweredBy,.ais-RangeInput-form,.ais-RatingMenu-link{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ais-GeoSearch,.ais-GeoSearch-map{height:100%}.ais-HierarchicalMenu-list .ais-HierarchicalMenu-list{margin-left:1em}.ais-PoweredBy-logo{display:block;height:1.2em;width:auto}.ais-RatingMenu-starIcon{display:block;width:20px;height:20px}.ais-SearchBox-input::-ms-clear,.ais-SearchBox-input::-ms-reveal{display:none;width:0;height:0}.ais-SearchBox-input::-webkit-search-cancel-button,.ais-SearchBox-input::-webkit-search-decoration,.ais-SearchBox-input::-webkit-search-results-button,.ais-SearchBox-input::-webkit-search-results-decoration{display:none}.ais-RangeSlider .rheostat{overflow:visible;margin-top:40px;margin-bottom:40px}.ais-RangeSlider .rheostat-background{height:6px;top:0;width:100%}.ais-RangeSlider .rheostat-handle{margin-left:-12px;top:-7px}.ais-RangeSlider .rheostat-background{position:relative;background-color:#fff;border:1px solid #aaa}.ais-RangeSlider .rheostat-progress{position:absolute;top:1px;height:4px;background-color:#333}.rheostat-handle{position:relative;z-index:1;width:20px;height:20px;background-color:#fff;border:1px solid #333;border-radius:50%;cursor:-webkit-grab;cursor:grab}.rheostat-marker{margin-left:-1px;position:absolute;width:1px;height:5px;background-color:#aaa}.rheostat-marker--large{height:9px}.rheostat-value{padding-top:15px}.rheostat-tooltip,.rheostat-value{margin-left:50%;position:absolute;text-align:center;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.rheostat-tooltip{top:-22px}
````

## File: src/styles/animate.min.css
````css
@charset "UTF-8";
/*!
 * animate.css - https://animate.style/
 * Version - 4.0.0
 * Licensed under the MIT license - http://opensource.org/licenses/MIT
 *
 * Copyright (c) 2020 Animate.css
 */:root{--animate-duration:1s;--animate-delay:1s;--animate-repeat:1}.animate__animated{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-duration:var(--animate-duration);animation-duration:var(--animate-duration);-webkit-animation-fill-mode:both;animation-fill-mode:both}.animate__animated.animate__infinite{-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.animate__animated.animate__repeat-1{-webkit-animation-iteration-count:1;animation-iteration-count:1;-webkit-animation-iteration-count:var(--animate-repeat);animation-iteration-count:var(--animate-repeat)}.animate__animated.animate__repeat-2{-webkit-animation-iteration-count:2;animation-iteration-count:2;-webkit-animation-iteration-count:calc(var(--animate-repeat)*2);animation-iteration-count:calc(var(--animate-repeat)*2)}.animate__animated.animate__repeat-3{-webkit-animation-iteration-count:3;animation-iteration-count:3;-webkit-animation-iteration-count:calc(var(--animate-repeat)*3);animation-iteration-count:calc(var(--animate-repeat)*3)}.animate__animated.animate__delay-1s{-webkit-animation-delay:1s;animation-delay:1s;-webkit-animation-delay:var(--animate-delay);animation-delay:var(--animate-delay)}.animate__animated.animate__delay-2s{-webkit-animation-delay:2s;animation-delay:2s;-webkit-animation-delay:calc(var(--animate-delay)*2);animation-delay:calc(var(--animate-delay)*2)}.animate__animated.animate__delay-3s{-webkit-animation-delay:3s;animation-delay:3s;-webkit-animation-delay:calc(var(--animate-delay)*3);animation-delay:calc(var(--animate-delay)*3)}.animate__animated.animate__delay-4s{-webkit-animation-delay:4s;animation-delay:4s;-webkit-animation-delay:calc(var(--animate-delay)*4);animation-delay:calc(var(--animate-delay)*4)}.animate__animated.animate__delay-5s{-webkit-animation-delay:5s;animation-delay:5s;-webkit-animation-delay:calc(var(--animate-delay)*5);animation-delay:calc(var(--animate-delay)*5)}.animate__animated.animate__faster{-webkit-animation-duration:.5s;animation-duration:.5s;-webkit-animation-duration:calc(var(--animate-duration)/2);animation-duration:calc(var(--animate-duration)/2)}.animate__animated.animate__fast{-webkit-animation-duration:.8s;animation-duration:.8s;-webkit-animation-duration:calc(var(--animate-duration)*0.8);animation-duration:calc(var(--animate-duration)*0.8)}.animate__animated.animate__slow{-webkit-animation-duration:2s;animation-duration:2s;-webkit-animation-duration:calc(var(--animate-duration)*2);animation-duration:calc(var(--animate-duration)*2)}.animate__animated.animate__slower{-webkit-animation-duration:3s;animation-duration:3s;-webkit-animation-duration:calc(var(--animate-duration)*3);animation-duration:calc(var(--animate-duration)*3)}@media (prefers-reduced-motion:reduce),print{.animate__animated{-webkit-animation-duration:1ms!important;animation-duration:1ms!important;-webkit-transition-duration:1ms!important;transition-duration:1ms!important;-webkit-animation-iteration-count:1!important;animation-iteration-count:1!important}.animate__animated[class*=Out]{opacity:0}}@-webkit-keyframes bounce{0%,20%,53%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1);-webkit-transform:translateZ(0);transform:translateZ(0)}40%,43%{-webkit-animation-timing-function:cubic-bezier(.755,.05,.855,.06);animation-timing-function:cubic-bezier(.755,.05,.855,.06);-webkit-transform:translate3d(0,-30px,0) scaleY(1.1);transform:translate3d(0,-30px,0) scaleY(1.1)}70%{-webkit-animation-timing-function:cubic-bezier(.755,.05,.855,.06);animation-timing-function:cubic-bezier(.755,.05,.855,.06);-webkit-transform:translate3d(0,-15px,0) scaleY(1.05);transform:translate3d(0,-15px,0) scaleY(1.05)}80%{-webkit-transition-timing-function:cubic-bezier(.215,.61,.355,1);transition-timing-function:cubic-bezier(.215,.61,.355,1);-webkit-transform:translateZ(0) scaleY(.95);transform:translateZ(0) scaleY(.95)}90%{-webkit-transform:translate3d(0,-4px,0) scaleY(1.02);transform:translate3d(0,-4px,0) scaleY(1.02)}}@keyframes bounce{0%,20%,53%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1);-webkit-transform:translateZ(0);transform:translateZ(0)}40%,43%{-webkit-animation-timing-function:cubic-bezier(.755,.05,.855,.06);animation-timing-function:cubic-bezier(.755,.05,.855,.06);-webkit-transform:translate3d(0,-30px,0) scaleY(1.1);transform:translate3d(0,-30px,0) scaleY(1.1)}70%{-webkit-animation-timing-function:cubic-bezier(.755,.05,.855,.06);animation-timing-function:cubic-bezier(.755,.05,.855,.06);-webkit-transform:translate3d(0,-15px,0) scaleY(1.05);transform:translate3d(0,-15px,0) scaleY(1.05)}80%{-webkit-transition-timing-function:cubic-bezier(.215,.61,.355,1);transition-timing-function:cubic-bezier(.215,.61,.355,1);-webkit-transform:translateZ(0) scaleY(.95);transform:translateZ(0) scaleY(.95)}90%{-webkit-transform:translate3d(0,-4px,0) scaleY(1.02);transform:translate3d(0,-4px,0) scaleY(1.02)}}.animate__bounce{-webkit-animation-name:bounce;animation-name:bounce;-webkit-transform-origin:center bottom;transform-origin:center bottom}@-webkit-keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}@keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}.animate__flash{-webkit-animation-name:flash;animation-name:flash}@-webkit-keyframes pulse{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}50%{-webkit-transform:scale3d(1.05,1.05,1.05);transform:scale3d(1.05,1.05,1.05)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes pulse{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}50%{-webkit-transform:scale3d(1.05,1.05,1.05);transform:scale3d(1.05,1.05,1.05)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}.animate__pulse{-webkit-animation-name:pulse;animation-name:pulse;-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}@-webkit-keyframes rubberBand{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}30%{-webkit-transform:scale3d(1.25,.75,1);transform:scale3d(1.25,.75,1)}40%{-webkit-transform:scale3d(.75,1.25,1);transform:scale3d(.75,1.25,1)}50%{-webkit-transform:scale3d(1.15,.85,1);transform:scale3d(1.15,.85,1)}65%{-webkit-transform:scale3d(.95,1.05,1);transform:scale3d(.95,1.05,1)}75%{-webkit-transform:scale3d(1.05,.95,1);transform:scale3d(1.05,.95,1)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes rubberBand{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}30%{-webkit-transform:scale3d(1.25,.75,1);transform:scale3d(1.25,.75,1)}40%{-webkit-transform:scale3d(.75,1.25,1);transform:scale3d(.75,1.25,1)}50%{-webkit-transform:scale3d(1.15,.85,1);transform:scale3d(1.15,.85,1)}65%{-webkit-transform:scale3d(.95,1.05,1);transform:scale3d(.95,1.05,1)}75%{-webkit-transform:scale3d(1.05,.95,1);transform:scale3d(1.05,.95,1)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}.animate__rubberBand{-webkit-animation-name:rubberBand;animation-name:rubberBand}@-webkit-keyframes shakeX{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(-10px,0,0);transform:translate3d(-10px,0,0)}20%,40%,60%,80%{-webkit-transform:translate3d(10px,0,0);transform:translate3d(10px,0,0)}}@keyframes shakeX{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(-10px,0,0);transform:translate3d(-10px,0,0)}20%,40%,60%,80%{-webkit-transform:translate3d(10px,0,0);transform:translate3d(10px,0,0)}}.animate__shakeX{-webkit-animation-name:shakeX;animation-name:shakeX}@-webkit-keyframes shakeY{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(0,-10px,0);transform:translate3d(0,-10px,0)}20%,40%,60%,80%{-webkit-transform:translate3d(0,10px,0);transform:translate3d(0,10px,0)}}@keyframes shakeY{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(0,-10px,0);transform:translate3d(0,-10px,0)}20%,40%,60%,80%{-webkit-transform:translate3d(0,10px,0);transform:translate3d(0,10px,0)}}.animate__shakeY{-webkit-animation-name:shakeY;animation-name:shakeY}@-webkit-keyframes headShake{0%{-webkit-transform:translateX(0);transform:translateX(0)}6.5%{-webkit-transform:translateX(-6px) rotateY(-9deg);transform:translateX(-6px) rotateY(-9deg)}18.5%{-webkit-transform:translateX(5px) rotateY(7deg);transform:translateX(5px) rotateY(7deg)}31.5%{-webkit-transform:translateX(-3px) rotateY(-5deg);transform:translateX(-3px) rotateY(-5deg)}43.5%{-webkit-transform:translateX(2px) rotateY(3deg);transform:translateX(2px) rotateY(3deg)}50%{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes headShake{0%{-webkit-transform:translateX(0);transform:translateX(0)}6.5%{-webkit-transform:translateX(-6px) rotateY(-9deg);transform:translateX(-6px) rotateY(-9deg)}18.5%{-webkit-transform:translateX(5px) rotateY(7deg);transform:translateX(5px) rotateY(7deg)}31.5%{-webkit-transform:translateX(-3px) rotateY(-5deg);transform:translateX(-3px) rotateY(-5deg)}43.5%{-webkit-transform:translateX(2px) rotateY(3deg);transform:translateX(2px) rotateY(3deg)}50%{-webkit-transform:translateX(0);transform:translateX(0)}}.animate__headShake{-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-name:headShake;animation-name:headShake}@-webkit-keyframes swing{20%{-webkit-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes swing{20%{-webkit-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}.animate__swing{-webkit-transform-origin:top center;transform-origin:top center;-webkit-animation-name:swing;animation-name:swing}@-webkit-keyframes tada{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}10%,20%{-webkit-transform:scale3d(.9,.9,.9) rotate(-3deg);transform:scale3d(.9,.9,.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale3d(1.1,1.1,1.1) rotate(3deg);transform:scale3d(1.1,1.1,1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale3d(1.1,1.1,1.1) rotate(-3deg);transform:scale3d(1.1,1.1,1.1) rotate(-3deg)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes tada{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}10%,20%{-webkit-transform:scale3d(.9,.9,.9) rotate(-3deg);transform:scale3d(.9,.9,.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale3d(1.1,1.1,1.1) rotate(3deg);transform:scale3d(1.1,1.1,1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale3d(1.1,1.1,1.1) rotate(-3deg);transform:scale3d(1.1,1.1,1.1) rotate(-3deg)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}.animate__tada{-webkit-animation-name:tada;animation-name:tada}@-webkit-keyframes wobble{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-25%,0,0) rotate(-5deg);transform:translate3d(-25%,0,0) rotate(-5deg)}30%{-webkit-transform:translate3d(20%,0,0) rotate(3deg);transform:translate3d(20%,0,0) rotate(3deg)}45%{-webkit-transform:translate3d(-15%,0,0) rotate(-3deg);transform:translate3d(-15%,0,0) rotate(-3deg)}60%{-webkit-transform:translate3d(10%,0,0) rotate(2deg);transform:translate3d(10%,0,0) rotate(2deg)}75%{-webkit-transform:translate3d(-5%,0,0) rotate(-1deg);transform:translate3d(-5%,0,0) rotate(-1deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes wobble{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-25%,0,0) rotate(-5deg);transform:translate3d(-25%,0,0) rotate(-5deg)}30%{-webkit-transform:translate3d(20%,0,0) rotate(3deg);transform:translate3d(20%,0,0) rotate(3deg)}45%{-webkit-transform:translate3d(-15%,0,0) rotate(-3deg);transform:translate3d(-15%,0,0) rotate(-3deg)}60%{-webkit-transform:translate3d(10%,0,0) rotate(2deg);transform:translate3d(10%,0,0) rotate(2deg)}75%{-webkit-transform:translate3d(-5%,0,0) rotate(-1deg);transform:translate3d(-5%,0,0) rotate(-1deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__wobble{-webkit-animation-name:wobble;animation-name:wobble}@-webkit-keyframes jello{0%,11.1%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}22.2%{-webkit-transform:skewX(-12.5deg) skewY(-12.5deg);transform:skewX(-12.5deg) skewY(-12.5deg)}33.3%{-webkit-transform:skewX(6.25deg) skewY(6.25deg);transform:skewX(6.25deg) skewY(6.25deg)}44.4%{-webkit-transform:skewX(-3.125deg) skewY(-3.125deg);transform:skewX(-3.125deg) skewY(-3.125deg)}55.5%{-webkit-transform:skewX(1.5625deg) skewY(1.5625deg);transform:skewX(1.5625deg) skewY(1.5625deg)}66.6%{-webkit-transform:skewX(-.78125deg) skewY(-.78125deg);transform:skewX(-.78125deg) skewY(-.78125deg)}77.7%{-webkit-transform:skewX(.390625deg) skewY(.390625deg);transform:skewX(.390625deg) skewY(.390625deg)}88.8%{-webkit-transform:skewX(-.1953125deg) skewY(-.1953125deg);transform:skewX(-.1953125deg) skewY(-.1953125deg)}}@keyframes jello{0%,11.1%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}22.2%{-webkit-transform:skewX(-12.5deg) skewY(-12.5deg);transform:skewX(-12.5deg) skewY(-12.5deg)}33.3%{-webkit-transform:skewX(6.25deg) skewY(6.25deg);transform:skewX(6.25deg) skewY(6.25deg)}44.4%{-webkit-transform:skewX(-3.125deg) skewY(-3.125deg);transform:skewX(-3.125deg) skewY(-3.125deg)}55.5%{-webkit-transform:skewX(1.5625deg) skewY(1.5625deg);transform:skewX(1.5625deg) skewY(1.5625deg)}66.6%{-webkit-transform:skewX(-.78125deg) skewY(-.78125deg);transform:skewX(-.78125deg) skewY(-.78125deg)}77.7%{-webkit-transform:skewX(.390625deg) skewY(.390625deg);transform:skewX(.390625deg) skewY(.390625deg)}88.8%{-webkit-transform:skewX(-.1953125deg) skewY(-.1953125deg);transform:skewX(-.1953125deg) skewY(-.1953125deg)}}.animate__jello{-webkit-animation-name:jello;animation-name:jello;-webkit-transform-origin:center;transform-origin:center}@-webkit-keyframes heartBeat{0%{-webkit-transform:scale(1);transform:scale(1)}14%{-webkit-transform:scale(1.3);transform:scale(1.3)}28%{-webkit-transform:scale(1);transform:scale(1)}42%{-webkit-transform:scale(1.3);transform:scale(1.3)}70%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes heartBeat{0%{-webkit-transform:scale(1);transform:scale(1)}14%{-webkit-transform:scale(1.3);transform:scale(1.3)}28%{-webkit-transform:scale(1);transform:scale(1)}42%{-webkit-transform:scale(1.3);transform:scale(1.3)}70%{-webkit-transform:scale(1);transform:scale(1)}}.animate__heartBeat{-webkit-animation-name:heartBeat;animation-name:heartBeat;-webkit-animation-duration:1.3s;animation-duration:1.3s;-webkit-animation-duration:calc(var(--animate-duration)*1.3);animation-duration:calc(var(--animate-duration)*1.3);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}@-webkit-keyframes backInDown{0%{-webkit-transform:translateY(-1200px) scale(.7);transform:translateY(-1200px) scale(.7);opacity:.7}80%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@keyframes backInDown{0%{-webkit-transform:translateY(-1200px) scale(.7);transform:translateY(-1200px) scale(.7);opacity:.7}80%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}.animate__backInDown{-webkit-animation-name:backInDown;animation-name:backInDown}@-webkit-keyframes backInLeft{0%{-webkit-transform:translateX(-2000px) scale(.7);transform:translateX(-2000px) scale(.7);opacity:.7}80%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@keyframes backInLeft{0%{-webkit-transform:translateX(-2000px) scale(.7);transform:translateX(-2000px) scale(.7);opacity:.7}80%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}.animate__backInLeft{-webkit-animation-name:backInLeft;animation-name:backInLeft}@-webkit-keyframes backInRight{0%{-webkit-transform:translateX(2000px) scale(.7);transform:translateX(2000px) scale(.7);opacity:.7}80%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@keyframes backInRight{0%{-webkit-transform:translateX(2000px) scale(.7);transform:translateX(2000px) scale(.7);opacity:.7}80%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}.animate__backInRight{-webkit-animation-name:backInRight;animation-name:backInRight}@-webkit-keyframes backInUp{0%{-webkit-transform:translateY(1200px) scale(.7);transform:translateY(1200px) scale(.7);opacity:.7}80%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@keyframes backInUp{0%{-webkit-transform:translateY(1200px) scale(.7);transform:translateY(1200px) scale(.7);opacity:.7}80%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}.animate__backInUp{-webkit-animation-name:backInUp;animation-name:backInUp}@-webkit-keyframes backOutDown{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:translateY(700px) scale(.7);transform:translateY(700px) scale(.7);opacity:.7}}@keyframes backOutDown{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:translateY(700px) scale(.7);transform:translateY(700px) scale(.7);opacity:.7}}.animate__backOutDown{-webkit-animation-name:backOutDown;animation-name:backOutDown}@-webkit-keyframes backOutLeft{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:translateX(-2000px) scale(.7);transform:translateX(-2000px) scale(.7);opacity:.7}}@keyframes backOutLeft{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:translateX(-2000px) scale(.7);transform:translateX(-2000px) scale(.7);opacity:.7}}.animate__backOutLeft{-webkit-animation-name:backOutLeft;animation-name:backOutLeft}@-webkit-keyframes backOutRight{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:translateX(2000px) scale(.7);transform:translateX(2000px) scale(.7);opacity:.7}}@keyframes backOutRight{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateX(0) scale(.7);transform:translateX(0) scale(.7);opacity:.7}to{-webkit-transform:translateX(2000px) scale(.7);transform:translateX(2000px) scale(.7);opacity:.7}}.animate__backOutRight{-webkit-animation-name:backOutRight;animation-name:backOutRight}@-webkit-keyframes backOutUp{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:translateY(-700px) scale(.7);transform:translateY(-700px) scale(.7);opacity:.7}}@keyframes backOutUp{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:translateY(0) scale(.7);transform:translateY(0) scale(.7);opacity:.7}to{-webkit-transform:translateY(-700px) scale(.7);transform:translateY(-700px) scale(.7);opacity:.7}}.animate__backOutUp{-webkit-animation-name:backOutUp;animation-name:backOutUp}@-webkit-keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}20%{-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}40%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}60%{opacity:1;-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}80%{-webkit-transform:scale3d(.97,.97,.97);transform:scale3d(.97,.97,.97)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}20%{-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}40%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}60%{opacity:1;-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}80%{-webkit-transform:scale3d(.97,.97,.97);transform:scale3d(.97,.97,.97)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}.animate__bounceIn{-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-duration:calc(var(--animate-duration)*0.75);animation-duration:calc(var(--animate-duration)*0.75);-webkit-animation-name:bounceIn;animation-name:bounceIn}@-webkit-keyframes bounceInDown{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(0,-3000px,0) scaleY(3);transform:translate3d(0,-3000px,0) scaleY(3)}60%{opacity:1;-webkit-transform:translate3d(0,25px,0) scaleY(.9);transform:translate3d(0,25px,0) scaleY(.9)}75%{-webkit-transform:translate3d(0,-10px,0) scaleY(.95);transform:translate3d(0,-10px,0) scaleY(.95)}90%{-webkit-transform:translate3d(0,5px,0) scaleY(.985);transform:translate3d(0,5px,0) scaleY(.985)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes bounceInDown{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(0,-3000px,0) scaleY(3);transform:translate3d(0,-3000px,0) scaleY(3)}60%{opacity:1;-webkit-transform:translate3d(0,25px,0) scaleY(.9);transform:translate3d(0,25px,0) scaleY(.9)}75%{-webkit-transform:translate3d(0,-10px,0) scaleY(.95);transform:translate3d(0,-10px,0) scaleY(.95)}90%{-webkit-transform:translate3d(0,5px,0) scaleY(.985);transform:translate3d(0,5px,0) scaleY(.985)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__bounceInDown{-webkit-animation-name:bounceInDown;animation-name:bounceInDown}@-webkit-keyframes bounceInLeft{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(-3000px,0,0) scaleX(3);transform:translate3d(-3000px,0,0) scaleX(3)}60%{opacity:1;-webkit-transform:translate3d(25px,0,0) scaleX(1);transform:translate3d(25px,0,0) scaleX(1)}75%{-webkit-transform:translate3d(-10px,0,0) scaleX(.98);transform:translate3d(-10px,0,0) scaleX(.98)}90%{-webkit-transform:translate3d(5px,0,0) scaleX(.995);transform:translate3d(5px,0,0) scaleX(.995)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes bounceInLeft{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(-3000px,0,0) scaleX(3);transform:translate3d(-3000px,0,0) scaleX(3)}60%{opacity:1;-webkit-transform:translate3d(25px,0,0) scaleX(1);transform:translate3d(25px,0,0) scaleX(1)}75%{-webkit-transform:translate3d(-10px,0,0) scaleX(.98);transform:translate3d(-10px,0,0) scaleX(.98)}90%{-webkit-transform:translate3d(5px,0,0) scaleX(.995);transform:translate3d(5px,0,0) scaleX(.995)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__bounceInLeft{-webkit-animation-name:bounceInLeft;animation-name:bounceInLeft}@-webkit-keyframes bounceInRight{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(3000px,0,0) scaleX(3);transform:translate3d(3000px,0,0) scaleX(3)}60%{opacity:1;-webkit-transform:translate3d(-25px,0,0) scaleX(1);transform:translate3d(-25px,0,0) scaleX(1)}75%{-webkit-transform:translate3d(10px,0,0) scaleX(.98);transform:translate3d(10px,0,0) scaleX(.98)}90%{-webkit-transform:translate3d(-5px,0,0) scaleX(.995);transform:translate3d(-5px,0,0) scaleX(.995)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes bounceInRight{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(3000px,0,0) scaleX(3);transform:translate3d(3000px,0,0) scaleX(3)}60%{opacity:1;-webkit-transform:translate3d(-25px,0,0) scaleX(1);transform:translate3d(-25px,0,0) scaleX(1)}75%{-webkit-transform:translate3d(10px,0,0) scaleX(.98);transform:translate3d(10px,0,0) scaleX(.98)}90%{-webkit-transform:translate3d(-5px,0,0) scaleX(.995);transform:translate3d(-5px,0,0) scaleX(.995)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__bounceInRight{-webkit-animation-name:bounceInRight;animation-name:bounceInRight}@-webkit-keyframes bounceInUp{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(0,3000px,0) scaleY(5);transform:translate3d(0,3000px,0) scaleY(5)}60%{opacity:1;-webkit-transform:translate3d(0,-20px,0) scaleY(.9);transform:translate3d(0,-20px,0) scaleY(.9)}75%{-webkit-transform:translate3d(0,10px,0) scaleY(.95);transform:translate3d(0,10px,0) scaleY(.95)}90%{-webkit-transform:translate3d(0,-5px,0) scaleY(.985);transform:translate3d(0,-5px,0) scaleY(.985)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes bounceInUp{0%,60%,75%,90%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:translate3d(0,3000px,0) scaleY(5);transform:translate3d(0,3000px,0) scaleY(5)}60%{opacity:1;-webkit-transform:translate3d(0,-20px,0) scaleY(.9);transform:translate3d(0,-20px,0) scaleY(.9)}75%{-webkit-transform:translate3d(0,10px,0) scaleY(.95);transform:translate3d(0,10px,0) scaleY(.95)}90%{-webkit-transform:translate3d(0,-5px,0) scaleY(.985);transform:translate3d(0,-5px,0) scaleY(.985)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__bounceInUp{-webkit-animation-name:bounceInUp;animation-name:bounceInUp}@-webkit-keyframes bounceOut{20%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}50%,55%{opacity:1;-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}to{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}}@keyframes bounceOut{20%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}50%,55%{opacity:1;-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}to{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}}.animate__bounceOut{-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-duration:calc(var(--animate-duration)*0.75);animation-duration:calc(var(--animate-duration)*0.75);-webkit-animation-name:bounceOut;animation-name:bounceOut}@-webkit-keyframes bounceOutDown{20%{-webkit-transform:translate3d(0,10px,0) scaleY(.985);transform:translate3d(0,10px,0) scaleY(.985)}40%,45%{opacity:1;-webkit-transform:translate3d(0,-20px,0) scaleY(.9);transform:translate3d(0,-20px,0) scaleY(.9)}to{opacity:0;-webkit-transform:translate3d(0,2000px,0) scaleY(3);transform:translate3d(0,2000px,0) scaleY(3)}}@keyframes bounceOutDown{20%{-webkit-transform:translate3d(0,10px,0) scaleY(.985);transform:translate3d(0,10px,0) scaleY(.985)}40%,45%{opacity:1;-webkit-transform:translate3d(0,-20px,0) scaleY(.9);transform:translate3d(0,-20px,0) scaleY(.9)}to{opacity:0;-webkit-transform:translate3d(0,2000px,0) scaleY(3);transform:translate3d(0,2000px,0) scaleY(3)}}.animate__bounceOutDown{-webkit-animation-name:bounceOutDown;animation-name:bounceOutDown}@-webkit-keyframes bounceOutLeft{20%{opacity:1;-webkit-transform:translate3d(20px,0,0) scaleX(.9);transform:translate3d(20px,0,0) scaleX(.9)}to{opacity:0;-webkit-transform:translate3d(-2000px,0,0) scaleX(2);transform:translate3d(-2000px,0,0) scaleX(2)}}@keyframes bounceOutLeft{20%{opacity:1;-webkit-transform:translate3d(20px,0,0) scaleX(.9);transform:translate3d(20px,0,0) scaleX(.9)}to{opacity:0;-webkit-transform:translate3d(-2000px,0,0) scaleX(2);transform:translate3d(-2000px,0,0) scaleX(2)}}.animate__bounceOutLeft{-webkit-animation-name:bounceOutLeft;animation-name:bounceOutLeft}@-webkit-keyframes bounceOutRight{20%{opacity:1;-webkit-transform:translate3d(-20px,0,0) scaleX(.9);transform:translate3d(-20px,0,0) scaleX(.9)}to{opacity:0;-webkit-transform:translate3d(2000px,0,0) scaleX(2);transform:translate3d(2000px,0,0) scaleX(2)}}@keyframes bounceOutRight{20%{opacity:1;-webkit-transform:translate3d(-20px,0,0) scaleX(.9);transform:translate3d(-20px,0,0) scaleX(.9)}to{opacity:0;-webkit-transform:translate3d(2000px,0,0) scaleX(2);transform:translate3d(2000px,0,0) scaleX(2)}}.animate__bounceOutRight{-webkit-animation-name:bounceOutRight;animation-name:bounceOutRight}@-webkit-keyframes bounceOutUp{20%{-webkit-transform:translate3d(0,-10px,0) scaleY(.985);transform:translate3d(0,-10px,0) scaleY(.985)}40%,45%{opacity:1;-webkit-transform:translate3d(0,20px,0) scaleY(.9);transform:translate3d(0,20px,0) scaleY(.9)}to{opacity:0;-webkit-transform:translate3d(0,-2000px,0) scaleY(3);transform:translate3d(0,-2000px,0) scaleY(3)}}@keyframes bounceOutUp{20%{-webkit-transform:translate3d(0,-10px,0) scaleY(.985);transform:translate3d(0,-10px,0) scaleY(.985)}40%,45%{opacity:1;-webkit-transform:translate3d(0,20px,0) scaleY(.9);transform:translate3d(0,20px,0) scaleY(.9)}to{opacity:0;-webkit-transform:translate3d(0,-2000px,0) scaleY(3);transform:translate3d(0,-2000px,0) scaleY(3)}}.animate__bounceOutUp{-webkit-animation-name:bounceOutUp;animation-name:bounceOutUp}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.animate__fadeIn{-webkit-animation-name:fadeIn;animation-name:fadeIn}@-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInDown{-webkit-animation-name:fadeInDown;animation-name:fadeInDown}@-webkit-keyframes fadeInDownBig{0%{opacity:0;-webkit-transform:translate3d(0,-2000px,0);transform:translate3d(0,-2000px,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInDownBig{0%{opacity:0;-webkit-transform:translate3d(0,-2000px,0);transform:translate3d(0,-2000px,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInDownBig{-webkit-animation-name:fadeInDownBig;animation-name:fadeInDownBig}@-webkit-keyframes fadeInLeft{0%{opacity:0;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInLeft{0%{opacity:0;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInLeft{-webkit-animation-name:fadeInLeft;animation-name:fadeInLeft}@-webkit-keyframes fadeInLeftBig{0%{opacity:0;-webkit-transform:translate3d(-2000px,0,0);transform:translate3d(-2000px,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInLeftBig{0%{opacity:0;-webkit-transform:translate3d(-2000px,0,0);transform:translate3d(-2000px,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInLeftBig{-webkit-animation-name:fadeInLeftBig;animation-name:fadeInLeftBig}@-webkit-keyframes fadeInRight{0%{opacity:0;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInRight{0%{opacity:0;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInRight{-webkit-animation-name:fadeInRight;animation-name:fadeInRight}@-webkit-keyframes fadeInRightBig{0%{opacity:0;-webkit-transform:translate3d(2000px,0,0);transform:translate3d(2000px,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInRightBig{0%{opacity:0;-webkit-transform:translate3d(2000px,0,0);transform:translate3d(2000px,0,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInRightBig{-webkit-animation-name:fadeInRightBig;animation-name:fadeInRightBig}@-webkit-keyframes fadeInUp{0%{opacity:0;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInUp{0%{opacity:0;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInUp{-webkit-animation-name:fadeInUp;animation-name:fadeInUp}@-webkit-keyframes fadeInUpBig{0%{opacity:0;-webkit-transform:translate3d(0,2000px,0);transform:translate3d(0,2000px,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInUpBig{0%{opacity:0;-webkit-transform:translate3d(0,2000px,0);transform:translate3d(0,2000px,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInUpBig{-webkit-animation-name:fadeInUpBig;animation-name:fadeInUpBig}@-webkit-keyframes fadeInTopLeft{0%{opacity:0;-webkit-transform:translate3d(-100%,-100%,0);transform:translate3d(-100%,-100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInTopLeft{0%{opacity:0;-webkit-transform:translate3d(-100%,-100%,0);transform:translate3d(-100%,-100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInTopLeft{-webkit-animation-name:fadeInTopLeft;animation-name:fadeInTopLeft}@-webkit-keyframes fadeInTopRight{0%{opacity:0;-webkit-transform:translate3d(100%,-100%,0);transform:translate3d(100%,-100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInTopRight{0%{opacity:0;-webkit-transform:translate3d(100%,-100%,0);transform:translate3d(100%,-100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInTopRight{-webkit-animation-name:fadeInTopRight;animation-name:fadeInTopRight}@-webkit-keyframes fadeInBottomLeft{0%{opacity:0;-webkit-transform:translate3d(-100%,100%,0);transform:translate3d(-100%,100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInBottomLeft{0%{opacity:0;-webkit-transform:translate3d(-100%,100%,0);transform:translate3d(-100%,100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInBottomLeft{-webkit-animation-name:fadeInBottomLeft;animation-name:fadeInBottomLeft}@-webkit-keyframes fadeInBottomRight{0%{opacity:0;-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes fadeInBottomRight{0%{opacity:0;-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__fadeInBottomRight{-webkit-animation-name:fadeInBottomRight;animation-name:fadeInBottomRight}@-webkit-keyframes fadeOut{0%{opacity:1}to{opacity:0}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}.animate__fadeOut{-webkit-animation-name:fadeOut;animation-name:fadeOut}@-webkit-keyframes fadeOutDown{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}}@keyframes fadeOutDown{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}}.animate__fadeOutDown{-webkit-animation-name:fadeOutDown;animation-name:fadeOutDown}@-webkit-keyframes fadeOutDownBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,2000px,0);transform:translate3d(0,2000px,0)}}@keyframes fadeOutDownBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,2000px,0);transform:translate3d(0,2000px,0)}}.animate__fadeOutDownBig{-webkit-animation-name:fadeOutDownBig;animation-name:fadeOutDownBig}@-webkit-keyframes fadeOutLeft{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@keyframes fadeOutLeft{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}.animate__fadeOutLeft{-webkit-animation-name:fadeOutLeft;animation-name:fadeOutLeft}@-webkit-keyframes fadeOutLeftBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(-2000px,0,0);transform:translate3d(-2000px,0,0)}}@keyframes fadeOutLeftBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(-2000px,0,0);transform:translate3d(-2000px,0,0)}}.animate__fadeOutLeftBig{-webkit-animation-name:fadeOutLeftBig;animation-name:fadeOutLeftBig}@-webkit-keyframes fadeOutRight{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}}@keyframes fadeOutRight{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}}.animate__fadeOutRight{-webkit-animation-name:fadeOutRight;animation-name:fadeOutRight}@-webkit-keyframes fadeOutRightBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(2000px,0,0);transform:translate3d(2000px,0,0)}}@keyframes fadeOutRightBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(2000px,0,0);transform:translate3d(2000px,0,0)}}.animate__fadeOutRightBig{-webkit-animation-name:fadeOutRightBig;animation-name:fadeOutRightBig}@-webkit-keyframes fadeOutUp{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}}@keyframes fadeOutUp{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}}.animate__fadeOutUp{-webkit-animation-name:fadeOutUp;animation-name:fadeOutUp}@-webkit-keyframes fadeOutUpBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,-2000px,0);transform:translate3d(0,-2000px,0)}}@keyframes fadeOutUpBig{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,-2000px,0);transform:translate3d(0,-2000px,0)}}.animate__fadeOutUpBig{-webkit-animation-name:fadeOutUpBig;animation-name:fadeOutUpBig}@-webkit-keyframes fadeOutTopLeft{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(-100%,-100%,0);transform:translate3d(-100%,-100%,0)}}@keyframes fadeOutTopLeft{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(-100%,-100%,0);transform:translate3d(-100%,-100%,0)}}.animate__fadeOutTopLeft{-webkit-animation-name:fadeOutTopLeft;animation-name:fadeOutTopLeft}@-webkit-keyframes fadeOutTopRight{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(100%,-100%,0);transform:translate3d(100%,-100%,0)}}@keyframes fadeOutTopRight{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(100%,-100%,0);transform:translate3d(100%,-100%,0)}}.animate__fadeOutTopRight{-webkit-animation-name:fadeOutTopRight;animation-name:fadeOutTopRight}@-webkit-keyframes fadeOutBottomRight{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}}@keyframes fadeOutBottomRight{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(100%,100%,0);transform:translate3d(100%,100%,0)}}.animate__fadeOutBottomRight{-webkit-animation-name:fadeOutBottomRight;animation-name:fadeOutBottomRight}@-webkit-keyframes fadeOutBottomLeft{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(-100%,100%,0);transform:translate3d(-100%,100%,0)}}@keyframes fadeOutBottomLeft{0%{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}to{opacity:0;-webkit-transform:translate3d(-100%,100%,0);transform:translate3d(-100%,100%,0)}}.animate__fadeOutBottomLeft{-webkit-animation-name:fadeOutBottomLeft;animation-name:fadeOutBottomLeft}@-webkit-keyframes flip{0%{-webkit-transform:perspective(400px) scaleX(1) translateZ(0) rotateY(-1turn);transform:perspective(400px) scaleX(1) translateZ(0) rotateY(-1turn);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-190deg);transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-190deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-170deg);transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-170deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(400px) scale3d(.95,.95,.95) translateZ(0) rotateY(0deg);transform:perspective(400px) scale3d(.95,.95,.95) translateZ(0) rotateY(0deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(400px) scaleX(1) translateZ(0) rotateY(0deg);transform:perspective(400px) scaleX(1) translateZ(0) rotateY(0deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes flip{0%{-webkit-transform:perspective(400px) scaleX(1) translateZ(0) rotateY(-1turn);transform:perspective(400px) scaleX(1) translateZ(0) rotateY(-1turn);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-190deg);transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-190deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-170deg);transform:perspective(400px) scaleX(1) translateZ(150px) rotateY(-170deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(400px) scale3d(.95,.95,.95) translateZ(0) rotateY(0deg);transform:perspective(400px) scale3d(.95,.95,.95) translateZ(0) rotateY(0deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(400px) scaleX(1) translateZ(0) rotateY(0deg);transform:perspective(400px) scaleX(1) translateZ(0) rotateY(0deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.animate__animated.animate__flip{-webkit-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flip;animation-name:flip}@-webkit-keyframes flipInX{0%{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateX(10deg);transform:perspective(400px) rotateX(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateX(-5deg);transform:perspective(400px) rotateX(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}@keyframes flipInX{0%{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateX(10deg);transform:perspective(400px) rotateX(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateX(-5deg);transform:perspective(400px) rotateX(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}.animate__flipInX{-webkit-backface-visibility:visible!important;backface-visibility:visible!important;-webkit-animation-name:flipInX;animation-name:flipInX}@-webkit-keyframes flipInY{0%{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateY(-20deg);transform:perspective(400px) rotateY(-20deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateY(10deg);transform:perspective(400px) rotateY(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateY(-5deg);transform:perspective(400px) rotateY(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}@keyframes flipInY{0%{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateY(-20deg);transform:perspective(400px) rotateY(-20deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateY(10deg);transform:perspective(400px) rotateY(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateY(-5deg);transform:perspective(400px) rotateY(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}.animate__flipInY{-webkit-backface-visibility:visible!important;backface-visibility:visible!important;-webkit-animation-name:flipInY;animation-name:flipInY}@-webkit-keyframes flipOutX{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);opacity:1}to{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);opacity:0}}@keyframes flipOutX{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);opacity:1}to{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);opacity:0}}.animate__flipOutX{-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-duration:calc(var(--animate-duration)*0.75);animation-duration:calc(var(--animate-duration)*0.75);-webkit-animation-name:flipOutX;animation-name:flipOutX;-webkit-backface-visibility:visible!important;backface-visibility:visible!important}@-webkit-keyframes flipOutY{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateY(-15deg);transform:perspective(400px) rotateY(-15deg);opacity:1}to{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);opacity:0}}@keyframes flipOutY{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateY(-15deg);transform:perspective(400px) rotateY(-15deg);opacity:1}to{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);opacity:0}}.animate__flipOutY{-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-duration:calc(var(--animate-duration)*0.75);animation-duration:calc(var(--animate-duration)*0.75);-webkit-backface-visibility:visible!important;backface-visibility:visible!important;-webkit-animation-name:flipOutY;animation-name:flipOutY}@-webkit-keyframes lightSpeedInRight{0%{-webkit-transform:translate3d(100%,0,0) skewX(-30deg);transform:translate3d(100%,0,0) skewX(-30deg);opacity:0}60%{-webkit-transform:skewX(20deg);transform:skewX(20deg);opacity:1}80%{-webkit-transform:skewX(-5deg);transform:skewX(-5deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes lightSpeedInRight{0%{-webkit-transform:translate3d(100%,0,0) skewX(-30deg);transform:translate3d(100%,0,0) skewX(-30deg);opacity:0}60%{-webkit-transform:skewX(20deg);transform:skewX(20deg);opacity:1}80%{-webkit-transform:skewX(-5deg);transform:skewX(-5deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__lightSpeedInRight{-webkit-animation-name:lightSpeedInRight;animation-name:lightSpeedInRight;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}@-webkit-keyframes lightSpeedInLeft{0%{-webkit-transform:translate3d(-100%,0,0) skewX(30deg);transform:translate3d(-100%,0,0) skewX(30deg);opacity:0}60%{-webkit-transform:skewX(-20deg);transform:skewX(-20deg);opacity:1}80%{-webkit-transform:skewX(5deg);transform:skewX(5deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes lightSpeedInLeft{0%{-webkit-transform:translate3d(-100%,0,0) skewX(30deg);transform:translate3d(-100%,0,0) skewX(30deg);opacity:0}60%{-webkit-transform:skewX(-20deg);transform:skewX(-20deg);opacity:1}80%{-webkit-transform:skewX(5deg);transform:skewX(5deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__lightSpeedInLeft{-webkit-animation-name:lightSpeedInLeft;animation-name:lightSpeedInLeft;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}@-webkit-keyframes lightSpeedOutRight{0%{opacity:1}to{-webkit-transform:translate3d(100%,0,0) skewX(30deg);transform:translate3d(100%,0,0) skewX(30deg);opacity:0}}@keyframes lightSpeedOutRight{0%{opacity:1}to{-webkit-transform:translate3d(100%,0,0) skewX(30deg);transform:translate3d(100%,0,0) skewX(30deg);opacity:0}}.animate__lightSpeedOutRight{-webkit-animation-name:lightSpeedOutRight;animation-name:lightSpeedOutRight;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}@-webkit-keyframes lightSpeedOutLeft{0%{opacity:1}to{-webkit-transform:translate3d(-100%,0,0) skewX(-30deg);transform:translate3d(-100%,0,0) skewX(-30deg);opacity:0}}@keyframes lightSpeedOutLeft{0%{opacity:1}to{-webkit-transform:translate3d(-100%,0,0) skewX(-30deg);transform:translate3d(-100%,0,0) skewX(-30deg);opacity:0}}.animate__lightSpeedOutLeft{-webkit-animation-name:lightSpeedOutLeft;animation-name:lightSpeedOutLeft;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}@-webkit-keyframes rotateIn{0%{-webkit-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes rotateIn{0%{-webkit-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}.animate__rotateIn{-webkit-animation-name:rotateIn;animation-name:rotateIn;-webkit-transform-origin:center;transform-origin:center}@-webkit-keyframes rotateInDownLeft{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes rotateInDownLeft{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}.animate__rotateInDownLeft{-webkit-animation-name:rotateInDownLeft;animation-name:rotateInDownLeft;-webkit-transform-origin:left bottom;transform-origin:left bottom}@-webkit-keyframes rotateInDownRight{0%{-webkit-transform:rotate(45deg);transform:rotate(45deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes rotateInDownRight{0%{-webkit-transform:rotate(45deg);transform:rotate(45deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}.animate__rotateInDownRight{-webkit-animation-name:rotateInDownRight;animation-name:rotateInDownRight;-webkit-transform-origin:right bottom;transform-origin:right bottom}@-webkit-keyframes rotateInUpLeft{0%{-webkit-transform:rotate(45deg);transform:rotate(45deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes rotateInUpLeft{0%{-webkit-transform:rotate(45deg);transform:rotate(45deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}.animate__rotateInUpLeft{-webkit-animation-name:rotateInUpLeft;animation-name:rotateInUpLeft;-webkit-transform-origin:left bottom;transform-origin:left bottom}@-webkit-keyframes rotateInUpRight{0%{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes rotateInUpRight{0%{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}.animate__rotateInUpRight{-webkit-animation-name:rotateInUpRight;animation-name:rotateInUpRight;-webkit-transform-origin:right bottom;transform-origin:right bottom}@-webkit-keyframes rotateOut{0%{opacity:1}to{-webkit-transform:rotate(200deg);transform:rotate(200deg);opacity:0}}@keyframes rotateOut{0%{opacity:1}to{-webkit-transform:rotate(200deg);transform:rotate(200deg);opacity:0}}.animate__rotateOut{-webkit-animation-name:rotateOut;animation-name:rotateOut;-webkit-transform-origin:center;transform-origin:center}@-webkit-keyframes rotateOutDownLeft{0%{opacity:1}to{-webkit-transform:rotate(45deg);transform:rotate(45deg);opacity:0}}@keyframes rotateOutDownLeft{0%{opacity:1}to{-webkit-transform:rotate(45deg);transform:rotate(45deg);opacity:0}}.animate__rotateOutDownLeft{-webkit-animation-name:rotateOutDownLeft;animation-name:rotateOutDownLeft;-webkit-transform-origin:left bottom;transform-origin:left bottom}@-webkit-keyframes rotateOutDownRight{0%{opacity:1}to{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);opacity:0}}@keyframes rotateOutDownRight{0%{opacity:1}to{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);opacity:0}}.animate__rotateOutDownRight{-webkit-animation-name:rotateOutDownRight;animation-name:rotateOutDownRight;-webkit-transform-origin:right bottom;transform-origin:right bottom}@-webkit-keyframes rotateOutUpLeft{0%{opacity:1}to{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);opacity:0}}@keyframes rotateOutUpLeft{0%{opacity:1}to{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);opacity:0}}.animate__rotateOutUpLeft{-webkit-animation-name:rotateOutUpLeft;animation-name:rotateOutUpLeft;-webkit-transform-origin:left bottom;transform-origin:left bottom}@-webkit-keyframes rotateOutUpRight{0%{opacity:1}to{-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}}@keyframes rotateOutUpRight{0%{opacity:1}to{-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}}.animate__rotateOutUpRight{-webkit-animation-name:rotateOutUpRight;animation-name:rotateOutUpRight;-webkit-transform-origin:right bottom;transform-origin:right bottom}@-webkit-keyframes hinge{0%{-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}20%,60%{-webkit-transform:rotate(80deg);transform:rotate(80deg);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}40%,80%{-webkit-transform:rotate(60deg);transform:rotate(60deg);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;opacity:1}to{-webkit-transform:translate3d(0,700px,0);transform:translate3d(0,700px,0);opacity:0}}@keyframes hinge{0%{-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}20%,60%{-webkit-transform:rotate(80deg);transform:rotate(80deg);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}40%,80%{-webkit-transform:rotate(60deg);transform:rotate(60deg);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;opacity:1}to{-webkit-transform:translate3d(0,700px,0);transform:translate3d(0,700px,0);opacity:0}}.animate__hinge{-webkit-animation-duration:2s;animation-duration:2s;-webkit-animation-duration:calc(var(--animate-duration)*2);animation-duration:calc(var(--animate-duration)*2);-webkit-animation-name:hinge;animation-name:hinge;-webkit-transform-origin:top left;transform-origin:top left}@-webkit-keyframes jackInTheBox{0%{opacity:0;-webkit-transform:scale(.1) rotate(30deg);transform:scale(.1) rotate(30deg);-webkit-transform-origin:center bottom;transform-origin:center bottom}50%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}70%{-webkit-transform:rotate(3deg);transform:rotate(3deg)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes jackInTheBox{0%{opacity:0;-webkit-transform:scale(.1) rotate(30deg);transform:scale(.1) rotate(30deg);-webkit-transform-origin:center bottom;transform-origin:center bottom}50%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}70%{-webkit-transform:rotate(3deg);transform:rotate(3deg)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}.animate__jackInTheBox{-webkit-animation-name:jackInTheBox;animation-name:jackInTheBox}@-webkit-keyframes rollIn{0%{opacity:0;-webkit-transform:translate3d(-100%,0,0) rotate(-120deg);transform:translate3d(-100%,0,0) rotate(-120deg)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes rollIn{0%{opacity:0;-webkit-transform:translate3d(-100%,0,0) rotate(-120deg);transform:translate3d(-100%,0,0) rotate(-120deg)}to{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__rollIn{-webkit-animation-name:rollIn;animation-name:rollIn}@-webkit-keyframes rollOut{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(100%,0,0) rotate(120deg);transform:translate3d(100%,0,0) rotate(120deg)}}@keyframes rollOut{0%{opacity:1}to{opacity:0;-webkit-transform:translate3d(100%,0,0) rotate(120deg);transform:translate3d(100%,0,0) rotate(120deg)}}.animate__rollOut{-webkit-animation-name:rollOut;animation-name:rollOut}@-webkit-keyframes zoomIn{0%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes zoomIn{0%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}50%{opacity:1}}.animate__zoomIn{-webkit-animation-name:zoomIn;animation-name:zoomIn}@-webkit-keyframes zoomInDown{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,-1000px,0);transform:scale3d(.1,.1,.1) translate3d(0,-1000px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,60px,0);transform:scale3d(.475,.475,.475) translate3d(0,60px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}@keyframes zoomInDown{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,-1000px,0);transform:scale3d(.1,.1,.1) translate3d(0,-1000px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,60px,0);transform:scale3d(.475,.475,.475) translate3d(0,60px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}.animate__zoomInDown{-webkit-animation-name:zoomInDown;animation-name:zoomInDown}@-webkit-keyframes zoomInLeft{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(-1000px,0,0);transform:scale3d(.1,.1,.1) translate3d(-1000px,0,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(10px,0,0);transform:scale3d(.475,.475,.475) translate3d(10px,0,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}@keyframes zoomInLeft{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(-1000px,0,0);transform:scale3d(.1,.1,.1) translate3d(-1000px,0,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(10px,0,0);transform:scale3d(.475,.475,.475) translate3d(10px,0,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}.animate__zoomInLeft{-webkit-animation-name:zoomInLeft;animation-name:zoomInLeft}@-webkit-keyframes zoomInRight{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(1000px,0,0);transform:scale3d(.1,.1,.1) translate3d(1000px,0,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(-10px,0,0);transform:scale3d(.475,.475,.475) translate3d(-10px,0,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}@keyframes zoomInRight{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(1000px,0,0);transform:scale3d(.1,.1,.1) translate3d(1000px,0,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(-10px,0,0);transform:scale3d(.475,.475,.475) translate3d(-10px,0,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}.animate__zoomInRight{-webkit-animation-name:zoomInRight;animation-name:zoomInRight}@-webkit-keyframes zoomInUp{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,1000px,0);transform:scale3d(.1,.1,.1) translate3d(0,1000px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}@keyframes zoomInUp{0%{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,1000px,0);transform:scale3d(.1,.1,.1) translate3d(0,1000px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}60%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}.animate__zoomInUp{-webkit-animation-name:zoomInUp;animation-name:zoomInUp}@-webkit-keyframes zoomOut{0%{opacity:1}50%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}to{opacity:0}}@keyframes zoomOut{0%{opacity:1}50%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}to{opacity:0}}.animate__zoomOut{-webkit-animation-name:zoomOut;animation-name:zoomOut}@-webkit-keyframes zoomOutDown{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}to{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,2000px,0);transform:scale3d(.1,.1,.1) translate3d(0,2000px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}@keyframes zoomOutDown{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);transform:scale3d(.475,.475,.475) translate3d(0,-60px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}to{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,2000px,0);transform:scale3d(.1,.1,.1) translate3d(0,2000px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}.animate__zoomOutDown{-webkit-animation-name:zoomOutDown;animation-name:zoomOutDown;-webkit-transform-origin:center bottom;transform-origin:center bottom}@-webkit-keyframes zoomOutLeft{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(42px,0,0);transform:scale3d(.475,.475,.475) translate3d(42px,0,0)}to{opacity:0;-webkit-transform:scale(.1) translate3d(-2000px,0,0);transform:scale(.1) translate3d(-2000px,0,0)}}@keyframes zoomOutLeft{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(42px,0,0);transform:scale3d(.475,.475,.475) translate3d(42px,0,0)}to{opacity:0;-webkit-transform:scale(.1) translate3d(-2000px,0,0);transform:scale(.1) translate3d(-2000px,0,0)}}.animate__zoomOutLeft{-webkit-animation-name:zoomOutLeft;animation-name:zoomOutLeft;-webkit-transform-origin:left center;transform-origin:left center}@-webkit-keyframes zoomOutRight{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(-42px,0,0);transform:scale3d(.475,.475,.475) translate3d(-42px,0,0)}to{opacity:0;-webkit-transform:scale(.1) translate3d(2000px,0,0);transform:scale(.1) translate3d(2000px,0,0)}}@keyframes zoomOutRight{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(-42px,0,0);transform:scale3d(.475,.475,.475) translate3d(-42px,0,0)}to{opacity:0;-webkit-transform:scale(.1) translate3d(2000px,0,0);transform:scale(.1) translate3d(2000px,0,0)}}.animate__zoomOutRight{-webkit-animation-name:zoomOutRight;animation-name:zoomOutRight;-webkit-transform-origin:right center;transform-origin:right center}@-webkit-keyframes zoomOutUp{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,60px,0);transform:scale3d(.475,.475,.475) translate3d(0,60px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}to{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,-2000px,0);transform:scale3d(.1,.1,.1) translate3d(0,-2000px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}@keyframes zoomOutUp{40%{opacity:1;-webkit-transform:scale3d(.475,.475,.475) translate3d(0,60px,0);transform:scale3d(.475,.475,.475) translate3d(0,60px,0);-webkit-animation-timing-function:cubic-bezier(.55,.055,.675,.19);animation-timing-function:cubic-bezier(.55,.055,.675,.19)}to{opacity:0;-webkit-transform:scale3d(.1,.1,.1) translate3d(0,-2000px,0);transform:scale3d(.1,.1,.1) translate3d(0,-2000px,0);-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1);animation-timing-function:cubic-bezier(.175,.885,.32,1)}}.animate__zoomOutUp{-webkit-animation-name:zoomOutUp;animation-name:zoomOutUp;-webkit-transform-origin:center bottom;transform-origin:center bottom}@-webkit-keyframes slideInDown{0%{-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes slideInDown{0%{-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__slideInDown{-webkit-animation-name:slideInDown;animation-name:slideInDown}@-webkit-keyframes slideInLeft{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes slideInLeft{0%{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__slideInLeft{-webkit-animation-name:slideInLeft;animation-name:slideInLeft}@-webkit-keyframes slideInRight{0%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes slideInRight{0%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__slideInRight{-webkit-animation-name:slideInRight;animation-name:slideInRight}@-webkit-keyframes slideInUp{0%{-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes slideInUp{0%{-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0);visibility:visible}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}.animate__slideInUp{-webkit-animation-name:slideInUp;animation-name:slideInUp}@-webkit-keyframes slideOutDown{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}}@keyframes slideOutDown{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}}.animate__slideOutDown{-webkit-animation-name:slideOutDown;animation-name:slideOutDown}@-webkit-keyframes slideOutLeft{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}@keyframes slideOutLeft{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}}.animate__slideOutLeft{-webkit-animation-name:slideOutLeft;animation-name:slideOutLeft}@-webkit-keyframes slideOutRight{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}}@keyframes slideOutRight{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}}.animate__slideOutRight{-webkit-animation-name:slideOutRight;animation-name:slideOutRight}@-webkit-keyframes slideOutUp{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}}@keyframes slideOutUp{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{visibility:hidden;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}}.animate__slideOutUp{-webkit-animation-name:slideOutUp;animation-name:slideOutUp}
````

## File: src/styles/globals.css
````css
@tailwind base;
@tailwind components;
@tailwind utilities;
@layer base {
  * {
    font-weight: 400 !important;
  }
}
@layer utilities {
  /* Chrome, Safari and Opera */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar::-webkit-scrollbar-track {
    background-color: transparent;
  }
  .no-scrollbar {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
  }
  input:focus ~ label:not([for]),
  input:not(:placeholder-shown) ~ label:not([for]) {
    @apply -translate-y-2 text-xsmall-regular;
  }
  input:focus ~ label:not([for]) {
    @apply left-0;
  }
  /* Ensure checkbox labels are properly aligned */
  input[type="checkbox"] + label,
  input[type="checkbox"] ~ label {
    @apply transform-none;
    line-height: 1.5;
  }
  input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus,
  textarea:-webkit-autofill,
  textarea:-webkit-autofill:hover,
  textarea:-webkit-autofill:focus,
  select:-webkit-autofill,
  select:-webkit-autofill:hover,
  select:-webkit-autofill:focus {
    border: 1px solid #212121;
    -webkit-text-fill-color: #212121;
    -webkit-box-shadow: 0 0 0px 1000px #fff inset;
    transition: background-color 5000s ease-in-out 0s;
  }
  input[type="search"]::-webkit-search-decoration,
  input[type="search"]::-webkit-search-cancel-button,
  input[type="search"]::-webkit-search-results-button,
  input[type="search"]::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }
}
@layer components {
  h1,
  h2 {
    font-family: var(--font-chakra-petch), sans-serif;
    font-weight: 400 !important;
  }
  .content-container {
    @apply max-w-[1440px] w-full mx-auto px-6;
  }
  .contrast-btn {
    @apply px-4 py-2 border border-black rounded-full hover:bg-black hover:text-white transition-colors duration-200 ease-in;
  }
  /* Make all buttons fully rounded */
  button,
  .btn,
  [role="button"],
  input[type="button"],
  input[type="submit"] {
    @apply rounded-full;
    font-weight: 400 !important;
  }
  .text-xsmall-regular {
    @apply text-[10px] leading-4 font-normal;
  }
  .text-small-regular {
    @apply text-xs leading-5 font-normal;
  }
  .text-small-semi {
    @apply text-xs leading-5 font-semibold;
  }
  .text-base-regular {
    @apply text-sm leading-6 font-normal;
  }
  .text-base-semi {
    @apply text-sm leading-6 font-semibold;
  }
  .text-large-regular {
    @apply text-base leading-6 font-normal;
  }
  .text-large-semi {
    @apply text-base leading-6 font-semibold;
  }
  .text-xl-regular {
    @apply text-2xl leading-[36px] font-normal;
  }
  .text-xl-semi {
    @apply text-2xl leading-[36px] font-semibold;
  }
  .text-2xl-regular {
    @apply text-[30px] leading-[48px] font-normal;
  }
  .text-2xl-semi {
    @apply text-[30px] leading-[48px] font-semibold;
  }
  .text-3xl-regular {
    @apply text-[32px] leading-[44px] font-normal;
  }
  .text-3xl-semi {
    @apply text-[32px] leading-[44px] font-semibold;
  }
  /* Product Detail Content Styles */
  .product-detail-content {
    @apply text-gray-700 leading-relaxed;
  }
  .product-detail-content h1,
  .product-detail-content h2,
  .product-detail-content h3,
  .product-detail-content h4,
  .product-detail-content h5,
  .product-detail-content h6 {
    @apply font-semibold text-gray-900 mt-6 mb-4;
  }
  .product-detail-content h1 {
    @apply text-2xl;
  }
  .product-detail-content h2 {
    @apply text-xl;
  }
  .product-detail-content h3 {
    @apply text-lg;
  }
  .product-detail-content p {
    @apply mb-4;
  }
  .product-detail-content ul,
  .product-detail-content ol {
    @apply mb-4 pl-6;
  }
  .product-detail-content ul {
    @apply list-disc;
  }
  .product-detail-content ol {
    @apply list-decimal;
  }
  .product-detail-content li {
    @apply mb-2;
  }
  .product-detail-content img {
    @apply max-w-full h-auto rounded-lg my-6;
  }
  .product-detail-content a {
    @apply text-gray-900 underline hover:text-gray-700;
  }
  .product-detail-content strong {
    @apply font-semibold;
  }
  .product-detail-content em {
    @apply italic;
  }
  .product-detail-content blockquote {
    @apply border-l-4 border-gray-300 pl-4 italic my-4;
  }
  .product-detail-content code {
    @apply bg-gray-100 px-1 py-0.5 rounded text-sm;
  }
  .product-detail-content pre {
    @apply bg-gray-100 p-4 rounded-lg overflow-x-auto my-4;
  }
  .product-detail-content table {
    @apply w-full border-collapse my-4;
  }
  .product-detail-content th,
  .product-detail-content td {
    @apply border border-gray-300 px-4 py-2;
  }
  .product-detail-content th {
    @apply bg-gray-100 font-semibold;
  }
}
/* Legacy styles for existing components */
#cart-div {
  width: 300px;
}
#closeXsearch {
  padding-left: 5px;
}
#close-cart-p {
  margin-top: 2px;
}
#mobile-search-close-p {
  margin-top: -20px;
}
/* Fix Algolia mobile searchbox design issues */
#mobilesearchdiv {
  position: absolute;
  height: 200px;
}
.ais-SearchBox-submit {
  width: 48px;
}
.ais-SearchBox-submitIcon {
  display: none;
}
/* WooCommerce My Account Navigation Styles */
.woocommerce-MyAccount-navigation {
  @apply mb-6 lg:mb-0;
}
.woocommerce-MyAccount-navigation ul {
  @apply list-none p-0 m-0;
}
.woocommerce-MyAccount-navigation-link {
  @apply mb-1;
}
.woocommerce-MyAccount-navigation-link.is-active a {
  @apply bg-gray-900 text-white;
}
.woocommerce-MyAccount-content {
  @apply w-full;
}
/* Mobile: Stack navigation above content */
@media (max-width: 1023px) {
  .woocommerce-MyAccount-navigation {
    @apply mb-8;
  }
  .woocommerce-MyAccount-navigation ul {
    @apply flex flex-wrap gap-2;
  }
  .woocommerce-MyAccount-navigation-link {
    @apply flex-1 min-w-[140px];
  }
  .woocommerce-MyAccount-navigation-link a,
  .woocommerce-MyAccount-navigation-link button {
    @apply text-center;
  }
}
.ais-SearchBox-reset {
  margin-left: 10px;
}
/* Fix Chrome padding issue */
.ais-SearchBox-input[type='search']::-webkit-search-cancel-button {
  display: none;
}
````

## File: src/styles/wp-blocks.css
````css
/* WordPress Block Editor Styles */
/* These styles match WordPress's block editor output */
/* Base block styles */
.wp-blocks {
  max-width: 100%;
}
/* Paragraph blocks */
.wp-block-paragraph,
p.wp-block-paragraph {
  margin-bottom: 1.5em;
  line-height: 1.8;
  display: block;
  visibility: visible;
  opacity: 1;
}
.wp-block-paragraph:last-child {
  margin-bottom: 0;
}
/* Ensure paragraph text is visible even with editor classes */
p.block-editor-rich-text__editable,
.wp-block-paragraph.block-editor-rich-text__editable {
  display: block;
  visibility: visible;
  opacity: 1;
  margin-bottom: 1.5em;
  line-height: 1.8;
}
/* Heading blocks */
.wp-block-heading,
h1.wp-block-heading,
h2.wp-block-heading,
h3.wp-block-heading,
h4.wp-block-heading,
h5.wp-block-heading,
h6.wp-block-heading {
  margin-top: 2em;
  margin-bottom: 1em;
  font-weight: 700;
  line-height: 1.2;
  display: block;
}
/* Direct heading elements inside wp-block-heading */
.wp-block-heading h1,
.wp-block-heading h2,
.wp-block-heading h3,
.wp-block-heading h4,
.wp-block-heading h5,
.wp-block-heading h6 {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 700;
  line-height: 1.2;
}
/* Heading sizes - when class is on the heading itself */
h1.wp-block-heading,
.wp-block-heading h1 {
  font-size: 2.5em;
}
h2.wp-block-heading,
.wp-block-heading h2 {
  font-size: 2em;
}
h3.wp-block-heading,
.wp-block-heading h3 {
  font-size: 1.75em;
}
h4.wp-block-heading,
.wp-block-heading h4 {
  font-size: 1.5em;
}
h5.wp-block-heading,
.wp-block-heading h5 {
  font-size: 1.25em;
}
h6.wp-block-heading,
.wp-block-heading h6 {
  font-size: 1em;
}
/* Ensure headings are visible and styled even with editor classes */
.block-editor-rich-text__editable.wp-block-heading,
.wp-block-heading.block-editor-rich-text__editable {
  font-weight: 700;
  line-height: 1.2;
  display: block;
  margin-top: 2em;
  margin-bottom: 1em;
}
/* Remove editor-specific styling that might hide content */
.block-editor-rich-text__editable {
  min-width: 1px;
  white-space: normal;
  display: block;
  visibility: visible;
  opacity: 1;
}
.block-editor-rich-text__editable[style*="white-space: pre-wrap"] {
  white-space: normal !important;
}
/* Ensure all text content is visible */
.rich-text {
  display: block;
  visibility: visible;
  opacity: 1;
}
/* Make sure headings are visible even with editor classes */
h1.block-editor-rich-text__editable,
h2.block-editor-rich-text__editable,
h3.block-editor-rich-text__editable,
h4.block-editor-rich-text__editable,
h5.block-editor-rich-text__editable,
h6.block-editor-rich-text__editable {
  font-weight: 700;
  line-height: 1.2;
  display: block;
  visibility: visible;
  opacity: 1;
  margin-top: 2em;
  margin-bottom: 1em;
}
h1.block-editor-rich-text__editable {
  font-size: 2.5em;
}
h2.block-editor-rich-text__editable {
  font-size: 2em;
}
h3.block-editor-rich-text__editable {
  font-size: 1.75em;
}
h4.block-editor-rich-text__editable {
  font-size: 1.5em;
}
h5.block-editor-rich-text__editable {
  font-size: 1.25em;
}
h6.block-editor-rich-text__editable {
  font-size: 1em;
}
/* Quote blocks */
.wp-block-quote {
  margin: 2em 0;
  padding-left: 1.5em;
  border-left: 4px solid #ddd;
  font-style: italic;
  color: #666;
}
.wp-block-quote p {
  margin-bottom: 1em;
}
.wp-block-quote cite {
  display: block;
  margin-top: 1em;
  font-size: 0.875em;
  font-style: normal;
  color: #888;
}
.wp-block-quote.is-style-large {
  padding: 2em;
  border-left: none;
  border-top: 4px solid #ddd;
  border-bottom: 4px solid #ddd;
  text-align: center;
  font-size: 1.25em;
}
/* List blocks */
.wp-block-list {
  margin: 1.5em 0;
  padding-left: 2.5em;
}
.wp-block-list li {
  margin-bottom: 0.5em;
  line-height: 1.8;
}
.wp-block-list ul,
.wp-block-list ol {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
/* Code blocks */
.wp-block-code {
  margin: 2em 0;
  padding: 1em;
  background-color: #f5f5f5;
  border-radius: 0.5em;
  overflow-x: auto;
  font-family: 'Courier New', Courier, monospace;
  font-size: 0.875em;
  line-height: 1.6;
}
.wp-block-code code {
  background: transparent;
  padding: 0;
  border: none;
}
/* Preformatted blocks */
.wp-block-preformatted {
  margin: 2em 0;
  padding: 1em;
  background-color: #f5f5f5;
  border-radius: 0.5em;
  overflow-x: auto;
  font-family: 'Courier New', Courier, monospace;
  font-size: 0.875em;
  line-height: 1.6;
  white-space: pre;
}
/* Image blocks */
.wp-block-image {
  margin: 2em 0;
}
.wp-block-image img {
  max-width: 100%;
  height: auto;
  border-radius: 0.5em;
  display: block;
}
.wp-block-image.size-full img {
  width: 100%;
  height: auto;
}
.wp-block-image figcaption {
  margin-top: 0.5em;
  font-size: 0.875em;
  text-align: center;
  color: #666;
  font-style: italic;
}
/* Remove editor resizing handles from images */
.wp-block-image .components-resizable-box__handle {
  display: none !important;
}
/* Gallery blocks */
.wp-block-gallery {
  margin: 2em 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1em;
}
.wp-block-gallery .wp-block-image {
  margin: 0;
}
/* Group blocks */
.wp-block-group {
  margin: 2em 0;
}
.wp-block-group__inner-container {
  max-width: 100%;
}
.wp-block-group.alignfull {
  width: 100vw;
  max-width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  padding-left: 1.5rem;
  padding-right: 1.5rem;
}
.wp-block-group.alignwide {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}
/* Background colors and styles */
.wp-block-group.has-background,
.wp-block-column.has-background,
.wp-block-cover.has-background {
  padding: 2em;
}
.wp-block-group.has-global-padding {
  padding: 2em;
}
.wp-block-column.has-global-padding {
  padding: 1.5em;
}
/* Style variations */
.wp-block-group.is-style-section,
.wp-block-group.is-style-secondary {
  padding: 3em 2em;
}
/* Remove editor-specific styles */
.block-editor-block-list__block,
.block-editor-rich-text__editable,
.components-resizable-box__container,
.components-drop-zone {
  all: unset;
}
.block-editor-block-list__block {
  display: block;
}
.components-resizable-box__container {
  position: relative;
  display: block;
}
.components-resizable-box__handle {
  display: none !important;
}
.components-drop-zone {
  display: none !important;
}
/* Columns blocks */
.wp-block-columns {
  margin: 2em 0;
  display: flex;
  flex-wrap: wrap;
  gap: 2em;
  align-items: stretch;
}
.wp-block-columns.is-layout-flex {
  display: flex;
  flex-wrap: nowrap;
}
.wp-block-columns.is-nowrap {
  flex-wrap: nowrap;
}
/* Vertical alignment on columns container */
.wp-block-columns.are-vertically-aligned-top {
  align-items: flex-start !important;
}
.wp-block-columns.are-vertically-aligned-center {
  align-items: center !important;
}
.wp-block-columns.are-vertically-aligned-bottom {
  align-items: flex-end !important;
}
.wp-block-columns.alignwide {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}
.wp-block-columns.alignfull {
  width: 100vw;
  max-width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  padding-left: 1.5rem;
  padding-right: 1.5rem;
}
.wp-block-column {
  min-width: 0;
  flex: 1;
  display: flex;
  flex-direction: column;
}
.wp-block-column.is-layout-constrained {
  max-width: 100%;
  display: flex;
  flex-direction: column;
}
.wp-block-column.is-layout-flow {
  display: block;
}
/* Vertical alignment on individual columns */
/* Note: justify-content controls vertical alignment in flex column, align-items controls horizontal */
.wp-block-column.is-vertically-aligned-top {
  justify-content: flex-start !important;
  align-items: stretch !important;
  align-self: flex-start;
}
.wp-block-column.is-vertically-aligned-top.is-layout-constrained {
  justify-content: flex-start !important;
  align-items: stretch !important;
}
.wp-block-column.is-vertically-aligned-top.is-layout-flow {
  /* For flow layout, content naturally flows from top */
  display: block;
}
.wp-block-column.is-vertically-aligned-center {
  justify-content: center !important;
  align-items: stretch !important;
  align-self: center;
}
.wp-block-column.is-vertically-aligned-center.is-layout-constrained {
  justify-content: center !important;
  align-items: stretch !important;
}
.wp-block-column.is-vertically-aligned-center.is-layout-flow {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: stretch;
}
.wp-block-column.is-vertically-aligned-bottom {
  justify-content: flex-end !important;
  align-items: stretch !important;
  align-self: flex-end;
}
.wp-block-column.is-vertically-aligned-bottom.is-layout-constrained {
  justify-content: flex-end !important;
  align-items: stretch !important;
}
.wp-block-column.is-vertically-aligned-bottom.is-layout-flow {
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  align-items: stretch;
}
/* Ensure content inside columns respects vertical alignment only */
/* Horizontal alignment is controlled by content-justification classes */
.wp-block-column.is-vertically-aligned-top > *:first-child {
  margin-top: 0;
}
.wp-block-column.is-vertically-aligned-bottom > *:last-child {
  margin-bottom: 0;
}
/* Fix for constrained layout - ensure flex container works */
/* align-items: stretch allows content-justification to control horizontal alignment */
.wp-block-column.is-layout-constrained.is-vertically-aligned-top {
  display: flex !important;
  flex-direction: column !important;
  justify-content: flex-start !important;
  align-items: stretch !important;
}
.wp-block-column.is-layout-constrained.is-vertically-aligned-center {
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important;
  align-items: stretch !important;
}
.wp-block-column.is-layout-constrained.is-vertically-aligned-bottom {
  display: flex !important;
  flex-direction: column !important;
  justify-content: flex-end !important;
  align-items: stretch !important;
}
@media (max-width: 768px) {
  .wp-block-columns {
    flex-direction: column !important;
    flex-wrap: wrap !important;
  }
  .wp-block-columns.is-nowrap {
    flex-wrap: wrap !important;
  }
  .wp-block-column {
    flex: 1 1 100% !important;
    width: 100% !important;
  }
}
/* Cover blocks */
.wp-block-cover {
  margin: 2em 0;
  min-height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-size: cover;
  background-position: center;
  position: relative;
}
.wp-block-cover::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
}
.wp-block-cover__inner-container {
  position: relative;
  z-index: 1;
  color: white;
  text-align: center;
}
/* Media & Text blocks */
.wp-block-media-text {
  margin: 2em 0;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2em;
  align-items: center;
}
.wp-block-media-text.has-media-on-the-right {
  grid-template-columns: 1fr 1fr;
}
.wp-block-media-text.has-media-on-the-right .wp-block-media-text__media {
  order: 2;
}
.wp-block-media-text.has-media-on-the-right .wp-block-media-text__content {
  order: 1;
}
@media (max-width: 768px) {
  .wp-block-media-text {
    grid-template-columns: 1fr;
  }
  .wp-block-media-text__media {
    order: 1;
  }
  .wp-block-media-text__content {
    order: 2;
  }
}
/* Button blocks */
.wp-block-buttons {
  margin: 1.5em 0;
  display: flex;
  flex-wrap: wrap;
  gap: 1em;
  align-items: center;
}
.wp-block-buttons.is-layout-flex {
  display: flex;
  flex-wrap: wrap;
}
.wp-block-button {
  margin: 0;
}
.wp-block-button__link,
.wp-element-button {
  display: inline-block;
  padding: 0.75em 1.5em;
  background-color: #000;
  color: #fff;
  text-decoration: none;
  border-radius: 9999px;
  font-weight: 600;
  transition: background-color 0.2s;
  border: none;
  cursor: pointer;
}
.wp-block-button__link:hover,
.wp-element-button:hover {
  background-color: #333;
}
.wp-block-button.is-style-outline .wp-block-button__link,
.wp-block-button.is-style-outline .wp-element-button {
  background-color: transparent;
  border: 2px solid #000;
  color: #000;
}
.wp-block-button.is-style-outline .wp-block-button__link:hover,
.wp-block-button.is-style-outline .wp-element-button:hover {
  background-color: #000;
  color: #fff;
}
/* Separator blocks */
.wp-block-separator {
  margin: 2em 0;
  border: none;
  border-top: 2px solid #ddd;
}
.wp-block-separator.is-style-wide {
  width: 100%;
}
.wp-block-separator.is-style-dots {
  border: none;
  text-align: center;
}
.wp-block-separator.is-style-dots::before {
  content: '';
  color: #ddd;
  font-size: 2em;
  letter-spacing: 1em;
}
/* Spacer blocks */
.wp-block-spacer {
  margin: 0;
}
/* HTML blocks */
.wp-block-html {
  margin: 2em 0;
}
/* Pullquote blocks */
.wp-block-pullquote {
  margin: 2em 0;
  padding: 2em;
  border-top: 4px solid #000;
  border-bottom: 4px solid #000;
  text-align: center;
  font-size: 1.25em;
  font-style: italic;
}
.wp-block-pullquote cite {
  display: block;
  margin-top: 1em;
  font-size: 0.875em;
  font-style: normal;
  color: #666;
}
/* Table blocks */
.wp-block-table {
  margin: 2em 0;
  width: 100%;
  border-collapse: collapse;
}
.wp-block-table table {
  width: 100%;
  border-collapse: collapse;
}
.wp-block-table th,
.wp-block-table td {
  padding: 0.75em;
  border: 1px solid #ddd;
  text-align: left;
}
.wp-block-table th {
  background-color: #f5f5f5;
  font-weight: 600;
}
.wp-block-table.is-style-stripes tbody tr:nth-child(odd) {
  background-color: #f9f9f9;
}
/* Video blocks */
.wp-block-video {
  margin: 2em 0;
}
.wp-block-video video {
  max-width: 100%;
  height: auto;
}
/* Audio blocks */
.wp-block-audio {
  margin: 2em 0;
}
.wp-block-audio audio {
  width: 100%;
}
/* File blocks */
.wp-block-file {
  margin: 2em 0;
}
.wp-block-file__button {
  display: inline-block;
  padding: 0.5em 1em;
  background-color: #000;
  color: #fff;
  text-decoration: none;
  border-radius: 0.25em;
  font-weight: 600;
}
/* Responsive adjustments */
@media (max-width: 768px) {
  .wp-block-group.alignfull {
    margin-left: -1rem;
    margin-right: -1rem;
    padding-left: 1rem;
    padding-right: 1rem;
  }
  .wp-block-quote.is-style-large {
    padding: 1.5em;
    font-size: 1.125em;
  }
}
/* Layout flow */
.is-layout-flow > * {
  margin-block-start: 0;
  margin-block-end: 0;
}
.is-layout-flow > * + * {
  margin-block-start: 1.5em;
}
.is-layout-constrained {
  max-width: 100%;
}
.is-layout-flex {
  display: flex;
}
/* Global padding */
.has-global-padding {
  padding: 2em;
}
@media (max-width: 768px) {
  .has-global-padding {
    padding: 1em;
  }
}
/* Content justification - controls horizontal alignment */
/* These apply to the column's content, not the column itself */
.wp-block-column.is-content-justification-left,
.wp-block-column.is-content-justification-left > * {
  text-align: left;
  align-self: flex-start;
}
.wp-block-column.is-content-justification-center,
.wp-block-column.is-content-justification-center > * {
  text-align: center;
  align-self: center;
}
.wp-block-column.is-content-justification-right,
.wp-block-column.is-content-justification-right > * {
  text-align: right;
  align-self: flex-end;
}
/* For flex layouts, content justification affects child alignment */
.wp-block-column.is-layout-constrained.is-content-justification-left > * {
  align-self: flex-start;
  text-align: left;
}
.wp-block-column.is-layout-constrained.is-content-justification-center > * {
  align-self: center;
  text-align: center;
}
.wp-block-column.is-layout-constrained.is-content-justification-right > * {
  align-self: flex-end;
  text-align: right;
}
/* Remove all editor-specific attributes and styles */
[contenteditable],
[draggable="true"],
[tabindex="0"],
[role="document"],
[aria-label*="Block:"],
[data-block],
[data-type],
[data-title],
[data-is-drop-zone] {
  /* Keep functionality but remove editor-specific behavior */
}
[contenteditable] {
  -webkit-user-modify: read-only;
  user-modify: read-only;
}
[draggable="true"] {
  -webkit-user-drag: none;
  user-drag: none;
}
/* Hide editor UI elements */
.block-editor-block-list__block::before,
.block-editor-block-list__block::after {
  display: none;
}
/* Ensure proper display for all block types */
.wp-block {
  display: block;
  position: relative;
}
.wp-block.is-selected {
  outline: none;
}
/* Container classes */
.wp-container-core-columns-is-layout-9,
.wp-container-core-column-is-layout-10,
.wp-container-core-column-is-layout-14,
.wp-container-core-column-is-layout-15 {
  display: flex;
  flex-direction: column;
}
/* WP Elements */
.wp-elements-3,
.wp-elements-4,
.wp-elements-5,
.wp-elements-6 {
  display: block;
}
````

## File: src/tests/Categories/Categories.spec.ts
````typescript
import { test, expect } from '@playwright/test';
test.describe('Categories Navigation', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('http://localhost:3000/');
  });
  test('should navigate through category pages', async ({ page }) => {
    // Navigate to categories page
    await page.getByRole('link', { name: 'Kategorier' }).click();
    await expect(page).toHaveURL('http://localhost:3000/kategorier');
    // Click a category and verify navigation
    await page.getByRole('link', { name: 'Clothing' }).click();
    await expect(page).toHaveURL(/^http:\/\/localhost:3000\/kategori\/clothing/);
    // Go back to categories
    await page.getByRole('link', { name: 'Kategorier' }).click();
    await expect(page).toHaveURL('http://localhost:3000/kategorier');
    // Try another category
    await page.getByRole('link', { name: 'Tshirts' }).click();
    await expect(page).toHaveURL(/^http:\/\/localhost:3000\/kategori\/tshirts/);
  });
  test('should navigate between categories and home', async ({ page }) => {
    // Go to categories
    await page.getByRole('link', { name: 'Kategorier' }).click();
    await expect(page).toHaveURL('http://localhost:3000/kategorier');
    // Go back home
    await page.getByRole('link', { name: 'NETTBUTIKK' }).click();
    await expect(page).toHaveURL('http://localhost:3000/');
  });
});
````

## File: src/tests/Index/Index.spec.ts
````typescript
import { test, expect } from '@playwright/test';
test.describe('Forside', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('http://localhost:3000');
  });
  test('Har h1 innhold p forsiden', async ({ page }) => {
    const h1 = await page.locator('h1');
    const count = await h1.count();
    await expect(count).toBeGreaterThan(0);
  });
});
````

## File: src/types/product.ts
````typescript
export interface Image {
  __typename: string;
  sourceUrl?: string;
}
export interface Node {
  __typename: string;
  price: string;
  regularPrice: string;
  salePrice?: string;
}
export interface ProductCategory {
  name: string;
  slug: string;
}
export interface ColorNode {
  name: string;
  slug: string;
}
export interface SizeNode {
  name: string;
}
export interface AttributeNode {
  name: string;
  value: string;
}
export interface Product {
  __typename: string;
  databaseId: number;
  name: string;
  onSale: boolean;
  slug: string;
  image: Image;
  price: string;
  regularPrice: string;
  salePrice?: string;
  productCategories?: {
    nodes: ProductCategory[];
  };
  allPaColors?: {
    nodes: ColorNode[];
  };
  allPaSizes?: {
    nodes: SizeNode[];
  };
  variations: {
    nodes: Array<{
      price: string;
      regularPrice: string;
      salePrice?: string;
      attributes?: {
        nodes: AttributeNode[];
      };
    }>;
  };
}
export interface ProductType {
  id: string;
  name: string;
  checked: boolean;
}
````

## File: src/utils/apollo/ApolloClient.js
````javascript
/*eslint complexity: ["error", 8]*/
import {
  ApolloClient,
  InMemoryCache,
  createHttpLink,
  ApolloLink,
} from '@apollo/client';
const SEVEN_DAYS = 7 * 24 * 60 * 60 * 1000; // 7 days in milliseconds
/**
 * Middleware operation
 * If we have a session token in localStorage, add it to the GraphQL request as a Session header.
 */
export const middleware = new ApolloLink(async (operation, forward) => {
  /**
   * If session data exist in local storage, set value as session header.
   * Here we also delete the session if it is older than 7 days
   */
  const sessionData = process.browser
    ? JSON.parse(localStorage.getItem('woo-session'))
    : null;
  const headers = {};
  if (sessionData && sessionData.token && sessionData.createdTime) {
    const { token, createdTime } = sessionData;
    // Check if the token is older than 7 days
    if (Date.now() - createdTime > SEVEN_DAYS) {
      // If it is, delete it
      localStorage.removeItem('woo-session');
      localStorage.setItem('woocommerce-cart', JSON.stringify({}));
    } else {
      // If it's not, use the token
      headers['woocommerce-session'] = `Session ${token}`;
    }
  }
  // Cookie-based authentication - no JWT tokens needed
  // Cookies are automatically included with credentials: 'include'
  operation.setContext({
    headers,
  });
  return forward(operation);
});
/**
 * Afterware operation.
 *
 * This catches the incoming session token and stores it in localStorage, for future GraphQL requests.
 */
export const afterware = new ApolloLink((operation, forward) =>
  forward(operation).map((response) => {
    /**
     * Check for session header and update session in local storage accordingly.
     */
    const context = operation.getContext();
    const {
      response: { headers },
    } = context;
    const session = headers.get('woocommerce-session');
    if (session && process.browser) {
      if ('false' === session) {
        // Remove session data if session destroyed.
        localStorage.removeItem('woo-session');
        // Update session new data if changed.
      } else if (!localStorage.getItem('woo-session')) {
        localStorage.setItem(
          'woo-session',
          JSON.stringify({ token: session, createdTime: Date.now() }),
        );
      }
    }
    return response;
  }),
);
const clientSide = typeof window === 'undefined';
// Apollo GraphQL client.
const client = new ApolloClient({
  ssrMode: clientSide,
  link: middleware.concat(
    afterware.concat(
      createHttpLink({
        uri: process.env.NEXT_PUBLIC_GRAPHQL_URL,
        fetch,
        credentials: 'include', // Include cookies for authentication
      }),
    ),
  ),
  cache: new InMemoryCache(),
});
export default client;
````

## File: src/utils/constants/INPUT_FIELDS.ts
````typescript
export const INPUT_FIELDS = [
  {
    id: 0,
    label: 'First Name',
    name: 'firstName',
    customValidation: { required: true, minlength: 4 },
  },
  {
    id: 1,
    label: 'Last Name',
    name: 'lastName',
    customValidation: { required: true, minlength: 4 },
  },
  {
    id: 2,
    label: 'Address',
    name: 'address1',
    customValidation: { required: true, minlength: 4 },
  },
  {
    id: 3,
    label: 'Postal Code',
    name: 'postcode',
    customValidation: { required: true, minlength: 4, pattern: '[+0-9]{4,6}' },
  },
  {
    id: 4,
    label: 'City',
    name: 'city',
    customValidation: { required: true, minlength: 2 },
  },
  {
    id: 5,
    label: 'Email',
    name: 'email',
    customValidation: { required: true, type: 'email' },
  },
  {
    id: 6,
    label: 'Phone',
    name: 'phone',
    customValidation: { required: true, minlength: 8, pattern: '[+0-9]{8,12}' },
  },
];
````

## File: src/utils/constants/LINKS.ts
````typescript
interface ILinks {
  id: number;
  title: string;
  href: string;
}
const LINKS: ILinks[] = [
  {
    id: 0,
    title: 'Home',
    href: '/',
  },
  {
    id: 1,
    title: 'Products',
    href: '/catalog',
  },
  {
    id: 2,
    title: 'Categories',
    href: '/categories',
  },
];
export default LINKS;
````

## File: src/utils/functions/functions.tsx
````typescript
/*eslint complexity: ["error", 20]*/
import { v4 as uuidv4 } from 'uuid';
import type { Product } from '@/stores/cartStore';
interface RootObject {
  products: Product[];
  totalProductsCount: number;
  totalProductsPrice: number;
}
import { ChangeEvent } from 'react';
import { IVariationNodes } from '@/components/Product/AddToCart.component';
/* Interface for products*/
export interface IImage {
  __typename: string;
  id: string;
  sourceUrl?: string;
  srcSet?: string;
  altText: string;
  title: string;
}
export interface IGalleryImages {
  __typename: string;
  nodes: IImage[];
}
interface IProductNode {
  __typename: string;
  id: string;
  databaseId: number;
  name: string;
  description: string;
  type: string;
  onSale: boolean;
  slug: string;
  averageRating: number;
  reviewCount: number;
  image: IImage;
  galleryImages: IGalleryImages;
  productId: number;
}
interface IProduct {
  __typename: string;
  node: IProductNode;
}
export interface IProductRootObject {
  __typename: string;
  key: string;
  product: IProduct;
  variation?: IVariationNodes;
  quantity: number;
  total: string;
  subtotal: string;
  subtotalTax: string;
}
type TUpdatedItems = { key: string; quantity: number }[];
export interface IUpdateCartItem {
  key: string;
  quantity: number;
}
export interface IUpdateCartInput {
  clientMutationId: string;
  items: IUpdateCartItem[];
}
export interface IUpdateCartVariables {
  input: IUpdateCartInput;
}
export interface IUpdateCartRootObject {
  variables: IUpdateCartVariables;
}
/* Interface for props */
interface IFormattedCartProps {
  cart: { contents: { nodes: IProductRootObject[] }; total: number };
}
export interface ICheckoutDataProps {
  firstName: string;
  lastName: string;
  address1: string;
  address2: string;
  city: string;
  country: string;
  state: string;
  postcode: string;
  email: string;
  phone: string;
  company: string;
  paymentMethod: string;
  metaData?: Array<{ key: string; value: string }>;
  isPaid?: boolean;
  transactionId?: string;
}
/**
 * Add empty character after currency symbol
 * @param {string} price The price string that we input
 * @param {string} symbol Currency symbol to add empty character/padding after
 */
export const paddedPrice = (price: string, symbol: string) =>
  price.split(symbol).join(`${symbol} `);
/**
 * Shorten inputted string (usually product description) to a maximum of length
 * @param {string} input The string that we input
 * @param {number} length The length that we want to shorten the text to
 */
export const trimmedStringToLength = (input: string, length: number) => {
  if (input.length > length) {
    const subStr = input.substring(0, length);
    return `${subStr}...`;
  }
  return input;
};
/**
 * Filter variant price. Changes "kr198.00 - kr299.00" to kr299.00 or kr198 depending on the side variable
 * @param {String} side Which side of the string to return (which side of the "-" symbol)
 * @param {String} price The inputted price that we need to convert
 */
export const filteredVariantPrice = (price: string, side: string) => {
  if ('right' === side) {
    return price.substring(price.length, price.indexOf('-')).replace('-', '');
  }
  return price.substring(0, price.indexOf('-')).replace('-', '');
};
/**
 * Returns cart data in the required format.
 * @param {String} data Cart data
 */
export const getFormattedCart = (data: IFormattedCartProps) => {
  const formattedCart: RootObject = {
    products: [],
    totalProductsCount: 0,
    totalProductsPrice: 0,
  };
  if (!data) {
    return;
  }
  const givenProducts = data.cart.contents.nodes;
  // Create an empty object.
  formattedCart.products = [];
  const product: Product = {
    productId: 0,
    cartKey: '',
    name: '',
    qty: 0,
    price: 0,
    totalPrice: '0',
    image: { sourceUrl: '', srcSet: '', title: '' },
  };
  let totalProductsCount = 0;
  let i = 0;
  if (!givenProducts.length) {
    return;
  }
  givenProducts.forEach(() => {
    const givenProduct = givenProducts[Number(i)].product.node;
    // Convert price to a float value
    const convertedCurrency = givenProducts[Number(i)].total.replace(
      /[^0-9.-]+/g,
      '',
    );
    product.productId = givenProduct.productId;
    product.cartKey = givenProducts[Number(i)].key;
    product.name = givenProduct.name;
    product.qty = givenProducts[Number(i)].quantity;
    product.price = Number(convertedCurrency) / product.qty;
    product.totalPrice = givenProducts[Number(i)].total;
    // Ensure we can add products without images to the cart
    product.image = givenProduct.image.sourceUrl
      ? {
          sourceUrl: givenProduct.image.sourceUrl,
          srcSet: givenProduct.image.srcSet,
          title: givenProduct.image.title,
        }
      : {
          sourceUrl: process.env.NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL,
          srcSet: process.env.NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL,
          title: givenProduct.name,
        };
    totalProductsCount += givenProducts[Number(i)].quantity;
    // Push each item into the products array.
    formattedCart.products.push(product);
    i++;
  });
  formattedCart.totalProductsCount = totalProductsCount;
  formattedCart.totalProductsPrice = data.cart.total;
  return formattedCart;
};
export const createCheckoutData = (order: ICheckoutDataProps) => ({
  clientMutationId: uuidv4(),
  billing: {
    firstName: order.firstName,
    lastName: order.lastName,
    address1: order.address1,
    address2: order.address2,
    city: order.city,
    country: order.country,
    state: order.state,
    postcode: order.postcode,
    email: order.email,
    phone: order.phone,
    company: order.company,
  },
  shipping: {
    firstName: order.firstName,
    lastName: order.lastName,
    address1: order.address1,
    address2: order.address2,
    city: order.city,
    country: order.country,
    state: order.state,
    postcode: order.postcode,
    email: order.email,
    phone: order.phone,
    company: order.company,
  },
  shipToDifferentAddress: false,
  paymentMethod: order.paymentMethod,
  metaData: order.metaData || [],
  isPaid: order.isPaid || false,
  transactionId: order.transactionId || '',
});
/**
 * Get the updated items in the below format required for mutation input.
 *
 * Creates an array in above format with the newQty (updated Qty ).
 *
 */
export const getUpdatedItems = (
  products: IProductRootObject[],
  newQty: number,
  cartKey: string,
) => {
  // Create an empty array.
  const updatedItems: TUpdatedItems = [];
  // Loop through the product array.
  products.forEach((cartItem) => {
    // If you find the cart key of the product user is trying to update, push the key and new qty.
    if (cartItem.key === cartKey) {
      updatedItems.push({
        key: cartItem.key,
        quantity: newQty,
      });
      // Otherwise just push the existing qty without updating.
    } else {
      updatedItems.push({
        key: cartItem.key,
        quantity: cartItem.quantity,
      });
    }
  });
  // Return the updatedItems array with new Qtys.
  return updatedItems;
};
/*
 * When user changes the quantity, update the cart in localStorage
 * Also update the cart in the global Context
 */
export const handleQuantityChange = (
  event: ChangeEvent<HTMLInputElement>,
  cartKey: string,
  cart: IProductRootObject[],
  updateCart: (variables: IUpdateCartRootObject) => void,
  updateCartProcessing: boolean,
) => {
  if (process.browser) {
    event.stopPropagation();
    // Return if the previous update cart mutation request is still processing
    if (updateCartProcessing || !cart) {
      return;
    }
    // If the user tries to delete the count of product, set that to 1 by default ( This will not allow him to reduce it less than zero )
    const newQty = event.target.value ? parseInt(event.target.value, 10) : 1;
    if (cart.length) {
      const updatedItems = getUpdatedItems(cart, newQty, cartKey);
      updateCart({
        variables: {
          input: {
            clientMutationId: uuidv4(),
            items: updatedItems,
          },
        },
      });
    }
  }
};
````

## File: src/utils/functions/productUtils.ts
````typescript
import { Product, ProductCategory, ProductType } from '@/types/product';
export const getUniqueProductTypes = (products: Product[]): ProductType[] => {
  // Use Map to ensure unique categories by slug
  const categoryMap = new Map<string, ProductType>();
  products?.forEach((product) => {
    product.productCategories?.nodes.forEach((cat: ProductCategory) => {
      if (!categoryMap.has(cat.slug)) {
        categoryMap.set(cat.slug, {
          id: cat.slug,
          name: cat.name,
          checked: false,
        });
      }
    });
  });
  // Convert Map values to array and sort by name
  return Array.from(categoryMap.values()).sort((a, b) =>
    a.name.localeCompare(b.name),
  );
};
/**
 * Cleans HTML from text by decoding HTML entities and stripping HTML tags
 * Works on both server and client side
 * @param html - The HTML string to clean
 * @returns Clean plain text
 */
export const cleanHtmlFromText = (html: string | null | undefined): string => {
  if (!html) return '';
  // If we're in the browser, use DOM API for better accuracy
  if (typeof window !== 'undefined' && typeof document !== 'undefined') {
    try {
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = html;
      const text = tempDiv.textContent || tempDiv.innerText || '';
      return text.trim();
    } catch {
      // Fall through to regex-based approach if DOM fails
    }
  }
  // Server-side or fallback: use regex-based approach
  // First decode common HTML entities
  let decoded = html
    .replace(/&amp;/g, '&') // Must be first to avoid double-decoding
    .replace(/&lt;/g, '<')
    .replace(/&gt;/g, '>')
    .replace(/&quot;/g, '"')
    .replace(/&#39;/g, "'")
    .replace(/&apos;/g, "'")
    .replace(/&nbsp;/g, ' ');
  // Handle numeric entities (&#123; and &#x1F; format)
  decoded = decoded.replace(/&#(\d+);/g, (_, dec) => {
    const code = parseInt(dec, 10);
    return code <= 0x10ffff ? String.fromCharCode(code) : '';
  });
  decoded = decoded.replace(/&#x([a-f\d]+);/gi, (_, hex) => {
    const code = parseInt(hex, 16);
    return code <= 0x10ffff ? String.fromCharCode(code) : '';
  });
  // Strip HTML tags using regex
  const stripped = decoded.replace(/<[^>]*>/g, '');
  // Final cleanup: decode any remaining entities and normalize whitespace
  return stripped
    .replace(/&amp;/g, '&')
    .replace(/&lt;/g, '<')
    .replace(/&gt;/g, '>')
    .replace(/&quot;/g, '"')
    .replace(/&#39;/g, "'")
    .replace(/&nbsp;/g, ' ')
    .replace(/\s+/g, ' ') // Normalize multiple spaces to single space
    .trim();
};
````

## File: src/utils/gql/GQL_MUTATIONS.ts
````typescript
import { gql } from '@apollo/client';
export const CREATE_USER = gql`
  mutation CreateUser(
    $username: String!
    $email: String!
    $password: String!
    $firstName: String
    $lastName: String
  ) {
    registerCustomer(
      input: {
        username: $username
        email: $email
        password: $password
        firstName: $firstName
        lastName: $lastName
      }
    ) {
      customer {
        id
        email
        firstName
        lastName
        username
      }
    }
  }
`;
export const LOGIN_USER = gql`
  mutation Login($username: String!, $password: String!) {
    loginWithCookies(input: { login: $username, password: $password }) {
      status
      clientMutationId
    }
  }
`;
export const REFRESH_AUTH_TOKEN = gql`
  mutation RefreshAuthToken($refreshToken: String!) {
    refreshJwtAuthToken(input: { jwtRefreshToken: $refreshToken }) {
      authToken
    }
  }
`;
export const ADD_TO_CART = gql`
  mutation ($input: AddToCartInput!) {
    addToCart(input: $input) {
      cartItem {
        key
        product {
          node {
            id
            databaseId
            name
            description
            type
            onSale
            slug
            averageRating
            reviewCount
            image {
              id
              sourceUrl
              altText
            }
            galleryImages {
              nodes {
                id
                sourceUrl
                altText
              }
            }
          }
        }
        variation {
          node {
            id
            databaseId
            name
            description
            type
            onSale
            price
            regularPrice
            salePrice
            image {
              id
              sourceUrl
              altText
            }
            attributes {
              nodes {
                id
                attributeId
                name
                value
              }
            }
          }
        }
        quantity
        total
        subtotal
        subtotalTax
      }
    }
  }
`;
export const CHECKOUT_MUTATION = gql`
  mutation CHECKOUT_MUTATION($input: CheckoutInput!) {
    checkout(input: $input) {
      result
      redirect
      order {
        id
        databaseId
        orderNumber
        orderKey
        status
        date
        total
        subtotal
        totalTax
        shippingTotal
        paymentMethod
        paymentMethodTitle
        currency
        billing {
          firstName
          lastName
          address1
          address2
          city
          state
          postcode
          country
          email
          phone
          company
        }
        shipping {
          firstName
          lastName
          address1
          address2
          city
          state
          postcode
          country
        }
        lineItems {
          nodes {
            id
            productId
            quantity
            subtotal
            total
            product {
              node {
                id
                name
                image {
                  sourceUrl
                  altText
                }
              }
            }
            variation {
              node {
                id
                name
                image {
                  sourceUrl
                  altText
                }
              }
            }
          }
        }
      }
    }
  }
`;
export const UPDATE_CART = gql`
  mutation ($input: UpdateItemQuantitiesInput!) {
    updateItemQuantities(input: $input) {
      items {
        key
        product {
          node {
            id
            databaseId
            name
            description
            type
            onSale
            slug
            averageRating
            reviewCount
            image {
              id
              sourceUrl
              altText
            }
            galleryImages {
              nodes {
                id
                sourceUrl
                altText
              }
            }
          }
        }
        variation {
          node {
            id
            databaseId
            name
            description
            type
            onSale
            price
            regularPrice
            salePrice
            image {
              id
              sourceUrl
              altText
            }
            attributes {
              nodes {
                id
                attributeId
                name
                value
              }
            }
          }
        }
        quantity
        total
        subtotal
        subtotalTax
      }
      removed {
        key
        product {
          node {
            id
            databaseId
          }
        }
        variation {
          node {
            id
            databaseId
          }
        }
      }
      updated {
        key
        product {
          node {
            id
            databaseId
          }
        }
        variation {
          node {
            id
            databaseId
          }
        }
      }
    }
  }
`;
export const LOGOUT_USER = gql`
  mutation Logout {
    logout {
      status
    }
  }
`;
export const UPDATE_CUSTOMER = gql`
  mutation UpdateCustomer($input: UpdateCustomerInput!) {
    updateCustomer(input: $input) {
      customer {
        id
        email
        firstName
        lastName
        username
        billing {
          firstName
          lastName
          address1
          address2
          city
          postcode
          country
          email
          phone
        }
        shipping {
          firstName
          lastName
          address1
          address2
          city
          postcode
          country
        }
      }
    }
  }
`;
````

## File: src/utils/gql/GQL_QUERIES.ts
````typescript
import { gql } from '@apollo/client';
import blocks from '@/wp-blocks';
export const GET_SINGLE_PRODUCT = gql`
  query Product($slug: ID!) {
    product(id: $slug, idType: SLUG) {
      id
      databaseId
      averageRating
      slug
      description
      onSale
      image {
        id
        uri
        title
        srcSet
        sourceUrl
      }
      name
      metaData(keysIn: ["description", "reviews"]) {
        key
        value
      }
      ... on SimpleProduct {
        salePrice
        regularPrice
        price
        id
        stockQuantity
      }
      ... on VariableProduct {
        salePrice
        regularPrice
        price
        id
        variations {
          nodes {
            id
            databaseId
            name
            stockStatus
            stockQuantity
            purchasable
            onSale
            price
            salePrice
            regularPrice
            attributes {
              nodes {
                name
                value
              }
            }
          }
        }
      }
      ... on ExternalProduct {
        price
        id
        externalUrl
      }
      ... on GroupProduct {
        products {
          nodes {
            ... on SimpleProduct {
              id
              price
            }
          }
        }
        id
      }
    }
  }
`;
/**
 * Fetch first 4 products from a specific category
 */
export const FETCH_FIRST_PRODUCTS_FROM_HOODIES_QUERY = `
 query MyQuery {
  products(first: 4, where: {category: "Hoodies"}) {
    nodes {
      productId
      name
      onSale
      slug
      image {
        sourceUrl
      }
      ... on SimpleProduct {
        price
        regularPrice
        salePrice
      }
      ... on VariableProduct {
        price
        regularPrice
        salePrice
      }
    }
  }
}
 `;
/**
 * Fetch first 200 Woocommerce products from GraphQL
 */
export const FETCH_ALL_PRODUCTS_QUERY = gql`
  query MyQuery {
    products(first: 50) {
      nodes {
        databaseId
        name
        onSale
        slug
        image {
          sourceUrl
        }
        ... on SimpleProduct {
          databaseId
          price
          regularPrice
          salePrice
          productCategories {
            nodes {
              name
              slug
            }
          }
        }
        ... on VariableProduct {
          databaseId
          price
          regularPrice
          salePrice
          productCategories {
            nodes {
              name
              slug
            }
          }
          variations {
            nodes {
              price
              regularPrice
              salePrice
              attributes {
                nodes {
                  name
                  value
                }
              }
            }
          }
        }
      }
    }
  }
`;
/**
 * Fetch first 20 categories from GraphQL
 */
export const FETCH_ALL_CATEGORIES_QUERY = gql`
  query Categories {
    productCategories(first: 20) {
      nodes {
        id
        name
        slug
      }
    }
  }
`;
export const GET_PRODUCTS_FROM_CATEGORY = gql`
  query ProductsFromCategory($id: ID!) {
    productCategory(id: $id) {
      id
      name
      products(first: 50) {
        nodes {
          id
          databaseId
          onSale
          averageRating
          slug
          description
          image {
            id
            uri
            title
            srcSet
            sourceUrl
          }
          name
          ... on SimpleProduct {
            salePrice
            regularPrice
            onSale
            price
            id
          }
          ... on VariableProduct {
            salePrice
            regularPrice
            onSale
            price
            id
          }
          ... on ExternalProduct {
            price
            id
            externalUrl
          }
          ... on GroupProduct {
            products {
              nodes {
                ... on SimpleProduct {
                  id
                  price
                }
              }
            }
            id
          }
        }
      }
    }
  }
`;
export const GET_CART = gql`
  query GET_CART {
    cart {
      contents {
        nodes {
          key
          product {
            node {
              id
              databaseId
              name
              description
              type
              onSale
              slug
              averageRating
              reviewCount
              image {
                id
                sourceUrl
                srcSet
                altText
                title
              }
              galleryImages {
                nodes {
                  id
                  sourceUrl
                  srcSet
                  altText
                  title
                }
              }
            }
          }
          variation {
            node {
              id
              databaseId
              name
              description
              type
              onSale
              price
              regularPrice
              salePrice
              image {
                id
                sourceUrl
                srcSet
                altText
                title
              }
              attributes {
                nodes {
                  id
                  name
                  value
                }
              }
            }
          }
          quantity
          total
          subtotal
          subtotalTax
        }
      }
      subtotal
      subtotalTax
      shippingTax
      shippingTotal
      total
      totalTax
      feeTax
      feeTotal
      discountTax
      discountTotal
    }
  }
`;
export const GET_CURRENT_USER = gql`
  query GET_CURRENT_USER {
    customer {
      id
      firstName
      lastName
      email
      username
      billing {
        firstName
        lastName
        address1
        address2
        city
        postcode
        country
        state
        email
        phone
      }
      shipping {
        firstName
        lastName
        address1
        address2
        city
        postcode
        country
        state
      }
    }
  }
`;
export const GET_CUSTOMER_ORDERS = gql`
  query GET_CUSTOMER_ORDERS {
    customer {
      orders {
        nodes {
          id
          orderNumber
          status
          total
          date
        }
      }
    }
  }
`;
/**
 * Fetch all blog posts for research page
 */
export const GET_ALL_POSTS = gql`
  query GetAllPosts {
    posts(first: 50, where: { status: PUBLISH }) {
      nodes {
        id
        databaseId
        title
        slug
        excerpt
        date
        author {
          node {
            name
          }
        }
        featuredImage {
          node {
            sourceUrl
            altText
            mediaDetails {
              width
              height
            }
          }
        }
        categories {
          nodes {
            name
            slug
          }
        }
      }
    }
  }
`;
/**
 * Fetch a single post by slug
 */
export const GET_POST_BY_SLUG = gql`
  query GetPostBySlug($slug: ID!) {
    post(id: $slug, idType: SLUG) {
      id
      databaseId
      title
      slug
      content
      excerpt
      date
      author {
        node {
          name
        }
      }
      featuredImage {
        node {
          sourceUrl
          altText
          mediaDetails {
            width
            height
          }
        }
      }
      categories {
        nodes {
          name
          slug
        }
      }
      tags {
        nodes {
          name
          slug
        }
      }
      editorBlocks(flat: false) {
        __typename
        name
        renderedHtml
        clientId
        parentClientId
        ... on CoreParagraph {
          attributes {
            content
            className
          }
        }
        ... on CoreHeading {
          attributes {
            content
            level
            className
          }
        }
        ... on CoreImage {
          attributes {
            url
            alt
            caption
            width
            height
            className
          }
        }
        ... on CoreGallery {
          attributes {
            images {
              url
              alt
              id
            }
            columns
            className
          }
        }
        ... on CoreQuote {
          attributes {
            value
            citation
            className
          }
        }
        ... on CoreCode {
          attributes {
            content
            className
          }
        }
        ... on CoreButton {
          attributes {
            text
            url
            className
          }
        }
        ... on CoreColumns {
          attributes {
            className
          }
        }
        ... on CoreColumn {
          attributes {
            width
            className
          }
        }
      }
    }
  }
`;
/**
 * Get all post slugs for static paths
 */
export const GET_ALL_POST_SLUGS = gql`
  query GetAllPostSlugs {
    posts(first: 100, where: { status: PUBLISH }) {
      nodes {
        slug
      }
    }
  }
`;
/**
 * Get all pages for navigation
 */
export const GET_PAGES = gql`
  query GetPages {
    pages(first: 50, where: { status: PUBLISH }) {
      nodes {
        id
        title
        slug
        uri
      }
    }
  }
`;
/**
 * Get a single page by slug
 * Note: WordPress pages don't support idType: SLUG, so we query by URI
 */
export const GET_PAGE_BY_SLUG = gql`
  ${blocks.CoreParagraph.fragments.entry}
  ${blocks.CoreHeading.fragments.entry}
  ${blocks.CoreImage.fragments.entry}
  ${blocks.CoreQuote.fragments.entry}
  ${blocks.CoreCode.fragments.entry}
  ${blocks.CoreButton.fragments.entry}
  ${blocks.CoreButtons.fragments.entry}
  ${blocks.CoreColumns.fragments.entry}
  ${blocks.CoreColumn.fragments.entry}
  ${blocks.CoreList.fragments.entry}
  ${blocks.CoreSeparator.fragments.entry}
  query GetPageBySlug($uri: String!) {
    pageBy(uri: $uri) {
      id
      databaseId
      title
      slug
      content
      date
      featuredImage {
        node {
          sourceUrl
          altText
          mediaDetails {
            width
            height
          }
        }
      }
      editorBlocks(flat: false) {
        __typename
        name
        renderedHtml
        id: clientId
        parentId: parentClientId
        ...${blocks.CoreParagraph.fragments.key}
        ...${blocks.CoreHeading.fragments.key}
        ...${blocks.CoreImage.fragments.key}
        ...${blocks.CoreQuote.fragments.key}
        ...${blocks.CoreCode.fragments.key}
        ...${blocks.CoreButton.fragments.key}
        ...${blocks.CoreButtons.fragments.key}
        ...${blocks.CoreColumns.fragments.key}
        ...${blocks.CoreColumn.fragments.key}
        ...${blocks.CoreList.fragments.key}
        ...${blocks.CoreSeparator.fragments.key}
      }
    }
  }
`;
/**
 * Get all page slugs for static paths
 */
export const GET_ALL_PAGE_SLUGS = gql`
  query GetAllPageSlugs {
    pages(first: 100, where: { status: PUBLISH }) {
      nodes {
        slug
      }
    }
  }
`;
export const GET_AVAILABLE_PAYMENT_GATEWAYS = gql`
  query GetAvailablePaymentGateways {
    paymentGateways {
      nodes {
        id
        title
        description
      }
    }
  }
`;
export const GET_STRIPE_PAYMENT_INTENT = gql`
  query GetStripePaymentIntent($stripePaymentMethod: StripePaymentMethodEnum!) {
    stripePaymentIntent(stripePaymentMethod: $stripePaymentMethod) {
      amount
      clientSecret
      error
      id
      currency
    }
  }
`;
````

## File: src/utils/auth.ts
````typescript
import { ApolloClient, InMemoryCache } from '@apollo/client';
import { LOGIN_USER, LOGOUT_USER } from './gql/GQL_MUTATIONS';
import { GET_CURRENT_USER } from './gql/GQL_QUERIES';
import client from './apollo/ApolloClient';
// Return URL handling for post-login redirects
const RETURN_URL_KEY = 'loginReturnUrl';
export function setReturnUrl(url: string): void {
  if (typeof window !== 'undefined') {
    sessionStorage.setItem(RETURN_URL_KEY, url);
  }
}
export function getReturnUrl(): string | null {
  if (typeof window !== 'undefined') {
    return sessionStorage.getItem(RETURN_URL_KEY);
  }
  return null;
}
export function clearReturnUrl(): void {
  if (typeof window !== 'undefined') {
    sessionStorage.removeItem(RETURN_URL_KEY);
  }
}
export function navigateToLogin(currentRoute?: string): string {
  if (typeof window !== 'undefined') {
    const route = currentRoute || window.location.pathname + window.location.search;
    // Only store return URL if it's not already the login page
    if (route && route !== '/login' && route !== '/account') {
      setReturnUrl(route);
    }
    return '/login';
  }
  return '/login';
}
// Cookie-based authentication - no token storage needed
export function hasCredentials() {
  if (typeof window === 'undefined') {
    return false; // Server-side, no credentials available
  }
  // With cookie-based auth, we'll check if user is logged in through a query
  // For now, we'll return false and let components handle the check
  return false;
}
export async function getAuthToken() {
  // Cookie-based auth doesn't need JWT tokens
  return null;
}
function getErrorMessage(error: any): string {
  // Check for GraphQL errors
  if (error.graphQLErrors && error.graphQLErrors.length > 0) {
    const graphQLError = error.graphQLErrors[0];
    const message = graphQLError.message;
    // Map GraphQL error messages to user-friendly messages
    switch (message) {
      case 'invalid_username':
        return 'Invalid username or email address. Please check and try again.';
      case 'incorrect_password':
        return 'Wrong password. Please check your password and try again.';
      case 'invalid_email':
        return 'Invalid email address. Please enter a valid email address.';
      case 'empty_username':
        return 'Please enter username or email address.';
      case 'empty_password':
        return 'Please enter password.';
      case 'too_many_retries':
        return 'Too many failed attempts. Please wait a moment before trying again.';
      default:
        return 'Login failed. Please check your credentials and try again.';
    }
  }
  // Check for network errors
  if (error.networkError) {
    return 'Network error. Please check your internet connection and try again.';
  }
  // Fallback for other errors
  if (error.message) {
    return 'An error occurred during login. Please try again.';
  }
  return 'An unknown error occurred. Please try again later.';
}
export async function login(username: string, password: string) {
  console.log('[Auth] Starting login process...', { username: username.substring(0, 3) + '***' });
  try {
    // Use the shared Apollo client to ensure cache is updated
    console.log('[Auth] Calling login mutation...');
    const { data, errors } = await client.mutate({
      mutation: LOGIN_USER,
      variables: { username, password },
      fetchPolicy: 'no-cache', // Don't use cache for login
      errorPolicy: 'all',
    });
    console.log('[Auth] Login mutation response:', { 
      hasData: !!data, 
      hasErrors: !!errors,
      errors: errors?.map(e => e.message),
      loginResult: data?.loginWithCookies 
    });
    const loginResult = data?.loginWithCookies;
    if (!loginResult) {
      console.error('[Auth] No login result in response:', { data, errors });
      throw new Error('Login failed. No response from server.');
    }
    if (loginResult.status !== 'SUCCESS') {
      console.error('[Auth] Login failed with status:', loginResult.status);
      throw new Error('Login failed. Please check your credentials and try again.');
    }
    console.log('[Auth] Login successful, clearing Apollo cache...');
    // Clear Apollo cache to ensure fresh user data is fetched
    try {
      await client.clearStore();
      console.log('[Auth] Apollo cache cleared');
      await client.resetStore();
      console.log('[Auth] Apollo store reset');
    } catch (cacheError) {
      console.warn('[Auth] Error clearing cache after login:', cacheError);
      // Continue even if cache clear fails
    }
    // Check cookies - wait a moment for them to be set
    if (typeof window !== 'undefined') {
      // Wait longer for cookies to propagate
      await new Promise(resolve => setTimeout(resolve, 500));
      const cookies = document.cookie;
      console.log('[Auth] Cookies after login:', cookies);
      console.log('[Auth] Cookie string length:', cookies.length);
      const hasWPCookie = cookies.includes('wordpress_logged_in') || 
                         cookies.includes('woocommerce') ||
                         cookies.includes('wp_');
      console.log('[Auth] Has WordPress/WooCommerce cookie:', hasWPCookie);
      // Log all cookie names for debugging
      const cookieNames = cookies.split(';').map(c => c.split('=')[0].trim()).filter(c => c);
      console.log('[Auth] All cookie names:', cookieNames);
      console.log('[Auth] Cookie count:', cookieNames.length);
      // Check if cookies are HttpOnly (not readable by JavaScript)
      if (cookieNames.length === 0 && cookies.length === 0) {
        console.log('[Auth] No cookies visible - they may be HttpOnly (normal for secure auth)');
        console.log('[Auth] HttpOnly cookies are still sent with requests but not readable by JavaScript');
      }
      // Try to verify authentication by checking if we can query customer
      console.log('[Auth] Verifying authentication by querying customer data...');
      try {
        const { data: verifyData } = await client.query({
          query: GET_CURRENT_USER,
          fetchPolicy: 'network-only',
          errorPolicy: 'all',
        });
        console.log('[Auth] Verification query result:', {
          hasCustomer: !!verifyData?.customer,
          customerId: verifyData?.customer?.id,
          customerEmail: verifyData?.customer?.email,
          isGuest: verifyData?.customer?.id === 'guest' || verifyData?.customer?.id === 'cGd1ZXN0',
        });
      } catch (verifyError) {
        console.warn('[Auth] Verification query failed:', verifyError);
      }
    }
    // On successful login, cookies are automatically set by the server
    console.log('[Auth] Login complete, returning success');
    return { success: true, status: loginResult.status };
  } catch (error: unknown) {
    console.error('[Auth] Login error:', error);
    const userFriendlyMessage = getErrorMessage(error);
    throw new Error(userFriendlyMessage);
  }
}
/**
 * Clears all cookies for the current domain
 * This is necessary for proper logout with cookie-based authentication
 */
function clearAllCookies() {
  if (typeof window === 'undefined') {
    console.log('[Auth] clearAllCookies: window is undefined, skipping');
    return;
  }
  console.log('[Auth] clearAllCookies: Starting cookie cleanup...');
  const hostname = window.location.hostname;
  const paths = ['/', '/wp-admin/', '/wp-content/', '/wp-includes/'];
  const domains = [
    hostname,
    `.${hostname}`,
    window.location.host,
    `.${window.location.host}`,
  ];
  console.log('[Auth] clearAllCookies: Hostname:', hostname);
  console.log('[Auth] clearAllCookies: Domains to try:', domains);
  console.log('[Auth] clearAllCookies: Paths to try:', paths);
  // Get all cookies
  const allCookies = document.cookie.split(';');
  const cookiesToClear: string[] = [];
  console.log('[Auth] clearAllCookies: Found', allCookies.length, 'cookies');
  // Collect all cookie names
  allCookies.forEach((cookie) => {
    const cookieName = cookie.split('=')[0].trim();
    if (cookieName) {
      cookiesToClear.push(cookieName);
    }
  });
  console.log('[Auth] clearAllCookies: Cookies to clear:', cookiesToClear);
  // Also clear known WordPress/WooCommerce cookie prefixes
  const cookiePrefixes = [
    'wordpress_logged_in_',
    'wordpress_',
    'wp_',
    'wp-settings-',
    'wp-settings-time-',
    'woocommerce_',
    'woocommerce_cart_',
    'woocommerce_items_in_cart',
    'woocommerce_cart_hash',
    'woocommerce_session_',
  ];
  // Clear cookies with all combinations of paths and domains
  let clearedCount = 0;
  cookiesToClear.forEach((cookieName) => {
    // Check if it matches any prefix or is in our list
    const shouldClear = cookiePrefixes.some((prefix) => cookieName.startsWith(prefix)) || 
                       cookiesToClear.includes(cookieName);
    if (shouldClear) {
      console.log('[Auth] clearAllCookies: Clearing cookie:', cookieName);
      paths.forEach((path) => {
        domains.forEach((domain) => {
          // Try clearing with specific domain and path
          document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}; domain=${domain};`;
          // Also try without domain
          document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path};`;
          // Try with secure flag
          document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}; domain=${domain}; secure;`;
          // Try with SameSite
          document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}; domain=${domain}; SameSite=None; Secure;`;
        });
      });
      clearedCount++;
    }
  });
  console.log('[Auth] clearAllCookies: Attempted to clear', clearedCount, 'cookies');
  console.log('[Auth] clearAllCookies: Remaining cookies:', document.cookie);
}
export async function logout() {
  console.log('[Auth] ========== LOGOUT STARTED ==========');
  try {
    // Step 1: Attempt logout mutation (optional - may not be available in all WPGraphQL setups)
    // For cookie-based auth, server-side logout mutation is optional since cookies are cleared client-side
    console.log('[Auth] Step 1: Attempting logout mutation (optional for cookie-based auth)...');
    try {
      const result = await client.mutate({
        mutation: LOGOUT_USER,
        fetchPolicy: 'no-cache',
        errorPolicy: 'all', // Continue even if mutation fails
      });
      if (result.errors && result.errors.length > 0) {
        const errorMessage = result.errors[0]?.message || 'Unknown error';
        // Check if it's the "field doesn't exist" error (expected)
        if (errorMessage.includes('Cannot query field "logout"')) {
          console.log('[Auth] Step 1: Logout mutation not available in GraphQL schema (expected)');
          console.log('[Auth] Step 1: This is normal - proceeding with client-side cleanup');
        } else {
          console.warn('[Auth] Step 1: Logout mutation error:', errorMessage);
          console.log('[Auth] Step 1: Proceeding with client-side cleanup');
        }
      } else if (result.data?.logout?.status) {
        console.log('[Auth] Step 1: Logout mutation successful, status:', result.data.logout.status);
      } else {
        console.log('[Auth] Step 1: Logout mutation completed (no data, no errors)');
      }
    } catch (error: any) {
      const errorMessage = error?.graphQLErrors?.[0]?.message || error?.message || 'Unknown error';
      // Check if it's the "field doesn't exist" error (expected)
      if (errorMessage.includes('Cannot query field "logout"')) {
        console.log('[Auth] Step 1: Logout mutation not available in GraphQL schema (expected)');
        console.log('[Auth] Step 1: This is normal - proceeding with client-side cleanup');
      } else {
        console.warn('[Auth] Step 1: Logout mutation error:', errorMessage);
        console.log('[Auth] Step 1: Proceeding with client-side cleanup');
      }
    }
    // Step 2: Clear WooCommerce session from localStorage (before clearing all)
    if (typeof window !== 'undefined') {
      console.log('[Auth] Step 2: Clearing WooCommerce session...');
      const wooSession = localStorage.getItem('woo-session');
      const wooCart = localStorage.getItem('woocommerce-cart');
      console.log('[Auth] Before clear - woo-session exists:', !!wooSession, 'woocommerce-cart exists:', !!wooCart);
      localStorage.removeItem('woo-session');
      localStorage.removeItem('woocommerce-cart');
      console.log('[Auth] After clear - woo-session exists:', !!localStorage.getItem('woo-session'), 'woocommerce-cart exists:', !!localStorage.getItem('woocommerce-cart'));
      console.log('[Auth] Step 2: WooCommerce session cleared');
    }
    // Step 3: Clear all cookies (WordPress session cookies, etc.)
    if (typeof window !== 'undefined') {
      console.log('[Auth] Step 3: Clearing cookies...');
      const cookiesBefore = document.cookie;
      console.log('[Auth] Cookies before clear:', cookiesBefore);
      console.log('[Auth] Cookie count before:', cookiesBefore.split(';').filter(c => c.trim()).length);
      clearAllCookies();
      const cookiesAfter = document.cookie;
      console.log('[Auth] Cookies after clear:', cookiesAfter);
      console.log('[Auth] Cookie count after:', cookiesAfter.split(';').filter(c => c.trim()).length);
      console.log('[Auth] Step 3: Cookies cleared');
    }
    // Step 4: Clear Apollo cache (must happen before redirect)
    console.log('[Auth] Step 4: Clearing Apollo cache...');
    try {
      // Clear the cache first
      await client.clearStore();
      console.log('[Auth] Step 4a: Apollo cache cleared');
      // Reset the store to ensure fresh state
      await client.resetStore();
      console.log('[Auth] Step 4b: Apollo store reset');
      console.log('[Auth] Step 4: Apollo cache cleared successfully');
    } catch (cacheError) {
      console.error('[Auth] Step 4: Error clearing Apollo cache:', cacheError);
    }
    // Step 5: Clear remaining localStorage and sessionStorage
    if (typeof window !== 'undefined') {
      console.log('[Auth] Step 5: Clearing storage...');
      const localStorageKeys = Object.keys(localStorage);
      const sessionStorageKeys = Object.keys(sessionStorage);
      console.log('[Auth] localStorage keys before clear:', localStorageKeys);
      console.log('[Auth] sessionStorage keys before clear:', sessionStorageKeys);
      localStorage.clear();
      sessionStorage.clear();
      console.log('[Auth] localStorage keys after clear:', Object.keys(localStorage));
      console.log('[Auth] sessionStorage keys after clear:', Object.keys(sessionStorage));
      console.log('[Auth] Step 5: Storage cleared');
    }
    // Step 6: Force a hard redirect to home page
    // Add a small delay to ensure all cleanup is complete
    if (typeof window !== 'undefined') {
      console.log('[Auth] Step 6: Preparing redirect...');
      const redirectUrl = '/?logout=success&t=' + Date.now();
      console.log('[Auth] Redirect URL:', redirectUrl);
      console.log('[Auth] Current URL:', window.location.href);
      // TEMPORARILY DISABLED: Prevent redirect to capture logs
      console.log('[Auth] REDIRECT DISABLED FOR DEBUGGING - Logout completed!');
      console.log('[Auth] Would redirect to:', redirectUrl);
      // setTimeout(() => {
      //   console.log('[Auth] Step 6: Executing redirect now...');
      //   // Use replace to prevent back button from going to account page
      //   // Add timestamp to prevent caching
      //   window.location.replace(redirectUrl);
      // }, 100);
    }
    console.log('[Auth] ========== LOGOUT COMPLETED ==========');
  } catch (error) {
    console.error('[Auth] Logout error:', error);
    // Even if logout fails, perform comprehensive cleanup
    try {
      if (typeof window !== 'undefined') {
        // Clear WooCommerce session
        localStorage.removeItem('woo-session');
        localStorage.removeItem('woocommerce-cart');
        // Clear all cookies
        clearAllCookies();
        // Clear storage
        localStorage.clear();
        sessionStorage.clear();
      }
      // Clear Apollo cache
      await client.clearStore();
      await client.resetStore();
    } catch (clearError) {
      console.error('[Auth] Error during cleanup:', clearError);
    }
    // Always redirect to home page even on error
    if (typeof window !== 'undefined') {
      // TEMPORARILY DISABLED: Prevent redirect to capture logs
      console.log('[Auth] ERROR HANDLER: REDIRECT DISABLED FOR DEBUGGING');
      console.log('[Auth] ERROR HANDLER: Would redirect to: /?logout=success&t=' + Date.now());
      // setTimeout(() => {
      //   window.location.replace('/?logout=success&t=' + Date.now());
      // }, 100);
    }
  }
}
````

## File: src/wp-blocks/CoreImage.js
````javascript
import { CoreBlocks } from '@faustwp/blocks';
// Get the original CoreImage component from CoreBlocks
// Use destructuring to ensure proper import
const { CoreImage: FaustCoreImage } = CoreBlocks;
if (!FaustCoreImage) {
  throw new Error('CoreImage not found in CoreBlocks. Available blocks: ' + Object.keys(CoreBlocks || {}).join(', '));
}
/**
 * Custom CoreImage component that fixes relative image URLs
 * to use the WordPress URL from environment variables
 */
export function CoreImage(props) {
  const { attributes, renderedHtml } = props;
  // Get WordPress URL from environment
  const wordpressUrl = typeof window !== 'undefined' 
    ? process.env.NEXT_PUBLIC_WORDPRESS_URL || 'http://localhost:8080'
    : process.env.NEXT_PUBLIC_WORDPRESS_URL || 'http://localhost:8080';
  // Create a new props object with fixed attributes
  const fixedProps = {
    ...props,
    attributes: attributes ? { ...attributes } : undefined,
  };
  // Fix relative URLs in attributes
  if (fixedProps.attributes) {
    // Fix src attribute
    if (fixedProps.attributes.src) {
      const src = fixedProps.attributes.src;
      // If src is relative (starts with /), prepend WordPress URL
      if (src.startsWith('/') && !src.startsWith('//')) {
        fixedProps.attributes.src = `${wordpressUrl}${src}`;
      }
      // If src is relative without leading slash, add it
      else if (!src.startsWith('http') && !src.startsWith('//')) {
        fixedProps.attributes.src = `${wordpressUrl}/${src}`;
      }
      // Fix malformed URLs like http://localhost:3000:8080
      else if (src.includes(':3000:8080')) {
        fixedProps.attributes.src = src.replace(':3000:8080', ':8080');
      }
    }
    // Fix url attribute if present
    if (fixedProps.attributes.url) {
      const url = fixedProps.attributes.url;
      if (url.startsWith('/') && !url.startsWith('//')) {
        fixedProps.attributes.url = `${wordpressUrl}${url}`;
      } else if (!url.startsWith('http') && !url.startsWith('//')) {
        fixedProps.attributes.url = `${wordpressUrl}/${url}`;
      } else if (url.includes(':3000:8080')) {
        fixedProps.attributes.url = url.replace(':3000:8080', ':8080');
      }
    }
  }
  // If renderedHtml exists, fix URLs in it
  if (renderedHtml) {
    let fixedHtml = renderedHtml;
    // Fix malformed URLs
    fixedHtml = fixedHtml.replace(/http:\/\/localhost:3000:8080/g, wordpressUrl);
    // Fix relative URLs in src attributes
    fixedHtml = fixedHtml.replace(/src="\/([^"]+)"/g, `src="${wordpressUrl}/$1"`);
    // Fix relative URLs in href attributes
    fixedHtml = fixedHtml.replace(/href="\/([^"]+)"/g, `href="${wordpressUrl}/$1"`);
    fixedProps.renderedHtml = fixedHtml;
  }
  // Use the Faust CoreImage component with fixed props
  return FaustCoreImage(fixedProps);
}
CoreImage.fragments = FaustCoreImage.fragments;
CoreImage.config = FaustCoreImage.config;
CoreImage.displayName = 'CoreImage';
````

## File: src/wp-blocks/index.js
````javascript
import { CoreBlocks } from "@faustwp/blocks";
import { CoreImage } from "./CoreImage.js";
export default {
	...CoreBlocks,
	CoreImage, // Override with custom CoreImage that fixes URLs
};
````

## File: src/faust.config.js
````javascript
import { setConfig } from '@faustwp/core';
/**
 * @type {import('@faustwp/core').FaustConfig}
 **/
export default setConfig({
  templates: {},
  plugins: [],
});
````

## File: .codeclimate.yml
````yaml
version: "2"
checks:
  argument-count:
    config:
      threshold: 4
  complex-logic:
    config:
      threshold: 4
  file-lines:
    config:
      threshold: 150
  method-complexity:
    config:
      threshold: 15
  method-count:
    config:
      threshold: 20
  method-lines:
    config:
      threshold: 150
  nested-control-flow:
    config:
      threshold: 4
  return-statements:
    config:
      threshold: 4
  similar-code:
    config:
      threshold: # language-specific defaults. an override will affect all languages.
  identical-code:
    config:
      threshold: # language-specific defaults. an override will affect all languages.
exclude_patterns:
  - "config/"
  - "db/"
  - "dist/"
  - "features/"
  - "**/node_modules/"
  - "script/"
  - "**/spec/"
  - "**/test/"
  - "**/tests/"
  - "**/vendor/"
  - "**/*.d.ts"
````

## File: .dockerignore
````
# Dependencies
node_modules
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Next.js
.next
out
build
dist

# Testing
coverage
.nyc_output
playwright-report
test-results

# Environment variables
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

# IDE
.vscode
.idea
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db

# Git
.git
.gitignore
.gitattributes

# Documentation
README.md
DOCS
*.md

# CI/CD
.github
.gitlab-ci.yml

# Misc
*.log
.cache
.turbo
.vercel

# Screenshots
screenshots
````

## File: .env.example
````
NEXT_PUBLIC_GRAPHQL_URL="https://wordpress.url.com/graphql"
NEXT_PUBLIC_ALGOLIA_INDEX_NAME= "algolia"
NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL="https://res.cloudinary.com/placeholder-337_utsb7h.jpg"
NEXT_PUBLIC_PLACEHOLDER_LARGE_IMAGE_URL="https://via.placeholder.com/600"
NEXT_PUBLIC_ALGOLIA_APP_ID = "changeme"
NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY = "changeme"
NODE_ENV="development"
NEXT_PUBLIC_AUTH_TOKEN_SS_KEY="auth-token"
NEXT_PUBLIC_REFRESH_TOKEN_LS_KEY="refresh-token"
NEXT_PUBLIC_SESSION_TOKEN_LS_KEY="session-token"
NEXT_PUBLIC_AUTH_KEY_TIMEOUT="300000"
````

## File: .eslintrc.json
````json
{
  "extends": ["next/core-web-vitals", "eslint:recommended"],
  "parser": "@typescript-eslint/parser",
  "plugins": ["@typescript-eslint"],
  "rules": {
    "@next/next/no-img-element": "off",
    "no-useless-escape": "off",
    "@typescript-eslint/no-unused-vars": 1
  },
  "globals": { "JSX": true },
  "env": {
    "browser": true,
    "es6": true
  }
}
````

## File: .gitignore
````
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.js

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# local env files
.env*.local
.env

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
/test-results/
/playwright-report/
/playwright/.cache/
src/pages/registrer.tsx
````

## File: .prettierrc
````
{
  "semi": true,
  "jsxBracketSameLine": false,
  "singleQuote": true,
  "jsxSingleQuote": false
}
````

## File: ACCOUNT_AND_PAYMENT_FIXES.md
````markdown
# Account and Payment Gateway Fixes

## Issues Fixed

### 1. Payment Gateways Not Appearing (Stripe & Cash on Delivery)

**Problem**: Stripe (test mode) and Cash on Delivery were enabled in WooCommerce but not appearing in the checkout.

**Root Cause**: 
- The GraphQL query was not properly handling errors
- No debugging information was available to diagnose issues
- The query might not be returning enabled gateways correctly

**Fixes Applied**:
1. Added comprehensive error handling and debugging logs to `PaymentMethod.component.tsx`
2. Added `fetchPolicy: 'network-only'` to ensure fresh data
3. Added debug logging in development mode to show:
   - All gateways returned from GraphQL
   - Which gateways are enabled
   - Gateway IDs for troubleshooting
4. Improved error messages with helpful troubleshooting information

**Backend Settings to Check**:
1. **WooCommerce Payment Settings**:
   - Go to WordPress Admin  WooCommerce  Settings  Payments
   - Verify that "Stripe" is enabled (check the toggle switch)
   - Verify that "Cash on Delivery" or "Bank Transfer (BACS)" is enabled
   - For Stripe, ensure test mode is properly configured if using test mode

2. **GraphQL Query Verification**:
   - The query `GET_AVAILABLE_PAYMENT_GATEWAYS` should return all enabled gateways
   - Check browser console in development mode for debug logs showing gateway IDs
   - Common Stripe gateway IDs: `stripe`, `stripe_cc`, `woocommerce_gateway_stripe`
   - Cash on Delivery IDs: `cod`, `bacs`

3. **Environment Variable**:
   - Ensure `NEXT_PUBLIC_STRIPE_GATEWAY_ID` is set correctly if your Stripe gateway has a custom ID
   - Default is `stripe` (matches webhook URL format `wc-api=wc_stripe`)

**If Still Not Working**:
- Check browser console for GraphQL errors
- Verify the payment gateways are actually enabled in WooCommerce admin
- Check if the GraphQL endpoint has proper permissions to query payment gateways
- Some payment gateways may require specific WooCommerce settings to be "available" (e.g., currency, country restrictions)

---

### 2. Account Details Not Editable

**Problem**: Account details page showed fields but clicking "Edit" didn't work properly, and changes couldn't be saved.

**Root Cause**:
- Component was setting state during render (causing infinite re-renders)
- No actual GraphQL mutation to update customer data
- Form state management was broken

**Fixes Applied**:
1. Fixed state initialization using `useEffect` instead of setting state during render
2. Added `UPDATE_CUSTOMER` GraphQL mutation to `GQL_MUTATIONS.ts`
3. Implemented proper form submission with mutation
4. Added loading states, success messages, and error handling
5. Added password validation (minimum 8 characters, matching confirmation)
6. Added form reset on cancel

**Backend Requirements**:
- The `updateCustomer` mutation must be available in your WooCommerce GraphQL schema
- This is provided by `wp-graphql-woocommerce` plugin
- No additional backend configuration needed if the plugin is installed and active

**How It Works Now**:
1. User clicks "Edit account details"
2. Form fields become editable
3. User can update:
   - First name
   - Last name
   - Email address
   - Password (optional, requires current password if changing)
4. On save, mutation is called and customer data is updated
5. Success/error messages are displayed
6. Form data is refreshed from server

---

### 3. Addresses Not Editable

**Problem**: Addresses page showed placeholder text with "Edit" buttons that didn't work.

**Root Cause**:
- No edit functionality implemented
- No form for editing addresses
- No mutation to update addresses

**Fixes Applied**:
1. Updated `GET_CURRENT_USER` query to include billing and shipping addresses
2. Created full address editing forms for both billing and shipping
3. Integrated with `UPDATE_CUSTOMER` mutation to save addresses
4. Added proper form validation
5. Added display of existing addresses when available
6. Added "Add" button when no address exists, "Edit" when address exists

**Backend Requirements**:
- Same as Account Details - requires `updateCustomer` mutation from `wp-graphql-woocommerce`
- No additional configuration needed

**How It Works Now**:
1. User sees billing and shipping address sections
2. If address exists, it's displayed; if not, shows "You have not set up this type of address yet"
3. User clicks "Edit" or "Add" button
4. Form appears with all address fields:
   - First name, Last name
   - Address line 1, Address line 2
   - City, Postcode
   - Country, State
   - Email, Phone (billing only)
5. User fills form and clicks "Save address"
6. Address is saved via GraphQL mutation
7. Success message appears and form closes
8. Updated address is displayed

---

### 4. Logout Not Working Properly

**Problem**: Logout button didn't properly clear the session, user remained logged in.

**Root Cause**:
- No GraphQL logout mutation was being called
- Only client-side redirect, no server-side session clearing
- Apollo cache wasn't being cleared

**Fixes Applied**:
1. Added `LOGOUT_USER` GraphQL mutation to `GQL_MUTATIONS.ts`
2. Updated `logout()` function in `auth.ts` to:
   - Call logout mutation to clear server-side session
   - Clear Apollo cache and reset store
   - Clear localStorage and sessionStorage
   - Redirect to home page with success parameter
3. Added proper error handling (continues with client-side cleanup if mutation fails)

**Backend Requirements**:
- The `logout` mutation must be available in your GraphQL schema
- This is typically provided by:
  - `wp-graphql` core plugin (basic logout)
  - `wp-graphql-cors` plugin (enhanced logout with cookie clearing)
- If logout mutation is not available, the function will still work but only clears client-side state

**How It Works Now**:
1. User clicks "Log out" button
2. Logout mutation is called to clear server-side session
3. All client-side storage is cleared (cookies, localStorage, sessionStorage)
4. Apollo cache is cleared and reset
5. User is redirected to home page
6. User is now fully logged out

**If Logout Still Doesn't Work**:
- Check if `logout` mutation exists in your GraphQL schema
- Install/activate `wp-graphql-cors` plugin for enhanced logout functionality
- Check browser console for any errors during logout
- Verify cookies are being cleared (check browser DevTools  Application  Cookies)

---

## Testing Checklist

### Payment Gateways
- [ ] Stripe appears in checkout when enabled in WooCommerce
- [ ] Cash on Delivery appears when enabled
- [ ] Only enabled gateways are shown
- [ ] Error messages appear if query fails
- [ ] Debug logs appear in console (development mode)

### Account Details
- [ ] Can click "Edit account details" button
- [ ] Form fields become editable
- [ ] Can update first name, last name, email
- [ ] Can change password (with validation)
- [ ] Success message appears on save
- [ ] Changes persist after page refresh
- [ ] Cancel button resets form

### Addresses
- [ ] Billing address section displays correctly
- [ ] Shipping address section displays correctly
- [ ] Can click "Edit" or "Add" button
- [ ] Form appears with all fields
- [ ] Can save billing address
- [ ] Can save shipping address
- [ ] Success message appears on save
- [ ] Addresses persist after page refresh

### Logout
- [ ] Can click "Log out" button
- [ ] User is redirected to home page
- [ ] User is logged out (cannot access account pages)
- [ ] Session is cleared (cannot access protected routes)
- [ ] No errors in console

---

## GraphQL Mutations Added

### UPDATE_CUSTOMER
```graphql
mutation UpdateCustomer($input: UpdateCustomerInput!) {
  updateCustomer(input: $input) {
    customer {
      id
      email
      firstName
      lastName
      username
      billing { ... }
      shipping { ... }
    }
  }
}
```

### LOGOUT_USER
```graphql
mutation Logout {
  logout {
    status
  }
}
```

---

## Environment Variables

- `NEXT_PUBLIC_STRIPE_GATEWAY_ID` - Optional, defaults to `stripe`. Set this if your Stripe gateway has a custom ID.

---

## Troubleshooting

### Payment Gateways Still Not Showing
1. Check WooCommerce  Settings  Payments - ensure gateways are enabled
2. Check browser console for GraphQL errors
3. Verify GraphQL endpoint is accessible
4. Check if gateways have country/currency restrictions
5. In development mode, check console logs for gateway IDs

### Account Updates Fail
1. Verify `updateCustomer` mutation exists in GraphQL schema
2. Check browser console for mutation errors
3. Verify user is logged in (mutation requires authentication)
4. Check if fields being updated are allowed by WooCommerce

### Logout Doesn't Clear Session
1. Verify `logout` mutation exists in GraphQL schema
2. Install/activate `wp-graphql-cors` plugin
3. Check browser console for errors
4. Verify cookies are being cleared in DevTools
5. Check if CORS is properly configured for cookie-based auth

---

## Notes

- All fixes maintain backward compatibility
- Error handling is comprehensive with user-friendly messages
- Development mode includes additional debugging information
- All mutations include proper error handling and loading states
````

## File: BEST_PRACTICES_FROM_WOONUXT.md
````markdown
# Best Practices from WooNuxt and Next-WP

## Overview

This document summarizes best practices from **WooNuxt** (Nuxt.js + WooCommerce) and **Next-WP** (Next.js + WordPress) for handling:
- Login/Logout
- Account Pages
- Checkout with Stripe and other payment gateways

## 1. Authentication (Login/Logout)

### WooNuxt Approach

#### Login Mutation
```graphql
mutation login($username: String!, $password: String!) {
  login(
    input: {
      provider: PASSWORD
      credentials: {
        username: $username
        password: $password
      }
    }
  ) {
    authToken
    authTokenExpiration
    refreshToken
    refreshTokenExpiration
    user {
      name
      username
    }
    sessionToken
    customer {
      databaseId
      username
      firstName
      lastName
    }
  }
}
```

**Key Features:**
- Uses `provider: PASSWORD` for username/password authentication
- Returns both JWT tokens (`authToken`, `refreshToken`) and session token
- Returns customer data immediately after login
- Supports OAuth providers (Google, Facebook, etc.)

#### Logout Mutation
```graphql
mutation Logout {
  logout(input: { clientMutationId: "" }) {
    success
  }
}
```

**Implementation Pattern:**
```typescript
async function logoutUser(): Promise<AuthResponse> {
  isPending.value = true;
  try {
    const { logout } = await GqlLogout();
    if (logout) {
      await refreshCart(); // Refresh cart after logout
      clearAllCookies(); // Clear all cookies
      customer.value = { billing: {}, shipping: {} }; // Reset customer state
      clearReturnUrl(); // Clear any stored return URL
    }
    return { success: true };
  } catch (error: any) {
    const errorMsg = getErrorMessage(error);
    return { success: false, error: errorMsg };
  } finally {
    updateViewer(null); // Clear viewer state
    // Redirect based on current route
    if (router.currentRoute.value.path === '/my-account' && viewer.value === null) {
      router.push('/my-account');
    } else {
      router.push('/');
    }
  }
}
```

**Best Practices:**
1. **Clear all state**: Customer, viewer, cart, cookies
2. **Refresh cart**: After logout, refresh cart to clear any session-based cart data
3. **Smart redirect**: Redirect to login page if on account page, otherwise home
4. **Return URL handling**: Store and clear return URLs for post-login redirects

### Current Implementation Comparison

**Your Current Implementation:**
-  Uses `loginWithCookies` mutation (cookie-based auth)
-  Clears cookies, localStorage, sessionStorage
-  Clears Apollo cache
-  Redirects properly

**Improvements from WooNuxt:**
- Consider adding return URL handling for post-login redirects
- Consider refreshing cart after logout
- Consider supporting OAuth providers if needed

---

## 2. Account Pages

### WooNuxt Account Page Structure

**File:** `app/pages/my-account/index.vue`

**Key Features:**
1. **Tab-based navigation** using query parameters (`?tab=my-details`)
2. **Sidebar navigation** with active state management
3. **Conditional rendering** based on authentication status
4. **Post-login redirect handling**

**Structure:**
```vue
<template>
  <div class="container min-h-[600px]">
    <!-- Show login form if not authenticated -->
    <LazyLoginAndRegister v-if="!viewer" />
    
    <!-- Show account dashboard if authenticated -->
    <div v-else class="flex flex-col lg:flex-row">
      <!-- Sidebar Navigation -->
      <div class="lg:sticky top-16 w-full lg:max-w-[260px]">
        <!-- User info with avatar -->
        <section>
          <img :src="avatar" />
          <div>Welcome, {{ viewer?.firstName }}</div>
          <span>{{ viewer?.email }}</span>
        </section>
        
        <!-- Navigation Links -->
        <nav>
          <NuxtLink to="/my-account?tab=my-details" :class="{ active: activeTab == 'my-details' }">
            My Details
          </NuxtLink>
          <NuxtLink to="/my-account?tab=orders">Orders</NuxtLink>
          <NuxtLink to="/my-account?tab=downloads">Downloads</NuxtLink>
          <NuxtLink to="/my-account?tab=wishlist">Wishlist</NuxtLink>
        </nav>
        
        <!-- Logout Button -->
        <button @click="logoutUser">Log out</button>
      </div>
      
      <!-- Main Content Area -->
      <main class="flex-1">
        <AccountMyDetails v-if="activeTab === 'my-details'" />
        <OrderList v-else-if="activeTab === 'orders'" />
        <DownloadList v-else-if="activeTab === 'downloads'" />
        <WishList v-else-if="activeTab === 'wishlist'" />
      </main>
    </div>
  </div>
</template>
```

**Account Details Component:**
```vue
<template>
  <div class="grid gap-8 account-form">
    <PersonalInformation />
    <BillingAndShipping />
    <ChangePassword />
  </div>
</template>
```

**Best Practices:**
1. **Tab-based navigation**: Use query parameters for tabs (`?tab=my-details`)
2. **Lazy loading**: Use `LazyLoginAndRegister` for code splitting
3. **Sticky sidebar**: Keep navigation visible while scrolling
4. **Avatar display**: Show user avatar and welcome message
5. **Mobile responsive**: Different layouts for mobile vs desktop
6. **Component separation**: Separate components for each section (PersonalInformation, BillingAndShipping, ChangePassword)

### Current Implementation Comparison

**Your Current Implementation:**
-  Uses separate routes (`/account`, `/account/orders`, etc.)
-  Has `AccountNavigation` component
-  Has `withAuth` HOC for protection
-  Has separate components for each section

**Improvements from WooNuxt:**
- Consider tab-based navigation for better UX (single page, query params)
- Consider adding avatar display
- Consider lazy loading components
- Consider adding wishlist functionality

---

## 3. Checkout with Stripe

### WooNuxt Stripe Integration

#### Stripe Payment Intent Query
```graphql
query getStripePaymentIntent($stripePaymentMethod: StripePaymentMethodEnum!) {
  stripePaymentIntent(stripePaymentMethod: $stripePaymentMethod) {
    amount
    clientSecret
    error
    id
    currency
  }
}
```

#### Checkout Mutation
```graphql
mutation Checkout(
  $billing: CustomerAddressInput = {}
  $metaData: [MetaDataInput] = { key: "", value: "" }
  $paymentMethod: String = "stripe"
  $shipping: CustomerAddressInput = {}
  $customerNote: String = ""
  $shipToDifferentAddress: Boolean = false
  $account: CreateAccountInput = { username: "", password: "" }
  $transactionId: String = ""
  $isPaid: Boolean = false
) {
  checkout(input: {
    paymentMethod: $paymentMethod
    billing: $billing
    metaData: $metaData
    shipping: $shipping
    customerNote: $customerNote
    shipToDifferentAddress: $shipToDifferentAddress
    account: $account
    transactionId: $transactionId
    isPaid: $isPaid
  }) {
    result
    redirect
    order {
      needsPayment
      needsProcessing
      status
      databaseId
      orderKey
      subtotal
      total
      paymentMethodTitle
      paymentMethod
    }
  }
}
```

#### Stripe Payment Flow

**1. Payment Element (Modern Approach)**
```typescript
// Load Stripe
const stripe = await loadStripe(stripeKey);

// Get payment intent client secret
const { stripePaymentIntent } = await GqlGetStripePaymentIntent({
  stripePaymentMethod: 'PAYMENT'
});
stripeClientSecret.value = stripePaymentIntent?.clientSecret || '';

// Create Stripe Elements
const elements = stripe.elements({
  clientSecret: stripeClientSecret.value
});

// Submit payment
const { error, paymentIntent } = await stripe.confirmPayment({
  elements: elements.value,
  clientSecret: stripeClientSecret.value,
  confirmParams: {
    return_url: `${window.location.origin}/checkout/order-received`,
    payment_method_data: {
      billing_details: {
        name: `${customer.billing.firstName} ${customer.billing.lastName}`,
        email: customer.billing.email,
        address: { ... }
      }
    }
  },
  redirect: 'if_required'
});

// Add metadata to checkout
if (paymentIntent) {
  orderInput.value.metaData.push({ 
    key: '_stripe_payment_intent_id', 
    value: paymentIntent.id 
  });
  orderInput.value.metaData.push({ 
    key: '_stripe_payment_method_id', 
    value: paymentIntent.payment_method 
  });
  orderInput.value.metaData.push({ 
    key: '_stripe_source_id', 
    value: paymentIntent.id 
  });
  orderInput.value.metaData.push({ 
    key: '_stripe_fee', 
    value: '0' 
  });
  orderInput.value.metaData.push({ 
    key: '_stripe_net', 
    value: paymentIntent.amount.toString() 
  });
  orderInput.value.metaData.push({ 
    key: '_stripe_currency', 
    value: paymentIntent.currency 
  });
  orderInput.value.metaData.push({ 
    key: '_stripe_charge_captured', 
    value: 'yes' 
  });
  orderInput.value.metaData.push({ 
    key: '_wc_stripe_payment_method_type', 
    value: 'card' 
  });
  
  isPaid.value = paymentIntent.status === 'succeeded' || paymentIntent.status === 'processing';
  orderInput.value.transactionId = paymentIntent.id;
}
```

**2. Card Element (Legacy Approach)**
```typescript
// Get setup intent
const { stripePaymentIntent } = await GqlGetStripePaymentIntent({
  stripePaymentMethod: 'SETUP'
});
clientSecret = stripePaymentIntent?.clientSecret || '';

// Confirm card setup
const { setupIntent } = await stripe.confirmCardSetup(clientSecret, { 
  payment_method: { card: cardElement } 
});

if (setupIntent) {
  orderInput.value.metaData.push({ 
    key: '_stripe_intent_id', 
    value: setupIntent.id 
  });
  isPaid.value = setupIntent?.status === 'succeeded' || false;
  orderInput.value.transactionId = setupIntent?.id || new Date().getTime().toString();
}
```

#### Checkout Process Flow

```typescript
const processCheckout = async (isPaid = false): Promise<any> => {
  isProcessingOrder.value = true;

  try {
    // 1. Build checkout payload
    const checkoutPayload = buildCheckoutPayload(isPaid);

    // 2. Process checkout
    const { checkout } = await GqlCheckout(checkoutPayload);

    // 3. Handle account creation if requested
    if (orderInput.value.createAccount) {
      await loginUser({ username, password });
    }

    const orderId = checkout?.order?.databaseId;
    const orderKey = checkout?.order?.orderKey;

    // 4. Handle PayPal redirect if needed
    if (checkout?.redirect && isPayPalPayment()) {
      await handlePayPalRedirect(checkout, String(orderId), orderKey);
    } else {
      // 5. Standard redirect to order received page
      router.push(`/checkout/order-received/${orderId}/?key=${orderKey}`);
    }

    // 6. Finalize checkout
    await finalizeCheckout(checkout);

    return checkout;
  } catch (error: any) {
    console.error('Checkout error:', error);
    if (error.message) alert(error.message);
    return null;
  } finally {
    isProcessingOrder.value = false;
  }
};
```

#### Stripe Element Component

**Key Features:**
- Supports both Payment Element (modern) and Card Element (legacy)
- Handles element ready state
- Validates form before submission
- Listens for changes to enable/disable checkout button

**Implementation:**
```vue
<template>
  <div v-if="stripe" id="stripe-element">
    <!-- Payment Element or Card Element -->
  </div>
</template>

<script setup>
const handleStripeElement = (stripeElements: StripeElements): void => {
  elements.value = stripeElements;
  const paymentMethodType = appConfig.stripePaymentMethod || 'payment';

  if (paymentMethodType === 'payment') {
    // Modern Payment Element
    const paymentElement = stripeElements.getElement('payment');
    if (paymentElement) {
      paymentElement.on('change', (event) => {
        isStripeElementReady.value = event.complete;
      });
    }
  } else {
    // Card Element
    const cardElement = stripeElements.getElement('card');
    if (cardElement) {
      cardElement.on('change', (event) => {
        isStripeElementReady.value = event.complete && !event.error;
      });
    }
  }
};
</script>
```

### Current Implementation Comparison

**Your Current Implementation:**
-  Has `PaymentMethod` component that fetches available gateways
-  Has `CreditCardFields` component for card input
-  Uses `CHECKOUT_MUTATION` with payment method

**Improvements from WooNuxt:**
1. **Stripe Payment Intent**: Use GraphQL query to get payment intent client secret
2. **Stripe Elements**: Use `@stripe/stripe-js` and Stripe Elements instead of manual card fields
3. **Payment Metadata**: Add comprehensive Stripe metadata to checkout
4. **Payment Status**: Track `isPaid` status based on payment intent
5. **Error Handling**: Better error handling for payment failures
6. **Payment Element**: Use modern Payment Element for better UX

---

## 4. Payment Gateway Handling

### WooNuxt Payment Gateway Fragment
```graphql
fragment PaymentGateway on PaymentGateway {
  title
  id
  description
}
```

### Payment Options Component

**Features:**
- Displays all enabled payment gateways
- Radio button selection
- Conditional rendering of Stripe Element
- Gateway-specific handling

**Implementation Pattern:**
```vue
<template>
  <div v-if="paymentGateways?.nodes.length">
    <h2>Payment Options</h2>
    <div v-for="gateway in paymentGateways.nodes" :key="gateway.id">
      <label>
        <input 
          type="radio" 
          :value="gateway.id" 
          v-model="selectedPaymentMethod"
        />
        {{ gateway.title }}
      </label>
    </div>
    <!-- Conditionally show Stripe Element -->
    <StripeElement 
      v-if="stripe && selectedPaymentMethod === 'stripe'" 
      :stripe 
      @updateElement="handleStripeElement" 
    />
  </div>
</template>
```

### Current Implementation Comparison

**Your Current Implementation:**
-  Fetches payment gateways from GraphQL
-  Filters by enabled status
-  Conditionally shows credit card fields for Stripe

**Improvements from WooNuxt:**
- Consider using Stripe Elements instead of manual card fields
- Consider adding payment gateway icons/logos
- Consider better visual feedback for selected payment method

---

## 5. Customer Data Management

### WooNuxt Customer Fragment
```graphql
fragment Customer on Customer {
  lastName
  email
  firstName
  username
  databaseId
  sessionToken
  isPayingCustomer
  billing {
    ...Address
  }
  shipping {
    ...Address
  }
}

fragment Address on CustomerAddress {
  address1
  address2
  city
  country
  email
  firstName
  lastName
  phone
  postcode
  company
  state
}
```

### Update Customer Mutation
```graphql
mutation UpdateCustomer($input: UpdateCustomerInput!) {
  updateCustomer(input: $input) {
    customer {
      downloadableItems(first: 100) {
        nodes {
          ...DownloadableItem
        }
      }
    }
  }
}
```

**Best Practices:**
1. **Session Token**: Store and use `sessionToken` for WooCommerce session
2. **Address Fragments**: Reuse address fragments for billing and shipping
3. **Comprehensive Fields**: Include all address fields (company, state, etc.)
4. **Downloadable Items**: Fetch downloadable items with customer data

---

## 6. Key Takeaways and Recommendations

### Authentication
1.  **Current**: Cookie-based auth is good for WordPress
2.  **Improve**: Add return URL handling for post-login redirects
3.  **Improve**: Refresh cart after logout
4.  **Consider**: Support OAuth providers if needed

### Account Pages
1.  **Current**: Separate routes work well
2.  **Consider**: Tab-based navigation for better UX
3.  **Add**: Avatar display and welcome message
4.  **Add**: Lazy loading for better performance

### Checkout & Stripe
1.  **Critical**: Implement Stripe Payment Intent query
2.  **Critical**: Use Stripe Elements instead of manual card fields
3.  **Critical**: Add comprehensive Stripe metadata to checkout
4.  **Improve**: Better error handling for payment failures
5.  **Add**: Support for both Payment Element and Card Element
6.  **Add**: Payment status tracking (`isPaid`)

### Payment Gateways
1.  **Current**: Dynamic gateway fetching is good
2.  **Improve**: Use Stripe Elements for Stripe payments
3.  **Add**: Payment gateway icons/logos
4.  **Add**: Better visual feedback

### Customer Management
1.  **Current**: Update customer mutation is implemented
2.  **Add**: Session token handling for WooCommerce
3.  **Add**: Comprehensive address fragments
4.  **Add**: Downloadable items support

---

## 7. Implementation Priority

### High Priority (Critical for Stripe)
1. **Stripe Payment Intent Query** - Required for Stripe to work properly
2. **Stripe Elements Integration** - Better UX and security
3. **Payment Metadata** - Required for WooCommerce Stripe plugin
4. **Payment Status Tracking** - Ensure orders are marked as paid

### Medium Priority (UX Improvements)
1. **Return URL Handling** - Better post-login experience
2. **Tab-based Account Navigation** - Better UX
3. **Avatar Display** - Personalization
4. **Payment Gateway Icons** - Visual clarity

### Low Priority (Nice to Have)
1. **OAuth Providers** - If needed
2. **Wishlist** - Additional feature
3. **Lazy Loading** - Performance optimization

---

## 8. Code Examples

### Stripe Payment Intent Query (Add to GQL_QUERIES.ts)
```typescript
export const GET_STRIPE_PAYMENT_INTENT = gql`
  query GetStripePaymentIntent($stripePaymentMethod: StripePaymentMethodEnum!) {
    stripePaymentIntent(stripePaymentMethod: $stripePaymentMethod) {
      amount
      clientSecret
      error
      id
      currency
    }
  }
`;
```

### Stripe Elements Component (Create new component)
```typescript
// components/Checkout/StripeElement.component.tsx
"use client";

import { useEffect, useRef } from 'react';
import { loadStripe, StripeElements } from '@stripe/stripe-js';
import { Elements, PaymentElement } from '@stripe/react-stripe-js';

interface StripeElementProps {
  clientSecret: string;
  onElementReady: (elements: StripeElements) => void;
}

const StripeElement = ({ clientSecret, onElementReady }: StripeElementProps) => {
  const stripePromise = loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY!);

  return (
    <Elements stripe={stripePromise} options={{ clientSecret }}>
      <PaymentElement 
        onReady={(elements) => onElementReady(elements)}
      />
    </Elements>
  );
};

export default StripeElement;
```

---

## 9. Resources

- **WooNuxt**: https://github.com/woonuxt/woonuxt
- **Stripe Elements**: https://stripe.com/docs/stripe-js
- **WooCommerce GraphQL**: https://github.com/wp-graphql/wp-graphql-woocommerce
- **Stripe WooCommerce Plugin**: https://woocommerce.com/products/woocommerce-gateway-stripe/

---

## 10. Next Steps

1. **Implement Stripe Payment Intent query**
2. **Create Stripe Elements component**
3. **Update checkout flow to use Stripe Elements**
4. **Add comprehensive Stripe metadata**
5. **Test with Stripe test mode**
6. **Add return URL handling for login**
7. **Consider tab-based account navigation**
````

## File: CODE_OF_CONDUCT.md
````markdown
# Contributor Covenant Code of Conduct

## Our Pledge

In the interest of fostering an open and welcoming environment, we as
contributors and maintainers pledge to making participation in our project and
our community a harassment-free experience for everyone, regardless of age, body
size, disability, ethnicity, sex characteristics, gender identity and expression,
level of experience, education, socio-economic status, nationality, personal
appearance, race, religion, or sexual identity and orientation.

## Our Standards

Examples of behavior that contributes to creating a positive environment
include:

-   Using welcoming and inclusive language
-   Being respectful of differing viewpoints and experiences
-   Gracefully accepting constructive criticism
-   Focusing on what is best for the community
-   Showing empathy towards other community members

Examples of unacceptable behavior by participants include:

-   The use of sexualized language or imagery and unwelcome sexual attention or
    advances
-   Trolling, insulting/derogatory comments, and personal or political attacks
-   Public or private harassment
-   Publishing others' private information, such as a physical or electronic
    address, without explicit permission
-   Other conduct which could reasonably be considered inappropriate in a
    professional setting

## Our Responsibilities

Project maintainers are responsible for clarifying the standards of acceptable
behavior and are expected to take appropriate and fair corrective action in
response to any instances of unacceptable behavior.

Project maintainers have the right and responsibility to remove, edit, or
reject comments, commits, code, wiki edits, issues, and other contributions
that are not aligned to this Code of Conduct, or to ban temporarily or
permanently any contributor for other behaviors that they deem inappropriate,
threatening, offensive, or harmful.

## Scope

This Code of Conduct applies both within project spaces and in public spaces
when an individual is representing the project or its community. Examples of
representing a project or community include using an official project e-mail
address, posting via an official social media account, or acting as an appointed
representative at an online or offline event. Representation of a project may be
further defined and clarified by project maintainers.

## Enforcement

Instances of abusive, harassing, or otherwise unacceptable behavior may be
reported by contacting the project team at . All
complaints will be reviewed and investigated and will result in a response that
is deemed necessary and appropriate to the circumstances. The project team is
obligated to maintain confidentiality with regard to the reporter of an incident.
Further details of specific enforcement policies may be posted separately.

Project maintainers who do not follow or enforce the Code of Conduct in good
faith may face temporary or permanent repercussions as determined by other
members of the project's leadership.

## Attribution

This Code of Conduct is adapted from the [Contributor Covenant][homepage], version 1.4,
available at <https://www.contributor-covenant.org/version/1/4/code-of-conduct.html>

[homepage]: https://www.contributor-covenant.org

For answers to common questions about this code of conduct, see
<https://www.contributor-covenant.org/faq>
````

## File: CONTRIBUTING.md
````markdown
# Contributing

When contributing to this repository, please first discuss the change you wish to make via issue,
email, or any other method with the owners of this repository before making a change. 

Please note we have a code of conduct, please follow it in all your interactions with the project.

## Pull Request Process

1.  Ensure any install or build dependencies are removed before the end of the layer when doing a 
    build.
2.  Update the README.md with details of changes to the interface, this includes new environment 
    variables, exposed ports, useful file locations and container parameters.
3.  Increase the version numbers in any examples files and the README.md to the new version that this
    Pull Request would represent. The versioning scheme we use is [SemVer](http://semver.org/).
4.  You may merge the Pull Request in once you have the sign-off of two other developers, or if you 
    do not have permission to do that, you may request the second reviewer to merge it for you.

## Code of Conduct

### Our Pledge

In the interest of fostering an open and welcoming environment, we as
contributors and maintainers pledge to making participation in our project and
our community a harassment-free experience for everyone, regardless of age, body
size, disability, ethnicity, gender identity and expression, level of experience,
nationality, personal appearance, race, religion, or sexual identity and
orientation.

### Our Standards

Examples of behavior that contributes to creating a positive environment
include:

-   Using welcoming and inclusive language
-   Being respectful of differing viewpoints and experiences
-   Gracefully accepting constructive criticism
-   Focusing on what is best for the community
-   Showing empathy towards other community members

Examples of unacceptable behavior by participants include:

-   The use of sexualized language or imagery and unwelcome sexual attention or
    advances
-   Trolling, insulting/derogatory comments, and personal or political attacks
-   Public or private harassment
-   Publishing others' private information, such as a physical or electronic
    address, without explicit permission
-   Other conduct which could reasonably be considered inappropriate in a
    professional setting

### Our Responsibilities

Project maintainers are responsible for clarifying the standards of acceptable
behavior and are expected to take appropriate and fair corrective action in
response to any instances of unacceptable behavior.

Project maintainers have the right and responsibility to remove, edit, or
reject comments, commits, code, wiki edits, issues, and other contributions
that are not aligned to this Code of Conduct, or to ban temporarily or
permanently any contributor for other behaviors that they deem inappropriate,
threatening, offensive, or harmful.

### Scope

This Code of Conduct applies both within project spaces and in public spaces
when an individual is representing the project or its community. Examples of
representing a project or community include using an official project e-mail
address, posting via an official social media account, or acting as an appointed
representative at an online or offline event. Representation of a project may be
further defined and clarified by project maintainers.

### Enforcement

Instances of abusive, harassing, or otherwise unacceptable behavior may be
reported by contacting the project team at [INSERT EMAIL ADDRESS]. All
complaints will be reviewed and investigated and will result in a response that
is deemed necessary and appropriate to the circumstances. The project team is
obligated to maintain confidentiality with regard to the reporter of an incident.
Further details of specific enforcement policies may be posted separately.

Project maintainers who do not follow or enforce the Code of Conduct in good
faith may face temporary or permanent repercussions as determined by other
members of the project's leadership.

### Attribution

This Code of Conduct is adapted from the [Contributor Covenant][homepage], version 1.4,
available at [http://contributor-covenant.org/version/1/4][version]

[homepage]: http://contributor-covenant.org

[version]: http://contributor-covenant.org/version/1/4/
````

## File: COOLIFY.md
````markdown
# Coolify Deployment Guide

This project is configured for deployment on Coolify.

## Prerequisites

- A Coolify instance running
- Access to your WordPress/WooCommerce GraphQL endpoint
- Algolia account (if using search functionality)

## Environment Variables

Set the following environment variables in Coolify:

### Required

- `NEXT_PUBLIC_GRAPHQL_URL` - Your WooCommerce GraphQL endpoint URL (e.g., `https://your-wordpress-site.com/graphql`)

### Algolia Search (Required if using search)

- `NEXT_PUBLIC_ALGOLIA_APP_ID` - Your Algolia Application ID
- `NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY` - Your Algolia Public API Key
- `NEXT_PUBLIC_ALGOLIA_INDEX_NAME` - Your Algolia Index Name

### Optional

- `NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL` - Placeholder image URL for small product images (default: `https://via.placeholder.com/300`)
- `NEXT_PUBLIC_PLACEHOLDER_LARGE_IMAGE_URL` - Placeholder image URL for large product images (default: `https://via.placeholder.com/800`)

## Deployment Steps

1. **Connect your repository** to Coolify
2. **Set environment variables** in Coolify's environment variable section
3. **Configure build settings**:
   - Build Command: `npm run build` (default)
   - Start Command: Automatically detected from Dockerfile
   - Port: `3000` (default)
4. **Deploy** - Coolify will automatically build and deploy using the Dockerfile

## Docker Configuration

The project includes:
- **Dockerfile**: Multi-stage build optimized for production
- **.dockerignore**: Excludes unnecessary files from Docker build context

## Build Process

The Dockerfile uses a multi-stage build:
1. **Dependencies stage**: Installs npm dependencies
2. **Builder stage**: Builds the Next.js application
3. **Runner stage**: Creates a minimal production image with only necessary files

## Notes

- The application runs on port 3000 by default
- The Dockerfile uses Node.js 20 Alpine for a smaller image size
- The application runs as a non-root user for security
- Standalone output mode is enabled in `next.config.js` for optimal Docker deployment

## Troubleshooting

### Build fails
- Check that all environment variables are set correctly
- Verify that your GraphQL endpoint is accessible
- Check Coolify build logs for specific errors

### Application won't start
- Verify port 3000 is exposed and accessible
- Check environment variables are properly set
- Review application logs in Coolify

### Images not loading
- Ensure your WordPress site allows image access from your Next.js domain
- Check `next.config.js` remote patterns include your image domains
- Verify CORS settings on your WordPress site
````

## File: Dockerfile
````dockerfile
# Stage 1: Dependencies
FROM node:20-alpine AS deps
RUN apk add --no-cache libc6-compat
WORKDIR /app

# Copy package files
COPY package.json package-lock.json* ./
RUN npm install --legacy-peer-deps

# Stage 2: Builder
FROM node:20-alpine AS builder
WORKDIR /app

# Copy dependencies from deps stage
COPY --from=deps /app/node_modules ./node_modules
COPY . .

# Set build-time environment variables
ENV NEXT_TELEMETRY_DISABLED=1

# Build the application
RUN npm run build

# Stage 3: Runner
FROM node:20-alpine AS runner
WORKDIR /app

ENV NODE_ENV=production
ENV NEXT_TELEMETRY_DISABLED=1

# Create a non-root user
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

# Copy necessary files from standalone build
COPY --from=builder --chown=nextjs:nodejs /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs

EXPOSE 3000

ENV PORT=3000
ENV HOSTNAME="0.0.0.0"

CMD ["node", "server.js"]
````

## File: IMPLEMENTATION_COMPLETE.md
````markdown
# Implementation Complete - WooNuxt Best Practices

##  All Tasks Completed

### 1. Stripe Integration (Critical)
-  **Stripe Dependencies**: Added `@stripe/stripe-js` and `@stripe/react-stripe-js` to package.json
-  **Stripe Payment Intent Query**: Added `GET_STRIPE_PAYMENT_INTENT` GraphQL query
-  **Stripe Elements Component**: Created `StripeElement.component.tsx` with Payment Element support
-  **Payment Processing**: Updated `CheckoutForm` to process Stripe payments before checkout
-  **Payment Metadata**: Added comprehensive Stripe metadata to checkout mutation
-  **Payment Status Tracking**: Implemented `isPaid` flag based on payment intent status

### 2. Checkout Flow Updates
-  **CheckoutForm**: Updated to handle Stripe payment confirmation
-  **Billing Component**: Integrated Stripe Elements with payment processing
-  **PaymentMethod Component**: Fetches Stripe payment intent when Stripe is selected
-  **CreditCardFields**: Conditionally uses Stripe Elements for Stripe, manual fields for others
-  **Checkout Mutation**: Updated to include full order data and metadata support

### 3. Return URL Handling
-  **Auth Utility**: Added `setReturnUrl`, `getReturnUrl`, `clearReturnUrl`, and `navigateToLogin` functions
-  **UserLogin Component**: Updated to check for return URL and redirect after login
-  **Session Storage**: Uses sessionStorage to persist return URLs

### 4. Account Page Improvements
-  **Tab-Based Navigation**: Converted account pages to use query parameters (`?tab=my-details`)
-  **Account Navigation**: Updated to support tabs with icons
-  **Avatar Display**: Added avatar display with fallback to initial letter
-  **Welcome Message**: Shows personalized welcome message with user name
-  **Tab Content**: All account sections accessible via tabs (my-details, orders, downloads, addresses, payment-methods, account-details)

### 5. Payment Gateway Icons
-  **Stripe Icon**: Added Stripe logo/icon to payment method selection
-  **Navigation Icons**: Added icons to account navigation items
-  **Visual Feedback**: Improved visual feedback for selected payment methods

##  Implementation Details

### Stripe Payment Flow
1. User selects Stripe as payment method
2. `PaymentMethod` component fetches Stripe payment intent
3. `StripeElement` component renders Payment Element
4. User fills in payment details
5. On form submit, `CheckoutForm` confirms payment with Stripe
6. Payment metadata is added to checkout data
7. Checkout is processed with `isPaid` flag set

### Return URL Flow
1. User tries to access protected page
2. `withAuth` HOC redirects to login with return URL stored
3. User logs in successfully
4. `UserLogin` component checks for return URL
5. User is redirected to original destination

### Account Page Tabs
1. All account sections accessible via `/account?tab=<section>`
2. Navigation uses query parameters instead of separate routes
3. Active tab highlighted based on query parameter
4. Avatar and welcome message displayed in sidebar

##  Environment Variables Required

```bash
# Stripe Configuration
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_... # Your Stripe publishable key
NEXT_PUBLIC_STRIPE_GATEWAY_ID=stripe # Stripe gateway ID (default: 'stripe')

# GraphQL
NEXT_PUBLIC_GRAPHQL_URL=https://your-wordpress-site.com/graphql
```

##  Files Modified/Created

### New Files
- `src/components/Checkout/StripeElement.component.tsx` - Stripe Elements integration
- `BEST_PRACTICES_FROM_WOONUXT.md` - Best practices documentation
- `IMPLEMENTATION_STATUS.md` - Implementation status tracking
- `IMPLEMENTATION_COMPLETE.md` - This file

### Modified Files
- `package.json` - Added Stripe dependencies
- `src/utils/gql/GQL_QUERIES.ts` - Added Stripe payment intent query, updated GET_CURRENT_USER
- `src/utils/gql/GQL_MUTATIONS.ts` - Updated checkout mutation with full order data
- `src/utils/functions/functions.tsx` - Updated checkout data structure
- `src/utils/auth.ts` - Added return URL handling
- `src/components/Checkout/CheckoutForm.component.tsx` - Stripe payment processing
- `src/components/Checkout/Billing.component.tsx` - Stripe Elements integration
- `src/components/Checkout/PaymentMethod.component.tsx` - Payment intent fetching
- `src/components/Checkout/CreditCardFields.component.tsx` - Stripe Elements support
- `src/components/User/UserLogin.component.tsx` - Return URL redirect
- `src/components/User/AccountNavigation.component.tsx` - Tab-based navigation with icons
- `src/pages/account.tsx` - Tab-based account page with avatar

##  Next Steps

1. **Install Dependencies**: Run `npm install` to install Stripe packages
2. **Configure Environment**: Set `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` and `NEXT_PUBLIC_STRIPE_GATEWAY_ID`
3. **Test Stripe Integration**: Test with Stripe test cards
4. **Test Return URLs**: Verify post-login redirects work correctly
5. **Test Account Tabs**: Verify all account sections are accessible via tabs

##  Testing Checklist

- [ ] Stripe payment flow with test cards
- [ ] Payment intent creation
- [ ] Payment confirmation
- [ ] Checkout with Stripe metadata
- [ ] Fallback to manual card fields for other gateways
- [ ] Return URL handling
- [ ] Account page tabs navigation
- [ ] Avatar display
- [ ] Payment gateway icons
- [ ] Logout functionality

##  Documentation

- See `BEST_PRACTICES_FROM_WOONUXT.md` for detailed best practices
- See `IMPLEMENTATION_STATUS.md` for implementation progress

##  Summary

All improvements from WooNuxt have been successfully implemented:
-  Complete Stripe integration with Payment Elements
-  Return URL handling for better UX
-  Tab-based account navigation
-  Avatar display and welcome message
-  Payment gateway icons

The implementation follows WooNuxt best practices and is ready for testing and deployment.
````

## File: IMPLEMENTATION_STATUS.md
````markdown
# Implementation Status - WooNuxt Best Practices

##  Completed

### 1. Stripe Dependencies
-  Added `@stripe/stripe-js` and `@stripe/react-stripe-js` to package.json

### 2. GraphQL Queries
-  Added `GET_STRIPE_PAYMENT_INTENT` query
-  Updated `CHECKOUT_MUTATION` to include full order data and metadata support

### 3. Stripe Elements Component
-  Created `StripeElement.component.tsx` with Payment Element support
-  Supports both Payment Element (modern) and Card Element (legacy)
-  Handles element ready state and payment validation

### 4. Payment Method Component
-  Updated to fetch Stripe payment intent when Stripe is selected
-  Passes client secret to parent components
-  Handles payment gateway icons

### 5. Credit Card Fields Component
-  Updated to conditionally use Stripe Elements for Stripe payments
-  Falls back to manual fields for other gateways (Ecrypt)
-  Integrates with Stripe Elements component

### 6. Checkout Data Structure
-  Updated `ICheckoutDataProps` to include `metaData`, `isPaid`, `transactionId`
-  Updated `createCheckoutData` to include Stripe metadata

### 7. Billing Component
-  Updated to handle Stripe Elements integration
-  Passes Stripe props to PaymentMethod and CreditCardFields

##  In Progress

### 8. Checkout Form Stripe Payment Processing
-  **Needs Implementation**: Process Stripe payment before checkout submission
-  **Needs Implementation**: Confirm payment with Stripe Elements
-  **Needs Implementation**: Add Stripe metadata to checkout data
-  **Needs Implementation**: Handle payment status (`isPaid`)

##  Remaining Tasks

### 9. Return URL Handling
-  Add return URL storage in auth utility
-  Handle post-login redirects
-  Clear return URL after redirect

### 10. Account Pages - Tab Navigation
-  Convert account pages to use query parameters (`?tab=my-details`)
-  Update AccountNavigation to use tabs
-  Update account page routing

### 11. Avatar Display
-  Add avatar field to GET_CURRENT_USER query
-  Display avatar in account navigation
-  Add welcome message with user name

### 12. Payment Gateway Icons
-  Add icons for different payment gateways
-  Improve visual feedback for selected payment method

##  Next Steps

### Priority 1: Complete Stripe Payment Flow
1. Update `CheckoutForm` to:
   - Process Stripe payment before checkout
   - Confirm payment with Stripe Elements
   - Add payment metadata to checkout data
   - Handle payment status

### Priority 2: Return URL Handling
1. Update `auth.ts` to store return URLs
2. Update login flow to redirect after login
3. Update account page to handle redirects

### Priority 3: Account Page Improvements
1. Convert to tab-based navigation
2. Add avatar display
3. Improve UX with welcome message

### Priority 4: Payment Gateway Icons
1. Add icons for Stripe, PayPal, BACS, etc.
2. Improve visual feedback

##  Notes

### Stripe Integration
- Stripe Payment Intent query is implemented
- Stripe Elements component is created
- Payment processing needs to be added to CheckoutForm

### Environment Variables Required
- `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` - Stripe publishable key
- `NEXT_PUBLIC_STRIPE_GATEWAY_ID` - Stripe gateway ID (default: 'stripe')

### Testing Checklist
- [ ] Test Stripe payment flow with test cards
- [ ] Test payment intent creation
- [ ] Test payment confirmation
- [ ] Test checkout with Stripe metadata
- [ ] Test fallback to manual card fields for other gateways
- [ ] Test return URL handling
- [ ] Test account page tabs
- [ ] Test avatar display
````

## File: LICENSE
````
GNU GENERAL PUBLIC LICENSE
                       Version 3, 29 June 2007

 Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.

                            Preamble

  The GNU General Public License is a free, copyleft license for
software and other kinds of works.

  The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
the GNU General Public License is intended to guarantee your freedom to
share and change all versions of a program--to make sure it remains free
software for all its users.  We, the Free Software Foundation, use the
GNU General Public License for most of our software; it applies also to
any other work released this way by its authors.  You can apply it to
your programs, too.

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

  To protect your rights, we need to prevent others from denying you
these rights or asking you to surrender the rights.  Therefore, you have
certain responsibilities if you distribute copies of the software, or if
you modify it: responsibilities to respect the freedom of others.

  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must pass on to the recipients the same
freedoms that you received.  You must make sure that they, too, receive
or can get the source code.  And you must show them these terms so they
know their rights.

  Developers that use the GNU GPL protect your rights with two steps:
(1) assert copyright on the software, and (2) offer you this License
giving you legal permission to copy, distribute and/or modify it.

  For the developers' and authors' protection, the GPL clearly explains
that there is no warranty for this free software.  For both users' and
authors' sake, the GPL requires that modified versions be marked as
changed, so that their problems will not be attributed erroneously to
authors of previous versions.

  Some devices are designed to deny users access to install or run
modified versions of the software inside them, although the manufacturer
can do so.  This is fundamentally incompatible with the aim of
protecting users' freedom to change the software.  The systematic
pattern of such abuse occurs in the area of products for individuals to
use, which is precisely where it is most unacceptable.  Therefore, we
have designed this version of the GPL to prohibit the practice for those
products.  If such problems arise substantially in other domains, we
stand ready to extend this provision to those domains in future versions
of the GPL, as needed to protect the freedom of users.

  Finally, every program is threatened constantly by software patents.
States should not allow patents to restrict development and use of
software on general-purpose computers, but in those that do, we wish to
avoid the special danger that patents applied to a free program could
make it effectively proprietary.  To prevent this, the GPL assures that
patents cannot be used to render the program non-free.

  The precise terms and conditions for copying, distribution and
modification follow.

                       TERMS AND CONDITIONS

  0. Definitions.

  "This License" refers to version 3 of the GNU General Public License.

  "Copyright" also means copyright-like laws that apply to other kinds of
works, such as semiconductor masks.

  "The Program" refers to any copyrightable work licensed under this
License.  Each licensee is addressed as "you".  "Licensees" and
"recipients" may be individuals or organizations.

  To "modify" a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of an
exact copy.  The resulting work is called a "modified version" of the
earlier work or a work "based on" the earlier work.

  A "covered work" means either the unmodified Program or a work based
on the Program.

  To "propagate" a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

  To "convey" a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user through
a computer network, with no transfer of a copy, is not conveying.

  An interactive user interface displays "Appropriate Legal Notices"
to the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent item in the list meets this criterion.

  1. Source Code.

  The "source code" for a work means the preferred form of the work
for making modifications to it.  "Object code" means any non-source
form of a work.

  A "Standard Interface" means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

  The "System Libraries" of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
"Major Component", in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

  The "Corresponding Source" for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

  The Corresponding Source need not include anything that users
can regenerate automatically from other parts of the Corresponding
Source.

  The Corresponding Source for a work in source code form is that
same work.

  2. Basic Permissions.

  All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

  You may make, run and propagate covered works that you do not
convey, without conditions so long as your license otherwise remains
in force.  You may convey covered works to others for the sole purpose
of having them make modifications exclusively for you, or provide you
with facilities for running those works, provided that you comply with
the terms of this License in conveying all material for which you do
not control copyright.  Those thus making or running the covered works
for you must do so exclusively on your behalf, under your direction
and control, on terms that prohibit them from making any copies of
your copyrighted material outside their relationship with you.

  Conveying under any other circumstances is permitted solely under
the conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

  3. Protecting Users' Legal Rights From Anti-Circumvention Law.

  No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

  When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such circumvention
is effected by exercising rights under this License with respect to
the covered work, and you disclaim any intention to limit operation or
modification of the work as a means of enforcing, against the work's
users, your or third parties' legal rights to forbid circumvention of
technological measures.

  4. Conveying Verbatim Copies.

  You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

  You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

  5. Conveying Modified Source Versions.

  You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these conditions:

    a) The work must carry prominent notices stating that you modified
    it, and giving a relevant date.

    b) The work must carry prominent notices stating that it is
    released under this License and any conditions added under section
    7.  This requirement modifies the requirement in section 4 to
    "keep intact all notices".

    c) You must license the entire work, as a whole, under this
    License to anyone who comes into possession of a copy.  This
    License will therefore apply, along with any applicable section 7
    additional terms, to the whole of the work, and all its parts,
    regardless of how they are packaged.  This License gives no
    permission to license the work in any other way, but it does not
    invalidate such permission if you have separately received it.

    d) If the work has interactive user interfaces, each must display
    Appropriate Legal Notices; however, if the Program has interactive
    interfaces that do not display Appropriate Legal Notices, your
    work need not make them do so.

  A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
"aggregate" if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

  6. Conveying Non-Source Forms.

  You may convey a covered work in object code form under the terms
of sections 4 and 5, provided that you also convey the
machine-readable Corresponding Source under the terms of this License,
in one of these ways:

    a) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by the
    Corresponding Source fixed on a durable physical medium
    customarily used for software interchange.

    b) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by a
    written offer, valid for at least three years and valid for as
    long as you offer spare parts or customer support for that product
    model, to give anyone who possesses the object code either (1) a
    copy of the Corresponding Source for all the software in the
    product that is covered by this License, on a durable physical
    medium customarily used for software interchange, for a price no
    more than your reasonable cost of physically performing this
    conveying of source, or (2) access to copy the
    Corresponding Source from a network server at no charge.

    c) Convey individual copies of the object code with a copy of the
    written offer to provide the Corresponding Source.  This
    alternative is allowed only occasionally and noncommercially, and
    only if you received the object code with such an offer, in accord
    with subsection 6b.

    d) Convey the object code by offering access from a designated
    place (gratis or for a charge), and offer equivalent access to the
    Corresponding Source in the same way through the same place at no
    further charge.  You need not require recipients to copy the
    Corresponding Source along with the object code.  If the place to
    copy the object code is a network server, the Corresponding Source
    may be on a different server (operated by you or a third party)
    that supports equivalent copying facilities, provided you maintain
    clear directions next to the object code saying where to find the
    Corresponding Source.  Regardless of what server hosts the
    Corresponding Source, you remain obligated to ensure that it is
    available for as long as needed to satisfy these requirements.

    e) Convey the object code using peer-to-peer transmission, provided
    you inform other peers where the object code and Corresponding
    Source of the work are being offered to the general public at no
    charge under subsection 6d.

  A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

  A "User Product" is either (1) a "consumer product", which means any
tangible personal property which is normally used for personal, family,
or household purposes, or (2) anything designed or sold for incorporation
into a dwelling.  In determining whether a product is a consumer product,
doubtful cases shall be resolved in favor of coverage.  For a particular
product received by a particular user, "normally used" refers to a
typical or common use of that class of product, regardless of the status
of the particular user or of the way in which the particular user
actually uses, or expects or is expected to use, the product.  A product
is a consumer product regardless of whether the product has substantial
commercial, industrial or non-consumer uses, unless such uses represent
the only significant mode of use of the product.

  "Installation Information" for a User Product means any methods,
procedures, authorization keys, or other information required to install
and execute modified versions of a covered work in that User Product from
a modified version of its Corresponding Source.  The information must
suffice to ensure that the continued functioning of the modified object
code is in no case prevented or interfered with solely because
modification has been made.

  If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

  The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or updates
for a work that has been modified or installed by the recipient, or for
the User Product in which it has been modified or installed.  Access to a
network may be denied when the modification itself materially and
adversely affects the operation of the network or violates the rules and
protocols for communication across the network.

  Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

  7. Additional Terms.

  "Additional permissions" are terms that supplement the terms of this
License by making exceptions from one or more of its conditions.
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

  When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

  Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders of
that material) supplement the terms of this License with terms:

    a) Disclaiming warranty or limiting liability differently from the
    terms of sections 15 and 16 of this License; or

    b) Requiring preservation of specified reasonable legal notices or
    author attributions in that material or in the Appropriate Legal
    Notices displayed by works containing it; or

    c) Prohibiting misrepresentation of the origin of that material, or
    requiring that modified versions of such material be marked in
    reasonable ways as different from the original version; or

    d) Limiting the use for publicity purposes of names of licensors or
    authors of the material; or

    e) Declining to grant rights under trademark law for use of some
    trade names, trademarks, or service marks; or

    f) Requiring indemnification of licensors and authors of that
    material by anyone who conveys the material (or modified versions of
    it) with contractual assumptions of liability to the recipient, for
    any liability that these contractual assumptions directly impose on
    those licensors and authors.

  All other non-permissive additional terms are considered "further
restrictions" within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

  If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

  Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions;
the above requirements apply either way.

  8. Termination.

  You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

  However, if you cease all violation of this License, then your
license from a particular copyright holder is reinstated (a)
provisionally, unless and until the copyright holder explicitly and
finally terminates your license, and (b) permanently, if the copyright
holder fails to notify you of the violation by some reasonable means
prior to 60 days after the cessation.

  Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

  Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

  9. Acceptance Not Required for Having Copies.

  You are not required to accept this License in order to receive or
run a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

  10. Automatic Licensing of Downstream Recipients.

  Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

  An "entity transaction" is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

  You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

  11. Patents.

  A "contributor" is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's "contributor version".

  A contributor's "essential patent claims" are all patent claims
owned or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, "control" includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

  Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

  In the following three paragraphs, a "patent license" is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To "grant" such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

  If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  "Knowingly relying" means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

  If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

  A patent license is "discriminatory" if it does not include within
the scope of its coverage, prohibits the exercise of, or is
conditioned on the non-exercise of one or more of the rights that are
specifically granted under this License.  You may not convey a covered
work if you are a party to an arrangement with a third party that is
in the business of distributing software, under which you make payment
to the third party based on the extent of your activity of conveying
the work, and under which the third party grants, to any of the
parties who would receive the covered work from you, a discriminatory
patent license (a) in connection with copies of the covered work
conveyed by you (or copies made from those copies), or (b) primarily
for and in connection with specific products or compilations that
contain the covered work, unless you entered into that arrangement,
or that patent license was granted, prior to 28 March 2007.

  Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

  12. No Surrender of Others' Freedom.

  If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey a
covered work so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you may
not convey it at all.  For example, if you agree to terms that obligate you
to collect a royalty for further conveying from those to whom you convey
the Program, the only way you could satisfy both those terms and this
License would be to refrain entirely from conveying the Program.

  13. Use with the GNU Affero General Public License.

  Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU Affero General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the special requirements of the GNU Affero General Public License,
section 13, concerning interaction through a network will apply to the
combination as such.

  14. Revised Versions of this License.

  The Free Software Foundation may publish revised and/or new versions of
the GNU General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

  Each version is given a distinguishing version number.  If the
Program specifies that a certain numbered version of the GNU General
Public License "or any later version" applies to it, you have the
option of following the terms and conditions either of that numbered
version or of any later version published by the Free Software
Foundation.  If the Program does not specify a version number of the
GNU General Public License, you may choose any version ever published
by the Free Software Foundation.

  If the Program specifies that a proxy can decide which future
versions of the GNU General Public License can be used, that proxy's
public statement of acceptance of a version permanently authorizes you
to choose that version for the Program.

  Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

  15. Disclaimer of Warranty.

  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY
OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM
IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

  16. Limitation of Liability.

  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS
THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE
USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF
DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
SUCH DAMAGES.

  17. Interpretation of Sections 15 and 16.

  If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

                     END OF TERMS AND CONDITIONS

            How to Apply These Terms to Your New Programs

  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

    <one line to give the program's name and a brief idea of what it does.>
    Copyright (C) <year>  <name of author>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

Also add information on how to contact you by electronic and paper mail.

  If the program does terminal interaction, make it output a short
notice like this when it starts in an interactive mode:

    <program>  Copyright (C) <year>  <name of author>
    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
    This is free software, and you are welcome to redistribute it
    under certain conditions; type `show c' for details.

The hypothetical commands `show w' and `show c' should show the appropriate
parts of the General Public License.  Of course, your program's commands
might be different; for a GUI interface, you would use an "about box".

  You should also get your employer (if you work as a programmer) or school,
if any, to sign a "copyright disclaimer" for the program, if necessary.
For more information on this, and how to apply and follow the GNU GPL, see
<https://www.gnu.org/licenses/>.

  The GNU General Public License does not permit incorporating your program
into proprietary programs.  If your program is a subroutine library, you
may consider it more useful to permit linking proprietary applications with
the library.  If this is what you want to do, use the GNU Lesser General
Public License instead of this License.  But first, please read
<https://www.gnu.org/licenses/why-not-lgpl.html>.
````

## File: lighthouserc.json
````json
{
  "ci": {
    "collect": {
      "numberOfRuns": 1,
      "url": [
        "http://localhost:3000/",
        "http://localhost:3000/produkter",
        "http://localhost:3000/kategorier"
      ],
      "port": 3000,
      "settings": {       
        "onlyCategories": [
          "performance",
          "accessibility",
          "best-practices",
          "seo"
        ],
        "skipAudits": ["uses-http2"],
        "throttling": {
          "method": "simulate"
        }
      }
    },
    "upload": { "target": "temporary-public-storage" },
    "assert": {
      "assertions": {
        "categories:performance": ["warn", { "minScore": 0.8 }],
        "categories:accessibility": ["warn", { "minScore": 0.9 }],
        "categories:best-practices": ["warn", { "minScore": 0.9 }],
        "categories:seo": ["warn", { "minScore": 0.9 }],
        "uses-http2": "off"
      }
    }
  }
}
````

## File: LOGOUT_FIX.md
````markdown
# Logout Functionality Fix

## Problem
The logout button was not fully working - users remained logged in after clicking logout.

## Root Causes Identified

1. **Missing Cookie Clearing**: WordPress uses cookie-based authentication, and the logout function wasn't properly clearing all WordPress/WooCommerce session cookies
2. **WooCommerce Session Not Cleared**: The WooCommerce session stored in localStorage (`woo-session`) wasn't being cleared
3. **Incomplete Cleanup Order**: The cleanup steps weren't in the optimal order, and some steps might not complete before redirect

## Fixes Applied

### 1. Added Comprehensive Cookie Clearing
- Added `clearAllCookies()` function that:
  - Identifies all cookies in the browser
  - Clears WordPress-specific cookies (e.g., `wordpress_logged_in_*`, `wordpress_*`, `wp_*`)
  - Clears WooCommerce cookies (e.g., `woocommerce_session_*`, `woocommerce_cart_*`)
  - Attempts to clear cookies with multiple path/domain combinations to ensure they're removed
  - Handles cookies with different security flags (secure, SameSite)

### 2. Proper Cleanup Sequence
The logout now follows this sequence:
1. **Call logout mutation** - Clears server-side session (if available)
2. **Clear WooCommerce session** - Removes `woo-session` and `woocommerce-cart` from localStorage
3. **Clear all cookies** - Removes all WordPress/WooCommerce cookies
4. **Clear Apollo cache** - Clears GraphQL cache and resets store
5. **Clear all storage** - Removes remaining localStorage and sessionStorage
6. **Redirect** - Redirects to home page with timestamp to prevent caching

### 3. Enhanced Error Handling
- Even if the logout mutation fails, all client-side cleanup still happens
- Comprehensive error handling ensures redirect always occurs
- Added delays to ensure cleanup completes before redirect

## Code Changes

### Updated `src/utils/auth.ts`

**Added:**
- `clearAllCookies()` function for comprehensive cookie clearing
- Proper cleanup sequence
- WooCommerce session clearing
- Enhanced error handling

**Key improvements:**
```typescript
// Now clears WooCommerce session first
localStorage.removeItem('woo-session');
localStorage.removeItem('woocommerce-cart');

// Then clears all cookies
clearAllCookies();

// Then clears Apollo cache
await client.clearStore();
await client.resetStore();

// Finally clears all storage and redirects
localStorage.clear();
sessionStorage.clear();
window.location.replace('/?logout=success&t=' + Date.now());
```

## Backend Requirements

### WordPress/GraphQL Configuration

1. **Logout Mutation Must Be Enabled**
   - The `logout` mutation must be available in your GraphQL schema
   - This is typically provided by:
     - `wp-graphql-cors` plugin (recommended) - provides enhanced logout with cookie clearing
     - `wp-graphql` core plugin - provides basic logout mutation

2. **Enable Logout Mutation in wp-graphql-cors**
   - Go to WordPress Admin  GraphQL  Settings  CORS Settings
   - Enable "Add logout mutation for destroying user session"
   - Ensure "Send site credentials" is also enabled

3. **Cookie Settings**
   - Ensure cookies are set with proper domain/path
   - If using cross-domain setup, ensure SameSite and Secure flags are configured correctly

## Testing Checklist

After deploying the fix, test the following:

- [ ] Click "Log out" button
- [ ] User is redirected to home page
- [ ] User cannot access `/account` pages (should redirect to login)
- [ ] Browser DevTools  Application  Cookies shows no WordPress/WooCommerce cookies
- [ ] Browser DevTools  Application  Local Storage shows no `woo-session` or `woocommerce-cart`
- [ ] Browser DevTools  Application  Session Storage is empty
- [ ] After logout, attempting to access account pages redirects to login
- [ ] No errors in browser console during logout
- [ ] User can log in again after logout

## Troubleshooting

### Logout Still Doesn't Work

1. **Check if logout mutation exists:**
   - Open browser DevTools  Network tab
   - Click logout button
   - Look for GraphQL request to `/graphql`
   - Check if mutation is `logout` and if it returns success
   - If mutation doesn't exist, enable it in wp-graphql-cors settings

2. **Check cookies:**
   - Open DevTools  Application  Cookies
   - Before logout, note all WordPress/WooCommerce cookies
   - After logout, verify they're all gone
   - If cookies remain, check cookie domain/path settings

3. **Check console logs:**
   - Open browser console
   - Click logout
   - Look for `[Auth]` log messages
   - Should see: "Starting logout process", "Logout mutation successful", "Cookies cleared", etc.
   - If errors appear, note them for debugging

4. **Verify Apollo cache is cleared:**
   - After logout, try accessing account page
   - Should redirect to login immediately
   - If it shows cached data, Apollo cache might not be clearing properly

### Common Issues

**Issue: User can still access account pages after logout**
- **Cause**: Cookies not being cleared properly
- **Solution**: Check cookie domain/path, ensure `clearAllCookies()` is working

**Issue: Logout mutation fails**
- **Cause**: Mutation not enabled in wp-graphql-cors
- **Solution**: Enable logout mutation in WordPress admin settings

**Issue: User redirected but still logged in**
- **Cause**: Server-side session not cleared
- **Solution**: Ensure logout mutation is working, check WordPress session handling

## Additional Notes

- The logout function now includes comprehensive error handling
- Even if some steps fail, cleanup continues and user is redirected
- All cleanup happens before redirect to ensure proper logout
- Timestamp is added to redirect URL to prevent browser caching
- `window.location.replace()` is used instead of `push()` to prevent back button from going to account page

## Related Files

- `src/utils/auth.ts` - Logout function implementation
- `src/components/User/AccountNavigation.component.tsx` - Logout button component
- `src/utils/gql/GQL_MUTATIONS.ts` - Logout mutation definition
- `src/components/User/withAuth.component.tsx` - Authentication check after logout
````

## File: next.config.js
````javascript
const path = require('path');
const { withFaust } = require('@faustwp/core');
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  output: 'standalone',
  // Set Turbopack root to current directory to avoid permission issues
  turbopack: {
    root: path.resolve(__dirname),
  },
  images: {
    remotePatterns: [
      {
        protocol: 'http',
        hostname: 'localhost',
        port: '8080',
        pathname: '**',
      },
      {
        protocol: 'https',
        hostname: 'swewoocommerce.dfweb.no',
        pathname: '**',
      },
      {
        protocol: 'https',
        hostname: 'res.cloudinary.com',
        pathname: '**',
      },
      {
        protocol: 'https',
        hostname: 'via.placeholder.com',
        pathname: '**',
      },
      {
        protocol: 'https',
        hostname: 'store.moleculepeptides.com',
        pathname: '**',
      },
    ],
  },
};
module.exports = withFaust(nextConfig);
````

## File: package.json
````json
{
  "name": "nextjs-woocommerce",
  "version": "1.2.4",
  "private": true,
  "scripts": {
    "lhci": "lhci autorun",
    "lhci:perf": "lhci autorun --collect.settings.preset=perf",
    "lhci:desktop": "lhci autorun --collect.settings.preset=desktop",
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "format": "prettier --write \"**/*.{js,ts,tsx,json}\"",
    "playwright": "npx playwright test",
    "playwright:ui": "npx playwright test --ui",
    "playwright:debug": "npx playwright test --debug",
    "playwright:codegen": "playwright codegen",
    "refresh": "rm -rf node_modules && rm package-lock.json && npm i && npm run format"
  },
  "keywords": [
    "next.js",
    "next",
    "javascript",
    "framer"
  ],
  "author": "w3bdesign",
  "license": "ISC",
  "dependencies": {
    "@apollo/client": "^3.14.0",
    "@faustwp/blocks": "^6.1.6",
    "@faustwp/cli": "^3.3.4",
    "@faustwp/core": "^3.3.4",
    "@stripe/react-stripe-js": "^2.9.0",
    "@stripe/stripe-js": "^4.0.0",
    "@types/react": "^19.2.7",
    "@wordpress/style-engine": "^2.36.0",
    "algoliasearch": "^4.25.3",
    "autoprefixer": "^10.4.22",
    "graphql": "^16.12.0",
    "lodash": "^4.17.21",
    "lucide-react": "^0.555.0",
    "motion": "^12.23.25",
    "next": "16.0.7",
    "nprogress": "^0.2.0",
    "postcss": "^8.5.6",
    "react": "19.2.1",
    "react-dom": "19.2.1",
    "react-hook-form": "^7.68.0",
    "react-instantsearch-dom": "^6.40.4",
    "uuid": "^13.0.0",
    "zustand": "^5.0.9"
  },
  "devDependencies": {
    "@lhci/cli": "^0.15.1",
    "@playwright/test": "^1.57.0",
    "@types/lodash": "^4.17.21",
    "@types/node": "24.10.1",
    "@types/nprogress": "^0.2.3",
    "@types/react-dom": "^19.2.0",
    "@types/react-instantsearch-dom": "^6.12.9",
    "@types/uuid": "^11.0.0",
    "@typescript-eslint/eslint-plugin": "^8.48.1",
    "@typescript-eslint/parser": "^8.48.1",
    "babel-plugin-styled-components": "^2.1.4",
    "eslint-config-next": "^16.0.7",
    "postcss-preset-env": "^10.4.0",
    "prettier": "^3.7.4",
    "tailwindcss": "^3.4.18",
    "typescript": "^5.9.3"
  }
}
````

## File: playwright.config.ts
````typescript
import type { PlaywrightTestConfig } from '@playwright/test';
import { devices } from '@playwright/test';
/**
 * Read environment variables from file.
 * https://github.com/motdotla/dotenv
 */
/**
 * See https://playwright.dev/docs/test-configuration.
 */
const config: PlaywrightTestConfig = {
  testDir: './src/tests',
  /* Maximum time one test can run for. */
  timeout: 60 * 1000, // Increased to 60 seconds
  expect: {
    /**
     * Maximum time expect() should wait for the condition to be met.
     * For example in `await expect(locator).toHaveText();`
     */
    timeout: 30000, // Increased to 30 seconds
  },
  /* Run tests in files in parallel */
  fullyParallel: true,
  /* Fail the build on CI if you accidentally left test.only in the source code. */
  forbidOnly: Boolean(process.env.CI),
  /* Retry on CI only */
  retries: process.env.CI ? 2 : 0,
  /* Opt out of parallel tests on CI. */
  workers: process.env.CI ? 1 : '100%',
  /* Reporter to use. See https://playwright.dev/docs/test-reporters */
  reporter: process.env.CI ? 'github' : 'html',
  /* Shared settings for all the projects below. See https://playwright.dev/docs/api/class-testoptions. */
  use: {
    /* Maximum time each action such as `click()` can take. Defaults to 0 (no limit). */
    actionTimeout: 30000, // Added 30 second timeout for actions
    /* Base URL to use in actions like `await page.goto('/')`. */
    baseURL: 'http://localhost:3000',
    /* Collect trace when retrying the failed test. See https://playwright.dev/docs/trace-viewer */
    trace: 'on-first-retry',
    viewport: { width: 2560, height: 1440 },
  },
  /* Configure projects for major browsers */
  projects: [
    {
      name: 'chromium',
      use: {
        ...devices['Desktop Chrome'],
      },
    },
    {
      name: 'firefox',
      use: {
        ...devices['Desktop Firefox'],
      },
    },
    {
      name: 'webkit',
      use: {
        ...devices['Desktop Safari'],
      },
    },
    /* Test against mobile viewports. */
    // {
    //   name: 'Mobile Chrome',
    //   use: {
    //     ...devices['Pixel 5'],
    //   },
    // },
    // {
    //   name: 'Mobile Safari',
    //   use: {
    //     ...devices['iPhone 12'],
    //   },
    // },
    /* Test against branded browsers. */
    // {
    //   name: 'Microsoft Edge',
    //   use: {
    //     channel: 'msedge',
    //   },
    // },
    // {
    //   name: 'Google Chrome',
    //   use: {
    //     channel: 'chrome',
    //   },
    // },
  ],
  /* Folder for test artifacts such as screenshots, videos, traces, etc. */
  outputDir: 'test-results/',
  /* Run your local dev server before starting the tests */
  webServer: {
    reuseExistingServer: true,
    command: 'npm run dev',
    port: 3000,
    timeout: 120000, // Added 2 minute timeout for server start
  },
};
export default config;
````

## File: postcss.config.js
````javascript
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};
````

## File: README copy.md
````markdown
[![Lighthouse CI](https://img.shields.io/github/actions/workflow/status/w3bdesign/nextjs-woocommerce/lighthouse.yml?branch=master&label=Lighthouse%20CI&logo=lighthouse&logoColor=white)](https://github.com/w3bdesign/nextjs-woocommerce/actions/workflows/lighthouse.yml)
[![Playwright Tests](https://img.shields.io/github/actions/workflow/status/w3bdesign/nextjs-woocommerce/playwright.yml?branch=master&label=Playwright%20Tests&logo=playwright&logoColor=white)](https://github.com/w3bdesign/nextjs-woocommerce/actions/workflows/playwright.yml)
[![Codacy Badge](https://img.shields.io/codacy/grade/29de6847b01142e6a0183988fc3df46a?logo=codacy&logoColor=white)](https://app.codacy.com/gh/w3bdesign/nextjs-woocommerce?utm_source=github.com&utm_medium=referral&utm_content=w3bdesign/nextjs-woocommerce&utm_campaign=Badge_Grade_Settings)
[![CodeFactor](https://img.shields.io/codefactor/grade/github/w3bdesign/nextjs-woocommerce?logo=codefactor&logoColor=white)](https://www.codefactor.io/repository/github/w3bdesign/nextjs-woocommerce)
[![Quality Gate Status](https://img.shields.io/sonar/alert_status/w3bdesign_nextjs-woocommerce?server=https%3A%2F%2Fsonarcloud.io&logo=sonarcloud&logoColor=white)](https://sonarcloud.io/dashboard?id=w3bdesign_nextjs-woocommerce)

![bilde](https://github.com/user-attachments/assets/08047025-0950-472a-ae7d-932c7faee1db)

## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=w3bdesign/nextjs-woocommerce&type=Date)](https://star-history.com/#w3bdesign/nextjs-woocommerce&Date)

# Next.js Ecommerce site with WooCommerce backend

## Live URL: <https://next-woocommerce.dfweb.no>

## Table Of Contents (TOC)

- [Installation](#installation)
  - [Prerequisites](#prerequisites)
  - [WordPress Plugin Setup](#step-1-wordpress-plugin-setup)
  - [WordPress CORS Configuration](#step-2-wordpress-cors-configuration)
  - [Next.js Project Setup](#step-3-nextjs-project-setup)
  - [WordPress WooCommerce Setup](#step-4-wordpress-woocommerce-setup)
  - [Custom Fields Setup](#step-5-custom-fields-setup-optional)
  - [Image Configuration](#step-6-image-configuration)
  - [Testing](#step-7-testing)
- [Coolify Deployment](#coolify-deployment)
- [Custom Fields Setup](#custom-fields-setup)
- [Features](#features)
- [Lighthouse Performance Monitoring](#lighthouse-performance-monitoring)
- [Troubleshooting](#troubleshooting)
- [Issues](#issues)
- [TODO](#todo)
- [Future Improvements](SUGGESTIONS.md)

## Installation

### Prerequisites

- Node.js 20.x or higher
- npm or yarn package manager
- WordPress site with WooCommerce installed
- Access to WordPress admin panel

### Step 1: WordPress Plugin Setup

Install and activate the following required plugins in your WordPress site:

**Required Plugins:**
- [WooCommerce](https://wordpress.org/plugins/woocommerce) - Ecommerce for WordPress
- [WP GraphQL](https://wordpress.org/plugins/wp-graphql) - Exposes GraphQL API for WordPress
- [WP GraphQL WooCommerce](https://github.com/wp-graphql/wp-graphql-woocommerce) - Adds WooCommerce functionality to WPGraphQL schema
- [WP GraphQL CORS](https://wordpress.org/plugins/wp-graphql-cors/) - Enables CORS for GraphQL requests

**Optional Plugins:**
- [Advanced Custom Fields (ACF)](https://www.advancedcustomfields.com/) - For product custom fields (see [Custom Fields Setup](#custom-fields-setup))
- [WPGraphQL for Advanced Custom Fields](https://wordpress.org/plugins/wp-graphql-acf/) - Exposes ACF fields to GraphQL (required if using ACF)
- [wp-algolia-woo-indexer](https://github.com/w3bdesign/wp-algolia-woo-indexer) - Required for Algolia search functionality
- [headless-wordpress](https://github.com/w3bdesign/headless-wp) - Disables WordPress frontend (optional)

**Tested Versions:**
- WordPress: 6.8.1+
- WooCommerce: 9.9.5+
- WP GraphQL: 2.3.3+
- WP GraphQL WooCommerce: 0.19.0+
- WP GraphQL CORS: 2.1+

### Step 2: WordPress CORS Configuration

**Critical:** This must be configured correctly or the Next.js app won't be able to communicate with WordPress.

1. Go to **WordPress Admin**  **Settings**  **WPGraphQL CORS**
2. In the **Access-Control-Allow-Origin** field, add your Next.js domain:
   - For local development: `http://localhost:3000`
   - For production: `https://your-nextjs-domain.com`
   - Example: `https://try.moleculepeptides.com`
3. Enable **"Send site credentials"** checkbox
4. Enable **"Add Site Address to Access-Control-Allow-Origin header"** checkbox
5. Save settings

**Important:** The server must return a specific origin (not `*`) when using `credentials: 'include'`. The CORS plugin handles this automatically when you add your domain to the allowed origins list.

### Step 3: Next.js Project Setup

1. **Clone the repository:**
   ```bash
   git clone <repository-url>
   cd wordpress-coolify/nextjs-woocommerce
   ```

2. **Install dependencies:**
   ```bash
   npm install --legacy-peer-deps
   ```
   Note: `--legacy-peer-deps` is required due to React 19 compatibility

3. **Configure environment variables:**
   
   Create a `.env.local` file in the project root:
   ```bash
   cp .env.example .env.local
   ```
   
   Edit `.env.local` and set the following variables:
   ```env
   # Required: Your WordPress GraphQL endpoint
   NEXT_PUBLIC_GRAPHQL_URL=https://your-wordpress-site.com/graphql
   
   # Optional: Algolia Search (only if using search)
   # If not configured, search components will be hidden automatically
   NEXT_PUBLIC_ALGOLIA_APP_ID=your_algolia_app_id
   NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY=your_algolia_public_key
   NEXT_PUBLIC_ALGOLIA_INDEX_NAME=your_index_name
   
   # Optional: Stripe WooCommerce Gateway ID
   # Default: 'stripe' (matches webhook URL format wc-api=wc_stripe)
   # Other common values: 'stripe_cc', 'woocommerce_gateway_stripe'
   # Check your WooCommerce  Settings  Payments  Stripe to find the exact ID
   # If your webhook URL shows wc-api=wc_stripe, use 'stripe'
   NEXT_PUBLIC_STRIPE_GATEWAY_ID=stripe
   
   # Optional: Placeholder images
   NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL=https://via.placeholder.com/300
   NEXT_PUBLIC_PLACEHOLDER_LARGE_IMAGE_URL=https://via.placeholder.com/800
   ```

4. **Start development server:**
   ```bash
   npm run dev
   ```

5. **Open your browser:**
   Navigate to `http://localhost:3000`

### Step 4: WordPress WooCommerce Setup

1. **Create products:**
   - Go to **Products**  **Add New**
   - Add at least one product with:
     - Product name
     - Price
     - Product image (recommended)
     - Description
     - Publish the product

2. **Enable payment method:**
   - Go to **WooCommerce**  **Settings**  **Payments**
   - Enable **Cash on Delivery (COD)** payment method
   - Configure as needed

3. **Verify GraphQL endpoint:**
   - Visit `https://your-wordpress-site.com/graphql` in your browser
   - You should see a GraphQL playground or API response
   - If you see an error, verify WP GraphQL plugin is activated

### Step 5: Custom Fields Setup (Optional)

To enable the product detail tabs (Description, COA, Research), you need to set up custom fields in WordPress.

**Quick Setup with ACF:**
1. Install **Advanced Custom Fields** plugin
2. Install **WPGraphQL for Advanced Custom Fields** plugin
3. Create a Field Group named "Product Detail Tabs"
4. Add three fields with these exact names:
   - `description` - Extended description
   - `coa` - Certificate of Analysis
   - `research` - Research information

For detailed instructions, see [WORDPRESS_CUSTOM_FIELDS_SETUP.md](WORDPRESS_CUSTOM_FIELDS_SETUP.md).

### Step 6: Image Configuration

The project is configured to load images from:
- `store.moleculepeptides.com` (already configured)
- Your WordPress media library

If you need to add additional image domains, edit `next.config.js`:
```javascript
images: {
  remotePatterns: [
    {
      protocol: 'https',
      hostname: 'your-image-domain.com',
      pathname: '**',
    },
  ],
}
```

### Step 7: Testing

1. **Test product listing:**
   - Visit `/catalog` or `/products`
   - Products should load from WordPress

2. **Test product page:**
   - Click on a product
   - Verify product details, images, and tabs display correctly

3. **Test cart functionality:**
   - Add a product to cart
   - Verify cart updates
   - Proceed to checkout

4. **Test GraphQL connection:**
   - Open browser DevTools  Network tab
   - Look for requests to `/graphql`
   - Verify no CORS errors

### Development Tools

For debugging and testing, install browser extensions:

- **Apollo Client DevTools:**
  - [Chrome](https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm)
  - [Firefox](https://addons.mozilla.org/en-US/firefox/addon/apollo-developer-tools/)

These tools help you:
- Inspect GraphQL queries and responses
- Debug Apollo Client cache
- Monitor network requests

## Coolify Deployment

This project is configured for deployment on [Coolify](https://coolify.io/), a self-hosted alternative to Heroku/Vercel.

### Prerequisites

- A Coolify instance running
- Access to your WordPress/WooCommerce GraphQL endpoint
- Algolia account (optional, only if using search functionality)

### Environment Variables

Set the following environment variables in Coolify:

**Required:**
- `NEXT_PUBLIC_GRAPHQL_URL` - Your WooCommerce GraphQL endpoint URL (e.g., `https://your-wordpress-site.com/graphql`)

**Algolia Search (Required if using search):**
- `NEXT_PUBLIC_ALGOLIA_APP_ID` - Your Algolia Application ID
- `NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY` - Your Algolia Public API Key
- `NEXT_PUBLIC_ALGOLIA_INDEX_NAME` - Your Algolia Index Name

**Optional:**
- `NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL` - Placeholder image URL for small product images (default: `https://via.placeholder.com/300`)
- `NEXT_PUBLIC_PLACEHOLDER_LARGE_IMAGE_URL` - Placeholder image URL for large product images (default: `https://via.placeholder.com/800`)

### Deployment Steps

1. **Connect your repository** to Coolify
2. **Set build pack to Dockerfile** (not Nixpacks or static site)
3. **Set environment variables** in Coolify's environment variable section
4. **Configure build settings**:
   - Build Command: `npm run build` (default, automatically handled by Dockerfile)
   - Start Command: Automatically detected from Dockerfile
   - Port: `3000` (default)
5. **Deploy** - Coolify will automatically build and deploy using the Dockerfile

### Docker Configuration

The project includes:
- **Dockerfile**: Multi-stage build optimized for production
- **.dockerignore**: Excludes unnecessary files from Docker build context

The Dockerfile uses a multi-stage build:
1. **Dependencies stage**: Installs npm dependencies with `--legacy-peer-deps` to handle React 19 compatibility
2. **Builder stage**: Builds the Next.js application with standalone output
3. **Runner stage**: Creates a minimal production image with only necessary files

### Important Notes

- **Build Pack**: Use **Dockerfile** (not Nixpacks or static site) - this is a Node.js application with server-side rendering
- The application runs on port 3000 by default
- The Dockerfile uses Node.js 20 Alpine for a smaller image size
- The application runs as a non-root user for security
- Standalone output mode is enabled in `next.config.js` for optimal Docker deployment

### Troubleshooting

**Build fails:**
- Check that all required environment variables are set correctly
- Verify that your GraphQL endpoint is accessible from the build environment
- Check Coolify build logs for specific errors

**Application won't start:**
- Verify port 3000 is exposed and accessible
- Check environment variables are properly set
- Review application logs in Coolify

**Images not loading:**
- Ensure your WordPress site allows image access from your Next.js domain
- Check `next.config.js` remote patterns include your image domains
- Verify CORS settings on your WordPress site

For more detailed information, see [COOLIFY.md](COOLIFY.md).

## Custom Fields Setup

The product detail tabs (Description, COA, Research) require custom fields to be set up in WordPress.

**Quick Start:**
1. Install **Advanced Custom Fields (ACF)** plugin
2. Install **WPGraphQL for Advanced Custom Fields** plugin
3. Create a Field Group with three fields:
   - `description` - Extended description
   - `coa` - Certificate of Analysis
   - `research` - Research information

**For detailed step-by-step instructions, see [WORDPRESS_CUSTOM_FIELDS_SETUP.md](WORDPRESS_CUSTOM_FIELDS_SETUP.md).**

## Features

- Next.js version 15.1.7
- React version 18.3.1
- Typescript
- Tests with Playwright
- Connect to Woocommerce GraphQL API and list name, price and display image for products
- Support for simple products and variable products
- Cart handling and checkout with WooCommerce using Zustand for state management
  - Persistent cart state with localStorage sync
  - Efficient updates through selective subscriptions
  - Type-safe cart operations
  - Cash On Delivery payment method
- Algolia search (requires [algolia-woo-indexer](https://github.com/w3bdesign/algolia-woo-indexer))
- Meets WCAG accessibility standards where possible
- Placeholder for products without images
- State Management:
  - Zustand for global state management
  - Apollo Client with GraphQL
- React Hook Form
- Native HTML5 form validation
- Animations with Framer motion, Styled components and Animate.css
- Loading spinner created with Styled Components
- Shows page load progress with Nprogress during navigation
- Fully responsive design
- Category and product listings
- Show stock status
- Pretty URLs with builtin Nextjs functionality
- Tailwind 3 for styling
- JSDoc comments
- Automated Lighthouse performance monitoring
  - Continuous performance, accessibility, and best practices checks
  - Automated reports on every pull request
  - Performance metrics tracking for:
    - Performance score
    - Accessibility compliance
    - Best practices adherence
    - SEO optimization
    - Progressive Web App readiness
- Product filtering:
  - Dynamic color filtering using Tailwind's color system
  - Mobile-optimized filter layout
  - Accessible form controls with ARIA labels
  - Price range slider
  - Size and color filters
  - Product type categorization
  - Sorting options (popularity, price, newest)

## Lighthouse Performance Monitoring

This project uses automated Lighthouse testing through GitHub Actions to ensure high-quality web performance. On every pull request:

- Performance, accessibility, best practices, and SEO are automatically evaluated
- Results are posted directly to the pull request
- Minimum score thresholds are enforced for:
  - Performance: Analyzing loading performance, interactivity, and visual stability
  - Accessibility: Ensuring WCAG compliance and inclusive design
  - Best Practices: Validating modern web development standards
  - SEO: Checking search engine optimization fundamentals
  - PWA: Assessing Progressive Web App capabilities

View the latest Lighthouse results in the GitHub Actions tab under the "Lighthouse Check" workflow.

## Troubleshooting

### CORS Errors

**Error:** `Access to fetch at 'https://your-site.com/graphql' from origin 'https://your-nextjs.com' has been blocked by CORS policy`

**Solution:**
1. Go to WordPress Admin  Settings  WPGraphQL CORS
2. Add your Next.js domain to the "Access-Control-Allow-Origin" field
3. Enable "Send site credentials"
4. Save settings
5. Clear any caching plugins

### GraphQL Connection Errors

**Error:** `Failed to fetch` or `Network error`

**Solutions:**
1. Verify `NEXT_PUBLIC_GRAPHQL_URL` is set correctly in `.env.local`
2. Check that WP GraphQL plugin is activated
3. Test the GraphQL endpoint directly: `https://your-site.com/graphql`
4. Verify CORS is configured (see above)
5. Check WordPress site is accessible and not behind a firewall

### Products Not Displaying

**Possible causes:**
1. **No products in WooCommerce:**
   - Create at least one published product
   - Ensure product has a price set

2. **GraphQL query errors:**
   - Check browser console for errors
   - Verify WP GraphQL WooCommerce plugin is active
   - Test GraphQL endpoint in browser

3. **Products with null prices:**
   - Products without prices are automatically filtered out
   - Set a price for all products

### Images Not Loading

**Error:** `Failed to load resource: the server responded with a status of 400`

**Solutions:**
1. Verify image domain is in `next.config.js` `remotePatterns`
2. Check that images exist in WordPress media library
3. Ensure WordPress allows external image access
4. Verify image URLs are accessible

### Add to Cart Not Working

**Possible causes:**
1. **CORS error:** See CORS Errors section above
2. **GraphQL mutation error:** Check browser console
3. **Product not purchasable:** Verify product stock status in WooCommerce
4. **Missing variation selection:** For variable products, ensure a variation is selected

### TypeScript Errors During Build

**Error:** `Type error: ...`

**Solutions:**
1. Run type checking locally: `npx tsc --noEmit`
2. Fix any TypeScript errors before deploying
3. Ensure all dependencies are installed: `npm install --legacy-peer-deps`

### Build Fails in Coolify/Docker

**Error:** `npm run build` fails

**Solutions:**
1. Check build logs for specific errors
2. Verify all environment variables are set
3. Ensure `package.json` has all required dependencies
4. Check that Node.js version matches (20.x)

### Product Detail Tabs Show "No content available"

**Solution:**
1. Set up custom fields in WordPress (see [Custom Fields Setup](#custom-fields-setup))
2. Add content to the `description`, `coa`, and `research` fields
3. Verify fields are exposed to GraphQL (if using ACF, install WPGraphQL for ACF plugin)
4. Check GraphQL query includes `metaData` field

### Catalog Page Shows "No products found"

**Solutions:**
1. Verify products exist in WooCommerce
2. Check products are published (not draft)
3. Ensure products have prices set
4. Verify GraphQL endpoint is accessible
5. Check browser console for errors

### Algolia Search Errors (changeme-dsn.algolia.net)

**Error:** `Failed to load resource: net::ERR_NAME_NOT_RESOLVED` for `changeme-dsn.algolia.net`

**Solutions:**
1. **If you're not using Algolia search:** The search components will automatically hide when Algolia credentials are not configured. No action needed.
2. **If you want to use Algolia search:**
   - Set up an Algolia account at https://www.algolia.com/
   - Configure the following environment variables:
     - `NEXT_PUBLIC_ALGOLIA_APP_ID` - Your Algolia Application ID
     - `NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY` - Your Algolia Public API Key
     - `NEXT_PUBLIC_ALGOLIA_INDEX_NAME` - Your Algolia Index Name
   - Ensure values are not "changeme" or "changethis" (these are placeholders)
   - Install and configure the [wp-algolia-woo-indexer](https://github.com/w3bdesign/wp-algolia-woo-indexer) WordPress plugin to sync products to Algolia

### Invalid Payment Method Error

**Error:** `ApolloError: Invalid payment method` during checkout

**Solutions:**
1. **Check the Stripe gateway ID in WordPress:**
   - Go to **WooCommerce  Settings  Payments  Stripe**
   - Note the exact gateway ID (most common: `stripe` - matches webhook URL `wc-api=wc_stripe`)
   - Other possible values: `stripe_cc`, `woocommerce_gateway_stripe`
2. **Set the environment variable (if different from default):**
   - The default is `stripe` which matches the webhook URL format `wc-api=wc_stripe`
   - If your gateway ID is different, add `NEXT_PUBLIC_STRIPE_GATEWAY_ID=your_gateway_id` to your `.env.local` file
   - Replace `your_gateway_id` with the actual ID from step 1
3. **Verify webhook URL matches:**
   - If your webhook URL shows `wc-api=wc_stripe`, use `stripe` as the gateway ID
   - This is the most common configuration
3. **Verify Stripe plugin is active:**
   - Ensure WooCommerce Stripe plugin is installed and activated
   - Check that Stripe payment method is enabled in WooCommerce settings
4. **Restart your development server** after changing environment variables

### I am getting a cart undefined error or other GraphQL errors

**Solution:**
- Check that you are using version 0.19.0+ of the [wp-graphql-woocommerce](https://github.com/wp-graphql/wp-graphql-woocommerce) plugin
- Verify WP GraphQL CORS plugin is configured correctly
- Check that cart mutations are enabled in WooCommerce settings

### The products page isn't loading

**Solution:**
- Check the attributes of the products. The application works with products that have or don't have Size and Color attributes
- Verify products are published and have prices
- Check browser console for specific errors

## Issues

Overall the application is working as intended, but it has not been tested extensively in a production environment.
More testing and debugging is required before deploying it in a production environment.

With that said, keep the following in mind:

- Currently only simple products and variable products work without any issues. Other product types are not known to work.
- Only Cash On Delivery (COD) is currently supported. More payment methods may be added later.

This project is tested with BrowserStack.

## TODO

- Implement UserRegistration.component.tsx in a registration page
- Add user dashboard with order history
- Add Cloudflare Turnstile on registration page
- Ensure email is real on registration page
- Add total to cart/checkout page
- Copy billing address to shipping address
- Hide products not in stock
````

## File: renovate.json
````json
{
  "extends": ["config:recommended"],
  "ignorePresets": [":prHourlyLimit2", ":prConcurrentLimit20"],
  "packageRules": [
    {
      "rangeStrategy": "bump",
      "matchDepTypes": [
        "dependencies",
        "devDependencies",
        "optionalDependencies",
        "peerDependencies"
      ]
    },
    {
      "matchUpdateTypes": ["minor", "pin", "digest"],
      "automerge": true,
      "matchDepTypes": [
        "dependencies",
        "devDependencies",
        "optionalDependencies",
        "peerDependencies"
      ]
    },
    {
      "matchUpdateTypes": ["patch", "lockFileMaintenance"],
      "automerge": true,
      "automergeType": "branch",
      "matchDepTypes": [
        "dependencies",
        "devDependencies",
        "optionalDependencies",
        "peerDependencies"
      ]
    }
  ]
}
````

## File: STRIPE_ENV_VARIABLES_EXPLAINED.md
````markdown
# Why Do We Need Stripe Environment Variables?

## Overview

Two environment variables are required for Stripe integration to work properly:

1. `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` - **Required for Stripe Elements**
2. `NEXT_PUBLIC_STRIPE_GATEWAY_ID` - **Required to identify Stripe in WooCommerce**

## 1. NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY

### Why It's Needed

**This is Stripe's client-side API key** that allows your frontend to:
- Load Stripe's JavaScript SDK (`@stripe/stripe-js`)
- Initialize Stripe Elements (the payment form)
- Create payment intents
- Process payments securely

### Where It's Used

```typescript
// src/components/Checkout/StripeElement.component.tsx
const stripePromise = process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY
  ? loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY)
  : null;
```

**Without this key:**
- Stripe Elements won't load
- Payment form won't render
- Users can't enter card details
- Stripe payment processing won't work

### How to Get It

1. Go to [Stripe Dashboard](https://dashboard.stripe.com/)
2. Navigate to **Developers  API keys**
3. Copy the **Publishable key** (starts with `pk_test_` for test mode or `pk_live_` for live mode)

### Security Note

 **Safe to expose**: Publishable keys are designed to be used in client-side code
- They're public and visible in your frontend code
- They can only create payment intents, not charge cards directly
- They require a secret key on the backend to actually process payments

---

## 2. NEXT_PUBLIC_STRIPE_GATEWAY_ID

### Why It's Needed

**WooCommerce can have different Stripe gateway IDs** depending on:
- Which Stripe plugin is installed
- How the plugin is configured
- Plugin version

Common values:
- `stripe` (most common, default)
- `stripe_cc`
- `woocommerce_gateway_stripe`
- Custom IDs if multiple Stripe gateways are configured

### Where It's Used

```typescript
// src/components/Checkout/PaymentMethod.component.tsx
const stripeGatewayId = process.env.NEXT_PUBLIC_STRIPE_GATEWAY_ID || 'stripe';

// Check if Stripe is enabled
const isStripeEnabled = enabledGatewayIds.has(stripeGatewayId) || 
                        enabledGatewayIds.has('stripe') || 
                        enabledGatewayIds.has('stripe_cc') ||
                        // ... other checks
```

**Without this:**
- The code might not recognize Stripe as a payment option
- Stripe won't appear in the payment method list
- Even if Stripe is enabled in WooCommerce, it won't show up

### How to Find Your Gateway ID

1. Go to **WordPress Admin  WooCommerce  Settings  Payments**
2. Find your Stripe payment gateway
3. Click on it to view settings
4. Look for **"Gateway ID"** or **"ID"** field
5. Common values:
   - `stripe` (WooCommerce Stripe Payment Gateway plugin)
   - `stripe_cc` (some plugin versions)
   - `woocommerce_gateway_stripe` (older versions)

### Default Value

If not set, the code defaults to `'stripe'`, which works for most installations.

---

## What Happens Without These Variables?

### Without NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY

```typescript
// StripeElement.component.tsx
if (!stripePromise) {
  return (
    <div className="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
      <p className="text-sm text-yellow-700">
        Stripe is not configured. Please set NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY...
      </p>
    </div>
  );
}
```

**Result**: 
-  Stripe payment form won't render
-  Users see an error message
-  Stripe payments are completely unavailable

### Without NEXT_PUBLIC_STRIPE_GATEWAY_ID

**Result**:
-  Code defaults to `'stripe'`
-  Might work if your gateway ID is actually `'stripe'`
-  Won't work if your gateway ID is different (e.g., `'stripe_cc'`)
-  Stripe won't appear in payment options even if enabled

---

## Example Configuration

### .env.local (for local development)

```bash
# Stripe Configuration
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_51AbCdEfGhIjKlMnOpQrStUvWxYz1234567890AbCdEfGhIjKlMnOpQrStUvWxYz1234567890
NEXT_PUBLIC_STRIPE_GATEWAY_ID=stripe

# GraphQL
NEXT_PUBLIC_GRAPHQL_URL=https://your-wordpress-site.com/graphql
```

### Coolify Environment Variables

In Coolify, add these in your application's environment variables section:
- `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` = `pk_test_...` (or `pk_live_...` for production)
- `NEXT_PUBLIC_STRIPE_GATEWAY_ID` = `stripe` (or your actual gateway ID)

---

## Summary

| Variable | Purpose | Required? | Default |
|----------|---------|-----------|---------|
| `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` | Initialize Stripe SDK and Elements |  **Yes** | None (Stripe won't work) |
| `NEXT_PUBLIC_STRIPE_GATEWAY_ID` | Identify Stripe gateway in WooCommerce |  **Recommended** | `'stripe'` (might not match your setup) |

**Bottom Line**: 
- `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` is **absolutely required** - Stripe won't work without it
- `NEXT_PUBLIC_STRIPE_GATEWAY_ID` is **highly recommended** - Set it to match your WooCommerce Stripe gateway ID to ensure Stripe appears as a payment option

---

## Quick Check

To verify your Stripe gateway ID, you can:

1. **Check WooCommerce GraphQL**:
   ```graphql
   query {
     paymentGateways {
       nodes {
         id
         title
         enabled
       }
     }
   }
   ```
   Look for the Stripe gateway and note its `id` field.

2. **Check WordPress Database** (if you have access):
   ```sql
   SELECT option_value 
   FROM wp_options 
   WHERE option_name LIKE '%stripe%gateway%';
   ```

3. **Check Plugin Settings**: Most Stripe plugins show the gateway ID in their settings page.
````

## File: tailwind.config.js
````javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: ['./src/components/**/*.tsx', './src/pages/**/*.tsx'],
  theme: {
    extend: {
      backgroundImage: {
        'hero-background': "url('/images/hero.jpg')",
      },
    },
  },
  plugins: [],
};
````

## File: tsconfig.json
````json
{
  "compilerOptions": {
    "target": "esnext",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx"
  ],
  "exclude": [
    "node_modules"
  ]
}
````

## File: WORDPRESS_BLOCKS_SETUP.md
````markdown
# WordPress Block Editor (Gutenberg) Support

This Next.js application now supports rendering WordPress Gutenberg blocks from the block editor.

## Setup Requirements

To enable block rendering, you need to install and configure the following WordPress plugins:

### 1. WPGraphQL
- **Plugin**: [WPGraphQL](https://wordpress.org/plugins/wp-graphql/)
- **Purpose**: Provides GraphQL API for WordPress

### 2. WPGraphQL Content Blocks (Recommended)
- **Plugin**: [WPGraphQL Content Blocks](https://github.com/wpengine/wp-graphql-content-blocks) by WP Engine
- **Purpose**: Exposes Gutenberg blocks via GraphQL with full block data
- **Installation**: See `WPGraphQL_CONTENT_BLOCKS_INSTALL.md` for detailed instructions
- **Features**:
  - Provides `editorBlocks` field with `renderedHtml` and `attributes`
  - Supports hierarchical block structure
  - Works with all Gutenberg blocks including custom blocks
- **Alternative**: Falls back to `blocks`/`blocksJSON` if plugin not installed

## How It Works

The `BlockRenderer` component automatically:
1. Checks if block data is available in the GraphQL response
2. Parses block JSON if provided as a string
3. Renders each block type with appropriate React components
4. Falls back to HTML content if blocks are not available

## Supported Block Types

The following WordPress core blocks are currently supported:

### Text Blocks
- **Paragraph** (`core/paragraph`) - Standard text paragraphs
- **Heading** (`core/heading`) - H1-H6 headings with proper styling
- **List** (`core/list`) - Ordered and unordered lists
- **Quote** (`core/quote`) - Blockquotes with citation support
- **Code** (`core/code`) - Code blocks with syntax highlighting container

### Media Blocks
- **Image** (`core/image`) - Single images with captions
- **Gallery** (`core/gallery`) - Image galleries in grid layout

### Layout Blocks
- **Columns** (`core/columns`) - Multi-column layouts
- **Column** (`core/column`) - Individual column containers
- **Group** (`core/group`) - Grouping container
- **Cover** (`core/cover`) - Cover block with background
- **Media & Text** (`core/media-text`) - Side-by-side media and text

### Design Blocks
- **Separator** (`core/separator`) - Horizontal dividers
- **Spacer** (`core/spacer`) - Vertical spacing
- **Button** (`core/button`) - Call-to-action buttons

### Other Blocks
- **HTML** (`core/html`) - Custom HTML content
- **Classic Editor Content** - Automatically falls back to HTML rendering

## GraphQL Query Fields

The following fields are automatically queried:

### Primary (WPGraphQL Content Blocks)
```graphql
editorBlocks(flat: false) {
  __typename
  name
  renderedHtml
  clientId
  parentClientId
  # ... block-specific attributes
}
```

### Fallback
```graphql
blocks
blocksJSON
```

These fields are added to:
- `GET_POST_BY_SLUG` - For blog posts/articles
- `GET_PAGE_BY_SLUG` - For WordPress pages

**Priority**: The component uses `editorBlocks` first (if available), then falls back to `blocks`/`blocksJSON`, and finally to HTML `content`.

## Usage

Blocks are automatically rendered on:
- Article pages (`/articles/[slug]`)
- WordPress pages (`/pages/[slug]`)
- Dynamic pages (`/[...slug]`)

The component will automatically:
1. Try to render blocks if available
2. Fall back to HTML content if blocks are not available
3. Handle both JSON string and array formats

## Adding Custom Block Support

To add support for additional blocks, edit `src/components/Blocks/BlockRenderer.component.tsx`:

1. Add a new case in the `switch` statement:
```typescript
case 'your-block-type':
  return (
    <YourCustomComponent attrs={attrs} innerHTML={innerHTML} />
  );
```

2. Handle nested blocks if needed:
```typescript
case 'your-block-type':
  return (
    <div>
      {innerBlocks.map((innerBlock, idx) => (
        <BlockComponent key={idx} block={innerBlock} />
      ))}
    </div>
  );
```

## Styling

Blocks use Tailwind CSS classes for styling. The component includes:
- Prose styling for text content
- Responsive image handling
- Proper spacing and typography
- Theme-consistent colors

Custom styles can be added by modifying the className props in each block case.

## Troubleshooting

### Blocks Not Rendering

1. **Check Plugin Installation**: 
   - Ensure WPGraphQL is installed and activated
   - Ensure WPGraphQL Content Blocks is installed and activated
   - See `WPGraphQL_CONTENT_BLOCKS_INSTALL.md` for installation instructions

2. **Check GraphQL Response**: 
   - Verify that `editorBlocks` field is being returned (check in GraphQL playground)
   - Test query:
   ```graphql
   {
     post(id: "YOUR_POST_ID", idType: DATABASE_ID) {
       editorBlocks(flat: false) {
         __typename
         name
         renderedHtml
       }
     }
   }
   ```

3. **Check Block Format**: 
   - WPGraphQL Content Blocks provides `renderedHtml` which is preferred
   - Component also supports `blocks`/`blocksJSON` as fallback
   - Component handles multiple formats automatically

4. **Fallback**: 
   - If `editorBlocks` aren't available, component tries `blocks`/`blocksJSON`
   - If blocks aren't available, component automatically uses HTML `content`

### Block Types Not Supported

If a block type isn't rendering correctly:
1. Check the browser console for errors
2. The component will attempt to render `innerHTML` or `innerBlocks` as fallback
3. Add a specific case for the block type in `BlockRenderer.component.tsx`

## Testing

To test block rendering:
1. Create a new WordPress post/page using the block editor
2. Add various block types (paragraphs, images, galleries, etc.)
3. View the post/page on the Next.js frontend
4. Verify that blocks render correctly

## Notes

- The component gracefully handles missing block data
- Classic editor content (non-block) will still render as HTML
- Images are optimized using Next.js Image component
- All blocks are responsive and mobile-friendly
````

## File: WORDPRESS_CUSTOM_FIELDS_SETUP.md
````markdown
# WordPress Custom Fields Setup Guide

This guide explains how to connect the product detail tabs (Description, COA, Research) to custom fields in WordPress/WooCommerce.

## Overview

The product detail tabs component looks for three custom fields:
- `description` - Extended product description (falls back to standard WooCommerce description)
- `coa` - Certificate of Analysis content
- `research` - Research information content

## Method 1: Using WooCommerce Product Meta (Recommended)

### Step 1: Install a Custom Fields Plugin

You can use one of these plugins:
- **Advanced Custom Fields (ACF)** - Most popular, user-friendly
- **Custom Fields Suite** - Lightweight alternative
- **Pods** - More advanced, supports custom post types

### Step 2: Create Custom Fields

#### Using Advanced Custom Fields (ACF):

1. Install and activate the **Advanced Custom Fields** plugin
2. Go to **Custom Fields**  **Add New**
3. Create a Field Group named "Product Detail Tabs"
4. Add three fields:

   **Field 1: Extended Description**
   - Field Label: `Extended Description`
   - Field Name: `description`
   - Field Type: `WYSIWYG Editor` or `Textarea`
   - Location Rules: Show this field group if `Post Type` is equal to `Product`

   **Field 2: COA**
   - Field Label: `COA (Certificate of Analysis)`
   - Field Name: `coa`
   - Field Type: `WYSIWYG Editor` or `Textarea`
   - Location Rules: Show this field group if `Post Type` is equal to `Product`

   **Field 3: Research**
   - Field Label: `Research Information`
   - Field Name: `research`
   - Field Type: `WYSIWYG Editor` or `Textarea`
   - Location Rules: Show this field group if `Post Type` is equal to `Product`

5. Save the Field Group

### Step 3: Configure ACF to Expose Fields to GraphQL

1. Install **WPGraphQL for Advanced Custom Fields** plugin
2. The fields will automatically be available in GraphQL as `metaData` entries

### Step 4: Add Content to Products

1. Edit any product in WooCommerce
2. Scroll down to find the "Product Detail Tabs" section
3. Fill in the three fields:
   - **Extended Description**: Additional product details (HTML supported)
   - **COA**: Certificate of Analysis content (HTML supported)
   - **Research**: Research information (HTML supported)
4. Save/Update the product

## Method 2: Using WooCommerce Product Meta Directly (Without ACF)

If you prefer not to use ACF, you can add custom meta directly using code or a meta box plugin.

### Using Code (functions.php):

Add this to your theme's `functions.php` or a custom plugin:

```php
// Add custom meta boxes to products
function add_product_detail_tabs_meta_box() {
    add_meta_box(
        'product_detail_tabs',
        'Product Detail Tabs',
        'product_detail_tabs_meta_box_callback',
        'product',
        'normal',
        'high'
    );
}
add_action('add_meta_boxes', 'add_product_detail_tabs_meta_box');

function product_detail_tabs_meta_box_callback($post) {
    wp_nonce_field('product_detail_tabs_meta_box', 'product_detail_tabs_meta_box_nonce');
    
    $description = get_post_meta($post->ID, 'description', true);
    $coa = get_post_meta($post->ID, 'coa', true);
    $research = get_post_meta($post->ID, 'research', true);
    ?>
    <table class="form-table">
        <tr>
            <th><label for="description">Extended Description</label></th>
            <td>
                <?php
                wp_editor($description, 'description', array(
                    'textarea_name' => 'description',
                    'textarea_rows' => 10,
                ));
                ?>
            </td>
        </tr>
        <tr>
            <th><label for="coa">COA (Certificate of Analysis)</label></th>
            <td>
                <?php
                wp_editor($coa, 'coa', array(
                    'textarea_name' => 'coa',
                    'textarea_rows' => 10,
                ));
                ?>
            </td>
        </tr>
        <tr>
            <th><label for="research">Research Information</label></th>
            <td>
                <?php
                wp_editor($research, 'research', array(
                    'textarea_name' => 'research',
                    'textarea_rows' => 10,
                ));
                ?>
            </td>
        </tr>
    </table>
    <?php
}

function save_product_detail_tabs_meta_box($post_id) {
    if (!isset($_POST['product_detail_tabs_meta_box_nonce'])) {
        return;
    }
    
    if (!wp_verify_nonce($_POST['product_detail_tabs_meta_box_nonce'], 'product_detail_tabs_meta_box')) {
        return;
    }
    
    if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) {
        return;
    }
    
    if (!current_user_can('edit_post', $post_id)) {
        return;
    }
    
    if (isset($_POST['description'])) {
        update_post_meta($post_id, 'description', wp_kses_post($_POST['description']));
    }
    
    if (isset($_POST['coa'])) {
        update_post_meta($post_id, 'coa', wp_kses_post($_POST['coa']));
    }
    
    if (isset($_POST['research'])) {
        update_post_meta($post_id, 'research', wp_kses_post($_POST['research']));
    }
}
add_action('save_post', 'save_product_detail_tabs_meta_box');
```

## Method 3: Using WooCommerce Product Data Tabs

You can also add these fields to the WooCommerce product data tabs:

1. Install **WooCommerce Custom Fields** plugin, or
2. Use the code method above which adds a custom meta box

## Verification

After setting up the fields:

1. **Test in WordPress Admin:**
   - Edit a product
   - Add content to the three fields
   - Save the product

2. **Test in GraphQL:**
   - Go to your GraphQL endpoint (usually `/graphql`)
   - Run this query:
   ```graphql
   query {
     product(id: "your-product-slug", idType: SLUG) {
       name
       metaData(keysIn: ["description", "coa", "research"]) {
         key
         value
       }
     }
   }
   ```
   - You should see the metaData array with your custom fields

3. **Test in Next.js:**
   - Visit a product page on your Next.js site
   - The tabs should display the content you entered

## Field Names

The component looks for these exact field names (case-sensitive):
- `description` - Extended description
- `coa` - Certificate of Analysis
- `research` - Research information

## HTML Support

All three fields support HTML content. You can use:
- Paragraphs (`<p>`)
- Headings (`<h1>`, `<h2>`, etc.)
- Lists (`<ul>`, `<ol>`)
- Links (`<a>`)
- Images (`<img>`)
- Bold/Italic (`<strong>`, `<em>`)

The component automatically cleans HTML entities and formats the content for display.

## Troubleshooting

### Fields not showing in GraphQL:
- Ensure WPGraphQL and WPGraphQL WooCommerce plugins are active
- Check that the meta keys match exactly: `description`, `coa`, `research`
- Verify the product meta is saved correctly in the database

### Content not displaying:
- Check browser console for errors
- Verify the GraphQL query includes `metaData`
- Ensure field names match exactly (case-sensitive)
- Check that content is saved in WordPress admin

### Description tab shows standard description:
- This is expected behavior - the Description tab falls back to the standard WooCommerce product description if no custom `description` meta field is found
````

## File: WPGraphQL_CONTENT_BLOCKS_INSTALL.md
````markdown
# Installing WPGraphQL Content Blocks Plugin

This guide explains how to install the [WPGraphQL Content Blocks](https://github.com/wpengine/wp-graphql-content-blocks) plugin on your WordPress backend.

## Prerequisites

1. **WPGraphQL Plugin** must be installed and activated first
   - Download from: https://wordpress.org/plugins/wp-graphql/
   - Or install via WordPress admin: Plugins  Add New  Search "WPGraphQL"

## Installation Methods

### Method 1: WordPress Admin (Recommended)

1. **Download the Plugin**
   - Go to: https://github.com/wpengine/wp-graphql-content-blocks/releases
   - Download the latest `.zip` file (e.g., `wp-graphql-content-blocks-4.8.4.zip`)

2. **Install via WordPress Admin**
   - Go to WordPress Admin  Plugins  Add New
   - Click "Upload Plugin"
   - Choose the downloaded `.zip` file
   - Click "Install Now"
   - Click "Activate Plugin"

### Method 2: Manual Installation

1. **Download the Plugin**
   ```bash
   # Download the latest release
   wget https://github.com/wpengine/wp-graphql-content-blocks/archive/refs/heads/main.zip
   unzip main.zip
   ```

2. **Upload to WordPress**
   - Upload the `wp-graphql-content-blocks-main` folder to `/wp-content/plugins/`
   - Rename it to `wp-graphql-content-blocks`
   - Or use SFTP/FTP to upload the folder

3. **Activate**
   - Go to WordPress Admin  Plugins
   - Find "WPGraphQL Content Blocks"
   - Click "Activate"

### Method 3: WP-CLI (Command Line)

```bash
# Navigate to WordPress root
cd /path/to/wordpress

# Download and install
wp plugin install https://github.com/wpengine/wp-graphql-content-blocks/archive/refs/heads/main.zip --activate
```

## Verification

After installation, verify the plugin is working:

1. **Check GraphQL Schema**
   - Go to your GraphQL endpoint (usually `/graphql`)
   - Or use GraphiQL IDE if available
   - Query for `editorBlocks` field:

```graphql
{
  posts {
    nodes {
      title
      editorBlocks(flat: false) {
        __typename
        name
        renderedHtml
      }
    }
  }
}
```

2. **Check WordPress Admin**
   - Go to Plugins page
   - Verify "WPGraphQL Content Blocks" is listed and activated

## What This Plugin Provides

- **`editorBlocks` field** on Post and Page types
- **Block data** with `__typename`, `name`, `attributes`, `renderedHtml`
- **Hierarchical structure** with `editorBlocks(flat: false)`
- **Flattened structure** with `editorBlocks(flat: true)`
- **Support for all Gutenberg blocks** including custom blocks

## Next Steps

Once installed, the Next.js frontend will automatically:
1. Query `editorBlocks` from WordPress
2. Render blocks using the `BlockRenderer` component
3. Fall back to HTML content if blocks aren't available

No additional configuration needed in WordPress - the plugin works automatically once activated!
````

## File: src/components/Checkout/CreateAccountCheckbox.component.tsx
````typescript
"use client";
import { useState } from 'react';
import { useFormContext } from 'react-hook-form';
import { useMutation } from '@apollo/client';
import { CREATE_USER } from '@/utils/gql/GQL_MUTATIONS';
import { login } from '@/utils/auth';
import client from '@/utils/apollo/ApolloClient';
interface CreateAccountCheckboxProps {
  email: string;
  firstName?: string;
  lastName?: string;
  onAccountCreated?: () => void;
}
/**
 * Component for creating account during checkout
 * Allows customers to create an account before placing their order
 */
const CreateAccountCheckbox = ({ email, firstName, lastName, onAccountCreated }: CreateAccountCheckboxProps) => {
  const { register, watch, setValue, formState: { errors }, trigger } = useFormContext();
  const [showPasswordFields, setShowPasswordFields] = useState(false);
  const [isCreatingAccount, setIsCreatingAccount] = useState(false);
  const [accountError, setAccountError] = useState<string | null>(null);
  const [accountSuccess, setAccountSuccess] = useState(false);
  const createAccount = watch('createAccount');
  const accountPassword = watch('accountPassword');
  const accountUsername = watch('accountUsername');
  const [registerUser] = useMutation(CREATE_USER);
  const handleCreateAccountChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const checked = e.target.checked;
    setValue('createAccount', checked);
    setShowPasswordFields(checked);
    setAccountError(null);
    setAccountSuccess(false);
    if (!checked) {
      setValue('accountPassword', '');
      setValue('accountUsername', '');
    }
  };
  // Handle account creation when password is entered and checkbox is checked
  const handleAccountCreation = async () => {
    if (!createAccount || !accountPassword || accountPassword.length < 8) {
      return;
    }
    // Validate form fields
    const isValid = await trigger('accountPassword');
    if (!isValid) {
      return;
    }
    setIsCreatingAccount(true);
    setAccountError(null);
    try {
      const username = accountUsername || email.split('@')[0];
      // Check if email is already taken by attempting registration
      const response = await registerUser({
        variables: {
          username,
          email,
          password: accountPassword,
          firstName: firstName || '',
          lastName: lastName || '',
        },
      });
      // Check for GraphQL errors
      if (response.errors && response.errors.length > 0) {
        const errorMessage = response.errors[0].message || 'Account creation failed';
        // Check for email already taken error
        if (errorMessage.toLowerCase().includes('email') || 
            errorMessage.toLowerCase().includes('already') ||
            errorMessage.toLowerCase().includes('exists')) {
          setAccountError('This email is already registered. Please log in instead.');
          setValue('createAccount', false);
          setShowPasswordFields(false);
          return;
        }
        setAccountError(errorMessage);
        return;
      }
      const customer = response.data?.registerCustomer?.customer;
      if (customer) {
        setAccountSuccess(true);
        // Auto-login after account creation
        try {
          // Use email as username for login (WooCommerce allows this)
          const loginResult = await login(email, accountPassword);
          if (loginResult.success) {
            // Clear Apollo cache to ensure fresh user data
            await client.clearStore();
            await client.resetStore();
            // Wait for cookies to be set
            await new Promise(resolve => setTimeout(resolve, 300));
            // Call success callback to populate form fields
            if (onAccountCreated) {
              onAccountCreated();
            }
          }
        } catch (loginError: any) {
          console.error('Auto-login after registration failed:', loginError);
          // Account was created but login failed - user can manually log in
          setAccountError('Account created successfully, but automatic login failed. Please log in manually.');
        }
      } else {
        setAccountError('Failed to create account. Please try again.');
      }
    } catch (error: any) {
      console.error('Account creation error:', error);
      // Handle GraphQL errors
      if (error.graphQLErrors && error.graphQLErrors.length > 0) {
        const graphQLError = error.graphQLErrors[0];
        const errorMessage = graphQLError.message || 'Account creation failed';
        // Check for email already taken
        if (errorMessage.toLowerCase().includes('email') || 
            errorMessage.toLowerCase().includes('already') ||
            errorMessage.toLowerCase().includes('exists')) {
          setAccountError('This email is already registered. Please log in instead.');
          setValue('createAccount', false);
          setShowPasswordFields(false);
          return;
        }
        setAccountError(errorMessage);
      } else if (error.networkError) {
        setAccountError('Network error. Please check your connection and try again.');
      } else {
        setAccountError('Failed to create account. Please try again.');
      }
    } finally {
      setIsCreatingAccount(false);
    }
  };
  // Trigger account creation when password field loses focus and has valid input
  const handlePasswordBlur = async () => {
    if (createAccount && accountPassword && accountPassword.length >= 8) {
      await handleAccountCreation();
    }
  };
  return (
    <div className="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
      <label className="flex items-start cursor-pointer">
        <input
          type="checkbox"
          {...register('createAccount')}
          onChange={handleCreateAccountChange}
          className="mt-1 h-4 w-4 cursor-pointer accent-black"
        />
        <div className="ml-3 flex-1">
          <span className="text-sm font-medium text-gray-900">
            Create an account?
          </span>
          <p className="text-xs text-gray-600 mt-1">
            Create an account to save your information for faster checkout next time.
          </p>
        </div>
      </label>
      {showPasswordFields && createAccount && (
        <div className="mt-4 space-y-4 pt-4 border-t border-gray-200">
          {accountError && (
            <div className="p-3 bg-red-50 border border-red-200 rounded-lg">
              <p className="text-sm text-red-600">{accountError}</p>
            </div>
          )}
          {accountSuccess && (
            <div className="p-3 bg-green-50 border border-green-200 rounded-lg">
              <p className="text-sm text-green-600">Account created successfully! You are now logged in.</p>
            </div>
          )}
          <div>
            <label htmlFor="account-username" className="block text-sm font-medium text-gray-700 mb-1">
              Username (optional)
            </label>
            <input
              id="account-username"
              type="text"
              {...register('accountUsername')}
              placeholder={email.split('@')[0] || 'username'}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm"
            />
            <p className="text-xs text-gray-500 mt-1">
              If left blank, your email will be used as your username.
            </p>
          </div>
          <div>
            <label htmlFor="account-password" className="block text-sm font-medium text-gray-700 mb-1">
              Password <span className="text-red-500">*</span>
            </label>
            <input
              id="account-password"
              type="password"
              {...register('accountPassword', {
                required: createAccount ? 'Password is required to create an account' : false,
                minLength: createAccount ? {
                  value: 8,
                  message: 'Password must be at least 8 characters'
                } : undefined,
                validate: (value) => {
                  if (createAccount && value && value.length < 8) {
                    return 'Password must be at least 8 characters';
                  }
                  return true;
                },
              })}
              placeholder="Enter a password (min. 8 characters)"
              onBlur={handlePasswordBlur}
              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-black focus:border-black text-sm ${
                errors.accountPassword ? 'border-red-300' : 'border-gray-300'
              }`}
            />
            {errors.accountPassword && (
              <p className="text-xs text-red-600 mt-1">{errors.accountPassword.message as string}</p>
            )}
            <p className="text-xs text-gray-500 mt-1">
              Minimum 8 characters. Use a strong password for security.
            </p>
            {isCreatingAccount && (
              <p className="text-xs text-blue-600 mt-1">Creating account...</p>
            )}
          </div>
        </div>
      )}
    </div>
  );
};
export default CreateAccountCheckbox;
````

## File: README.md
````markdown
# Next.js WooCommerce with Faust.js

A modern headless e-commerce solution built with Next.js, WooCommerce, and Faust.js. This project provides a fully functional online store with authentication, cart management, checkout, and payment processing.

![Project Preview](public/preview.png)

##  Features

- **Headless Architecture**: Next.js frontend with WordPress/WooCommerce backend
- **Faust.js Integration**: Seamless WordPress authentication and content management
- **WooCommerce Integration**: Full e-commerce functionality via GraphQL
- **User Authentication**: Login, registration, and account management
- **Shopping Cart**: Persistent cart with session management
- **Checkout Flow**: Complete checkout with billing, shipping, and payment processing  **Note: Checkout functionality is currently under review and may require fixes**
- **Stripe Integration**: Secure payment processing with Stripe Elements
- **Product Catalog**: Product listings, categories, and search
- **User Accounts**: Order history, account details, and address management
- **Responsive Design**: Mobile-first, modern UI built with Tailwind CSS

##  Prerequisites

Before you begin, ensure you have the following installed:

- **Node.js** 20.x or higher
- **npm** or **yarn** package manager
- **WordPress** site (5.8 or higher)
- **PHP** 7.4 or higher (for WordPress)
- **MySQL** 5.7 or higher (for WordPress database)

##  Installation

### Step 1: Clone the Repository

```bash
git clone <repository-url>
cd nw-nextjs-faust-woocommerce
```

### Step 2: Install Next.js Dependencies

```bash
npm install
```

### Step 3: Configure Environment Variables

Create a `.env.local` file in the root directory:

```bash
cp .env.example .env.local  # If you have an example file
# Or create .env.local manually
```

Add the following environment variables:

```env
# Required: Your WordPress GraphQL endpoint
NEXT_PUBLIC_GRAPHQL_URL=http://localhost:8080/graphql

# Faust.js Configuration
# Your WordPress site URL (base URL, not the GraphQL endpoint)
NEXT_PUBLIC_WORDPRESS_URL=http://localhost:8080

# Plugin secret found in WordPress Settings->Faust
FAUST_SECRET_KEY=your-faust-secret-key-here

# Optional: Algolia Search (only if using search)
# NEXT_PUBLIC_ALGOLIA_APP_ID=your_algolia_app_id
# NEXT_PUBLIC_ALGOLIA_PUBLIC_API_KEY=your_algolia_public_key
# NEXT_PUBLIC_ALGOLIA_INDEX_NAME=your_index_name

# Optional: Placeholder images
NEXT_PUBLIC_PLACEHOLDER_SMALL_IMAGE_URL=https://via.placeholder.com/300
NEXT_PUBLIC_PLACEHOLDER_LARGE_IMAGE_URL=https://via.placeholder.com/800

# Stripe Configuration
# Publishable key - safe to use in frontend/client-side code
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...

# Stripe Gateway ID - usually 'stripe' but check your WooCommerce Stripe plugin settings
# Common values: 'stripe', 'stripe_cc', 'woocommerce_gateway_stripe'
NEXT_PUBLIC_STRIPE_GATEWAY_ID=stripe

# NOTE: The Stripe SECRET key (sk_test_...) should NOT be added here!
# Secret keys must only be stored in your WordPress/WooCommerce backend (server-side)
# Add the secret key in your WordPress admin: WooCommerce > Settings > Payments > Stripe
```

### Step 4: Start Development Server

```bash
npm run dev
```

The application will be available at `http://localhost:3000`

##  WordPress Backend Setup

### Required WordPress Plugins

Install and activate the following plugins in your WordPress site:

#### Core Plugins (Required)

1. **[WooCommerce](https://wordpress.org/plugins/woocommerce/)**
   - E-commerce platform for WordPress
   - Install via: Plugins  Add New  Search "WooCommerce"

2. **[WP GraphQL](https://wordpress.org/plugins/wp-graphql/)**
   - Exposes GraphQL API for WordPress
   - Install via: Plugins  Add New  Search "WPGraphQL"
   - **Important**: After activation, note your GraphQL endpoint URL (usually `/graphql`)

3. **[WP GraphQL WooCommerce](https://github.com/wp-graphql/wp-graphql-woocommerce)**
   - Adds WooCommerce functionality to WPGraphQL schema
   - Install via: Download from GitHub  Plugins  Add New  Upload Plugin
   - Download: https://github.com/wp-graphql/wp-graphql-woocommerce/releases

4. **[WP GraphQL CORS](https://wordpress.org/plugins/wp-graphql-cors/)**
   - Enables CORS for GraphQL requests
   - Install via: Plugins  Add New  Search "WPGraphQL CORS"
   - **Configuration**: After activation, configure CORS settings to allow your Next.js domain

5. **[Faust.js WordPress Plugin](https://wordpress.org/plugins/faustwp/)**
   - Provides authentication and API endpoints for Faust.js
   - Install via: Plugins  Add New  Search "Faust"
   - **Configuration**: 
     - Go to Settings  Faust
     - Copy the "Secret Key" and add it to your `.env.local` as `FAUST_SECRET_KEY`
     - Set "Frontend URL" to your Next.js app URL (e.g., `http://localhost:3000`)

#### Optional Plugins

6. **[WPGraphQL Content Blocks](https://github.com/wpengine/wp-graphql-content-blocks)**
   - Enables Gutenberg block support in GraphQL
   - Required if you want to use WordPress blocks in your Next.js app
   - See [WPGraphQL_CONTENT_BLOCKS_INSTALL.md](./WPGraphQL_CONTENT_BLOCKS_INSTALL.md) for installation

7. **[Advanced Custom Fields (ACF)](https://www.advancedcustomfields.com/)**
   - For custom product fields
   - Install via: Plugins  Add New  Search "Advanced Custom Fields"
   - See [WORDPRESS_CUSTOM_FIELDS_SETUP.md](./WORDPRESS_CUSTOM_FIELDS_SETUP.md) for setup

8. **[WPGraphQL for Advanced Custom Fields](https://wordpress.org/plugins/wp-graphql-acf/)**
   - Exposes ACF fields to GraphQL (required if using ACF)
   - Install via: Plugins  Add New  Search "WPGraphQL ACF"

9. **[WooCommerce Stripe Payment Gateway](https://woocommerce.com/products/stripe/)**
   - Required for Stripe payment processing
   - Install via: WooCommerce  Settings  Payments  Stripe  Set up
   - **Configuration**: Add your Stripe API keys (Secret key goes here, not in Next.js)

### WordPress Configuration Steps

1. **Configure WooCommerce**
   - Go to WooCommerce  Settings
   - Complete the setup wizard:
     - Store details (address, currency, etc.)
     - Payment methods (enable Stripe)
     - Shipping options
   - Add some test products

2. **Configure WP GraphQL CORS**
   - Go to Settings  GraphQL CORS (or GraphQL  Settings)
   - Add your Next.js frontend URL to allowed origins
   - Example: `http://localhost:3000` (for development)
   - For production: `https://your-domain.com`

3. **Configure Faust.js**
   - Go to Settings  Faust
   - Set "Frontend URL" to your Next.js app URL
   - Copy the "Secret Key" to your `.env.local` file
   - Enable "Enable Redirects" if you want WordPress to redirect to your Next.js frontend

4. **Test GraphQL Endpoint**
   - Visit `http://your-wordpress-site.com/graphql`
   - You should see a GraphQL interface or endpoint
   - Test a simple query:
     ```graphql
     {
       products(first: 5) {
         nodes {
           id
           name
           price
         }
       }
     }
     ```

##  Dependencies

### Core Dependencies

- **Next.js** `16.0.7` - React framework for production
- **React** `19.2.1` - UI library
- **TypeScript** `5.9.3` - Type safety
- **Apollo Client** `^3.14.0` - GraphQL client
- **Faust.js** `^3.3.4` - WordPress integration framework
  - `@faustwp/core` - Core Faust.js functionality
  - `@faustwp/blocks` - WordPress block rendering
  - `@faustwp/cli` - CLI tools

### E-commerce Dependencies

- **Stripe** - Payment processing
  - `@stripe/stripe-js` `^4.0.0` - Stripe.js SDK
  - `@stripe/react-stripe-js` `^2.9.0` - React components for Stripe

### UI & Styling

- **Tailwind CSS** `^3.4.18` - Utility-first CSS framework
- **Lucide React** `^0.555.0` - Icon library
- **Motion** `^12.23.25` - Animation library

### Form Management

- **React Hook Form** `^7.68.0` - Form state management and validation

### State Management

- **Zustand** `^5.0.9` - Lightweight state management (for cart)

### Search (Optional)

- **Algolia Search** - If using Algolia search
  - `algoliasearch` `^4.25.3`
  - `react-instantsearch-dom` `^6.40.4`

### Development Dependencies

- **ESLint** - Code linting
- **Prettier** `^3.7.4` - Code formatting
- **TypeScript** - Type checking
- **Playwright** `^1.57.0` - E2E testing
- **Lighthouse CI** `^0.15.1` - Performance monitoring

##  Development

### Available Scripts

```bash
# Start development server
npm run dev

# Build for production
npm run build

# Start production server
npm start

# Run linter
npm run lint

# Format code
npm run format

# Run Playwright tests
npm run playwright

# Run Playwright UI
npm run playwright:ui

# Run Lighthouse CI
npm run lhci
```

### Project Structure

```
nw-nextjs-faust-woocommerce/
 src/
    components/          # React components
       Checkout/       # Checkout flow components
       Cart/           # Shopping cart components
       Product/        # Product display components
       User/           # User account components
    pages/              # Next.js pages
       checkout.tsx    # Checkout page
       cart.tsx        # Cart page
       account.tsx     # Account page
       [...slug].tsx   # Dynamic WordPress pages
    utils/              # Utility functions
       apollo/         # Apollo Client configuration
       gql/            # GraphQL queries and mutations
       auth.ts         # Authentication utilities
    stores/             # State management (Zustand)
    faust.config.js     # Faust.js configuration
 public/                 # Static assets
 .env.local             # Environment variables (not in git)
 package.json          # Dependencies and scripts
```

##  Authentication

This project uses **Faust.js** for WordPress authentication. The authentication flow:

1. User logs in via `useLogin()` hook from `@faustwp/core`
2. Faust.js handles the authorization code flow
3. Access tokens are stored securely
4. Authenticated requests use `getApolloAuthClient()` which automatically includes auth headers

### Key Authentication Components

- **CheckoutLogin**: Login component for checkout page
- **Account Page**: Full account management with authentication
- **useAuth Hook**: Checks authentication status throughout the app

##  Payment Processing

Stripe integration is configured for secure payment processing:

1. **Frontend**: Uses Stripe Elements for card input
2. **Backend**: WooCommerce Stripe plugin processes payments
3. **Configuration**: 
   - Publishable key in `.env.local` (frontend)
   - Secret key in WordPress WooCommerce settings (backend)

See [STRIPE_ENV_VARIABLES_EXPLAINED.md](./STRIPE_ENV_VARIABLES_EXPLAINED.md) for detailed Stripe setup.

##  Known Issues

### Checkout Functionality

**Status**: Under Review

The checkout flow is currently being reviewed and may have issues with:
- User authentication during checkout
- Order assignment to logged-in users
- Billing and shipping data population

**Workaround**: If you encounter issues:
1. Ensure you're logged in before adding items to cart
2. Visit the account page first to establish authentication session
3. Then proceed to checkout

**Note**: The checkout components have been refactored to use Faust.js authentication, but additional testing and fixes may be required.

##  Troubleshooting

### Common Issues

#### "Sorry, no session found" Error

- **Cause**: Authentication session not initialized
- **Solution**: Ensure `useAuth()` is called in components that need authentication
- **Fix**: The checkout page now initializes auth automatically

#### GraphQL Connection Errors

- **Check**: `NEXT_PUBLIC_GRAPHQL_URL` is correct in `.env.local`
- **Verify**: WordPress GraphQL endpoint is accessible
- **Test**: Visit `http://your-wordpress-site.com/graphql` in browser

#### CORS Errors

- **Check**: WP GraphQL CORS plugin is installed and configured
- **Verify**: Your Next.js URL is added to allowed origins
- **Test**: Check browser console for specific CORS error messages

#### Orders Assigned to Guest

- **Cause**: Checkout mutation not using authenticated client
- **Solution**: Ensure `getApolloAuthClient()` is used for checkout mutations
- **Status**:  Fixed in latest version

#### User Data Not Loading After Login

- **Cause**: Apollo cache not refreshing after authentication
- **Solution**: Faust.js handles this automatically, but ensure `useAuth()` is called
- **Fix**: Components now use authenticated Apollo client

### Debug Mode

Enable debug logging by checking browser console. The app includes extensive logging for:
- Authentication flow
- GraphQL queries and mutations
- Cart operations
- Checkout process

##  Additional Documentation

- [WordPress Blocks Setup](./WORDPRESS_BLOCKS_SETUP.md) - Setting up WordPress blocks
- [WordPress Custom Fields Setup](./WORDPRESS_CUSTOM_FIELDS_SETUP.md) - ACF configuration
- [WPGraphQL Content Blocks Install](./WPGraphQL_CONTENT_BLOCKS_INSTALL.md) - Block plugin setup
- [Stripe Environment Variables](./STRIPE_ENV_VARIABLES_EXPLAINED.md) - Stripe configuration guide

##  Contributing

Please read [CONTRIBUTING.md](./CONTRIBUTING.md) for details on our code of conduct and the process for submitting pull requests.

##  License

This project is licensed under the ISC License - see the [LICENSE](./LICENSE) file for details.

##  Acknowledgments

- [Faust.js](https://faustjs.org/) - WordPress headless framework
- [WooCommerce](https://woocommerce.com/) - E-commerce platform
- [WPGraphQL](https://www.wpgraphql.com/) - GraphQL API for WordPress
- [Next.js](https://nextjs.org/) - React framework
````

## File: src/components/Checkout/Billing.component.tsx
````typescript
// Imports
import {
  SubmitHandler,
  useForm,
  useFormContext,
  FormProvider,
} from 'react-hook-form';
import { useState, useEffect } from 'react';
import { useQuery } from '@apollo/client';
// Components
import { InputField } from '@/components/Input/InputField.component';
import Button from '../UI/Button.component';
import CheckoutLogin from './CheckoutLogin.component';
import CreateAccountCheckbox from './CreateAccountCheckbox.component';
import PaymentMethod from './PaymentMethod.component';
import CreditCardFields from './CreditCardFields.component';
import StateField from './StateField.component';
import BillingAddressCheckbox from './BillingAddressCheckbox.component';
import BillingAddressFields from './BillingAddressFields.component';
// GraphQL
import { GET_CURRENT_USER } from '@/utils/gql/GQL_QUERIES';
import { getApolloAuthClient } from '@faustwp/core';
// Constants
import { INPUT_FIELDS } from '@/utils/constants/INPUT_FIELDS';
import { ICheckoutDataProps } from '@/utils/functions/functions';
interface IBillingProps {
  handleFormSubmit: SubmitHandler<ICheckoutDataProps>;
  onStripeClientSecret?: (secret: string) => void;
  onStripeElements?: (elements: any) => void;
  onStripePaymentReady?: (ready: boolean) => void;
  isProcessingStripe?: boolean;
}
const OrderButton = ({ isProcessingStripe }: { isProcessingStripe?: boolean }) => {
  const { register, formState: { errors }, watch } = useFormContext();
  const paymentMethod = watch('paymentMethod');
  return (
    <div className="w-full">
      {/* Terms Checkbox in Grey Border Container */}
      <div className="mb-6 p-4 bg-gray-50 border border-gray-300 rounded-lg">
        <label className="flex items-start cursor-pointer">
          <input
            type="checkbox"
            className="mt-1 h-4 w-4 cursor-pointer accent-black flex-shrink-0"
            {...register('termsAccepted', { 
              required: 'You must accept the terms and conditions to proceed' 
            })}
          />
          <span className="ml-3 text-sm text-gray-700">
            I have read, understood and agreed with your Terms of Service and Waiver Agreement. I certify that these products will not be used on humans.
          </span>
        </label>
        {errors.termsAccepted && (
          <p className="text-red-600 text-sm mt-2 ml-7">
            {errors.termsAccepted.message as string}
          </p>
        )}
      </div>
      <div className="flex justify-center">
        <Button type="submit" disabled={isProcessingStripe}>
          {isProcessingStripe ? 'PROCESSING PAYMENT...' : 'PLACE ORDER'}
        </Button>
      </div>
    </div>
  );
};
const Billing = ({ 
  handleFormSubmit, 
  onStripeClientSecret, 
  onStripeElements, 
  onStripePaymentReady,
  isProcessingStripe = false 
}: IBillingProps) => {
  const methods = useForm<ICheckoutDataProps>();
  const email = methods.watch('email') || '';
  const [stripeClientSecret, setStripeClientSecret] = useState<string>('');
  const [stripeElements, setStripeElements] = useState<any>(null);
  const [stripePaymentReady, setStripePaymentReady] = useState<boolean>(false);
  const [fieldsPopulated, setFieldsPopulated] = useState(false);
  // Query user data to auto-populate form using Faust.js authenticated client
  const authClient = getApolloAuthClient(); // Get authenticated Apollo client from Faust.js
  const { data: userData, loading: userDataLoading, error: userDataError, refetch: refetchUser } = useQuery(GET_CURRENT_USER, {
    client: authClient, // Use authenticated client - automatically includes auth tokens
    errorPolicy: 'all',
    fetchPolicy: 'network-only', // Always fetch from network to ensure fresh data
    notifyOnNetworkStatusChange: true,
  });
  // Debug logging - check cookies and query state
  useEffect(() => {
    if (typeof window !== 'undefined') {
      const cookies = document.cookie;
      const cookieNames = cookies.split(';').map(c => c.split('=')[0].trim()).filter(c => c);
      console.log('[Billing] Cookies available:', {
        cookieString: cookies,
        cookieNames,
        hasWordPressCookie: cookies.includes('wordpress_logged_in') || cookies.includes('wp_'),
        hasWooCommerceCookie: cookies.includes('woocommerce'),
      });
    }
    console.log('[Billing] User data query state:', {
      hasData: !!userData,
      loading: userDataLoading,
      error: userDataError,
      customer: userData?.customer,
      customerId: userData?.customer?.id,
      customerEmail: userData?.customer?.email,
      customerFirstName: userData?.customer?.firstName,
      customerLastName: userData?.customer?.lastName,
      hasBilling: !!userData?.customer?.billing,
      hasShipping: !!userData?.customer?.shipping,
      billing: userData?.customer?.billing,
      shipping: userData?.customer?.shipping,
      isGuest: userData?.customer?.id === 'guest' || userData?.customer?.id === 'cGd1ZXN0',
    });
    // Log full customer object for debugging
    if (userData?.customer) {
      console.log('[Billing] Full customer object:', JSON.stringify(userData.customer, null, 2));
    }
  }, [userData, userDataLoading, userDataError]);
  const customer = userData?.customer;
  const isLoggedIn = !!customer && customer?.id !== 'guest' && customer?.id !== 'cGd1ZXN0';
  const isGuest = customer?.id === 'guest' || customer?.id === 'cGd1ZXN0';
  // Debug logged in status
  useEffect(() => {
    console.log('[Billing] Login status:', {
      isLoggedIn,
      hasCustomer: !!customer,
      customerId: customer?.id,
      isGuest,
    });
  }, [isLoggedIn, customer, isGuest]);
  // Note: We don't auto-clear cache here because:
  // 1. It causes errors when called during active queries
  // 2. HttpOnly cookies (wordpress_logged_in) aren't visible to JavaScript
  // 3. The login flow in CheckoutLogin already handles cache clearing
  // If user data doesn't update after login, it's likely a backend/cookie issue
  // Auto-populate form fields from user data when logged in
  useEffect(() => {
    console.log('[Billing] Field population effect triggered:', {
      isLoggedIn,
      hasCustomer: !!customer,
      fieldsPopulated,
      shouldPopulate: isLoggedIn && customer && !fieldsPopulated,
    });
    if (isLoggedIn && customer && !fieldsPopulated) {
      console.log('[Billing] Starting field population...');
      console.log('[Billing] Full customer object:', JSON.stringify(customer, null, 2));
      console.log('[Billing] Populating form fields from customer data:', {
        hasCustomer: !!customer,
        customerId: customer.id,
        customerEmail: customer.email,
        customerFirstName: customer.firstName,
        customerLastName: customer.lastName,
        hasBilling: !!customer.billing,
        hasShipping: !!customer.shipping,
        billing: customer.billing,
        shipping: customer.shipping,
      });
      const billing = customer.billing;
      const shipping = customer.shipping;
      console.log('[Billing] Billing data:', {
        hasBilling: !!billing,
        billingFirstName: billing?.firstName,
        billingLastName: billing?.lastName,
        billingAddress1: billing?.address1,
        billingCity: billing?.city,
        billingState: billing?.state,
        billingPostcode: billing?.postcode,
        billingPhone: billing?.phone,
        billingEmail: billing?.email,
      });
      console.log('[Billing] Shipping data:', {
        hasShipping: !!shipping,
        shippingFirstName: shipping?.firstName,
        shippingLastName: shipping?.lastName,
        shippingAddress1: shipping?.address1,
        shippingCity: shipping?.city,
        shippingState: shipping?.state,
        shippingPostcode: shipping?.postcode,
      });
      // Populate email from customer (always use customer email if available)
      if (customer.email) {
        const currentEmail = methods.getValues('email');
        console.log('[Billing] Email check:', {
          customerEmail: customer.email,
          currentEmail,
          isEmpty: !currentEmail || currentEmail.trim() === '',
        });
        if (!currentEmail || currentEmail.trim() === '') {
          methods.setValue('email', customer.email, { shouldValidate: false });
          console.log('[Billing]  Populated email:', customer.email);
        } else {
          console.log('[Billing]  Skipped email (already has value):', currentEmail);
        }
      } else {
        console.log('[Billing]  No customer email available');
      }
      // Populate shipping fields (prefer shipping address, fallback to billing)
      const addressSource = (shipping?.address1 || shipping?.city) ? shipping : billing;
      console.log('[Billing] Address source selection:', {
        hasShippingAddress1: !!shipping?.address1,
        hasShippingCity: !!shipping?.city,
        hasBillingAddress1: !!billing?.address1,
        hasBillingCity: !!billing?.city,
        selectedSource: addressSource === shipping ? 'shipping' : 'billing',
        addressSourceData: addressSource,
      });
      if (addressSource) {
        console.log('[Billing]  Using address source:', addressSource === shipping ? 'shipping' : 'billing');
        // Always populate if field is empty, or if we have data from customer
        const currentFirstName = methods.getValues('firstName');
        if (addressSource.firstName && (!currentFirstName || currentFirstName.trim() === '')) {
          methods.setValue('firstName', addressSource.firstName, { shouldValidate: false });
          console.log('[Billing]  Populated firstName:', addressSource.firstName);
        } else {
          console.log('[Billing]  Skipped firstName:', { 
            hasValue: !!addressSource.firstName, 
            currentValue: currentFirstName 
          });
        }
        const currentLastName = methods.getValues('lastName');
        if (addressSource.lastName && (!currentLastName || currentLastName.trim() === '')) {
          methods.setValue('lastName', addressSource.lastName, { shouldValidate: false });
          console.log('[Billing]  Populated lastName:', addressSource.lastName);
        } else {
          console.log('[Billing]  Skipped lastName:', { 
            hasValue: !!addressSource.lastName, 
            currentValue: currentLastName 
          });
        }
        const currentAddress1 = methods.getValues('address1');
        if (addressSource.address1 && (!currentAddress1 || currentAddress1.trim() === '')) {
          methods.setValue('address1', addressSource.address1, { shouldValidate: false });
          console.log('[Billing]  Populated address1:', addressSource.address1);
        } else {
          console.log('[Billing]  Skipped address1:', { 
            hasValue: !!addressSource.address1, 
            currentValue: currentAddress1 
          });
        }
        const currentCity = methods.getValues('city');
        if (addressSource.city && (!currentCity || currentCity.trim() === '')) {
          methods.setValue('city', addressSource.city, { shouldValidate: false });
          console.log('[Billing]  Populated city:', addressSource.city);
        } else {
          console.log('[Billing]  Skipped city:', { 
            hasValue: !!addressSource.city, 
            currentValue: currentCity 
          });
        }
        const currentState = methods.getValues('state');
        if (addressSource.state && (!currentState || currentState.trim() === '')) {
          methods.setValue('state', addressSource.state, { shouldValidate: false });
          console.log('[Billing]  Populated state:', addressSource.state);
        } else {
          console.log('[Billing]  Skipped state:', { 
            hasValue: !!addressSource.state, 
            currentValue: currentState 
          });
        }
        const currentPostcode = methods.getValues('postcode');
        if (addressSource.postcode && (!currentPostcode || currentPostcode.trim() === '')) {
          methods.setValue('postcode', addressSource.postcode, { shouldValidate: false });
          console.log('[Billing]  Populated postcode:', addressSource.postcode);
        } else {
          console.log('[Billing]  Skipped postcode:', { 
            hasValue: !!addressSource.postcode, 
            currentValue: currentPostcode 
          });
        }
        // Phone can come from billing if not in shipping
        const phoneSource = addressSource.phone || billing?.phone;
        const currentPhone = methods.getValues('phone');
        if (phoneSource && (!currentPhone || currentPhone.trim() === '')) {
          methods.setValue('phone', phoneSource, { shouldValidate: false });
          console.log('[Billing]  Populated phone:', phoneSource);
        } else {
          console.log('[Billing]  Skipped phone:', { 
            hasValue: !!phoneSource, 
            currentValue: currentPhone 
          });
        }
      }
      // Always populate billing fields from customer.billing if available
      if (billing) {
        console.log('[Billing]  Populating billing fields from customer.billing');
        console.log('[Billing] Billing data available:', {
          firstName: billing.firstName,
          lastName: billing.lastName,
          address1: billing.address1,
          city: billing.city,
          state: billing.state,
          postcode: billing.postcode,
        });
        const currentBillingFirstName = methods.getValues('billingFirstName');
        if (billing.firstName && (!currentBillingFirstName || currentBillingFirstName.trim() === '')) {
          methods.setValue('billingFirstName', billing.firstName, { shouldValidate: false });
          console.log('[Billing]  Populated billingFirstName:', billing.firstName);
        } else {
          console.log('[Billing]  Skipped billingFirstName:', { 
            hasValue: !!billing.firstName, 
            currentValue: currentBillingFirstName 
          });
        }
        const currentBillingLastName = methods.getValues('billingLastName');
        if (billing.lastName && (!currentBillingLastName || currentBillingLastName.trim() === '')) {
          methods.setValue('billingLastName', billing.lastName, { shouldValidate: false });
          console.log('[Billing]  Populated billingLastName:', billing.lastName);
        } else {
          console.log('[Billing]  Skipped billingLastName:', { 
            hasValue: !!billing.lastName, 
            currentValue: currentBillingLastName 
          });
        }
        const currentBillingAddress1 = methods.getValues('billingAddress1');
        if (billing.address1 && (!currentBillingAddress1 || currentBillingAddress1.trim() === '')) {
          methods.setValue('billingAddress1', billing.address1, { shouldValidate: false });
          console.log('[Billing]  Populated billingAddress1:', billing.address1);
        } else {
          console.log('[Billing]  Skipped billingAddress1:', { 
            hasValue: !!billing.address1, 
            currentValue: currentBillingAddress1 
          });
        }
        const currentBillingCity = methods.getValues('billingCity');
        if (billing.city && (!currentBillingCity || currentBillingCity.trim() === '')) {
          methods.setValue('billingCity', billing.city, { shouldValidate: false });
          console.log('[Billing]  Populated billingCity:', billing.city);
        } else {
          console.log('[Billing]  Skipped billingCity:', { 
            hasValue: !!billing.city, 
            currentValue: currentBillingCity 
          });
        }
        const currentBillingState = methods.getValues('billingState');
        if (billing.state && (!currentBillingState || currentBillingState.trim() === '')) {
          methods.setValue('billingState', billing.state, { shouldValidate: false });
          console.log('[Billing]  Populated billingState:', billing.state);
        } else {
          console.log('[Billing]  Skipped billingState:', { 
            hasValue: !!billing.state, 
            currentValue: currentBillingState 
          });
        }
        const currentBillingPostcode = methods.getValues('billingPostcode');
        if (billing.postcode && (!currentBillingPostcode || currentBillingPostcode.trim() === '')) {
          methods.setValue('billingPostcode', billing.postcode, { shouldValidate: false });
          console.log('[Billing]  Populated billingPostcode:', billing.postcode);
        } else {
          console.log('[Billing]  Skipped billingPostcode:', { 
            hasValue: !!billing.postcode, 
            currentValue: currentBillingPostcode 
          });
        }
      } else {
        console.log('[Billing]  No billing data available from customer');
      }
      console.log('[Billing]  Form fields populated - setting fieldsPopulated to true');
      setFieldsPopulated(true);
    } else {
      console.log('[Billing]  Skipping field population:', {
        isLoggedIn,
        hasCustomer: !!customer,
        fieldsPopulated,
        reason: !isLoggedIn ? 'not logged in' : !customer ? 'no customer data' : 'already populated',
      });
    }
  }, [isLoggedIn, customer, fieldsPopulated]);
  // Reset fieldsPopulated when customer data changes (e.g., after login)
  useEffect(() => {
    if (isLoggedIn && customer && fieldsPopulated) {
      // Check if customer data has actually changed by comparing key fields
      const currentEmail = methods.getValues('email');
      if (customer.email && currentEmail !== customer.email) {
        console.log('[Billing] Customer data changed, resetting population flag');
        setFieldsPopulated(false);
      }
    }
  }, [customer?.email, customer?.id, isLoggedIn, fieldsPopulated]);
  // Handle login success - refetch user data and populate fields
  const handleLoginSuccess = async () => {
    const { data: newUserData } = await refetchUser();
    if (newUserData?.customer) {
      setFieldsPopulated(false); // Reset to trigger population
    }
  };
  // Handle account creation success - same as login success
  const handleAccountCreated = async () => {
    await handleLoginSuccess();
  };
  // Pass Stripe data to parent
  useEffect(() => {
    if (onStripeClientSecret && stripeClientSecret) {
      onStripeClientSecret(stripeClientSecret);
    }
  }, [stripeClientSecret, onStripeClientSecret]);
  useEffect(() => {
    if (onStripeElements && stripeElements) {
      onStripeElements(stripeElements);
    }
  }, [stripeElements, onStripeElements]);
  useEffect(() => {
    if (onStripePaymentReady !== undefined) {
      onStripePaymentReady(stripePaymentReady);
    }
  }, [stripePaymentReady, onStripePaymentReady]);
  return (
    <section className="text-gray-700">
      <FormProvider {...methods}>
        {/* Login Section - Outside form to avoid nested forms */}
        <CheckoutLogin onLoginSuccess={handleLoginSuccess} />
        <form onSubmit={methods.handleSubmit(handleFormSubmit)}>
          {/* Compact Form Fields - Side by Side, No Top Labels */}
          <div className="space-y-3 mb-6">
            {/* Email - Full Width */}
            {INPUT_FIELDS.filter(field => field.name === 'email').map(({ id, label, name, customValidation }) => (
              <InputField
                key={id}
                inputLabel={label}
                inputName={name}
                customValidation={customValidation}
                className="w-full"
              />
            ))}
            {/* Shipping Information Heading */}
            <div className="text-sm text-gray-600 mb-3">Shipping Information</div>
            {/* First Name and Last Name - Side by Side */}
            <div className="flex gap-3">
              {INPUT_FIELDS.filter(field => field.name === 'firstName' || field.name === 'lastName').map(({ id, label, name, customValidation }) => (
                <InputField
                  key={id}
                  inputLabel={label}
                  inputName={name}
                  customValidation={customValidation}
                />
              ))}
            </div>
            {/* Address - Full Width */}
            {INPUT_FIELDS.filter(field => field.name === 'address1').map(({ id, label, name, customValidation }) => (
              <InputField
                key={id}
                inputLabel={label}
                inputName={name}
                customValidation={customValidation}
                className="w-full"
              />
            ))}
            {/* City, State, and Postal Code - Side by Side */}
            <div className="flex gap-3">
              {INPUT_FIELDS.filter(field => field.name === 'city').map(({ id, label, name, customValidation }) => (
                <InputField
                  key={id}
                  inputLabel={label}
                  inputName={name}
                  customValidation={customValidation}
                />
              ))}
              <StateField />
              {INPUT_FIELDS.filter(field => field.name === 'postcode').map(({ id, label, name, customValidation }) => (
                <InputField
                  key={id}
                  inputLabel={label}
                  inputName={name}
                  customValidation={customValidation}
                />
              ))}
            </div>
            {/* Phone - Full Width */}
            {INPUT_FIELDS.filter(field => field.name === 'phone').map(({ id, label, name, customValidation }) => (
              <InputField
                key={id}
                inputLabel={label}
                inputName={name}
                customValidation={customValidation}
                className="w-full"
              />
            ))}
          </div>
          {/* Create Account During Checkout */}
          {email && !isLoggedIn && (
            <CreateAccountCheckbox
              email={email}
              firstName={methods.watch('firstName')}
              lastName={methods.watch('lastName')}
              onAccountCreated={handleAccountCreated}
            />
          )}
          {/* Payment Method */}
          <PaymentMethod 
            onStripeClientSecret={setStripeClientSecret}
            onStripeElementReady={setStripePaymentReady}
          />
          {/* Credit Card Fields - Stripe Elements or manual fields */}
          <CreditCardFields 
            stripeClientSecret={stripeClientSecret}
            onStripeElementReady={setStripeElements}
            onStripePaymentReady={setStripePaymentReady}
          />
          {/* Billing Address Checkbox */}
          <BillingAddressCheckbox />
          {/* Billing Address Fields - Show when checkbox is unchecked */}
          <BillingAddressFields />
          {/* Order Button */}
          <OrderButton isProcessingStripe={isProcessingStripe} />
        </form>
      </FormProvider>
    </section>
  );
};
export default Billing;
````

## File: src/components/Checkout/CheckoutForm.component.tsx
````typescript
/*eslint complexity: ["error", 20]*/
// Imports
import { useState, useEffect, useRef } from 'react';
import { useQuery, useMutation, ApolloError } from '@apollo/client';
import { getApolloAuthClient, useAuth } from '@faustwp/core';
import { loadStripe, Stripe, StripeElements } from '@stripe/stripe-js';
import client from '@/utils/apollo/ApolloClient';
// Components
import Billing from './Billing.component';
import CheckoutOrderSummary from './CheckoutOrderSummary.component';
import LoadingSpinner from '../LoadingSpinner/LoadingSpinner.component';
import CheckoutConfirmation from './CheckoutConfirmation.component';
// GraphQL
import { GET_CART } from '@/utils/gql/GQL_QUERIES';
import { CHECKOUT_MUTATION } from '@/utils/gql/GQL_MUTATIONS';
import { useCartStore } from '@/stores/cartStore';
// Utils
import {
  getFormattedCart,
  createCheckoutData,
  ICheckoutDataProps,
} from '@/utils/functions/functions';
export interface IBilling {
  firstName: string;
  lastName: string;
  address1: string;
  city: string;
  postcode: string;
  email: string;
  phone: string;
}
export interface IShipping {
  firstName: string;
  lastName: string;
  address1: string;
  city: string;
  postcode: string;
  email: string;
  phone: string;
}
export interface ICheckoutData {
  clientMutationId: string;
  billing: IBilling;
  shipping: IShipping;
  shipToDifferentAddress: boolean;
  paymentMethod: string;
  isPaid: boolean;
  transactionId: string;
}
interface OrderResponse {
  checkout: {
    result: string;
    redirect: string;
    order: {
      id: string;
      databaseId: number;
      orderNumber: string;
      orderKey: string;
      status: string;
      date: string;
      total: string;
      subtotal: string;
      totalTax: string;
      shippingTotal: string;
      paymentMethod: string;
      paymentMethodTitle: string;
      currency: string;
      billing: {
        firstName: string;
        lastName: string;
        address1: string;
        address2?: string;
        city: string;
        state?: string;
        postcode: string;
        country: string;
        email: string;
        phone?: string;
        company?: string;
      };
      shipping: {
        firstName: string;
        lastName: string;
        address1: string;
        address2?: string;
        city: string;
        state?: string;
        postcode: string;
        country: string;
      };
      lineItems: {
        nodes: Array<{
          id: string;
          productId: number | null;
          quantity: number;
          subtotal: string;
          total: string;
          product: {
            node: {
              id: string;
              name: string;
              image: {
                sourceUrl: string;
                altText: string;
              } | null;
            };
          } | null;
          variation: {
            node: {
              id: string;
              name: string;
              image: {
                sourceUrl: string;
                altText: string;
              } | null;
            };
          } | null;
        }>;
      };
    } | null;
  };
}
const CheckoutForm = () => {
  const { cart, clearWooCommerceSession, syncWithWooCommerce } = useCartStore();
  const [orderData, setOrderData] = useState<ICheckoutData | null>(null);
  const [requestError, setRequestError] = useState<ApolloError | null>(null);
  const [orderCompleted, setorderCompleted] = useState<boolean>(false);
  const [completedOrder, setCompletedOrder] = useState<OrderResponse['checkout']['order'] | null>(null);
  // Initialize Faust.js authentication to ensure session is established
  const { isAuthenticated, isReady } = useAuth({
    strategy: 'local',
    loginPageUrl: '/login-faust',
    shouldRedirect: false, // Don't redirect on checkout page
  });
  // Stripe payment processing state
  const [stripeClientSecret, setStripeClientSecret] = useState<string>('');
  const [stripeElements, setStripeElements] = useState<StripeElements | null>(null);
  const [stripePaymentReady, setStripePaymentReady] = useState<boolean>(false);
  const [isProcessingStripe, setIsProcessingStripe] = useState<boolean>(false);
  const stripeRef = useRef<Stripe | null>(null);
  // Initialize Stripe
  useEffect(() => {
    if (process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY) {
      loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY).then((stripe) => {
        stripeRef.current = stripe;
      });
    }
  }, []);
  // Get cart data query
  const { data, refetch, error: cartError } = useQuery(GET_CART, {
    notifyOnNetworkStatusChange: true,
    errorPolicy: 'all', // Return partial data even if there are errors
  });
  // Use useEffect instead of onCompleted (deprecated)
  useEffect(() => {
    if (data) {
      const updatedCart = getFormattedCart(data);
      if (!updatedCart && !data?.cart?.contents?.nodes?.length) {
        clearWooCommerceSession();
        return;
      }
      if (updatedCart) {
        syncWithWooCommerce(updatedCart);
      }
    }
  }, [data, clearWooCommerceSession, syncWithWooCommerce]);
  // Log errors for debugging
  useEffect(() => {
    if (cartError) {
      console.error('[CheckoutForm] Error fetching cart:', cartError);
    }
  }, [cartError]);
  // Checkout GraphQL mutation - use authenticated client if user is logged in, otherwise use regular client
  // This ensures the order is associated with the logged-in user when authenticated
  const authClient = isAuthenticated && isReady ? getApolloAuthClient() : client;
  const [checkout, { loading: checkoutLoading, data: checkoutData, error: checkoutError }] = useMutation<OrderResponse>(
    CHECKOUT_MUTATION,
    {
      client: authClient, // Use authenticated client if logged in, regular client for guests
      variables: {
        input: orderData,
      },
      errorPolicy: 'all', // Return partial data even if there are errors
    },
  );
  // Use useEffect instead of onCompleted (deprecated)
  useEffect(() => {
    if (checkoutData?.checkout?.order) {
      clearWooCommerceSession();
      setorderCompleted(true);
      setCompletedOrder(checkoutData.checkout.order);
      refetch();
    }
  }, [checkoutData, clearWooCommerceSession, refetch]);
  // Log errors for debugging
  useEffect(() => {
    if (checkoutError) {
      setRequestError(checkoutError);
      console.error('[CheckoutForm] Checkout mutation error:', checkoutError);
      refetch();
    }
  }, [checkoutError, refetch]);
  useEffect(() => {
    if (checkoutData?.checkout && !checkoutData.checkout.order) {
      console.error('[CheckoutForm] Checkout completed but no order data received');
    }
  }, [checkoutData]);
  useEffect(() => {
    if (null !== orderData) {
      // Perform checkout mutation when the value for orderData changes.
      checkout();
      setTimeout(() => {
        refetch();
      }, 2000);
    }
  }, [checkout, orderData, refetch]);
  useEffect(() => {
    refetch();
  }, [refetch]);
  const handleFormSubmit = async (submitData: ICheckoutDataProps) => {
    // Ensure all required fields have defaults
    const formData: ICheckoutDataProps = {
      ...submitData,
      address2: submitData.address2 || '',
      country: submitData.country || 'US',
      state: submitData.state || '',
      company: submitData.company || '',
      paymentMethod: submitData.paymentMethod || 'bacs',
    };
    // Note: If user is logged in (cookies are set), WooCommerce GraphQL will automatically
    // associate this order with the user's account. The checkout mutation uses cookie-based
    // authentication, so no additional user ID needs to be passed.
    const stripeGatewayId = process.env.NEXT_PUBLIC_STRIPE_GATEWAY_ID || 'stripe';
    const isStripe = formData.paymentMethod === stripeGatewayId || 
                     formData.paymentMethod === 'stripe' || 
                     formData.paymentMethod === 'stripe_cc' ||
                     formData.paymentMethod === 'woocommerce_gateway_stripe' ||
                     formData.paymentMethod?.startsWith('stripe');
    // Process Stripe payment if Stripe is selected
    if (isStripe && stripeRef.current && stripeElements && stripeClientSecret) {
      setIsProcessingStripe(true);
      try {
        // Submit the elements to validate the form
        const { error: submitError } = await stripeElements.submit();
        if (submitError) {
          console.error('Stripe form validation failed:', submitError);
          setRequestError(new Error(submitError.message) as ApolloError);
          setIsProcessingStripe(false);
          return;
        }
        // Confirm payment with Stripe
        const { error, paymentIntent } = await stripeRef.current.confirmPayment({
          elements: stripeElements,
          clientSecret: stripeClientSecret,
          confirmParams: {
            return_url: `${window.location.origin}/checkout/order-received`,
            payment_method_data: {
              billing_details: {
                name: `${formData.firstName || ''} ${formData.lastName || ''}`.trim() || undefined,
                email: formData.email || undefined,
                phone: formData.phone || undefined,
                address: {
                  line1: formData.address1 || undefined,
                  line2: formData.address2 || undefined,
                  city: formData.city || undefined,
                  state: formData.state || undefined,
                  postal_code: formData.postcode || undefined,
                  country: formData.country || undefined,
                },
              },
            },
          },
          redirect: 'if_required',
        });
        if (error) {
          console.error('Stripe payment failed:', error);
          setRequestError(new Error(error.message) as ApolloError);
          setIsProcessingStripe(false);
          return;
        }
        if (paymentIntent) {
          // Add Stripe metadata to checkout data
          const stripeMetaData = [
            { key: '_stripe_payment_intent_id', value: paymentIntent.id },
            { key: '_stripe_payment_method_id', value: paymentIntent.payment_method as string || '' },
            { key: '_stripe_source_id', value: paymentIntent.id },
            { key: '_stripe_fee', value: '0' },
            { key: '_stripe_net', value: paymentIntent.amount.toString() },
            { key: '_stripe_currency', value: paymentIntent.currency },
            { key: '_stripe_charge_captured', value: 'yes' },
            { key: '_wc_stripe_payment_method_type', value: 'card' },
          ];
          formData.metaData = stripeMetaData;
          formData.isPaid = paymentIntent.status === 'succeeded' || paymentIntent.status === 'processing';
          formData.transactionId = paymentIntent.id;
        }
      } catch (error: any) {
        console.error('Stripe payment error:', error);
        setRequestError(new Error(error.message || 'Payment processing failed') as ApolloError);
        setIsProcessingStripe(false);
        return;
      } finally {
        setIsProcessingStripe(false);
      }
    }
    const checkOutData = createCheckoutData(formData);
    setOrderData(checkOutData);
    setRequestError(null);
  };
  return (
    <>
      {cart && !orderCompleted ? (
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
          {/* Two Column Layout */}
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8">
            {/* Left Column - Checkout Form */}
            <div className="lg:col-span-2 order-2 lg:order-1">
              <div className="bg-white rounded-lg shadow-sm p-6 md:p-8">
                <h1 className="text-2xl md:text-3xl font-bold text-gray-900 mb-6">
                  Checkout
                </h1>
                {/* Error display*/}
                {requestError && (
                  <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                    <p className="text-red-600">
                      An error has occurred. Please try again.
                    </p>
                  </div>
                )}
                {/* Checkout Loading*/}
                {checkoutLoading && (
                  <div className="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg text-center">
                    <p className="text-blue-600 mb-2">
                      Processing order, please wait...
                    </p>
                    <LoadingSpinner />
                  </div>
                )}
                {/* Payment Details Form */}
                <Billing 
                  handleFormSubmit={handleFormSubmit}
                  onStripeClientSecret={setStripeClientSecret}
                  onStripeElements={setStripeElements}
                  onStripePaymentReady={setStripePaymentReady}
                  isProcessingStripe={isProcessingStripe}
                />
              </div>
            </div>
            {/* Right Column - Order Summary */}
            <div className="lg:col-span-1 order-1 lg:order-2">
              <CheckoutOrderSummary className="lg:sticky lg:top-20" />
            </div>
          </div>
        </div>
      ) : (
        <>
          {!cart && !orderCompleted && (
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
              <div className="bg-white rounded-lg shadow-sm p-8 text-center">
                <h1 className="text-2xl font-bold text-gray-900 mb-4">
                  No products in cart
                </h1>
                <p className="text-gray-600 mb-6">
                  Your cart is empty. Add some products to continue.
                </p>
                <a
                  href="/catalog"
                  className="inline-block px-6 py-3 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors"
                >
                  Continue Shopping
                </a>
              </div>
            </div>
          )}
          {orderCompleted && completedOrder && (
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
              <CheckoutConfirmation order={completedOrder} />
            </div>
          )}
          {orderCompleted && !completedOrder && (
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
              <div className="bg-white rounded-lg shadow-sm p-8 text-center">
                <h1 className="text-2xl font-bold text-gray-900 mb-4">
                  Thank you for your order!
                </h1>
              </div>
            </div>
          )}
        </>
      )}
    </>
  );
};
export default CheckoutForm;
````

## File: src/components/Checkout/CheckoutLogin.component.tsx
````typescript
"use client";
import { useState, useEffect } from 'react';
import { useQuery } from '@apollo/client';
import { useRouter } from 'next/router';
import { useLogin, useLogout, useAuth, getApolloAuthClient } from '@faustwp/core';
import { GET_CURRENT_USER } from '@/utils/gql/GQL_QUERIES';
import Button from '@/components/UI/Button.component';
interface CheckoutLoginProps {
  onLoginSuccess?: () => void;
}
/**
 * Login component for checkout page
 * Allows customers to log in during checkout
 */
const CheckoutLogin = ({ onLoginSuccess }: CheckoutLoginProps) => {
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [error, setError] = useState<string | null>(null);
  const [showLogin, setShowLogin] = useState(false);
  const router = useRouter();
  // Faust.js authentication hooks
  const { isAuthenticated, isReady } = useAuth({
    strategy: 'local',
    loginPageUrl: '/login-faust', // Required for local strategy
    shouldRedirect: false, // Don't redirect on checkout page
  });
  const { login: faustLogin, loading: loginLoading, data: loginData, error: loginError } = useLogin();
  const { logout: faustLogout, loading: logoutLoading } = useLogout();
  // Get authenticated Apollo client for user data
  const authClient = getApolloAuthClient();
  const { data, refetch } = useQuery(GET_CURRENT_USER, {
    client: authClient, // Use authenticated client
    errorPolicy: 'all',
    fetchPolicy: 'cache-and-network',
  });
  const customer = data?.customer;
  const isLoggedIn = isAuthenticated && !!customer && customer?.id !== 'guest' && customer?.id !== 'cGd1ZXN0';
  // Get user display name (firstName + lastName, or email, or username)
  const getUserDisplayName = () => {
    if (customer?.firstName && customer?.lastName) {
      return `${customer.firstName} ${customer.lastName}`;
    }
    if (customer?.firstName) {
      return customer.firstName;
    }
    if (customer?.email) {
      return customer.email;
    }
    if (customer?.username) {
      return customer.username;
    }
    return 'User';
  };
  // Handle logout using Faust.js
  const handleLogout = async () => {
    try {
      console.log('[CheckoutLogin] Logging out using Faust.js...');
      await faustLogout();
      console.log('[CheckoutLogin] Logout successful');
      // Refetch to update UI
      await refetch();
      // Reload page to clear form data
      router.reload();
    } catch (error) {
      console.error('[CheckoutLogin] Logout error:', error);
    }
  };
  // Handle login response from Faust.js (same pattern as login-faust.tsx)
  useEffect(() => {
    if (loginData?.generateAuthorizationCode) {
      if (loginData.generateAuthorizationCode.error) {
        setError(loginData.generateAuthorizationCode.error);
      } else if (loginData.generateAuthorizationCode.code) {
        // Login successful - complete the login flow by calling login again
        console.log('[CheckoutLogin] Authorization code received, completing login...');
        const returnUrl = router.asPath;
        faustLogin(username, password, returnUrl);
        // After successful login, refetch user data and call success callback
        setTimeout(async () => {
          try {
            await refetch();
            if (onLoginSuccess) {
              console.log('[CheckoutLogin] Calling onLoginSuccess callback...');
              onLoginSuccess();
            }
            setShowLogin(false);
            setUsername('');
            setPassword('');
          } catch (err) {
            console.warn('[CheckoutLogin] Error refetching after login:', err);
          }
        }, 500);
      }
    }
  }, [loginData, username, password, faustLogin, router, refetch, onLoginSuccess]);
  // Handle login errors
  useEffect(() => {
    if (loginError) {
      setError(loginError.message || 'Login failed. Please try again.');
    }
  }, [loginError]);
  // Show logged in message if user is logged in
  if (isLoggedIn) {
    return (
      <div className="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
        <div className="flex items-center justify-between">
          <div>
            <p className="text-sm text-gray-700">
              Logged in as <span className="font-semibold text-gray-900">{getUserDisplayName()}</span>
              {customer?.email && customer.email !== getUserDisplayName() && (
                <span className="text-gray-500"> ({customer.email})</span>
              )}
            </p>
          </div>
          <button
            type="button"
            onClick={handleLogout}
            disabled={logoutLoading}
            className="text-sm text-blue-600 hover:text-blue-800 font-medium underline disabled:opacity-50 disabled:cursor-not-allowed"
          >
            {logoutLoading ? 'Logging out...' : 'Log out'}
          </button>
        </div>
      </div>
    );
  }
  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    e.stopPropagation();
    // Validate inputs
    if (!username.trim()) {
      setError('Please enter your username or email');
      return;
    }
    if (!password.trim()) {
      setError('Please enter your password');
      return;
    }
    setError(null);
    console.log('[CheckoutLogin] Starting login with Faust.js...', { username: username.substring(0, 3) + '***' });
    // Use Faust.js login - this will trigger generateAuthorizationCode mutation
    faustLogin(username.trim(), password.trim(), router.asPath);
  };
  if (!showLogin) {
    return (
      <div className="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
        <div className="flex items-center justify-between">
          <div>
            <p className="text-sm text-gray-700">
              Already have an account?{' '}
              <button
                type="button"
                onClick={() => setShowLogin(true)}
                className="text-blue-600 hover:text-blue-800 font-medium underline"
              >
                Log in
              </button>
            </p>
          </div>
        </div>
      </div>
    );
  }
  return (
    <div className="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
      <div className="flex items-center justify-between mb-4">
        <h3 className="text-lg font-semibold text-gray-900">Log in to your account</h3>
        <button
          type="button"
          onClick={() => {
            setShowLogin(false);
            setError(null);
            setUsername('');
            setPassword('');
          }}
          className="text-gray-500 hover:text-gray-700"
          aria-label="Close login form"
        >
          <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd" />
          </svg>
        </button>
      </div>
      <form onSubmit={handleLogin} className="space-y-4">
        {error && (
          <div className="p-3 bg-red-50 border border-red-200 rounded-lg">
            <p className="text-sm text-red-600">{error}</p>
          </div>
        )}
        <div>
          <label htmlFor="checkout-username" className="block text-sm font-medium text-gray-700 mb-1">
            Username or Email
          </label>
          <input
            id="checkout-username"
            type="text"
            value={username}
            onChange={(e) => setUsername(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black"
            placeholder="Enter your username or email"
          />
        </div>
        <div>
          <label htmlFor="checkout-password" className="block text-sm font-medium text-gray-700 mb-1">
            Password
          </label>
          <input
            id="checkout-password"
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black"
            placeholder="Enter your password"
          />
        </div>
        <div className="flex items-center justify-between">
          <Button
            type="submit"
            variant="primary"
            buttonDisabled={loginLoading || !username.trim() || !password.trim()}
          >
            {loginLoading ? 'Logging in...' : 'Log in'}
          </Button>
          <a
            href="/login"
            className="text-sm text-blue-600 hover:text-blue-800 underline"
          >
            Forgot password?
          </a>
        </div>
      </form>
    </div>
  );
};
export default CheckoutLogin;
````
